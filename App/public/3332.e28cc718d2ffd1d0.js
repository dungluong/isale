"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3332],{8257:(ee,K,b)=>{b.d(K,{r:()=>A});var v=b(6900);class A{constructor(E=0,T="",G="",$="",D=!1){this.id=0,this.code="",this.staffId=0,this.businessTypeId=0,this.salesLineId=0,this.avatarUrl="",this.fullName="",this.mobile="",this.isImportant=!1,this.gender="",this.email="",this.address="",this.dateOfBirth="",this.lastActive="",this.lastAction="",this.onlineId=0,this.staff=new v.O,this.businessType=null,this.salesLine=null,this.point=0,this.levelId=0,this.level=null,this.buyCount=0,this.fbUserId=null,this.source=null,this.id=E,this.avatarUrl=T,this.fullName=G,this.mobile=$,this.isImportant=D}}},6900:(ee,K,b)=>{b.d(K,{O:()=>v});class v{constructor(r=0,E="",T="",G=""){this.hourLimit=1,this.storeId=0,this.store=null,this.isCollaborator=!1,this.shiftId=0,this.shift=null,this.blockViewingQuantity=!1,this.id=0,this.avatarUrl="",this.name="",this.userName="",this.shopName="",this.createdAt="",this.hasFullAccess=!1,this.canCreateOrder=!1,this.canUpdateDeleteOrder=!1,this.canCreateNewTransaction=!1,this.canUpdateDeleteTransaction=!1,this.canCreateUpdateNote=!1,this.canCreateUpdateDebt=!1,this.canUpdateDeleteProduct=!1,this.canViewProductCostPrice=!1,this.canUpdateProductCostPrice=!1,this.canViewAllContacts=!1,this.canManageContacts=!1,this.updateStatusExceptDone=!1,this.blockEditingOrderPrice=!1,this.id=r,this.avatarUrl=E,this.name=T,this.userName=G}}},8580:(ee,K,b)=>{b.r(K),b.d(K,{FbPageModule:()=>Fo});var v=b(6895),A=b(4006),r=b(191),E=b(2216),T=b(3306),G=b(529),$=b(3093),D=b(3196),p=b(5861),e=b(6738),I=b(7712),N=b(5851),H=b(7488),J=b(323);function ae(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",18),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.delete())}),e._UZ(1,"ion-icon",19),e.qZA()}}function re(o,s){if(1&o&&(e.TgZ(0,"ion-select-option",20),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function se(o,s){if(1&o&&(e.TgZ(0,"div")(1,"i",21),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.example"),": ",n.example,"")}}function le(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",22),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw();e.xp6(1),e.hij(" ",n.strip(n.selectedPage.name,38)," ")}}function ce(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",23),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"fb-page.select-page")," "))}function pe(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePage())}),e._UZ(1,"ion-icon",25),e.qZA()}}let _e=(()=>{class o{constructor(n,t,i,a,l,_){var m=this;this.omniChannelService=n,this.navCtrl=t,this.userService=i,this.translateService=a,this.analyticsService=l,this.alertCtrl=_,this.params=null,this.config={isActive:!0},this.saveDisabled=!1,this.templates=["(s\u1ed1 \u0111i\u1ec7n tho\u1ea1i) (m\xe3 s\u1ea3n ph\u1ea9m)","(m\xe3 s\u1ea3n ph\u1ea9m)","(m\xe3 s\u1ea3n ph\u1ea9m) (s\u1ed1 l\u01b0\u1ee3ng)","(s\u1ed1 \u0111i\u1ec7n tho\u1ea1i) (m\xe3 s\u1ea3n ph\u1ea9m) (s\u1ed1 l\u01b0\u1ee3ng)"],this.templatesExample=["0938111666 SP1234","SP1234","SP1234 12","0938111666 SP1234 12"],this.templatesEn=["(phone) (product code)","(product code)","(product code) (quantity)","(phone) (product code) (quantity)"],this.reload=(0,p.Z)(function*(){const g=yield m.navCtrl.loading();"vn"!==(yield m.userService.getAttr("current-language"))&&(m.templates=m.templatesEn);const x=m.params?m.params:m.navCtrl.getParams();if(m.params=x,x&&x.id&&(m.config=yield m.omniChannelService.getAutoOrderConfig(x.id),m.config.pageId)){const y=yield m.omniChannelService.getPagesByPageId(m.config.pageId);m.selectedPage=y&&y.length?y[0]:null}yield g.dismiss()})}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-auto-order-add")})()}ngOnInit(){this.reload()}showSearchPages(){var n=this;this.analyticsService.logEvent("fb-auto-order-add-search-page");const t=function(){var i=(0,p.Z)(function*(a){const l=a;l&&(n.selectedPage=l,n.config.pageId=l.pageId,n.config.pageName=l.name)});return function(l){return i.apply(this,arguments)}}();this.navCtrl.push("/fbpage/search-page",{callback:t,searchMode:!0})}changeTemplate(){const n=this.templates.indexOf(this.config.comment);n>=0&&(this.example=this.templatesExample[n])}removePage(){this.selectedPage=null,this.config.pageId=null}strip(n,t){return!n||n.length<t?n:n.substring(0,t-1)+"..."}save(){var n=this;return(0,p.Z)(function*(){const t=yield n.navCtrl.loading();n.saveDisabled=!0,n.omniChannelService.saveAutoOrderConfig(n.config).then((0,p.Z)(function*(){n.analyticsService.logEvent("save-auto-order-config-success"),yield t.dismiss(),n.exitPage()}))})()}delete(){var n=this;return(0,p.Z)(function*(){yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-auto-order-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:()=>{n.omniChannelService.deleteReplyConfig(n.config).then((0,p.Z)(function*(){n.analyticsService.logEvent("auto-order-delete-success"),n.navCtrl.pop(),n.navCtrl.publish("reloadFbAutoOrderConfigs",null)}))}}]})).present()})()}exitPage(){var n=this;return(0,p.Z)(function*(){yield n.navCtrl.popOnly(),n.navCtrl.publish("reloadFbAutoOrderConfigs")})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(H.K),e.Y36(T.sK),e.Y36(J.y),e.Y36(r.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-auto-order-add"]],viewQuery:function(n,t){if(1&n&&e.Gf(r.W2,7),2&n){let i;e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:63,vars:57,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"disabled","click"],["name","checkmark"],["color","danger",3,"click",4,"ngIf"],["lines","none"],["position","stacked","color","primary",1,"ion-text-wrap"],[3,"ngModel","ngModelChange"],[3,"ngModel","placeholder","ngModelChange"],["class","ion-text-wrap",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[2,"font-size","0.8em",3,"innerHTML"],["position","stacked","color","primary"],["color","dark",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end","fill","clear",3,"click",4,"ngIf"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["color","danger",3,"click"],["name","trash","slot","icon-only"],[1,"ion-text-wrap",3,"value"],[2,"font-size","0.8em"],["color","dark",3,"click"],[3,"click"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","trash"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.save()}),e._UZ(9,"ion-icon",4),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.YNc(12,ae,2,0,"ion-button",5),e.qZA()()(),e.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item",6)(16,"ion-label",7),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.isActive=a}),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-label",7),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"ion-select",9),e.NdJ("ngModelChange",function(a){return t.config.comment=a})("ngModelChange",function(){return t.changeTemplate()}),e.ALo(25,"translate"),e.YNc(26,re,2,2,"ion-select-option",10),e.qZA(),e.YNc(27,se,4,4,"div",11),e._UZ(28,"p",12),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"ion-item",6)(31,"ion-label",13),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.YNc(34,le,2,1,"ion-button",14),e.YNc(35,ce,3,3,"ion-button",15),e.YNc(36,pe,2,0,"ion-button",16),e.qZA(),e.TgZ(37,"ion-item"),e._UZ(38,"p",12),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"ion-item",6)(41,"ion-label",7),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.applyOnPostComment=a}),e.qZA()(),e.TgZ(45,"ion-item",6)(46,"ion-label",7),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.applyOnMessage=a}),e.qZA()(),e.TgZ(50,"ion-item",6)(51,"ion-label",7),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.TgZ(54,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.applyOnLiveStream=a}),e.qZA()(),e.TgZ(55,"ion-item",6)(56,"ion-label",7),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.TgZ(59,"ion-input",17),e.NdJ("ngModelChange",function(a){return t.config.replyTemplate=a}),e.ALo(60,"translate"),e.qZA(),e._UZ(61,"p",12),e.ALo(62,"translate"),e.qZA()()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,29,"fb-page.title-reply-config-add")),e.xp6(3),e.Q6J("disabled",t.saveDisabled),e.xp6(2),e.hij(" ",e.lcZ(11,31,"action.save")," "),e.xp6(2),e.Q6J("ngIf",t.config&&t.config.id),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(4),e.hij(" ",e.lcZ(18,33,"fb-page.is-active")," "),e.xp6(2),e.Q6J("ngModel",t.config.isActive),e.xp6(3),e.hij(" ",e.lcZ(23,35,"fb-page.auto-order-template")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(25,37,"fb-page.auto-order-template")),e.Q6J("ngModel",t.config.comment),e.xp6(2),e.Q6J("ngForOf",t.templates),e.xp6(1),e.Q6J("ngIf",t.example),e.xp6(1),e.Q6J("innerHTML",e.lcZ(29,39,"fb-page.auto-order-template-description"),e.oJD),e.xp6(4),e.Oqu(e.lcZ(33,41,"fb-page.select-page")),e.xp6(2),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(1),e.Q6J("ngIf",!t.selectedPage||0===t.selectedPage.id),e.xp6(1),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(2),e.Q6J("innerHTML",e.lcZ(39,43,"fb-page.select-page-description"),e.oJD),e.xp6(4),e.hij(" ",e.lcZ(43,45,"fb-page.apply-on-post-comment")," "),e.xp6(2),e.Q6J("ngModel",t.config.applyOnPostComment),e.xp6(3),e.hij(" ",e.lcZ(48,47,"fb-page.apply-on-message")," "),e.xp6(2),e.Q6J("ngModel",t.config.applyOnMessage),e.xp6(3),e.hij(" ",e.lcZ(53,49,"fb-page.apply-on-livestream")," "),e.xp6(2),e.Q6J("ngModel",t.config.applyOnLiveStream),e.xp6(3),e.hij(" ",e.lcZ(58,51,"fb-page.reply-template-for-auto-order")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(60,53,"fb-page.reply-template")),e.Q6J("ngModel",t.config.replyTemplate),e.xp6(2),e.Q6J("innerHTML",e.lcZ(62,55,"fb-page.reply-template-description"),e.oJD))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.pK,r.Ie,r.Q$,r.q_,r.t9,r.n0,r.wd,r.ho,r.sr,r.w,r.QI,r.j9,r.cs,T.X$],encapsulation:2}),o})();var h=b(6723);function me(o,s){if(1&o&&(e.TgZ(0,"span",14),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function ge(o,s){1&o&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"br"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.all-page")))}function de(o,s){if(1&o&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.AsE("",e.lcZ(2,2,"fb-page.post-id"),": ",n.postId,"")}}function ue(o,s){1&o&&(e.TgZ(0,"p")(1,"ion-text",15),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"fb-page.apply-on-post-comment")))}function fe(o,s){1&o&&(e.TgZ(0,"p")(1,"ion-text",15),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"fb-page.apply-on-message")))}function he(o,s){1&o&&(e.TgZ(0,"p")(1,"ion-text",15),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"fb-page.apply-on-livestream")))}function be(o,s){if(1&o&&(e.TgZ(0,"p")(1,"ion-text",16),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"i"),e._uU(5),e.qZA()()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"fb-page.reply-template-for-auto-order"),": "),e.xp6(3),e.Oqu(n.replyTemplate)}}function Ce(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label",9),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.edit(a.id))}),e.YNc(2,me,3,1,"span",10),e.YNc(3,ge,4,3,"span",10),e.YNc(4,de,4,4,"span",10),e.TgZ(5,"span",11),e._uU(6),e.ALo(7,"translate"),e.TgZ(8,"i"),e._uU(9),e.qZA(),e._UZ(10,"br"),e.qZA(),e.YNc(11,ue,4,3,"p",12),e.YNc(12,fe,4,3,"p",12),e.YNc(13,he,4,3,"p",12),e.YNc(14,be,6,4,"p",12),e.qZA(),e.TgZ(15,"ion-toggle",13),e.NdJ("ngModelChange",function(i){const l=e.CHM(n).$implicit;return e.KtG(l.isActive=i)})("ngModelChange",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.updateActive(a))}),e.qZA()()}if(2&o){const n=s.$implicit;e.xp6(2),e.Q6J("ngIf",n.pageName),e.xp6(1),e.Q6J("ngIf",!n.pageName),e.xp6(1),e.Q6J("ngIf",n.postId),e.xp6(2),e.hij("",e.lcZ(7,10,"fb-page.auto-order-template"),": "),e.xp6(3),e.Oqu(n.comment),e.xp6(2),e.Q6J("ngIf",n.applyOnPostComment),e.xp6(1),e.Q6J("ngIf",n.applyOnMessage),e.xp6(1),e.Q6J("ngIf",n.applyOnLiveStream),e.xp6(1),e.Q6J("ngIf",n.replyTemplate),e.xp6(1),e.Q6J("ngModel",n.isActive)}}function xe(o,s){1&o&&(e.TgZ(0,"ion-item",17),e._UZ(1,"div",18),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-auto-order-config"),e.oJD))}let Ze=(()=>{class o{constructor(n,t,i,a){var l=this;this.omniChannelService=n,this.navCtrl=t,this.translateService=i,this.analyticsService=a,this.params=null,this.searchKey="",this.reload=(0,p.Z)(function*(){const _=yield l.navCtrl.loading();l.omniChannelService.getAutoOrderConfigs().then(function(){var m=(0,p.Z)(function*(g){l.originals=JSON.parse(JSON.stringify(g)),l.configs=g,yield _.dismiss()});return function(g){return m.apply(this,arguments)}}())}),this.navCtrl.unsubscribe("reloadFbAutoOrderConfigs",this.reload),this.navCtrl.subscribe("reloadFbAutoOrderConfigs",this.reload)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-auto-order-config")})()}ngOnInit(){this.reload()}edit(n){this.navCtrl.push("/fbpage/auto-order-add",{id:n})}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-auto-order-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.comment&&h.W.stringSpecialContains(i,a.comment)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.postId&&h.W.stringSpecialContains(i,a.postId)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.configs=t})()}clearSearch(){this.searchKey=null,this.reload()}updateActive(n){var t=this;return(0,p.Z)(function*(){yield t.omniChannelService.saveAutoOrderConfig(n)})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(T.sK),e.Y36(J.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-auto-order"]],viewQuery:function(n,t){if(1&n&&e.Gf(r.W2,7),2&n){let i;e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:18,vars:14,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],[3,"click"],["name","add"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],[2,"padding-left","15px","padding-right","15px","font-style","italic","font-size","0.85em",3,"innerHTML"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap",3,"click"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],[2,"white-space","pre-wrap"],[4,"ngIf"],["slot","end",3,"ngModel","ngModelChange"],[2,"white-space","pre-wrap","font-weight","bold"],["color","secondary"],["color","tertiary"],[1,"ion-text-wrap"],[3,"innerHTML"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.edit(0)}),e._UZ(9,"ion-icon",4),e.qZA()()(),e.TgZ(10,"ion-searchbar",5),e.NdJ("ionClear",function(){return t.clearSearch()})("ionChange",function(){return t.search()})("ngModelChange",function(a){return t.searchKey=a}),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"ion-content"),e._UZ(13,"p",6),e.ALo(14,"translate"),e.TgZ(15,"ion-list"),e.YNc(16,Ce,16,12,"ion-item",7),e.YNc(17,xe,3,3,"ion-item",8),e.qZA()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"fb-page.title-auto-order")),e.xp6(5),e.s9C("placeholder",e.lcZ(11,10,"fb-page.search-auto-order-config")),e.Q6J("ngModel",t.searchKey),e.xp6(2),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(1),e.Q6J("innerHTML",e.lcZ(14,12,"fb-page.auto-order-description"),e.oJD),e.xp6(3),e.Q6J("ngForOf",t.configs),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.Ie,r.Q$,r.q_,r.VI,r.yW,r.wd,r.ho,r.sr,r.w,r.j9,r.cs,T.X$],encapsulation:2}),o})();function ve(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",15),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.delete())}),e._UZ(1,"ion-icon",16),e.qZA()}}function Te(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",17),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw();e.xp6(1),e.hij(" ",n.strip(n.selectedPage.name,38)," ")}}function ye(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",18),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"fb-page.select-page")," "))}function Ae(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePage())}),e._UZ(1,"ion-icon",20),e.qZA()}}let Fe=(()=>{class o{constructor(n,t,i,a,l){var _=this;this.omniChannelService=n,this.navCtrl=t,this.translateService=i,this.analyticsService=a,this.alertCtrl=l,this.params=null,this.config={isActive:!0,applyOnPostComment:!0,applyOnLiveStream:!1},this.saveDisabled=!1,this.reload=(0,p.Z)(function*(){const m=yield _.navCtrl.loading(),g=_.params?_.params:_.navCtrl.getParams();_.params=g,g&&g.id&&(_.config=yield _.omniChannelService.getReplyConfig(g.id)),yield m.dismiss()})}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-auto-reply-config-add")})()}ngOnInit(){this.reload()}showSearchPages(){var n=this;this.analyticsService.logEvent("fb-reply-config-add-search-page");const t=function(){var i=(0,p.Z)(function*(a){const l=a;l&&(n.selectedPage=l,n.config.pageId=l.pageId,n.config.pageName=l.name)});return function(l){return i.apply(this,arguments)}}();this.navCtrl.push("/fbpage/search-page",{callback:t,searchMode:!0})}removePage(){this.selectedPage=null,this.config.pageId=null}strip(n,t){return!n||n.length<t?n:n.substring(0,t-1)+"..."}save(){var n=this;return(0,p.Z)(function*(){const t=yield n.navCtrl.loading();n.saveDisabled=!0,n.omniChannelService.saveReplyConfig(n.config).then((0,p.Z)(function*(){n.analyticsService.logEvent("save-reply-config-success"),yield t.dismiss(),n.exitPage()}))})()}delete(){var n=this;return(0,p.Z)(function*(){yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-reply-config-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:()=>{n.omniChannelService.deleteReplyConfig(n.config).then((0,p.Z)(function*(){n.analyticsService.logEvent("reply-config-delete-success"),n.navCtrl.pop(),n.navCtrl.publish("reloadFbReplyConfigs",null)}))}}]})).present()})()}exitPage(){var n=this;return(0,p.Z)(function*(){yield n.navCtrl.popOnly(),n.navCtrl.publish("reloadFbReplyConfigs")})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(T.sK),e.Y36(J.y),e.Y36(r.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-auto-reply-config-add"]],viewQuery:function(n,t){if(1&n&&e.Gf(r.W2,7),2&n){let i;e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:48,vars:41,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"disabled","click"],["name","checkmark"],["color","danger",3,"click",4,"ngIf"],["lines","none"],["position","stacked","color","primary",1,"ion-text-wrap"],[3,"ngModel","ngModelChange"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],[2,"font-size","0.8em",3,"innerHTML"],["position","stacked","color","primary"],["color","dark",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end","fill","clear",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","trash","slot","icon-only"],["color","dark",3,"click"],[3,"click"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","trash"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.save()}),e._UZ(9,"ion-icon",4),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.YNc(12,ve,2,0,"ion-button",5),e.qZA()()(),e.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item",6)(16,"ion-label",7),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.isActive=a}),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-label",7),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"ion-input",9),e.NdJ("ngModelChange",function(a){return t.config.comment=a}),e.ALo(25,"translate"),e.qZA(),e._UZ(26,"p",10),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"ion-item",6)(29,"ion-label",11),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.YNc(32,Te,2,1,"ion-button",12),e.YNc(33,ye,3,3,"ion-button",13),e.YNc(34,Ae,2,0,"ion-button",14),e.qZA(),e.TgZ(35,"ion-item"),e._UZ(36,"p",10),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"ion-item",6)(39,"ion-label",7),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.applyOnPostComment=a}),e.qZA()(),e.TgZ(43,"ion-item",6)(44,"ion-label",7),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"ion-toggle",8),e.NdJ("ngModelChange",function(a){return t.config.applyOnLiveStream=a}),e.qZA()()()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,21,"fb-page.title-reply-config-add")),e.xp6(3),e.Q6J("disabled",t.saveDisabled),e.xp6(2),e.hij(" ",e.lcZ(11,23,"action.save")," "),e.xp6(2),e.Q6J("ngIf",t.config&&t.config.id),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(4),e.hij(" ",e.lcZ(18,25,"fb-page.is-active")," "),e.xp6(2),e.Q6J("ngModel",t.config.isActive),e.xp6(3),e.hij(" ",e.lcZ(23,27,"fb-page.reply-template")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(25,29,"fb-page.reply-template")),e.Q6J("ngModel",t.config.comment),e.xp6(2),e.Q6J("innerHTML",e.lcZ(27,31,"fb-page.reply-template-description"),e.oJD),e.xp6(4),e.Oqu(e.lcZ(31,33,"fb-page.select-page")),e.xp6(2),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(1),e.Q6J("ngIf",!t.selectedPage||0===t.selectedPage.id),e.xp6(1),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(2),e.Q6J("innerHTML",e.lcZ(37,35,"fb-page.select-page-description"),e.oJD),e.xp6(4),e.hij(" ",e.lcZ(41,37,"fb-page.apply-on-post-comment")," "),e.xp6(2),e.Q6J("ngModel",t.config.applyOnPostComment),e.xp6(3),e.hij(" ",e.lcZ(46,39,"fb-page.apply-on-livestream")," "),e.xp6(2),e.Q6J("ngModel",t.config.applyOnLiveStream))},dependencies:[v.O5,A.JJ,A.On,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.pK,r.Ie,r.Q$,r.q_,r.wd,r.ho,r.sr,r.w,r.j9,r.cs,T.X$],encapsulation:2}),o})();function we(o,s){if(1&o&&(e.TgZ(0,"span",14),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function Ue(o,s){1&o&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"br"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.all-page")))}function Me(o,s){if(1&o&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.AsE("",e.lcZ(2,2,"fb-page.post-id"),": ",n.postId,"")}}function Se(o,s){1&o&&(e.TgZ(0,"p")(1,"ion-text",15),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"fb-page.apply-on-post-comment")))}function Ie(o,s){1&o&&(e.TgZ(0,"p")(1,"ion-text",15),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"fb-page.apply-on-livestream")))}function Ne(o,s){if(1&o&&(e.TgZ(0,"p")(1,"ion-text",16),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"i"),e._uU(5),e.qZA()()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"fb-page.reply-template-for-auto-order"),": "),e.xp6(3),e.Oqu(n.replyTemplate)}}function Je(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label",9),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.edit(a.id))}),e.YNc(2,we,3,1,"span",10),e.YNc(3,Ue,4,3,"span",10),e.YNc(4,Me,4,4,"span",10),e.TgZ(5,"span",11),e._uU(6),e.ALo(7,"translate"),e.TgZ(8,"i"),e._uU(9),e.qZA(),e._UZ(10,"br"),e.qZA(),e.YNc(11,Se,4,3,"p",12),e.YNc(12,Ie,4,3,"p",12),e.YNc(13,Ne,6,4,"p",12),e.qZA(),e.TgZ(14,"ion-toggle",13),e.NdJ("ngModelChange",function(i){const l=e.CHM(n).$implicit;return e.KtG(l.isActive=i)})("ngModelChange",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.updateActive(a))}),e.qZA()()}if(2&o){const n=s.$implicit;e.xp6(2),e.Q6J("ngIf",n.pageName),e.xp6(1),e.Q6J("ngIf",!n.pageName),e.xp6(1),e.Q6J("ngIf",n.postId),e.xp6(2),e.hij("",e.lcZ(7,9,"fb-page.reply-template"),": "),e.xp6(3),e.Oqu(n.comment),e.xp6(2),e.Q6J("ngIf",n.applyOnPostComment),e.xp6(1),e.Q6J("ngIf",n.applyOnLiveStream),e.xp6(1),e.Q6J("ngIf",n.replyTemplate),e.xp6(1),e.Q6J("ngModel",n.isActive)}}function qe(o,s){1&o&&(e.TgZ(0,"ion-item",17),e._UZ(1,"div",18),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-reply-config"),e.oJD))}let ke=(()=>{class o{constructor(n,t,i,a){var l=this;this.omniChannelService=n,this.navCtrl=t,this.translateService=i,this.analyticsService=a,this.params=null,this.searchKey="",this.reload=(0,p.Z)(function*(){const _=yield l.navCtrl.loading();l.omniChannelService.getReplyConfigs().then(function(){var m=(0,p.Z)(function*(g){l.originals=JSON.parse(JSON.stringify(g)),l.configs=g,yield _.dismiss()});return function(g){return m.apply(this,arguments)}}())}),this.navCtrl.unsubscribe("reloadFbReplyConfigs",this.reload),this.navCtrl.subscribe("reloadFbReplyConfigs",this.reload)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-auto-reply-config")})()}ngOnInit(){this.reload()}edit(n){this.navCtrl.push("/fbpage/auto-reply-add",{id:n})}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-auto-reply-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.comment&&h.W.stringSpecialContains(i,a.comment)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.postId&&h.W.stringSpecialContains(i,a.postId)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.configs=t})()}clearSearch(){this.searchKey=null,this.reload()}updateActive(n){var t=this;return(0,p.Z)(function*(){yield t.omniChannelService.saveReplyConfig(n)})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(T.sK),e.Y36(J.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-auto-reply-config"]],viewQuery:function(n,t){if(1&n&&e.Gf(r.W2,7),2&n){let i;e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:19,vars:14,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],[3,"click"],["name","add"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],[2,"padding-left","15px","padding-right","15px","font-style","italic"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap",3,"click"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],[2,"white-space","pre-wrap"],[4,"ngIf"],["slot","end",3,"ngModel","ngModelChange"],[2,"white-space","pre-wrap","font-weight","bold"],["color","secondary"],["color","tertiary"],[1,"ion-text-wrap"],[3,"innerHTML"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.edit(0)}),e._UZ(9,"ion-icon",4),e.qZA()()(),e.TgZ(10,"ion-searchbar",5),e.NdJ("ionClear",function(){return t.clearSearch()})("ionChange",function(){return t.search()})("ngModelChange",function(a){return t.searchKey=a}),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"ion-content")(13,"p",6),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"ion-list"),e.YNc(17,Je,15,11,"ion-item",7),e.YNc(18,qe,3,3,"ion-item",8),e.qZA()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"fb-page.title-reply-config")),e.xp6(5),e.s9C("placeholder",e.lcZ(11,10,"fb-page.search-reply-config")),e.Q6J("ngModel",t.searchKey),e.xp6(2),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.hij(" ",e.lcZ(15,12,"fb-page.reply-config-description"),""),e.xp6(3),e.Q6J("ngForOf",t.configs),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.Ie,r.Q$,r.q_,r.VI,r.yW,r.wd,r.ho,r.sr,r.w,r.j9,r.cs,T.X$],encapsulation:2}),o})();var k=b(5439),q=b(1914),F=b(9854),B=b(7696),z=b(3142),V=b(6961),X=b(5129);const Le=["messageInput"],Pe=["fileUploadInput"];function Oe(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-buttons",20)(1,"ion-button",21),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.selectMulti())}),e._UZ(2,"ion-icon",22),e.qZA()()}}function Qe(o,s){if(1&o&&(e.TgZ(0,"b"),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Oqu(n.post.pageName)}}function Ye(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",23)(1,"ion-label",24),e.YNc(2,Qe,3,1,"b",25),e.TgZ(3,"i"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"ion-buttons",20)(7,"ion-button",21),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openPage())}),e._UZ(8,"ion-icon",26),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.post.pageName),e.xp6(2),e.AsE("",e.lcZ(5,3,"fb-page.post-id"),": ",n.post.postId,"")}}function Ke(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",27),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearch())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.search())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.searchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search-comment")),e.Q6J("ngModel",n.searchKey)}}function He(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",28)(1,"ion-checkbox",29),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.selectedAll=i)})("ngModelChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.changeSelectedAll())}),e.qZA(),e.TgZ(2,"ion-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-buttons",20)(6,"ion-button",30),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.deleteMulti())}),e._UZ(7,"ion-icon",31),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.selectedAll),e.xp6(2),e.Oqu(e.lcZ(4,2,"fb-page.select-all-noti"))}}function Ee(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-checkbox",29),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw().$implicit;return e.KtG(a.selected=i)}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("ngModel",n.selected)}}function Ge(o,s){1&o&&e._UZ(0,"ion-icon",43)}function Re(o,s){if(1&o&&(e.TgZ(0,"span")(1,"b"),e._uU(2),e.qZA(),e._UZ(3,"br"),e.qZA()),2&o){const n=e.oxw(2).$implicit;e.xp6(2),e.Oqu(n.parent.fromUserName)}}function $e(o,s){if(1&o&&(e.TgZ(0,"p",44)(1,"span",37),e.YNc(2,Re,4,1,"span",25),e._uU(3),e.qZA()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.Q6J("ngIf",n.parent.fromUserName),e.xp6(1),e.hij(" ",n.parent.comment," ")}}function De(o,s){if(1&o&&(e.TgZ(0,"span",45),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.fromUserName)}}function We(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-img",46),e.NdJ("ionImgDidLoad",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.scroll())}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("src",n.photoUrl)}}function je(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",47)(1,"ion-text",48),e._uU(2),e.qZA(),e._uU(3," \xa0 "),e.TgZ(4,"ion-icon",49),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addToContact(i,i.phone))}),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",50),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.call(i.phone))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.Oqu(n.phone)}}function Be(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",47)(1,"ion-text",51),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," \xa0 "),e.TgZ(5,"ion-icon",52),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.order-added"),": #",n.order.orderCode,"")}}function ze(o,s){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const n=e.oxw().index;e.xp6(1),e.hij("",n+1,".\xa0")}}function Ve(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label",24)(1,"p")(2,"ion-text",48),e.YNc(3,ze,2,1,"span",25),e._uU(4),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",56),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(2).$implicit,_=e.oxw();return e.KtG(_.sendProduct(l,a))}),e.qZA()()()}if(2&o){const n=s.$implicit,t=e.oxw(2).$implicit;e.xp6(3),e.Q6J("ngIf",t.products.length>1),e.xp6(1),e.Oqu(n.title)}}function Xe(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label",47),e.YNc(1,Ve,7,2,"ion-label",53),e.TgZ(2,"ion-label",21),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addOrder(i))}),e.TgZ(3,"p")(4,"ion-text",54),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._uU(7," \xa0"),e._UZ(8,"ion-icon",55),e.qZA()()()}if(2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.products),e.xp6(4),e.Oqu(e.lcZ(6,2,"fb-page.add-order"))}}function en(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",57),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.reply(i))}),e.qZA()}}function nn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",58),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.moreAction(i))}),e.qZA()}}function tn(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",20),e._UZ(1,"ion-img",59),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function on(o,s){if(1&o&&(e.TgZ(0,"ion-item",23),e.YNc(1,Ee,1,1,"ion-checkbox",32),e.YNc(2,Ge,1,0,"ion-icon",33),e.TgZ(3,"ion-label",34),e.YNc(4,$e,4,2,"p",35),e.YNc(5,De,3,1,"span",36),e.TgZ(6,"span",37),e._uU(7),e.qZA(),e.YNc(8,We,1,1,"ion-img",38),e.TgZ(9,"p",39),e._uU(10),e.qZA(),e.YNc(11,je,7,1,"p",40),e.YNc(12,Be,6,4,"p",40),e.YNc(13,Xe,9,4,"ion-label",40),e.qZA(),e.YNc(14,en,1,0,"ion-icon",41),e.YNc(15,nn,1,0,"ion-icon",42),e.YNc(16,tn,2,1,"ion-avatar",2),e.qZA()),2&o){const n=s.$implicit,t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.multiSelect),e.xp6(1),e.Q6J("ngIf",n.fromUser),e.xp6(1),e.Q6J("slot",n.fromUser?"start":"end"),e.xp6(1),e.Q6J("ngIf",n.parent),e.xp6(1),e.Q6J("ngIf",n.fromUserName&&n.fromUser),e.xp6(2),e.Oqu(n.comment),e.xp6(1),e.Q6J("ngIf",n.photoUrl),e.xp6(2),e.hij(" ",t.dateFormat(n.timestamp)," "),e.xp6(1),e.Q6J("ngIf",n.phone),e.xp6(1),e.Q6J("ngIf",n.order),e.xp6(1),e.Q6J("ngIf",!n.order&&n.products&&n.products.length&&n.fromUser),e.xp6(1),e.Q6J("ngIf",n.fromUser),e.xp6(1),e.Q6J("ngIf",n.fromUser),e.xp6(1),e.Q6J("ngIf",!n.fromUser)}}function an(o,s){1&o&&(e.TgZ(0,"ion-item",24),e._UZ(1,"div",60),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-comment"),e.oJD))}function rn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-img",46),e.NdJ("ionImgDidLoad",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.scroll())}),e.qZA()}if(2&o){const n=e.oxw(2);e.Q6J("src",n.replyingComment.photoUrl)}}function sn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",23)(1,"ion-label",61)(2,"span"),e._uU(3),e.ALo(4,"translate"),e._UZ(5,"br"),e.qZA(),e.TgZ(6,"span",37),e._uU(7),e.qZA(),e.YNc(8,rn,1,1,"ion-img",38),e.qZA(),e.TgZ(9,"ion-icon",62),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removeReply())}),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("slot",n.replyingComment.fromUser?"start":"end"),e.xp6(2),e.hij("",e.lcZ(4,4,"fb-page.replying"),": "),e.xp6(4),e.Oqu(n.replyingComment.comment),e.xp6(1),e.Q6J("ngIf",n.replyingComment.photoUrl)}}function ln(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",23)(1,"ion-label")(2,"ion-thumbnail"),e._UZ(3,"img",63),e.qZA()(),e.TgZ(4,"ion-button",64),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePhoto())}),e._UZ(5,"ion-icon",65),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(3),e.Q6J("src",n.photo,e.LSH)}}function cn(o,s){1&o&&(e.TgZ(0,"label",66),e._UZ(1,"ion-icon",67),e.qZA())}function pn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"input",68,69),e.NdJ("change",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.rememberFile(i))}),e.qZA()}}function _n(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",70),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.upload())}),e.qZA()}}let mn=(()=>{class o{constructor(n,t,i,a,l,_,m,g,u,x,y,w){var c=this;this.omniChannelService=n,this.contactService=t,this.dataService=i,this.productService=a,this.camera=l,this.actionSheetController=_,this.navCtrl=m,this.translateService=g,this.alertCtrl=u,this.analyticsService=x,this.userService=y,this.currencyPipe=w,this.params=null,this.searchKey="",this.uploadDisabled=!1,this.multiSelect=!1,this.selectedAll=!1,this.tab="all",this.handleComment=function(){var d=(0,p.Z)(function*(Z){const f=Z.detail;f&&c.post&&f.fromUserId!==c.post.fromUserId||f&&c.post&&f.pageId!==c.post.pageId||c.searchKey||(c.originals&&c.originals.push(f),c.comments&&c.comments.push(f),setTimeout((0,p.Z)(function*(){c.content.scrollToBottom(300)}),100),c.post.lastComment=f.comment,c.post.lastTimestamp=new Date,c.post.lastCommentId=f.commentId,c.post.isRead=!0,c.post.fromUser=!0,c.post.lastFromUserName=f.fromUserName,c.post.lastFromUserAvatarUrl=f.fromUserAvatarUrl,yield c.omniChannelService.savePost(c.post),yield c.omniChannelService.setRecentNotification(!1))});return function(Z){return d.apply(this,arguments)}}(),this.reload=(0,p.Z)(function*(){const d=yield c.navCtrl.loading();c.currency=yield c.userService.getAttr("current-currency");const Z=c.params?c.params:c.navCtrl.getParams();c.params=Z,Z&&Z.post&&(c.post=Z.post,c.omniChannelService.getComments(c.post.postId,c.post.pageId).then(function(){var f=(0,p.Z)(function*(C){if(!C||!C.length)return;let P=0;for(const M of C){P++;const U=C.find(L=>L.commentId===M.parentId);M.parent=U;const O=(0,F.wm)(M.comment);if(O&&(M.phone=O),C.length-10<=P){const L=yield c.productService.getProductsByMessage(M.comment);L&&L.length&&(M.products=L)}}c.post.isRead=!0,yield c.omniChannelService.savePost(c.post),yield c.omniChannelService.updateNotificationsForPost(c.post),c.navCtrl.publish("reloadFbNotifications"),c.originals=JSON.parse(JSON.stringify(C)),c.comments=C,setTimeout((0,p.Z)(function*(){c.content.scrollToBottom(300),setTimeout((0,p.Z)(function*(){yield c.messageInput.setFocus()}),500),yield d.dismiss()}),100)});return function(C){return f.apply(this,arguments)}}()))}),this.navCtrl.unsubscribe("reloadFbComments",this.reload),this.navCtrl.subscribe("reloadFbComments",this.reload)}ionViewWillLeave(){this.navCtrl.unsubscribe("fbcomment",this.handleComment)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){n.navCtrl.subscribe("fbcomment",n.handleComment),yield n.analyticsService.setCurrentScreen("fb-comment")})()}ngOnInit(){this.reload()}openPage(){!this.post||(this.analyticsService.logEvent("fb-comment-open-page"),this.navCtrl.openExternalUrl("https://www.facebook.com/"+this.post.postId))}scroll(){var n=this;setTimeout((0,p.Z)(function*(){n.content.scrollToBottom(300)}),100)}selectPage(n){this.navCtrl.push("/fbpage/detail",{id:n})}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-comment-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.comment&&h.W.stringSpecialContains(i,a.comments)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.fromUserId&&h.W.stringSpecialContains(i,a.fromUserId)||a.fromUserName&&h.W.stringSpecialContains(i,a.fromUserName)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.comments=t})()}clearSearch(){this.searchKey=null,this.reload()}dateFormat(n){const t=n?k(n):k();let i=n;return(!n||n.indexOf(":00Z")<0)&&(i=t.format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(i)}loginFacebook(){FB.login(n=>{"connected"===n.status?this.readPages():alert(this.translateService.instant("fb-page.login-fail-alert"))},{scope:"public_profile,pages_show_list,pages_manage_metadata,pages_messaging,pages_manage_engagement,user_videos"})}readPages(){var n=this;return(0,p.Z)(function*(){const t=n.replyingComment?n.replyingComment.commentId:n.post.postId,i={comment:n.comment,pageId:n.post.pageId,pageName:n.post.pageName,fromUser:!1,photoUrl:n.photo,postId:n.post.postId,parentId:t,commentId:"",parent:n.replyingComment};n.originals.push(i),n.comments.push(i),n.comment="",n.removeReply(),setTimeout(()=>{n.content.scrollToBottom(300)},100);const a=yield(0,F.H5)("/me/accounts",null,null);if(a&&a.data&&a.data.length)for(const l of a.data){if(n.post.pageId!==l.id)continue;n.pageAccessToken=l.access_token;const _=yield(0,F.H5)("/"+t+"/comments","POST",{access_token:n.pageAccessToken,message:i.comment,attachment_url:n.photo});if(!_||!_.id)return void alert(n.translateService.instant("fb-page.login-fail-alert"));i.commentId=_.id,n.post.lastComment=i.comment,n.post.lastCommentId=_.id,n.post.photoUrl=n.photo,n.post.isRead=!0,n.post.fromUser=!1,n.post.notified=!1,n.photo=null,yield n.omniChannelService.saveComment(i),yield n.omniChannelService.savePost(n.post);break}else alert(n.translateService.instant("fb-page.login-fail-alert"))})()}enterMessage(){FB.getLoginStatus(n=>{"connected"===n.status?this.readPages():this.loginFacebook()})}upload(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-upload-avatar"),yield(yield n.actionSheetController.create({header:n.translateService.instant("common.select-image-source"),buttons:[{text:n.translateService.instant("common.load-from-gallery"),handler:()=>{n.doUpload(n.camera.PictureSourceType.PHOTOLIBRARY)}},{text:n.translateService.instant("common.use-camera"),handler:()=>{n.doUpload(n.camera.PictureSourceType.CAMERA)}},{text:n.translateService.instant("common.cancel"),role:"cancel"}]})).present()})()}doUpload(n){var t=this;return(0,p.Z)(function*(){t.uploadDisabled=!0,t.camera.getPicture({quality:100,sourceType:n,destinationType:t.camera.DestinationType.DATA_URL,encodingType:t.camera.EncodingType.JPEG,mediaType:t.camera.MediaType.PICTURE}).then(function(){var a=(0,p.Z)(function*(l){const _=l,m=yield t.navCtrl.loading();t.dataService.uploadPictureBase64(_).then(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),u&&u.url?(t.photo=u.url,t.uploadDisabled=!1,t.fileToUpload=null,t.fileUploadInput.nativeElement.value=null):u&&u.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),t.uploadDisabled=!1});return function(u){return g.apply(this,arguments)}}()).catch(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),console.error(u)});return function(u){return g.apply(this,arguments)}}())});return function(l){return a.apply(this,arguments)}}())})()}removePhoto(){this.photo=null}rememberFile(n){this.fileToUpload=n.target.files[0],this.browsePicture()}browsePicture(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-browse-avatar"),n.fileToUpload?(n.uploadDisabled=!0,n.dataService.uploadPicture(n.fileToUpload).then(t=>{t&&t.url?n.photo=t.url:t&&t.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null}).catch(()=>{alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null})):alert(n.translateService.instant("note-add.no-picture-selected"))})()}reply(n){var t=this;this.replyingComment=n,setTimeout((0,p.Z)(function*(){t.content.scrollToBottom(300),yield t.messageInput.setFocus()}),100)}removeReply(){this.replyingComment=null}selectMulti(){this.multiSelect=!this.multiSelect}changeSelectedAll(){for(const n of this.comments)n.selected=this.selectedAll}deleteMulti(){var n=this;return(0,p.Z)(function*(){var i;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-multi-comment-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:(i=(0,p.Z)(function*(){for(const a of n.comments)a.selected&&(yield n.omniChannelService.deleteComment(a));n.analyticsService.logEvent("comment-delete-success"),n.navCtrl.publish("reloadFbComments",null),n.multiSelect=!1}),function(){return i.apply(this,arguments)})}]})).present()})()}chat(n){this.navCtrl.push("/fbpage/messages",{comment:n})}call(n){h.W.callPhone(n)}text(n){h.W.sendSms(n)}addToContact(n,t=null){var i=this;return(0,p.Z)(function*(){const a=yield i.contactService.searchContactByFbUserId(n.fromUserId);if(a)return t?void i.navCtrl.push("/contact/add",{id:a.id,phone:t}):void i.navCtrl.push("/contact/detail",{id:a.id});i.navCtrl.push("/contact/add",{fbcomment:n,phone:t})})()}addOrder(n){var t=this;return(0,p.Z)(function*(){t.navCtrl.push("/order/add",{fbcomment:n,products:n.products})})()}moreAction(n){var t=this;return(0,p.Z)(function*(){const i=[{icon:"mail",text:t.translateService.instant("fb-page.private-chat"),handler:()=>{t.chat(n)}},{icon:"person-add",text:t.translateService.instant("fb-page.add-contact"),handler:()=>{t.addToContact(n)}},{text:t.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}];yield(yield t.actionSheetController.create({header:t.translateService.instant("action.action"),buttons:i})).present()})()}sendProduct(n,t=null){if(t){const a=this.currencyPipe.transform(t.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let l=t.code;return l=l?l+" "+t.title:t.title,l=l&&t.description?l+"\r\n"+t.description:l,l=l&&t.price?l+"\r\n"+this.translateService.instant("product-add.price")+": "+a:l,this.replyingComment=n,this.comment=l,t.avatarUrl&&(this.photo=t.avatarUrl),void this.enterMessage()}this.navCtrl.push("/product",{callback:a=>{const l=a;if(!l)return;const _=this.currencyPipe.transform(l.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let m=l.code;m=m?m+" "+l.title:l.title,m=m&&l.description?m+"\r\n"+l.description:m,m=m&&l.price?m+"\r\n"+this.translateService.instant("product-add.price")+": "+_:m,this.comment=m,l.avatarUrl&&(this.photo=l.avatarUrl),this.enterMessage()},searchMode:!0})}viewOrder(n){this.navCtrl.push("/order/detail",{id:n.id})}changeTab(){this.analyticsService.logEvent("fb-messageflow-show-tab");let n=JSON.parse(JSON.stringify(this.originals));n=n.filter(t=>"all"===this.tab||"phone"===this.tab&&t.phone||"order"===this.tab&&(t.products||t.order)||"order-phone"===this.tab&&(t.products||t.order||t.phone)),this.comments=n}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(B.y),e.Y36(z.D),e.Y36(V.M),e.Y36(X.V1),e.Y36(r.BX),e.Y36(N.G),e.Y36(T.sK),e.Y36(r.Br),e.Y36(J.y),e.Y36(H.K),e.Y36(v.H9))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-comment"]],viewQuery:function(n,t){if(1&n&&(e.Gf(Le,5),e.Gf(Pe,5),e.Gf(r.W2,7)),2&n){let i;e.iGM(i=e.CRH())&&(t.messageInput=i.first),e.iGM(i=e.CRH())&&(t.fileUploadInput=i.first),e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:39,vars:33,consts:[["slot","start"],["defaultHref","/fbpage"],["slot","end",4,"ngIf"],["lines","none",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","all"],["value","phone",1,"ion-text-wrap"],["value","order",1,"ion-text-wrap"],["value","order-phone",1,"ion-text-wrap"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],["lines","none","style","margin: 5px; ",4,"ngIf"],["lines","none",4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["lines","none",2,"margin-bottom","10px"],[2,"border","2px solid #bbb","border-radius","10px","--padding-start","5px","min-height","50px",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["messageInput",""],["slot","end","color","primary","for","files","style","width: 28px; padding-top: 3px;",4,"ngIf"],["type","file","accept","image/*","id","files","style","width: 0; height: 0; font-size: 0;",3,"change",4,"ngIf"],["slot","end","name","image","color","success",3,"click",4,"ngIf"],["slot","end","name","send","color","success",3,"click"],["slot","end"],[3,"click"],["slot","icon-only","name","list"],["lines","none"],[1,"ion-text-wrap"],[4,"ngIf"],["slot","icon-only","name","logo-facebook"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["lines","none",2,"margin","5px"],["slot","start",3,"ngModel","ngModelChange"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["slot","start",3,"ngModel","ngModelChange",4,"ngIf"],["name","person","slot","start",4,"ngIf"],[1,"ion-text-wrap",2,"border-radius","10px","border","1px solid #ccc","padding","5px","flex","unset","max-width","60%",3,"slot"],["style","border-radius: 5px; border: 1px solid #ccc; padding: 5px;",4,"ngIf"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],[2,"white-space","pre-wrap"],["style","max-width: 288px",3,"src","ionImgDidLoad",4,"ngIf"],[2,"font-size","0.8em"],["style","border: 1px solid #ccc; border-radius: 5px; padding: 5px; margin-top: 5px;",4,"ngIf"],["name","arrow-undo-outline",3,"click",4,"ngIf"],["name","ellipsis-vertical","style","margin-left: 10px;",3,"click",4,"ngIf"],["name","person","slot","start"],[2,"border-radius","5px","border","1px solid #ccc","padding","5px"],[2,"white-space","pre-wrap","font-weight","bold"],[2,"max-width","288px",3,"src","ionImgDidLoad"],[2,"border","1px solid #ccc","border-radius","5px","padding","5px","margin-top","5px"],["color","success"],["name","person-add",3,"click"],["name","call",3,"click"],["color","tertiary",2,"font-size","0.8em",3,"click"],["name","eye",2,"margin-bottom","-3px",3,"click"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["color","primary",2,"font-size","0.8em"],["name","basket",2,"margin-bottom","-3px"],["name","arrow-undo",3,"click"],["name","arrow-undo-outline",3,"click"],["name","ellipsis-vertical",2,"margin-left","10px",3,"click"],[3,"src"],[3,"innerHTML"],[1,"ion-text-wrap",2,"border-radius","10px","border","1px solid #ccc","padding","5px","min-width","65%",3,"slot"],["name","close","color","danger","slot","end",3,"click"],[2,"max-width","150px",3,"src"],["fill","clear","size","small",3,"click"],["size","small","name","trash-outline","slot","icon-only"],["slot","end","color","primary","for","files",2,"width","28px","padding-top","3px"],["name","image","color","success",2,"font-size","28px"],["type","file","accept","image/*","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],["slot","end","name","image","color","success",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Oe,3,0,"ion-buttons",2),e.qZA(),e.YNc(8,Ye,9,5,"ion-item",3),e.TgZ(9,"ion-segment",4),e.NdJ("ngModelChange",function(a){return t.tab=a})("ngModelChange",function(){return t.changeTab()}),e.TgZ(10,"ion-segment-button",5),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-segment-button",6),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"ion-segment-button",7),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"ion-segment-button",8),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.YNc(22,Ke,2,4,"ion-searchbar",9),e.YNc(23,He,8,4,"ion-item",10),e.qZA(),e.TgZ(24,"ion-content")(25,"ion-list"),e.YNc(26,on,17,14,"ion-item",11),e.YNc(27,an,3,3,"ion-item",12),e.qZA()(),e.TgZ(28,"ion-footer"),e.YNc(29,sn,10,6,"ion-item",3),e.YNc(30,ln,6,1,"ion-item",3),e.TgZ(31,"ion-item",13)(32,"ion-input",14,15),e.NdJ("ngModelChange",function(a){return t.comment=a})("keyup.enter",function(){return t.enterMessage()}),e.ALo(34,"translate"),e.qZA(),e.YNc(35,cn,2,0,"label",16),e.YNc(36,pn,2,0,"input",17),e.YNc(37,_n,1,0,"ion-icon",18),e.TgZ(38,"ion-icon",19),e.NdJ("click",function(){return t.enterMessage()}),e.qZA()()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,21,"fb-page.title-comment")),e.xp6(2),e.Q6J("ngIf",t.originals&&t.originals.length),e.xp6(1),e.Q6J("ngIf",t.post),e.xp6(1),e.Q6J("ngModel",t.tab),e.xp6(2),e.hij(" ",e.lcZ(12,23,"fb-page.all-mess")," "),e.xp6(3),e.hij(" ",e.lcZ(15,25,"fb-page.show-phone")," "),e.xp6(3),e.hij(" ",e.lcZ(18,27,"fb-page.show-order")," "),e.xp6(3),e.hij(" ",e.lcZ(21,29,"fb-page.show-order-phone")," "),e.xp6(2),e.Q6J("ngIf","all"===t.tab),e.xp6(1),e.Q6J("ngIf",t.multiSelect&&t.originals&&t.originals.length),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.Q6J("ngForOf",t.comments),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length),e.xp6(2),e.Q6J("ngIf",t.replyingComment),e.xp6(1),e.Q6J("ngIf",t.photo),e.xp6(2),e.s9C("placeholder",e.lcZ(34,31,"fb-page.enter-message")),e.Q6J("ngModel",t.comment),e.xp6(3),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",!t.navCtrl.isNotCordova()))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.BJ,r.oU,r.YG,r.Sm,r.nz,r.W2,r.fr,r.Gu,r.gu,r.Xz,r.pK,r.Ie,r.Q$,r.q_,r.VI,r.cJ,r.GO,r.yW,r.Bs,r.wd,r.sr,r.w,r.QI,r.j9,r.cs,T.X$],encapsulation:2}),o})();var gn=b(9297);const dn=["messageInput"],un=["fileUploadInput"];function fn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-buttons",27)(1,"ion-button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.selectMulti())}),e._UZ(2,"ion-icon",29),e.qZA()()}}function hn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",30),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw();e.xp6(1),e.hij(" ",n.strip(n.selectedPage.name,38)," ")}}function bn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showSearchPages())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"fb-page.select-page")," "))}function Cn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",31),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePage())}),e._UZ(1,"ion-icon",32),e.qZA()}}function xn(o,s){if(1&o&&(e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.AsE(" ",e.lcZ(3,2,"fb-page.livevideo-stream"),": ",n.liveVideo.title," ")}}function Zn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",33),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearch())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.search())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.searchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search-comment")),e.Q6J("ngModel",n.searchKey)}}function vn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",34)(1,"ion-checkbox",35),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.selectedAll=i)})("ngModelChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.changeSelectedAll())}),e.qZA(),e.TgZ(2,"ion-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-buttons",27)(6,"ion-button",36),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.deleteMulti())}),e._UZ(7,"ion-icon",37),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.selectedAll),e.xp6(2),e.Oqu(e.lcZ(4,2,"fb-page.select-all-noti"))}}function Tn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-checkbox",35),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw().$implicit;return e.KtG(a.selected=i)}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("ngModel",n.selected)}}function yn(o,s){1&o&&e._UZ(0,"ion-icon",50)}function An(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e._UZ(1,"ion-img",51),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src",n.fromUserAvatarUrl)}}function Fn(o,s){if(1&o&&(e.TgZ(0,"p",52)(1,"span"),e._uU(2),e.ALo(3,"translate"),e._UZ(4,"br"),e.qZA(),e.TgZ(5,"span",44),e._uU(6),e.qZA()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"fb-page.reply"),": "),e.xp6(4),e.Oqu(n.parent.comment)}}function wn(o,s){if(1&o&&(e.TgZ(0,"span",53),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.fromUserName)}}function Un(o,s){if(1&o&&(e.TgZ(0,"span",53),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function Mn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-img",54),e.NdJ("ionImgDidLoad",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.scroll())}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("src",n.photoUrl)}}function Sn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",55)(1,"ion-text",56),e._uU(2),e.qZA(),e._uU(3," \xa0 "),e.TgZ(4,"ion-icon",57),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addToContact(i,i.phone))}),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",58),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.call(i.phone))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.Oqu(n.phone)}}function In(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",55)(1,"ion-text",59),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," \xa0 "),e.TgZ(5,"ion-icon",60),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.order-added"),": #",n.order.orderCode,"")}}function Nn(o,s){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const n=e.oxw().index;e.xp6(1),e.hij("",n+1,".\xa0")}}function Jn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label",64)(1,"p")(2,"ion-text",56),e.YNc(3,Nn,2,1,"span",9),e._uU(4),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",65),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(2).$implicit,_=e.oxw();return e.KtG(_.sendProduct(l,a))}),e.qZA()()()}if(2&o){const n=s.$implicit,t=e.oxw(2).$implicit;e.xp6(3),e.Q6J("ngIf",t.products.length>1),e.xp6(1),e.Oqu(n.title)}}function qn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label",55),e.YNc(1,Jn,7,2,"ion-label",61),e.TgZ(2,"ion-label",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addOrder(i))}),e.TgZ(3,"p")(4,"ion-text",62),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._uU(7," \xa0"),e._UZ(8,"ion-icon",63),e.qZA()()()}if(2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.products),e.xp6(4),e.Oqu(e.lcZ(6,2,"fb-page.add-order"))}}function kn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",66),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.reply(i))}),e.qZA()}}function Ln(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",67),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.chat(i))}),e.qZA()}}function Pn(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",27),e._UZ(1,"ion-img",51),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function On(o,s){if(1&o&&(e.TgZ(0,"ion-item",3),e.YNc(1,Tn,1,1,"ion-checkbox",38),e.YNc(2,yn,1,0,"ion-icon",39),e.YNc(3,An,2,1,"ion-avatar",40),e.TgZ(4,"ion-label",41),e.YNc(5,Fn,7,4,"p",42),e.YNc(6,wn,3,1,"span",43),e.YNc(7,Un,3,1,"span",43),e.TgZ(8,"span",44),e._uU(9),e.qZA(),e.YNc(10,Mn,1,1,"ion-img",45),e.TgZ(11,"p",46),e._uU(12),e.qZA(),e.YNc(13,Sn,7,1,"p",47),e.YNc(14,In,6,4,"p",47),e.YNc(15,qn,9,4,"ion-label",47),e.qZA(),e.YNc(16,kn,1,0,"ion-icon",48),e.YNc(17,Ln,1,0,"ion-icon",49),e.YNc(18,Pn,2,1,"ion-avatar",2),e.qZA()),2&o){const n=s.$implicit,t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.multiSelect),e.xp6(1),e.Q6J("ngIf",n.fromUser&&!n.fromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",n.fromUser&&n.fromUserAvatarUrl),e.xp6(1),e.Q6J("slot",n.fromUser?"start":"end"),e.xp6(1),e.Q6J("ngIf",n.parent),e.xp6(1),e.Q6J("ngIf",n.fromUserName&&n.fromUser),e.xp6(1),e.Q6J("ngIf",n.pageName&&!n.fromUser),e.xp6(2),e.Oqu(n.comment),e.xp6(1),e.Q6J("ngIf",n.photoUrl),e.xp6(2),e.hij(" ",t.dateFormat(n.timestamp)," "),e.xp6(1),e.Q6J("ngIf",n.phone),e.xp6(1),e.Q6J("ngIf",n.order),e.xp6(1),e.Q6J("ngIf",!n.order&&n.products&&n.products.length&&n.fromUser),e.xp6(1),e.Q6J("ngIf",n.fromUser),e.xp6(1),e.Q6J("ngIf",n.fromUser),e.xp6(1),e.Q6J("ngIf",!n.fromUser)}}function Qn(o,s){1&o&&(e.TgZ(0,"ion-item",64),e._UZ(1,"div",68),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-comment"),e.oJD))}function Yn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-img",54),e.NdJ("ionImgDidLoad",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.scroll())}),e.qZA()}if(2&o){const n=e.oxw(2);e.Q6J("src",n.replyingComment.photoUrl)}}function Kn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",3)(1,"ion-label",69)(2,"span"),e._uU(3),e.ALo(4,"translate"),e._UZ(5,"br"),e.qZA(),e.TgZ(6,"span",44),e._uU(7),e.qZA(),e.YNc(8,Yn,1,1,"ion-img",45),e.qZA(),e.TgZ(9,"ion-icon",70),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removeReply())}),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("slot",n.replyingComment.fromUser?"start":"end"),e.xp6(2),e.hij("",e.lcZ(4,4,"fb-page.replying"),": "),e.xp6(4),e.Oqu(n.replyingComment.comment),e.xp6(1),e.Q6J("ngIf",n.replyingComment.photoUrl)}}function Hn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",3)(1,"ion-label")(2,"ion-thumbnail"),e._UZ(3,"img",71),e.qZA()(),e.TgZ(4,"ion-button",72),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePhoto())}),e._UZ(5,"ion-icon",73),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(3),e.Q6J("src",n.photo,e.LSH)}}function En(o,s){1&o&&(e.TgZ(0,"label",74),e._UZ(1,"ion-icon",75),e.qZA())}function Gn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"input",76,77),e.NdJ("change",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.rememberFile(i))}),e.qZA()}}function Rn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",78),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.upload())}),e.qZA()}}let $n=(()=>{class o{constructor(n,t,i,a,l,_,m,g,u,x,y,w,c){var d=this;this.cdRef=n,this.omniChannelService=t,this.currencyPipe=i,this.productService=a,this.userService=l,this.dataService=_,this.camera=m,this.actionSheetController=g,this.navCtrl=u,this.translateService=x,this.contactService=y,this.alertCtrl=w,this.analyticsService=c,this.params=null,this.originals=[],this.comments=[],this.searchKey="",this.uploadDisabled=!1,this.multiSelect=!1,this.selectedAll=!1,this.tab="all",this.autoOrderConfigs=[],this.reload=(0,p.Z)(function*(){d.currency=yield d.userService.getAttr("current-currency"),d.autoOrderConfigs=yield d.omniChannelService.getAutoOrderConfigsForLive();const Z=d.params?d.params:d.navCtrl.getParams();d.params=Z}),this.readPages=(0,p.Z)(function*(){const Z=yield(0,F.H5)("/me/accounts",null,null);if(Z&&Z.data&&Z.data.length)for(const f of Z.data){if(d.selectedPage.pageId!==f.id)continue;d.pageAccessToken=f.access_token;const C=yield(0,F.H5)("/"+f.id+"/live_videos",null,null);if(!C||!C.data)return void alert(d.translateService.instant("fb-page.login-fail-alert"));if(!C.data.length)return void alert(d.translateService.instant("fb-page.no-livestream-video"));if(d.liveVideo=C.data[0],!d.liveVideo)return;d.cdRef.detectChanges(),d.liveVideoId=d.liveVideo.id,d.readComments();break}else alert(d.translateService.instant("fb-page.login-fail-alert"))}),this.handleLiveEvent=function(){var Z=(0,p.Z)(function*(f){if(!f||!f.data)return;const C=JSON.parse(f.data),P=C.from.id,U={comment:C.message,commentId:C.id,parent:null,phone:null,parentId:null,pageId:d.selectedPage.pageId,pageName:d.selectedPage.pageName,fromUser:P!==d.selectedPage.pageId,fromUserId:P,fromUserName:C.from.name,fromUserAvatarUrl:C.from.picture&&C.from.picture.data?C.from.picture.data.url:""},O=d.comments.find(Y=>Y.commentId===U.parentId);U.parent=O;const L=(0,F.wm)(U.comment);L&&(U.phone=L);const R=yield d.productService.getProductsByMessage(U.comment);R&&R.length&&(U.products=R),d.originals.push(U),d.comments.push(U),d.comment="";const te=C.object?C.object.id:null;te&&!d.post&&(d.post=yield d.omniChannelService.getPostByPostId(d.selectedPage.pageId+"_"+te,d.selectedPage.pageId),d.post&&(d.post.liveVideoId=d.liveVideoId,yield d.omniChannelService.savePost(d.post))),d.removeReply();const S=d.autoOrderConfigs.find(Y=>!Y.pageId||Y.pageId===d.selectedPage.pageId),Q=U.comment.split(" ");let j=!1,oe=1;if(Q&&Q.length&&S&&R&&R.length&&(3!==Q.length||!U.phone||"(s\u1ed1 \u0111i\u1ec7n tho\u1ea1i) (m\xe3 s\u1ea3n ph\u1ea9m) (s\u1ed1 l\u01b0\u1ee3ng)"!==S.comment&&"(phone) (product code) (quantity)"!==S.comment?2!==Q.length||"(m\xe3 s\u1ea3n ph\u1ea9m) (s\u1ed1 l\u01b0\u1ee3ng)"!==S.comment&&"(product code) (quantity)"!==S.comment&&"(s\u1ed1 \u0111i\u1ec7n tho\u1ea1i) (m\xe3 s\u1ea3n ph\u1ea9m)"!==S.comment&&"(phone) (product code)"!==S.comment?1===Q.length&&("(m\xe3 s\u1ea3n ph\u1ea9m)"===S.comment||"(product code)"===S.comment)&&(j=!0):(j=!0,("(m\xe3 s\u1ea3n ph\u1ea9m) (s\u1ed1 l\u01b0\u1ee3ng)"===S.comment||"(product code) (quantity)"===S.comment)&&(oe=Number(Q[1]))):(j=!0,oe=Number(Q[2]))),j){const Y=new gn.K;if(U.phone){const ie=yield d.contactService.searchContactByPhone(U.phone);ie?Y.contactId=ie.id:Y.contactPhone=L}}d.cdRef.detectChanges(),setTimeout(()=>{d.content.scrollToBottom(300)},500)});return function(f){return Z.apply(this,arguments)}}(),this.readComments=()=>{this.source&&this.source.readyState==EventSource.OPEN&&(this.source.removeEventListener("message",this.handleLiveEvent),this.source.close()),this.source=new EventSource("https://streaming-graph.facebook.com/"+this.liveVideoId+"/live_comments?access_token="+this.pageAccessToken+"&comment_rate=ten_per_second&fields=from{name,id,picture},message,object"),this.source.addEventListener("message",this.handleLiveEvent),this.source.onerror=Z=>{alert(this.translateService.instant("fb-page.no-livestream-video"))}},this.navCtrl.unsubscribe("reloadFbComments",this.reload),this.navCtrl.subscribe("reloadFbComments",this.reload)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-comment")})()}ngOnInit(){this.reload()}scroll(){var n=this;setTimeout((0,p.Z)(function*(){n.content.scrollToBottom(300)}),100)}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-comment-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.comment&&h.W.stringSpecialContains(i,a.comments)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.fromUserId&&h.W.stringSpecialContains(i,a.fromUserId)||a.fromUserName&&h.W.stringSpecialContains(i,a.fromUserName)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.comments=t})()}clearSearch(){this.searchKey=null,this.reload()}dateFormat(n){const t=n?k(n):k();let i=n;return(!n||n.indexOf(":00Z")<0)&&(i=t.format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(i)}loginFacebook(){FB.login(n=>{"connected"===n.status?this.readPages():alert(this.translateService.instant("fb-page.login-fail-alert"))},{scope:"public_profile,pages_show_list,pages_manage_metadata,pages_messaging,pages_manage_engagement,user_videos"})}enterMessage(){FB.getLoginStatus(n=>{"connected"===n.status?this.sendReply():this.loginFacebook()})}upload(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-upload-avatar"),yield(yield n.actionSheetController.create({header:n.translateService.instant("common.select-image-source"),buttons:[{text:n.translateService.instant("common.load-from-gallery"),handler:()=>{n.doUpload(n.camera.PictureSourceType.PHOTOLIBRARY)}},{text:n.translateService.instant("common.use-camera"),handler:()=>{n.doUpload(n.camera.PictureSourceType.CAMERA)}},{text:n.translateService.instant("common.cancel"),role:"cancel"}]})).present()})()}doUpload(n){var t=this;return(0,p.Z)(function*(){t.uploadDisabled=!0,t.camera.getPicture({quality:100,sourceType:n,destinationType:t.camera.DestinationType.DATA_URL,encodingType:t.camera.EncodingType.JPEG,mediaType:t.camera.MediaType.PICTURE}).then(function(){var a=(0,p.Z)(function*(l){const _=l,m=yield t.navCtrl.loading();t.dataService.uploadPictureBase64(_).then(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),u&&u.url?(t.photo=u.url,t.uploadDisabled=!1,t.fileToUpload=null,t.fileUploadInput.nativeElement.value=null):u&&u.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),t.uploadDisabled=!1});return function(u){return g.apply(this,arguments)}}()).catch(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),console.error(u)});return function(u){return g.apply(this,arguments)}}())});return function(l){return a.apply(this,arguments)}}())})()}removePhoto(){this.photo=null}rememberFile(n){this.fileToUpload=n.target.files[0],this.browsePicture()}browsePicture(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-browse-avatar"),n.fileToUpload?(n.uploadDisabled=!0,n.dataService.uploadPicture(n.fileToUpload).then(t=>{t&&t.url?n.photo=t.url:t&&t.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null}).catch(()=>{alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null})):alert(n.translateService.instant("note-add.no-picture-selected"))})()}reply(n){var t=this;this.replyingComment=n,setTimeout((0,p.Z)(function*(){t.content.scrollToBottom(300),yield t.messageInput.setFocus()}),100)}removeReply(){this.replyingComment=null}selectMulti(){this.multiSelect=!this.multiSelect}changeSelectedAll(){for(const n of this.comments)n.selected=this.selectedAll}deleteMulti(){var n=this;return(0,p.Z)(function*(){var i;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-multi-comment-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:(i=(0,p.Z)(function*(){for(const a of n.comments)a.selected&&(yield n.omniChannelService.deleteComment(a));n.analyticsService.logEvent("comment-delete-success"),n.navCtrl.publish("reloadFbComments",null),n.multiSelect=!1}),function(){return i.apply(this,arguments)})}]})).present()})()}chat(n){this.navCtrl.push("/fbpage/messages",{comment:n})}strip(n,t){return!n||n.length<t?n:n.substring(0,t-1)+"..."}showSearchPages(){var n=this;this.analyticsService.logEvent("fb-live-comment-search-page");const t=function(){var i=(0,p.Z)(function*(a){const l=a;l&&(n.post=null,n.photo=null,n.replyingComment=null,n.selectedPage=l,n.loginFacebook())});return function(l){return i.apply(this,arguments)}}();this.navCtrl.push("/fbpage/search-page",{callback:t,searchMode:!0})}removePage(){this.selectedPage=null,this.source.close()}call(n){h.W.callPhone(n)}text(n){h.W.sendSms(n)}addToContact(n,t=null){var i=this;return(0,p.Z)(function*(){const a=yield i.contactService.searchContactByFbUserId(n.fromUserId);if(a)return t?void i.navCtrl.push("/contact/add",{id:a.id,phone:t}):void i.navCtrl.push("/contact/detail",{id:a.id});i.navCtrl.push("/contact/add",{fbcomment:n,phone:t})})()}addOrder(n){var t=this;return(0,p.Z)(function*(){t.navCtrl.push("/order/add",{fbcomment:n,products:n.products})})()}moreAction(n){var t=this;return(0,p.Z)(function*(){const i=[{icon:"mail",text:t.translateService.instant("fb-page.private-chat"),handler:()=>{t.chat(n)}},{icon:"person-add",text:t.translateService.instant("fb-page.add-contact"),handler:()=>{t.addToContact(n)}},{text:t.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}];yield(yield t.actionSheetController.create({header:t.translateService.instant("action.action"),buttons:i})).present()})()}sendProduct(n,t=null){if(t){const a=this.currencyPipe.transform(t.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let l=t.code;return l=l?l+" "+t.title:t.title,l=l&&t.description?l+"\r\n"+t.description:l,l=l&&t.price?l+"\r\n"+this.translateService.instant("product-add.price")+": "+a:l,this.replyingComment=n,this.comment=l,t.avatarUrl&&(this.photo=t.avatarUrl),void this.enterMessage()}this.navCtrl.push("/product",{callback:a=>{const l=a;if(!l)return;const _=this.currencyPipe.transform(l.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let m=l.code;m=m?m+" "+l.title:l.title,m=m&&l.description?m+"\r\n"+l.description:m,m=m&&l.price?m+"\r\n"+this.translateService.instant("product-add.price")+": "+_:m,this.comment=m,l.avatarUrl&&(this.photo=l.avatarUrl),this.enterMessage()},searchMode:!0})}viewOrder(n){this.navCtrl.push("/order/detail",{id:n.id})}sendReply(){var n=this;return(0,p.Z)(function*(){const t=n.replyingComment?n.replyingComment.commentId:n.liveVideoId,i={comment:n.comment,pageId:n.selectedPage.pageId,pageName:n.selectedPage.pageName,fromUser:!1,photoUrl:n.photo,liveVideoId:n.liveVideoId,parentId:t,commentId:"",parent:n.replyingComment};n.originals.push(i),n.comments.push(i),n.comment="",n.removeReply(),setTimeout(()=>{n.content.scrollToBottom(300)},100);const a=yield(0,F.H5)("/me/accounts",null,null);if(a&&a.data&&a.data.length)for(const l of a.data){if(n.selectedPage.pageId!==l.id)continue;n.pageAccessToken=l.access_token;const _=yield(0,F.H5)("/"+t+"/comments","POST",{access_token:n.pageAccessToken,message:i.comment,attachment_url:n.photo});if(!_||!_.id)return void alert(n.translateService.instant("fb-page.login-fail-alert"));i.commentId=_.id,n.photo=null;break}else alert(n.translateService.instant("fb-page.login-fail-alert"))})()}changeTab(){this.analyticsService.logEvent("fb-messageflow-show-tab");let n=JSON.parse(JSON.stringify(this.originals));n=n.filter(t=>"all"===this.tab||"phone"===this.tab&&t.phone||"order"===this.tab&&(t.products||t.order)||"order-phone"===this.tab&&(t.products||t.order||t.phone)),this.comments=n}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(e.sBO),e.Y36(I.Q),e.Y36(v.H9),e.Y36(V.M),e.Y36(H.K),e.Y36(z.D),e.Y36(X.V1),e.Y36(r.BX),e.Y36(N.G),e.Y36(T.sK),e.Y36(B.y),e.Y36(r.Br),e.Y36(J.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-live-comment"]],viewQuery:function(n,t){if(1&n&&(e.Gf(dn,5),e.Gf(un,5),e.Gf(r.W2,7)),2&n){let i;e.iGM(i=e.CRH())&&(t.messageInput=i.first),e.iGM(i=e.CRH())&&(t.fileUploadInput=i.first),e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:49,vars:42,consts:[["slot","start"],["defaultHref","/fbpage"],["slot","end",4,"ngIf"],["lines","none"],["position","stacked","color","primary"],["color","dark",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end","fill","clear",3,"click",4,"ngIf"],[2,"font-size","0.8em",3,"innerHTML"],[4,"ngIf"],[3,"ngModel","ngModelChange"],["value","all"],["value","phone",1,"ion-text-wrap"],["value","order",1,"ion-text-wrap"],["value","order-phone",1,"ion-text-wrap"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],["lines","none","style","margin: 5px; ",4,"ngIf"],["lines","none",4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["lines","none",4,"ngIf"],["lines","none",2,"margin-bottom","10px"],[2,"border","2px solid #bbb","border-radius","10px","--padding-start","5px","min-height","50px",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["messageInput",""],["slot","end","color","primary","for","files","style","width: 28px; padding-top: 3px;",4,"ngIf"],["type","file","accept","image/*","id","files","style","width: 0; height: 0; font-size: 0;",3,"change",4,"ngIf"],["slot","end","name","image","color","success",3,"click",4,"ngIf"],["slot","end","name","send","color","success",3,"click"],["slot","end"],[3,"click"],["slot","icon-only","name","list"],["color","dark",3,"click"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","close"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["lines","none",2,"margin","5px"],["slot","start",3,"ngModel","ngModelChange"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["slot","start",3,"ngModel","ngModelChange",4,"ngIf"],["name","person","slot","start",4,"ngIf"],["slot","start",4,"ngIf"],[1,"ion-text-wrap",2,"border-radius","10px","border","1px solid #ccc","padding","5px","flex","unset","max-width","65%",3,"slot"],["style","border-radius: 10px; border: 1px solid #ccc; padding: 5px;",4,"ngIf"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],[2,"white-space","pre-wrap"],["style","max-width: 288px",3,"src","ionImgDidLoad",4,"ngIf"],[2,"font-size","0.8em"],["style","border: 1px solid #ccc; border-radius: 5px; padding: 5px; margin-top: 5px;",4,"ngIf"],["name","arrow-undo-outline",3,"click",4,"ngIf"],["name","mail-outline","style","margin-left: 10px;",3,"click",4,"ngIf"],["name","person","slot","start"],[3,"src"],[2,"border-radius","10px","border","1px solid #ccc","padding","5px"],[2,"white-space","pre-wrap","font-weight","bold"],[2,"max-width","288px",3,"src","ionImgDidLoad"],[2,"border","1px solid #ccc","border-radius","5px","padding","5px","margin-top","5px"],["color","success"],["name","person-add",3,"click"],["name","call",3,"click"],["color","tertiary",2,"font-size","0.8em",3,"click"],["name","eye",2,"margin-bottom","-3px",3,"click"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["color","primary",2,"font-size","0.8em"],["name","basket",2,"margin-bottom","-3px"],[1,"ion-text-wrap"],["name","arrow-undo",3,"click"],["name","arrow-undo-outline",3,"click"],["name","mail-outline",2,"margin-left","10px",3,"click"],[3,"innerHTML"],[1,"ion-text-wrap",2,"border-radius","10px","border","1px solid #ccc","padding","5px","min-width","65%",3,"slot"],["name","close","color","danger","slot","end",3,"click"],[2,"max-width","150px",3,"src"],["fill","clear","size","small",3,"click"],["size","small","name","trash-outline","slot","icon-only"],["slot","end","color","primary","for","files",2,"width","28px","padding-top","3px"],["name","image","color","success",2,"font-size","28px"],["type","file","accept","image/*","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],["slot","end","name","image","color","success",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,fn,3,0,"ion-buttons",2),e.qZA(),e.TgZ(8,"ion-item",3)(9,"ion-label",4),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.YNc(12,hn,2,1,"ion-button",5),e.YNc(13,bn,3,3,"ion-button",6),e.YNc(14,Cn,2,0,"ion-button",7),e.qZA(),e.TgZ(15,"ion-item"),e._UZ(16,"p",8),e.ALo(17,"translate"),e.qZA(),e.YNc(18,xn,4,4,"ion-item",9),e.TgZ(19,"ion-segment",10),e.NdJ("ngModelChange",function(a){return t.tab=a})("ngModelChange",function(){return t.changeTab()}),e.TgZ(20,"ion-segment-button",11),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"ion-segment-button",12),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"ion-segment-button",13),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"ion-segment-button",14),e._uU(30),e.ALo(31,"translate"),e.qZA()(),e.YNc(32,Zn,2,4,"ion-searchbar",15),e.YNc(33,vn,8,4,"ion-item",16),e.qZA(),e.TgZ(34,"ion-content")(35,"ion-list"),e.YNc(36,On,19,16,"ion-item",17),e.YNc(37,Qn,3,3,"ion-item",18),e.qZA()(),e.TgZ(38,"ion-footer"),e.YNc(39,Kn,10,6,"ion-item",19),e.YNc(40,Hn,6,1,"ion-item",19),e.TgZ(41,"ion-item",20)(42,"ion-input",21,22),e.NdJ("ngModelChange",function(a){return t.comment=a})("keyup.enter",function(){return t.enterMessage()}),e.ALo(44,"translate"),e.qZA(),e.YNc(45,En,2,0,"label",23),e.YNc(46,Gn,2,0,"input",24),e.YNc(47,Rn,1,0,"ion-icon",25),e.TgZ(48,"ion-icon",26),e.NdJ("click",function(){return t.enterMessage()}),e.qZA()()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,26,"fb-page.title-live-comment")),e.xp6(2),e.Q6J("ngIf",t.originals&&t.originals.length),e.xp6(3),e.Oqu(e.lcZ(11,28,"fb-page.select-page")),e.xp6(2),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(1),e.Q6J("ngIf",!t.selectedPage||0===t.selectedPage.id),e.xp6(1),e.Q6J("ngIf",t.selectedPage&&t.selectedPage.id>0),e.xp6(2),e.Q6J("innerHTML",e.lcZ(17,30,"fb-page.live-comment-description"),e.oJD),e.xp6(2),e.Q6J("ngIf",t.liveVideo),e.xp6(1),e.Q6J("ngModel",t.tab),e.xp6(2),e.hij(" ",e.lcZ(22,32,"fb-page.all-mess")," "),e.xp6(3),e.hij(" ",e.lcZ(25,34,"fb-page.show-phone")," "),e.xp6(3),e.hij(" ",e.lcZ(28,36,"fb-page.show-order")," "),e.xp6(3),e.hij(" ",e.lcZ(31,38,"fb-page.show-order-phone")," "),e.xp6(2),e.Q6J("ngIf","all"===t.tab),e.xp6(1),e.Q6J("ngIf",t.multiSelect&&t.originals&&t.originals.length),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.Q6J("ngForOf",t.comments),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length),e.xp6(2),e.Q6J("ngIf",t.replyingComment),e.xp6(1),e.Q6J("ngIf",t.photo),e.xp6(2),e.s9C("placeholder",e.lcZ(44,40,"fb-page.enter-message")),e.Q6J("ngModel",t.comment),e.xp6(3),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",!t.navCtrl.isNotCordova()))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.BJ,r.oU,r.YG,r.Sm,r.nz,r.W2,r.fr,r.Gu,r.gu,r.Xz,r.pK,r.Ie,r.Q$,r.q_,r.VI,r.cJ,r.GO,r.yW,r.Bs,r.wd,r.sr,r.w,r.QI,r.j9,r.cs,T.X$],encapsulation:2}),o})();const Dn=["messageInput"],Wn=["fileUploadInput"];function jn(o,s){if(1&o&&(e.TgZ(0,"ion-avatar"),e._UZ(1,"ion-img",27),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("src",n.flow.fromUserAvatarUrl)}}function Bn(o,s){if(1&o&&(e.TgZ(0,"span",28),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Oqu(n.flow.fromUserName)}}function zn(o,s){if(1&o&&(e.TgZ(0,"span",28),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Oqu(n.profile.name)}}function Vn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",23),e.YNc(1,jn,2,1,"ion-avatar",24),e.TgZ(2,"ion-label"),e._uU(3," \xa0 "),e.YNc(4,Bn,3,1,"span",25),e.YNc(5,zn,3,1,"span",25),e.qZA(),e.TgZ(6,"ion-buttons",2)(7,"ion-button",3),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openPage())}),e._UZ(8,"ion-icon",26),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.flow.fromUserAvatarUrl),e.xp6(3),e.Q6J("ngIf",n.flow.fromUserName),e.xp6(1),e.Q6J("ngIf",!n.flow.fromUserName&&n.profile)}}function Xn(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",29),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearch())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.search())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.searchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search-message")),e.Q6J("ngModel",n.searchKey)}}function et(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",30)(1,"ion-checkbox",31),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.selectedAll=i)})("ngModelChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.changeSelectedAll())}),e.qZA(),e.TgZ(2,"ion-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-buttons",2)(6,"ion-button",32),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.deleteMulti())}),e._UZ(7,"ion-icon",33),e.qZA(),e.TgZ(8,"ion-button",34),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.selectMulti())}),e._UZ(9,"ion-icon",35),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.selectedAll),e.xp6(2),e.Oqu(e.lcZ(4,2,"fb-page.select-all-noti"))}}function nt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-checkbox",31),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw().$implicit;return e.KtG(a.selected=i)}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("ngModel",n.selected)}}function tt(o,s){1&o&&e._UZ(0,"ion-icon",46)}function ot(o,s){if(1&o&&e._UZ(0,"ion-img",27),2&o){const n=e.oxw(3);e.Q6J("src",n.flow.fromUserAvatarUrl)}}function it(o,s){if(1&o&&e._UZ(0,"ion-img",27),2&o){const n=e.oxw(3);e.Q6J("src",n.profile.profile_pic)}}function at(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e.YNc(1,ot,1,1,"ion-img",47),e.YNc(2,it,1,1,"ion-img",47),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.flow.fromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",!n.flow.fromUserAvatarUrl&&n.profile&&n.profile.profile_pic)}}function rt(o,s){if(1&o&&(e.TgZ(0,"span",28),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function st(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-img",48),e.NdJ("ionImgDidLoad",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.scroll())}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("src",n.photoUrl)}}function lt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",49)(1,"ion-text",50),e._uU(2),e.qZA(),e._uU(3," \xa0 "),e.TgZ(4,"ion-icon",51),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addToContact(i.phone))}),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",52),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.call(i.phone))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.Oqu(n.phone)}}function ct(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"p",49)(1,"ion-text",53),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," \xa0 "),e.TgZ(5,"ion-icon",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.viewOrder(i.order))}),e.qZA()()}if(2&o){const n=e.oxw().$implicit;e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.order-added"),": #",n.order.orderCode,"")}}function pt(o,s){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const n=e.oxw().index;e.xp6(1),e.hij("",n+1,".\xa0")}}function _t(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label")(1,"p")(2,"ion-text",50),e.YNc(3,pt,2,1,"span",24),e._uU(4),e.qZA(),e._uU(5," \xa0 "),e.TgZ(6,"ion-icon",57),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(3);return e.KtG(l.sendProduct(a))}),e.qZA()()()}if(2&o){const n=s.$implicit,t=e.oxw(2).$implicit;e.xp6(3),e.Q6J("ngIf",t.products.length>1),e.xp6(1),e.Oqu(n.title)}}function mt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-label",49),e.YNc(1,_t,7,2,"ion-label",13),e.TgZ(2,"ion-label",3),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addOrder(i))}),e.TgZ(3,"p")(4,"ion-text",55),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._uU(7," \xa0"),e._UZ(8,"ion-icon",56),e.qZA()()()}if(2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.products),e.xp6(4),e.Oqu(e.lcZ(6,2,"fb-page.add-order"))}}function gt(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",2),e._UZ(1,"ion-img",27),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function dt(o,s){if(1&o&&(e.ynx(0),e.TgZ(1,"ion-item",36),e.YNc(2,nt,1,1,"ion-checkbox",37),e.YNc(3,tt,1,0,"ion-icon",38),e.YNc(4,at,3,2,"ion-avatar",39),e.TgZ(5,"ion-label",40),e.YNc(6,rt,3,1,"span",25),e.TgZ(7,"span",41),e._uU(8),e.qZA(),e.YNc(9,st,1,1,"ion-img",42),e.TgZ(10,"p",43),e._uU(11),e.qZA(),e.YNc(12,lt,7,1,"p",44),e.YNc(13,ct,6,4,"p",44),e.YNc(14,mt,9,4,"ion-label",44),e.qZA(),e.YNc(15,gt,2,1,"ion-avatar",45),e.qZA(),e.BQk()),2&o){const n=s.$implicit,t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.multiSelect),e.xp6(1),e.Q6J("ngIf",n.fromUser&&!(t.flow.fromUserAvatarUrl||t.profile&&t.profile.profile_pic)),e.xp6(1),e.Q6J("ngIf",n.fromUser&&(t.flow.fromUserAvatarUrl||t.profile&&t.profile.profile_pic)),e.xp6(1),e.Q6J("slot",n.fromUser?"start":"end"),e.xp6(1),e.Q6J("ngIf",n.pageName&&!n.fromUser),e.xp6(2),e.Oqu(n.message),e.xp6(1),e.Q6J("ngIf",n.photoUrl),e.xp6(2),e.hij(" ",t.dateFormat(n.timestamp)," "),e.xp6(1),e.Q6J("ngIf",n.phone),e.xp6(1),e.Q6J("ngIf",n.order),e.xp6(1),e.Q6J("ngIf",!n.order&&n.products&&n.products.length),e.xp6(1),e.Q6J("ngIf",!n.fromUser)}}function ut(o,s){1&o&&(e.TgZ(0,"ion-item",58),e._UZ(1,"div",59),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-message"),e.oJD))}function ft(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",36)(1,"ion-label")(2,"ion-thumbnail"),e._UZ(3,"img",60),e.qZA()(),e.TgZ(4,"ion-button",61),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removePhoto())}),e._UZ(5,"ion-icon",62),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(3),e.Q6J("src",n.photo,e.LSH)}}function ht(o,s){1&o&&(e.TgZ(0,"label",63),e._UZ(1,"ion-icon",64),e.qZA())}function bt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"input",65,66),e.NdJ("change",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.rememberFile(i))}),e.qZA()}}function Ct(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-icon",67),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.upload())}),e.qZA()}}let xt=(()=>{class o{constructor(n,t,i,a,l,_,m,g,u,x,y,w){var c=this;this.dataService=n,this.omniChannelService=t,this.userService=i,this.contactService=a,this.productService=l,this.camera=_,this.navCtrl=m,this.translateService=g,this.analyticsService=u,this.alertCtrl=x,this.currencyPipe=y,this.actionSheetController=w,this.params=null,this.searchKey="",this.uploadDisabled=!1,this.multiSelect=!1,this.selectedAll=!1,this.tab="all",this.handleMessage=function(){var d=(0,p.Z)(function*(Z){const f=Z.detail;f&&c.flow&&f.fromUserId!==c.flow.fromUserId||f&&c.flow&&f.pageId!==c.flow.pageId||c.searchKey||(c.originals&&c.originals.push(f),c.messages&&c.messages.push(f),setTimeout((0,p.Z)(function*(){c.content.scrollToBottom(300)}),100),c.flow.lastMessage=f.message,c.flow.lastTimestamp=new Date,c.flow.lastMessageId=f.messageId,c.flow.isRead=!0,c.flow.fromUser=!0,c.flow.fromUserAvatarUrl=c.flow.fromUserAvatarUrl?c.flow.fromUserAvatarUrl:c.profile?c.profile.profile_pic:"",c.flow.fromUserName=c.flow.fromUserName?c.flow.fromUserName:c.profile?c.profile.name:"",yield c.omniChannelService.saveFlow(c.flow),yield c.omniChannelService.setRecentNotification(!1))});return function(Z){return d.apply(this,arguments)}}(),this.reload=(0,p.Z)(function*(){const d=yield c.navCtrl.loading();c.currency=yield c.userService.getAttr("current-currency");const Z=c.params?c.params:c.navCtrl.getParams();if(c.params=Z,Z&&Z.flow)c.flow=Z.flow;else if(Z&&Z.comment){const f=Z.comment,C=yield c.omniChannelService.getFlowsByFromUser(f.fromUserId,f.pageId);c.flow={},c.flow.id=0,c.flow.pageId=f.pageId,c.flow.pageName=f.pageName,c.flow.fromUserName=f.fromUserName,c.flow.fromUserId=f.fromUserId,C&&C.length&&(c.flow=C[0]),c.originals=[],c.messages=[]}c.omniChannelService.getMessages(c.flow.fromUserId,c.flow.pageId).then(function(){var f=(0,p.Z)(function*(C){c.flow.isRead=!0,yield c.omniChannelService.saveFlow(c.flow),yield c.omniChannelService.updateNotificationsForFlow(c.flow),c.navCtrl.publish("reloadFbNotifications");let P=0;for(const M of C){P++;const U=(0,F.wm)(M.message);if(U&&(M.phone=U),M.fromUser&&C.length-10<=P){const O=yield c.productService.getProductsByMessage(M.message);O&&O.length&&(M.products=O)}}c.originals=JSON.parse(JSON.stringify(C)),c.messages=C,setTimeout((0,p.Z)(function*(){c.content.scrollToBottom(300),setTimeout((0,p.Z)(function*(){yield c.messageInput.setFocus()}),500),yield d.dismiss()}),100)});return function(C){return f.apply(this,arguments)}}())}),this.navCtrl.unsubscribe("reloadFbMessages",this.reload),this.navCtrl.subscribe("reloadFbMessages",this.reload)}ionViewWillLeave(){this.navCtrl.unsubscribe("fbmessage",this.handleMessage)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){n.navCtrl.subscribe("fbmessage",n.handleMessage),yield n.analyticsService.setCurrentScreen("fb-message")})()}ngOnInit(){this.reload()}selectPage(n){this.navCtrl.push("/fbpage/detail",{id:n})}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-messageflow-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.message&&h.W.stringSpecialContains(i,a.message)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.fromUserId&&h.W.stringSpecialContains(i,a.fromUserId)||a.fromUserName&&h.W.stringSpecialContains(i,a.fromUserName)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.messages=t})()}clearSearch(){this.searchKey=null,this.reload()}loginFacebook(){FB.login(n=>{"connected"===n.status?this.readPages():alert(this.translateService.instant("fb-page.login-fail-alert"))},{scope:"public_profile,pages_show_list,pages_manage_metadata,pages_messaging,pages_manage_engagement,user_videos"})}readPages(){var n=this;return(0,p.Z)(function*(){const t={message:n.message,pageId:n.flow.pageId,pageName:n.flow.pageName,fromUserId:n.flow.fromUserId,fromUser:!1,fromUserAvatarUrl:null,fromUserName:null,photoUrl:n.photo,messageId:""};n.originals.push(t),n.messages.push(t),n.message="",setTimeout(()=>{n.content.scrollToBottom(300)},100);const i=yield(0,F.H5)("/me/accounts",null,null);if(i&&i.data&&i.data.length)for(const a of i.data){if(n.flow.pageId!==a.id)continue;if(n.pageAccessToken=a.access_token,!n.profile){const _=yield(0,F.H5)("/"+n.flow.fromUserId,"GET",{access_token:n.pageAccessToken,fields:"name,profile_pic"});_&&(n.profile=_)}const l=yield(0,F.H5)("/"+n.flow.pageId+"/messages","POST",{access_token:n.pageAccessToken,message:{text:t.message},recipient:{id:n.flow.fromUserId}});if(!l||!l.message_id)return void alert(n.translateService.instant("fb-page.login-fail-alert"));if(n.photo){const _=yield(0,F.H5)("/"+n.flow.pageId+"/messages","POST",{access_token:n.pageAccessToken,message:{attachment:{type:"IMAGE",payload:{url:n.photo}}},recipient:{id:n.flow.fromUserId}});if(!_||!_.message_id)return void alert(n.translateService.instant("fb-page.login-fail-alert"));n.photo=null}t.messageId=l.message_id,t.fromUserAvatarUrl=n.profile?n.profile.profile_pic:"",t.fromUserName=n.profile?n.profile.name:"",n.flow.lastMessage=t.message,n.flow.lastTimestamp=new Date,n.flow.lastMessageId=l.message_id,n.flow.photoUrl=n.photo,n.flow.isRead=!0,n.flow.fromUser=!1,n.flow.fromUserAvatarUrl=n.profile?n.profile.profile_pic:"",n.flow.fromUserName=n.profile?n.profile.name:"",yield n.omniChannelService.saveMessage(t),yield n.omniChannelService.saveFlow(n.flow);break}else alert(n.translateService.instant("fb-page.login-fail-alert"))})()}dateFormat(n){const t=n?k(n):k();let i=n;return(!n||n.indexOf(":00Z")<0)&&(i=t.format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(i)}enterMessage(){FB.getLoginStatus(n=>{"connected"===n.status?this.readPages():this.loginFacebook()})}upload(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-upload-avatar"),yield(yield n.actionSheetController.create({header:n.translateService.instant("common.select-image-source"),buttons:[{text:n.translateService.instant("common.load-from-gallery"),handler:()=>{n.doUpload(n.camera.PictureSourceType.PHOTOLIBRARY)}},{text:n.translateService.instant("common.use-camera"),handler:()=>{n.doUpload(n.camera.PictureSourceType.CAMERA)}},{text:n.translateService.instant("common.cancel"),role:"cancel"}]})).present()})()}doUpload(n){var t=this;return(0,p.Z)(function*(){t.uploadDisabled=!0,t.camera.getPicture({quality:100,sourceType:n,destinationType:t.camera.DestinationType.DATA_URL,encodingType:t.camera.EncodingType.JPEG,mediaType:t.camera.MediaType.PICTURE}).then(function(){var a=(0,p.Z)(function*(l){const _=l,m=yield t.navCtrl.loading();t.dataService.uploadPictureBase64(_).then(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),u&&u.url?(t.photo=u.url,t.uploadDisabled=!1,t.fileToUpload=null,t.fileUploadInput.nativeElement.value=null):u&&u.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),t.uploadDisabled=!1});return function(u){return g.apply(this,arguments)}}()).catch(function(){var g=(0,p.Z)(function*(u){yield m.dismiss(),console.error(u)});return function(u){return g.apply(this,arguments)}}())});return function(l){return a.apply(this,arguments)}}())})()}removePhoto(){this.photo=null}rememberFile(n){this.fileToUpload=n.target.files[0],this.browsePicture()}browsePicture(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("contact-add-browse-avatar"),n.fileToUpload?(n.uploadDisabled=!0,n.dataService.uploadPicture(n.fileToUpload).then(t=>{t&&t.url?n.photo=t.url:t&&t.error&&alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null}).catch(()=>{alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),n.uploadDisabled=!1,n.fileToUpload=null,n.fileUploadInput.nativeElement.value=null})):alert(n.translateService.instant("note-add.no-picture-selected"))})()}selectMulti(){this.multiSelect=!this.multiSelect}changeSelectedAll(){for(const n of this.messages)n.selected=this.selectedAll}deleteMulti(){var n=this;return(0,p.Z)(function*(){var i;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-multi-message-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:(i=(0,p.Z)(function*(){for(const a of n.messages)a.selected&&(yield n.omniChannelService.deleteMessage(a));n.analyticsService.logEvent("comment-delete-success"),n.navCtrl.publish("reloadFbMessages",null),n.multiSelect=!1}),function(){return i.apply(this,arguments)})}]})).present()})()}scroll(){var n=this;setTimeout((0,p.Z)(function*(){n.content.scrollToBottom(300)}),100)}showHeaderMenu(){var n=this;return(0,p.Z)(function*(){const t=[{text:n.translateService.instant("fb-page.select-multi"),handler:()=>{n.selectMulti()}},{text:n.translateService.instant("fb-page.add-order"),handler:()=>{n.addOrder(null)}},{text:n.translateService.instant("fb-page.send-product"),handler:()=>{n.sendProduct()}},{text:n.translateService.instant("fb-page.add-contact"),handler:()=>{n.addToContact()}},{text:n.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}];yield(yield n.actionSheetController.create({header:n.translateService.instant("action.action"),buttons:t})).present()})()}addOrder(n){this.navCtrl.push("/order/add",{flow:this.flow,products:n.products})}sendProduct(n=null){if(n){const i=this.currencyPipe.transform(n.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let a=n.code;return a=a?a+" "+n.title:n.title,a=a&&n.description?a+"\r\n"+n.description:a,a=a&&n.price?a+"\r\n"+this.translateService.instant("product-add.price")+": "+i:a,this.message=a,n.avatarUrl&&(this.photo=n.avatarUrl),void this.enterMessage()}this.navCtrl.push("/product",{callback:i=>{const a=i;if(!a)return;const l=this.currencyPipe.transform(a.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);let _=a.code;_=_?_+" "+a.title:a.title,_=_&&a.description?_+"\r\n"+a.description:_,_=_&&a.price?_+"\r\n"+this.translateService.instant("product-add.price")+": "+l:_,this.message=_,a.avatarUrl&&(this.photo=a.avatarUrl),this.enterMessage()},searchMode:!0})}addToContact(n=null){var t=this;return(0,p.Z)(function*(){if(!t.flow||!t.flow.fromUserId)return;const i=yield t.contactService.searchContactByFbUserId(t.flow.fromUserId);if(i)return n?void t.navCtrl.push("/contact/add",{id:i.id,phone:n}):void t.navCtrl.push("/contact/detail",{id:i.id});t.navCtrl.push("/contact/add",{flow:t.flow,phone:n})})()}openPage(){!this.flow||(this.analyticsService.logEvent("fb-message-open-profile"),this.navCtrl.openExternalUrl("https://www.facebook.com/"+this.flow.fromUserId))}call(n){h.W.callPhone(n)}text(n){h.W.sendSms(n)}viewOrder(n){this.navCtrl.push("/order/detail",{id:n.id})}changeTab(){this.analyticsService.logEvent("fb-messageflow-show-tab");let n=JSON.parse(JSON.stringify(this.originals));n=n.filter(t=>"all"===this.tab||"phone"===this.tab&&t.phone||"order"===this.tab&&(t.products||t.order)||"order-phone"===this.tab&&(t.products||t.order||t.phone)),this.messages=n}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(z.D),e.Y36(I.Q),e.Y36(H.K),e.Y36(B.y),e.Y36(V.M),e.Y36(X.V1),e.Y36(N.G),e.Y36(T.sK),e.Y36(J.y),e.Y36(r.Br),e.Y36(v.H9),e.Y36(r.BX))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-message"]],viewQuery:function(n,t){if(1&n&&(e.Gf(Dn,5),e.Gf(Wn,5),e.Gf(r.W2,7)),2&n){let i;e.iGM(i=e.CRH())&&(t.messageInput=i.first),e.iGM(i=e.CRH())&&(t.fileUploadInput=i.first),e.iGM(i=e.CRH())&&(t.content=i.first)}},decls:40,vars:31,consts:[["slot","start"],["defaultHref","/fbpage"],["slot","end"],[3,"click"],["slot","icon-only","name","ellipsis-vertical"],["lines","none","style","padding-top: 10px;",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","all"],["value","phone",1,"ion-text-wrap"],["value","order",1,"ion-text-wrap"],["value","order-phone",1,"ion-text-wrap"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],["lines","none","style","margin: 5px; ",4,"ngIf"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["lines","none",4,"ngIf"],["lines","none",2,"margin-bottom","10px"],[2,"border","2px solid #bbb","border-radius","10px","--padding-start","5px","min-height","50px",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["messageInput",""],["slot","end","color","primary","for","files","style","width: 28px; padding-top: 3px;",4,"ngIf"],["type","file","accept","image/*","id","files","style","width: 0; height: 0; font-size: 0;",3,"change",4,"ngIf"],["slot","end","name","image","color","success",3,"click",4,"ngIf"],["slot","end","name","send","color","success",3,"click"],["lines","none",2,"padding-top","10px"],[4,"ngIf"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],["slot","icon-only","name","logo-facebook"],[3,"src"],[2,"white-space","pre-wrap","font-weight","bold"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["lines","none",2,"margin","5px"],["slot","start",3,"ngModel","ngModelChange"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["color","primary",3,"click"],["slot","icon-only","name","close"],["lines","none"],["slot","start",3,"ngModel","ngModelChange",4,"ngIf"],["name","person","slot","start",4,"ngIf"],["slot","start",4,"ngIf"],[1,"ion-text-wrap",2,"border-radius","10px","border","1px solid #ccc","padding","5px","flex","unset","max-width","65%",3,"slot"],[2,"white-space","pre-wrap"],["style","max-width: 288px",3,"src","ionImgDidLoad",4,"ngIf"],[2,"font-size","0.8em"],["style","border: 1px solid #ccc; border-radius: 5px; padding: 5px; margin-top: 5px;",4,"ngIf"],["slot","end",4,"ngIf"],["name","person","slot","start"],[3,"src",4,"ngIf"],[2,"max-width","288px",3,"src","ionImgDidLoad"],[2,"border","1px solid #ccc","border-radius","5px","padding","5px","margin-top","5px"],["color","success"],["name","person-add",3,"click"],["name","call",3,"click"],["color","tertiary",2,"font-size","0.8em",3,"click"],["name","eye",2,"margin-bottom","-3px",3,"click"],["color","primary",2,"font-size","0.8em"],["name","basket",2,"margin-bottom","-3px"],["name","arrow-undo",3,"click"],[1,"ion-text-wrap"],[3,"innerHTML"],[2,"max-width","150px",3,"src"],["fill","clear","size","small",3,"click"],["size","small","name","trash-outline","slot","icon-only"],["slot","end","color","primary","for","files",2,"width","28px","padding-top","3px"],["name","image","color","success",2,"font-size","28px"],["type","file","accept","image/*","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],["slot","end","name","image","color","success",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.showHeaderMenu()}),e._UZ(9,"ion-icon",4),e.qZA()()(),e.YNc(10,Vn,9,3,"ion-item",5),e.TgZ(11,"ion-segment",6),e.NdJ("ngModelChange",function(a){return t.tab=a})("ngModelChange",function(){return t.changeTab()}),e.TgZ(12,"ion-segment-button",7),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"ion-segment-button",8),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"ion-segment-button",9),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"ion-segment-button",10),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.YNc(24,Xn,2,4,"ion-searchbar",11),e.YNc(25,et,10,4,"ion-item",12),e.qZA(),e.TgZ(26,"ion-content")(27,"ion-list"),e.YNc(28,dt,16,12,"ng-container",13),e.YNc(29,ut,3,3,"ion-item",14),e.qZA()(),e.TgZ(30,"ion-footer"),e.YNc(31,ft,6,1,"ion-item",15),e.TgZ(32,"ion-item",16)(33,"ion-input",17,18),e.NdJ("ngModelChange",function(a){return t.message=a})("keyup.enter",function(){return t.enterMessage()}),e.ALo(35,"translate"),e.qZA(),e.YNc(36,ht,2,0,"label",19),e.YNc(37,bt,2,0,"input",20),e.YNc(38,Ct,1,0,"ion-icon",21),e.TgZ(39,"ion-icon",22),e.NdJ("click",function(){return t.enterMessage()}),e.qZA()()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,19,"fb-page.title-message")),e.xp6(5),e.Q6J("ngIf",t.flow&&(t.flow.fromUserName||t.profile)),e.xp6(1),e.Q6J("ngModel",t.tab),e.xp6(2),e.hij(" ",e.lcZ(14,21,"fb-page.all-mess")," "),e.xp6(3),e.hij(" ",e.lcZ(17,23,"fb-page.show-phone")," "),e.xp6(3),e.hij(" ",e.lcZ(20,25,"fb-page.show-order")," "),e.xp6(3),e.hij(" ",e.lcZ(23,27,"fb-page.show-order-phone")," "),e.xp6(2),e.Q6J("ngIf","all"===t.tab),e.xp6(1),e.Q6J("ngIf",t.multiSelect&&t.originals&&t.originals.length),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.Q6J("ngForOf",t.messages),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length),e.xp6(2),e.Q6J("ngIf",t.photo),e.xp6(2),e.s9C("placeholder",e.lcZ(35,29,"fb-page.enter-message")),e.Q6J("ngModel",t.message),e.xp6(3),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",!t.navCtrl.isNotCordova()))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.BJ,r.oU,r.YG,r.Sm,r.nz,r.W2,r.fr,r.Gu,r.gu,r.Xz,r.pK,r.Ie,r.Q$,r.q_,r.VI,r.cJ,r.GO,r.yW,r.Bs,r.wd,r.sr,r.w,r.QI,r.j9,r.cs,T.X$],encapsulation:2}),o})();function Zt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-buttons",7)(1,"ion-button",8),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.selectMulti())}),e._UZ(2,"ion-icon",9),e.qZA()()}}function vt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",10),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearch())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.search())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.searchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search")),e.Q6J("ngModel",n.searchKey)}}function Tt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",11)(1,"ion-checkbox",12),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.selectedAll=i)})("ngModelChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.changeSelectedAll())}),e.qZA(),e.TgZ(2,"ion-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-buttons",7)(6,"ion-button",13),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.deleteMultiNoti())}),e._UZ(7,"ion-icon",14),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.selectedAll),e.xp6(2),e.Oqu(e.lcZ(4,2,"fb-page.select-all-noti"))}}function yt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-checkbox",12),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw().$implicit;return e.KtG(a.selected=i)}),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.Q6J("ngModel",n.selected)}}function At(o,s){if(1&o&&(e.TgZ(0,"span")(1,"i",23),e._uU(2),e.qZA(),e._UZ(3,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.Oqu(n.fromUserName)}}function Ft(o,s){if(1&o&&(e.TgZ(0,"span")(1,"i",23),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"fb-page.comment"),":"),e.xp6(2),e.hij(" ",n.comment,"")}}function wt(o,s){if(1&o&&(e.TgZ(0,"span")(1,"i",23),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"fb-page.chat"),":"),e.xp6(2),e.hij(" ",n.message,"")}}function Ut(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item",15),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.selectMessage(a))}),e.YNc(2,yt,1,1,"ion-checkbox",16),e._UZ(3,"ion-icon",17),e.TgZ(4,"ion-label",18),e.YNc(5,At,4,1,"span",19),e.YNc(6,Ft,5,4,"span",19),e.YNc(7,wt,5,4,"span",19),e.TgZ(8,"p",20),e._uU(9),e.qZA()(),e.TgZ(10,"ion-avatar",7),e._UZ(11,"ion-img",21),e.qZA()(),e.TgZ(12,"ion-item-options",22)(13,"ion-item-option",13),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.deleteNoti(a))}),e._UZ(14,"ion-icon",14),e.qZA()()()}if(2&o){const n=s.$implicit,t=e.oxw();e.xp6(1),e.Q6J("color",n.isRead?"light":"tertiary"),e.xp6(1),e.Q6J("ngIf",t.multiSelect),e.xp6(3),e.Q6J("ngIf",n.fromUserName),e.xp6(1),e.Q6J("ngIf",n.isComment),e.xp6(1),e.Q6J("ngIf",!n.isComment),e.xp6(2),e.hij(" ",t.dateFormat(n.timestamp)," "),e.xp6(2),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function Mt(o,s){1&o&&(e.TgZ(0,"ion-item",24),e._UZ(1,"div",25),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-notification"),e.oJD))}let St=(()=>{class o{constructor(n,t,i,a,l){var _=this;this.omniChannelService=n,this.navCtrl=t,this.translateService=i,this.analyticsService=a,this.alertCtrl=l,this.params=null,this.multiSelect=!1,this.selectedAll=!1,this.reload=(0,p.Z)(function*(){const m=yield _.navCtrl.loading();_.omniChannelService.setRecentNotification(!1),_.navCtrl.publish("recentNoti",!1),_.omniChannelService.getNotificationsFromStorage().then(function(){var g=(0,p.Z)(function*(u){const x=u.filter(y=>y.fromUser);_.originals=JSON.parse(JSON.stringify(x)),_.messages=x,yield m.dismiss()});return function(u){return g.apply(this,arguments)}}())}),this.navCtrl.unsubscribe("reloadFbNotifications",this.reload),this.navCtrl.subscribe("reloadFbNotifications",this.reload)}ionViewWillLeave(){this.navCtrl.unsubscribe("fbmessage",this.reload)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){n.navCtrl.subscribe("fbmessage",n.reload),yield n.analyticsService.setCurrentScreen("fb-notifications")})()}ngOnInit(){this.reload()}dateFormat(n){const t=n?k(n):k();let i=n;return(!n||n.indexOf(":00Z")<0)&&(i=t.format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(i)}selectMessage(n){var t=this;return(0,p.Z)(function*(){if(t.multiSelect)return;if(n.isComment){const a=yield t.omniChannelService.getPostByComment(n);if(!a)return;return void t.navCtrl.push("/fbpage/comments",{post:a})}const i=yield t.omniChannelService.getMessageFlowByMessage(n);!i||t.navCtrl.push("/fbpage/messages",{flow:i})})()}deleteNoti(n){var t=this;return(0,p.Z)(function*(){yield(yield t.alertCtrl.create({header:t.translateService.instant("common.confirm"),message:t.translateService.instant("fb-page.delete-notification-alert"),buttons:[{text:t.translateService.instant("common.cancel"),handler:()=>{}},{text:t.translateService.instant("common.agree"),handler:()=>{t.omniChannelService.deleteNotification(n).then((0,p.Z)(function*(){t.analyticsService.logEvent("notification-delete-success"),t.navCtrl.publish("reloadFbNotifications",null)}))}}]})).present()})()}deleteMultiNoti(){var n=this;return(0,p.Z)(function*(){var i;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-multi-notification-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:(i=(0,p.Z)(function*(){for(const a of n.messages)a.selected&&(yield n.omniChannelService.deleteNotification(a));n.analyticsService.logEvent("notification-delete-success"),n.navCtrl.publish("reloadFbNotifications",null)}),function(){return i.apply(this,arguments)})}]})).present()})()}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-messageflow-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.message&&h.W.stringSpecialContains(i,a.message)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.pageName&&h.W.stringSpecialContains(i,a.pageName))}n.messages=t})()}clearSearch(){this.searchKey=null,this.reload()}selectMulti(){this.multiSelect=!this.multiSelect}changeSelectedAll(){for(const n of this.messages)n.selected=this.selectedAll}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(T.sK),e.Y36(J.y),e.Y36(r.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-notifications"]],decls:14,vars:10,consts:[["slot","start"],["defaultHref","/home"],["slot","end",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],["lines","none","style","margin: 5px; ",4,"ngIf"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only","name","list"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["lines","none",2,"margin","5px"],["slot","start",3,"ngModel","ngModelChange"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["lines","none",2,"margin","5px","border-radius","10px",3,"color","click"],["slot","start",3,"ngModel","ngModelChange",4,"ngIf"],["name","logo-facebook"],[2,"margin-left","5px"],[4,"ngIf"],[2,"font-size","0.65em"],[3,"src"],["side","end"],[2,"font-size","0.8em"],[1,"ion-text-wrap"],[3,"innerHTML"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Zt,3,0,"ion-buttons",2),e.qZA(),e.YNc(8,vt,2,4,"ion-searchbar",3),e.YNc(9,Tt,8,4,"ion-item",4),e.qZA(),e.TgZ(10,"ion-content")(11,"ion-list"),e.YNc(12,Ut,15,7,"ion-item-sliding",5),e.YNc(13,Mt,3,3,"ion-item",6),e.qZA()()),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"fb-page.notifications")),e.xp6(2),e.Q6J("ngIf",t.originals&&t.originals.length),e.xp6(1),e.Q6J("ngIf",t.originals&&t.originals.length),e.xp6(1),e.Q6J("ngIf",t.multiSelect&&t.originals&&t.originals.length),e.xp6(1),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.Q6J("ngForOf",t.messages),e.xp6(1),e.Q6J("ngIf",!t.originals||0===t.originals.length))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.BJ,r.oU,r.YG,r.Sm,r.nz,r.W2,r.Gu,r.gu,r.Xz,r.Ie,r.u8,r.IK,r.td,r.Q$,r.q_,r.VI,r.wd,r.sr,r.w,r.j9,r.cs,T.X$],encapsulation:2}),o})();var It=b(667);const Nt=["barcode"];function Jt(o,s){1&o&&(e.TgZ(0,"ion-text",14),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.connected")))}function qt(o,s){1&o&&(e.TgZ(0,"ion-text",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.not-connected")))}function kt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-content")(1,"ion-list",6)(2,"ion-item")(3,"ion-thumbnail"),e._UZ(4,"ion-img",7),e.qZA(),e.TgZ(5,"ion-label",8)(6,"span",9),e._uU(7),e.TgZ(8,"ion-icon",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.copy(i.page.name))}),e.qZA()(),e.TgZ(9,"p")(10,"ion-text",11),e._uU(11),e.ALo(12,"translate"),e.TgZ(13,"ion-icon",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.copy(i.page.pageId))}),e.qZA()()(),e.TgZ(14,"p"),e.YNc(15,Jt,3,3,"ion-text",12),e.YNc(16,qt,3,3,"ion-text",13),e.qZA()()()()()}if(2&o){const n=e.oxw();e.xp6(4),e.Q6J("src","http://graph.facebook.com/"+n.page.pageId+"/picture?type=square"),e.xp6(3),e.hij(" ",n.page.name," \xa0 "),e.xp6(4),e.AsE("",e.lcZ(12,6,"fb-page.page-id"),": ",n.page.pageId," \xa0 "),e.xp6(4),e.Q6J("ngIf",n.page.isConnected),e.xp6(1),e.Q6J("ngIf",!n.page.isConnected)}}let Lt=(()=>{class o{constructor(n,t,i,a,l,_,m,g,u){var x=this;this.navCtrl=n,this.staffService=t,this.translateService=i,this.omniChannelService=a,this.alertCtrl=l,this.platform=_,this.toastController=m,this.userService=g,this.analyticsService=u,this.tab="info",this.params=null,this.page={},this.reload=(0,p.Z)(function*(){const w=yield x.navCtrl.loading(),c=x.params?x.params:x.navCtrl.getParams();if(x.params=c,c&&c.id&&c.id>0){x.params=c;const d=c.id;c.tab&&""!=c.tab&&(x.tab=c.tab),x.page=yield x.omniChannelService.get(d)}yield w.dismiss()});const y=w=>{const c=w.detail;c&&this.page&&c.id===this.page.id&&this.reload()};this.navCtrl.unsubscribe("reloadFbPage",y),this.navCtrl.subscribe("reloadFbPage",y)}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("fb-page-detail")})()}ngOnInit(){this.reload()}delete(){var n=this;return(0,p.Z)(function*(){yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("fb-page.delete-alert"),buttons:[{text:n.translateService.instant("common.cancel"),handler:()=>{}},{text:n.translateService.instant("common.agree"),handler:()=>{n.loginFacebook()}}]})).present()})()}loginFacebook(){var n=this;FB.login(function(){var t=(0,p.Z)(function*(i){"connected"===i.status?yield n.readPages():alert(n.translateService.instant("fb-page.delete-fail-alert"))});return function(i){return t.apply(this,arguments)}}(),{scope:"public_profile,pages_show_list,pages_manage_metadata,pages_messaging,pages_manage_engagement,user_videos"})}readPages(){var n=this;return(0,p.Z)(function*(){const t=yield n.navCtrl.loading(),i=yield(0,F.H5)("/me/accounts",null,null);if(!i||!i.data||!i.data.length)return alert(n.translateService.instant("fb-page.login-fail-alert")),void(yield t.dismiss());for(const a of i.data)a.id===n.page.pageId&&(yield n.unSubscribeApp(a.access_token));yield t.dismiss(),yield n.reload()})()}unSubscribeApp(n){var t=this;return(0,p.Z)(function*(){const i=yield(0,F.H5)("/"+t.page.pageId+"/subscribed_apps","DELETE",{access_token:n});i&&!i.error?yield t.omniChannelService.deletePage(t.page).then((0,p.Z)(function*(){t.analyticsService.logEvent("fb-page-detail-delete-success"),t.navCtrl.pop(),t.navCtrl.publish("reloadFbPageList",null)})):alert(t.translateService.instant("fb-page.delete-fail-alert"))})()}isCordova(){return this.platform.is("capacitor")||this.platform.is("cordova")}copy(n){var t=this;return(0,p.Z)(function*(){if(t.isCordova())return t.share(n);yield(0,F.OR)(n);const i=t.translateService.instant("request-pro.copied")+n;yield(yield t.toastController.create({message:i,duration:3e3,position:"bottom"})).present()})()}share(n){var t=this;return(0,p.Z)(function*(){yield t.userService.shareText(n)})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(N.G),e.Y36(It.x),e.Y36(T.sK),e.Y36(I.Q),e.Y36(r.Br),e.Y36(r.t4),e.Y36(r.yF),e.Y36(H.K),e.Y36(J.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-page-detail"]],viewQuery:function(n,t){if(1&n&&e.Gf(Nt,5),2&n){let i;e.iGM(i=e.CRH())&&(t.barcode=i.first)}},decls:11,vars:4,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","danger",3,"click"],["name","trash","slot","icon-only"],[4,"ngIf"],["lines","none"],[3,"src"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap"],["name","copy",3,"click"],["color","secondary"],["color","success",4,"ngIf"],["color","dark",4,"ngIf"],["color","success"],["color","dark"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return t.delete()}),e._UZ(9,"ion-icon",4),e.qZA()()()(),e.YNc(10,kt,17,8,"ion-content",5)),2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"fb-page.title-detail")),e.xp6(5),e.Q6J("ngIf",t.page))},dependencies:[v.O5,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.Xz,r.Ie,r.Q$,r.q_,r.yW,r.Bs,r.wd,r.sr,r.cs,T.X$],encapsulation:2}),o})();var W=b(7489),Pt=b(6861);function Ot(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",8),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.dismiss())}),e._UZ(1,"ion-icon",9),e.qZA()}}function Qt(o,s){1&o&&e._UZ(0,"ion-menu-button",10)}function Yt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-button",11),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.navCtrl.home())}),e._UZ(1,"ion-icon",12),e.qZA()}}function Kt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",13)(1,"p",14),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ion-button",15),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.navCtrl.push("/request-pro"))}),e._UZ(5,"ion-icon",16),e._uU(6),e.ALo(7,"translate"),e.qZA()()}2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"common.register-pro-alert")),e.xp6(4),e.hij("\xa0 ",e.lcZ(7,4,"home.request-pro-plan")," "))}function Ht(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",13)(1,"p",14),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ion-button",15),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openBrowser())}),e._UZ(5,"ion-icon",17),e._uU(6),e.ALo(7,"translate"),e.qZA()()}2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"common.only-on-browser")),e.xp6(4),e.hij("\xa0 ",e.lcZ(7,4,"common.open-isale-browser")," "))}function Et(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",18)(3,"ion-item",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.loginFacebook())}),e.TgZ(4,"ion-label",20),e._UZ(5,"ion-icon",21)(6,"br"),e.TgZ(7,"ion-text",22),e._uU(8),e.ALo(9,"translate"),e.qZA()()()(),e.TgZ(10,"ion-col",18)(11,"ion-item",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.autoReplyConfig())}),e.TgZ(12,"ion-label",20),e._UZ(13,"ion-icon",23)(14,"br"),e.TgZ(15,"ion-text",22),e._uU(16),e.ALo(17,"translate"),e.qZA()()()(),e.TgZ(18,"ion-col",18)(19,"ion-item",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openLiveStream())}),e.TgZ(20,"ion-label",20),e._UZ(21,"ion-icon",24)(22,"br"),e.TgZ(23,"ion-text",22),e._uU(24),e.ALo(25,"translate"),e.qZA()()()(),e.TgZ(26,"ion-col",18)(27,"ion-item",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.autoOrder())}),e.TgZ(28,"ion-label",20),e._UZ(29,"ion-icon",25)(30,"br"),e.TgZ(31,"ion-text",22),e._uU(32),e.ALo(33,"translate"),e.qZA()()()()()()}2&o&&(e.xp6(5),e.Udp("font-size","35px"),e.xp6(2),e.Udp("font-size","0.9em"),e.xp6(1),e.hij(" ",e.lcZ(9,20,"fb-page.title-connect"),""),e.xp6(5),e.Udp("font-size","35px"),e.xp6(2),e.Udp("font-size","0.9em"),e.xp6(1),e.hij(" ",e.lcZ(17,22,"fb-page.reply-config"),""),e.xp6(5),e.Udp("font-size","35px"),e.xp6(2),e.Udp("font-size","0.9em"),e.xp6(1),e.hij(" ",e.lcZ(25,24,"fb-page.live-stream-comments"),""),e.xp6(5),e.Udp("font-size","35px"),e.xp6(2),e.Udp("font-size","0.9em"),e.xp6(1),e.hij(" ",e.lcZ(33,26,"fb-page.auto-order"),""))}function Gt(o,s){if(1&o&&(e.TgZ(0,"ion-text",32),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const n=e.oxw(3);e.xp6(1),e.AsE("",e.lcZ(2,2,"fb-page.chat")," (",n.totalUnRead,")")}}function Rt(o,s){1&o&&(e.TgZ(0,"ion-text"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.chat")))}function $t(o,s){if(1&o&&(e.TgZ(0,"ion-segment-button",30),e.YNc(1,Gt,3,4,"ion-text",31),e.YNc(2,Rt,3,3,"ion-text",5),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.totalUnRead),e.xp6(1),e.Q6J("ngIf",!n.totalUnRead)}}function Dt(o,s){if(1&o&&(e.TgZ(0,"ion-text",32),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const n=e.oxw(3);e.xp6(1),e.AsE("",e.lcZ(2,2,"fb-page.comment")," (",n.totalUnReadComment,")")}}function Wt(o,s){1&o&&(e.TgZ(0,"ion-text"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.comment")))}function jt(o,s){if(1&o&&(e.TgZ(0,"ion-segment-button",33),e.YNc(1,Dt,3,4,"ion-text",31),e.YNc(2,Wt,3,3,"ion-text",5),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.totalUnReadComment),e.xp6(1),e.Q6J("ngIf",!n.totalUnReadComment)}}function Bt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-segment",26),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.tab=i)}),e.TgZ(1,"ion-segment-button",27),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,$t,3,2,"ion-segment-button",28),e.YNc(5,jt,3,2,"ion-segment-button",29),e.qZA()}if(2&o){const n=e.oxw();e.Q6J("ngModel",n.tab),e.xp6(2),e.hij(" ",e.lcZ(3,4,"fb-page.page")," "),e.xp6(2),e.Q6J("ngIf",!n.searchMode),e.xp6(1),e.Q6J("ngIf",!n.searchMode)}}function zt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",34),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearch())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.search())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.searchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search")),e.Q6J("ngModel",n.searchKey)}}function Vt(o,s){1&o&&(e.TgZ(0,"ion-text",43),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.connected")))}function Xt(o,s){1&o&&(e.TgZ(0,"ion-text",44),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"fb-page.not-connected")))}function eo(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",8),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(2);return e.KtG(l.selectPage(a))}),e.TgZ(1,"ion-thumbnail"),e._UZ(2,"ion-img",37),e.qZA(),e.TgZ(3,"ion-label",38)(4,"span",39),e._uU(5),e.qZA(),e.TgZ(6,"p")(7,"ion-text",40),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"p"),e.YNc(11,Vt,3,3,"ion-text",41),e.YNc(12,Xt,3,3,"ion-text",42),e.qZA()()()}if(2&o){const n=s.$implicit;e.xp6(2),e.Q6J("src","http://graph.facebook.com/"+n.pageId+"/picture?type=square"),e.xp6(3),e.Oqu(n.name),e.xp6(3),e.AsE("",e.lcZ(9,6,"fb-page.page-id"),": ",n.pageId,""),e.xp6(3),e.Q6J("ngIf",n.isConnected),e.xp6(1),e.Q6J("ngIf",!n.isConnected)}}function no(o,s){1&o&&(e.TgZ(0,"ion-item",22),e._UZ(1,"div",45),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-connected-page"),e.oJD))}function to(o,s){if(1&o&&(e.TgZ(0,"ion-list"),e.YNc(1,eo,13,8,"ion-item",35),e.YNc(2,no,3,3,"ion-item",36),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.items),e.xp6(1),e.Q6J("ngIf",!n.originals||0===n.originals.length)}}function oo(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",34),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearchFlow())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.searchFlow())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.flowSearchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search-flow")),e.Q6J("ngModel",n.flowSearchKey)}}function io(o,s){1&o&&e._UZ(0,"ion-icon",53)}function ao(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e._UZ(1,"ion-img",37),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src",n.fromUserAvatarUrl)}}function ro(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e._UZ(1,"ion-img",37),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function so(o,s){if(1&o&&(e.TgZ(0,"span",54),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.fromUserName)}}function lo(o,s){if(1&o&&(e.TgZ(0,"span",54),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function co(o,s){if(1&o&&(e.TgZ(0,"p",52)(1,"i"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.replied"),": ",n.fromUserName,"")}}function po(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",47),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(2);return e.KtG(l.selectFlow(a))}),e.YNc(1,io,1,0,"ion-icon",48),e.YNc(2,ao,2,1,"ion-avatar",49),e.YNc(3,ro,2,1,"ion-avatar",49),e.TgZ(4,"ion-label",38),e.YNc(5,so,3,1,"span",50),e.YNc(6,lo,3,1,"span",50),e.YNc(7,co,4,4,"p",51),e.TgZ(8,"span",39),e._uU(9),e.qZA(),e.TgZ(10,"p",52),e._uU(11),e.qZA()(),e.TgZ(12,"ion-avatar"),e._UZ(13,"ion-img",37),e.qZA()()}if(2&o){const n=s.$implicit,t=e.oxw(2);e.Q6J("color",n.isRead?"light":"secondary"),e.xp6(1),e.Q6J("ngIf",n.fromUser&&!n.fromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",n.fromUser&&n.fromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",!n.fromUser),e.xp6(2),e.Q6J("ngIf",n.fromUserName&&n.fromUser),e.xp6(1),e.Q6J("ngIf",n.pageName&&!n.fromUser),e.xp6(1),e.Q6J("ngIf",n.fromUserName&&!n.fromUser),e.xp6(2),e.Oqu(n.lastMessage),e.xp6(2),e.hij(" ",t.dateFormat(n.lastTimestamp)," "),e.xp6(2),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function _o(o,s){1&o&&(e.TgZ(0,"ion-item",22),e._UZ(1,"div",45),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-messages"),e.oJD))}function mo(o,s){if(1&o&&(e.TgZ(0,"ion-list"),e.YNc(1,po,14,10,"ion-item",46),e.YNc(2,_o,3,3,"ion-item",36),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.flows),e.xp6(1),e.Q6J("ngIf",!n.originalFlows||0===n.originalFlows.length)}}function go(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-searchbar",34),e.NdJ("ionClear",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.clearSearchPost())})("ionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.searchPost())})("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.postSearchKey=i)}),e.ALo(1,"translate"),e.qZA()}if(2&o){const n=e.oxw();e.s9C("placeholder",e.lcZ(1,2,"fb-page.search-post")),e.Q6J("ngModel",n.postSearchKey)}}function uo(o,s){1&o&&e._UZ(0,"ion-icon",53)}function fo(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e._UZ(1,"ion-img",37),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src",n.lastFromUserAvatarUrl)}}function ho(o,s){if(1&o&&(e.TgZ(0,"ion-avatar",0),e._UZ(1,"ion-img",37),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function bo(o,s){if(1&o&&(e.TgZ(0,"span",54),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.lastFromUserName)}}function Co(o,s){if(1&o&&(e.TgZ(0,"span",54),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.pageName)}}function xo(o,s){if(1&o&&(e.TgZ(0,"p",52)(1,"i"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o){const n=e.oxw().$implicit;e.xp6(2),e.AsE("",e.lcZ(3,2,"fb-page.replied"),": ",n.lastFromUserName,"")}}function Zo(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",47),e.NdJ("click",function(){const a=e.CHM(n).$implicit,l=e.oxw(2);return e.KtG(l.selectPost(a))}),e.YNc(1,uo,1,0,"ion-icon",48),e.YNc(2,fo,2,1,"ion-avatar",49),e.YNc(3,ho,2,1,"ion-avatar",49),e.TgZ(4,"ion-label",38)(5,"p")(6,"i"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.YNc(9,bo,3,1,"span",50),e.YNc(10,Co,3,1,"span",50),e.YNc(11,xo,4,4,"p",51),e.TgZ(12,"span",39),e._uU(13),e.qZA(),e.TgZ(14,"p",52),e._uU(15),e.qZA()(),e.TgZ(16,"ion-avatar"),e._UZ(17,"ion-img",37),e.qZA()()}if(2&o){const n=s.$implicit,t=e.oxw(2);e.Q6J("color",n.isRead?"light":"secondary"),e.xp6(1),e.Q6J("ngIf",n.lastFromUser&&!n.lastFromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",n.lastFromUser&&n.lastFromUserAvatarUrl),e.xp6(1),e.Q6J("ngIf",!n.fromUser),e.xp6(4),e.AsE("",e.lcZ(8,12,"fb-page.post-id"),": ",n.postId,""),e.xp6(2),e.Q6J("ngIf",n.lastFromUserName&&n.fromUser),e.xp6(1),e.Q6J("ngIf",n.pageName&&!n.fromUser),e.xp6(1),e.Q6J("ngIf",n.lastFromUserName&&!n.fromUser),e.xp6(2),e.Oqu(n.lastComment),e.xp6(2),e.hij(" ",t.dateFormat(n.lastTimestamp)," "),e.xp6(2),e.Q6J("src","https://graph.facebook.com/"+n.pageId+"/picture?type=square")}}function vo(o,s){1&o&&(e.TgZ(0,"ion-item",22),e._UZ(1,"div",45),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,"fb-page.no-posts"),e.oJD))}function To(o,s){if(1&o&&(e.TgZ(0,"ion-list"),e.YNc(1,Zo,18,14,"ion-item",46),e.YNc(2,vo,3,3,"ion-item",36),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.posts),e.xp6(1),e.Q6J("ngIf",!n.originalPosts||0===n.originalPosts.length)}}let ne=(()=>{class o{constructor(n,t,i,a,l,_,m){var g=this;this.omniChannelService=n,this.navCtrl=t,this.modalController=i,this.translateService=a,this.userService=l,this.planService=_,this.analyticsService=m,this.flowSearchKey="",this.postSearchKey="",this.tab="page",this.totalUnRead=0,this.totalUnReadComment=0,this.searchKey="",this.currentPlan=null,this.isOnTrial=!1,this.searchMode=!1,this.reload=(0,p.Z)(function*(){const u=yield g.navCtrl.loading();g.currentPlan=yield g.planService.getCurrentPlan(),g.currentPlan||(g.isOnTrial=yield g.planService.isOnTrial(g.currentPlan)),g.currency=yield g.userService.getAttr("current-currency"),yield g.omniChannelService.getPages().then(function(){var x=(0,p.Z)(function*(y){g.originals=JSON.parse(JSON.stringify(y)),g.items=y});return function(y){return x.apply(this,arguments)}}()),yield g.omniChannelService.getMessageFlows().then(function(){var x=(0,p.Z)(function*(y){const w=W.orderBy(y,["lastTimestamp"],["desc"]);g.originalFlows=JSON.parse(JSON.stringify(w)),g.flows=w;const c=W.filter(w,d=>!d.isRead);g.totalUnRead=c.length});return function(y){return x.apply(this,arguments)}}()),yield g.omniChannelService.getPosts().then(function(){var x=(0,p.Z)(function*(y){const w=W.orderBy(y,["lastTimestamp"],["desc"]);g.originalPosts=JSON.parse(JSON.stringify(w)),g.posts=w;const c=W.filter(w,d=>!d.isRead);g.totalUnReadComment=c.length});return function(y){return x.apply(this,arguments)}}()),yield u.dismiss()}),this.navCtrl.unsubscribe("reloadFbPageList",this.reload),this.navCtrl.subscribe("reloadFbPageList",this.reload)}openBrowser(){this.navCtrl.openExternalUrl("https://isale.online/app")}ionViewWillEnter(){var n=this;return(0,p.Z)(function*(){yield n.analyticsService.setCurrentScreen("money-account")})()}ngOnInit(){this.params=this.navCtrl.getParams(this.params),this.params&&this.params.callback&&(this.callback=this.params.callback),this.params&&this.params.searchMode&&(this.searchMode=this.params.searchMode),this.reload()}dateFormat(n){let t=n;return t&&t instanceof Date?t:(n&&n.indexOf(":00Z")<0&&(t=k(n).format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(t))}validPlan(){return!(!this.currentPlan&&!this.isOnTrial&&(this.analyticsService.logEvent("register-pro-alert"),alert(this.translateService.instant("common.register-pro-alert")),1))}selectPost(n){!this.validPlan()||this.navCtrl.push("/fbpage/comments",{post:n})}selectPage(n){var t=this;return(0,p.Z)(function*(){if(t.validPlan()){if(t.searchMode)return t.callback?(t.callback(n),void(yield t.navCtrl.back())):void t.modalController.dismiss(n);t.navCtrl.push("/fbpage/detail",{id:n.id})}})()}selectFlow(n){!this.validPlan()||this.navCtrl.push("/fbpage/messages",{flow:n})}search(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-page-search");let t=JSON.parse(JSON.stringify(n.originals));if(null!==n.searchKey&&""!==n.searchKey){const i=n.searchKey.toLowerCase();t=t.filter(a=>a.name&&h.W.stringSpecialContains(i,a.name)||a.pageId&&h.W.stringSpecialContains(i,a.pageId))}n.items=t})()}searchFlow(){var n=this;return(0,p.Z)(function*(){n.analyticsService.logEvent("fb-page-search-flow");let t=JSON.parse(JSON.stringify(n.originalFlows));if(null!==n.flowSearchKey&&""!==n.flowSearchKey){const i=n.flowSearchKey.toLowerCase();t=t.filter(a=>a.fromUserName&&h.W.stringSpecialContains(i,a.fromUserName)||a.pageId&&h.W.stringSpecialContains(i,a.pageId)||a.pageName&&h.W.stringSpecialContains(i,a.pageName)||a.lastMessage&&h.W.stringSpecialContains(i,a.lastMessage))}n.flows=t})()}clearSearch(){this.searchKey=null,this.reload()}clearSearchFlow(){this.flowSearchKey=null,this.reload()}loginFacebook(){var n=this;!this.validPlan()||FB.getLoginStatus(function(){var t=(0,p.Z)(function*(i){"connected"===i.status?(i.authResponse&&(yield n.omniChannelService.updateFbToken(i.authResponse.userID,i.authResponse.accessToken)),yield n.readPages()):n.doLoginFacebook()});return function(i){return t.apply(this,arguments)}}())}doLoginFacebook(){FB.login(n=>{"connected"===n.status?this.readPages():alert(this.translateService.instant("fb-page.login-fail-alert"))},{scope:"public_profile,pages_show_list,pages_manage_metadata,pages_messaging,pages_manage_engagement,user_videos"})}readPages(){var n=this;return(0,p.Z)(function*(){const t=yield n.navCtrl.loading(),i=yield(0,F.H5)("/me/accounts",null,null);if(!i||!i.data||!i.data.length)return alert(n.translateService.instant("fb-page.login-fail-alert")),void(yield t.dismiss());const a=yield n.omniChannelService.getPages();if(a&&a.length){for(const l of i.data){if(a.find(g=>g.isConnected&&g.pageId==l.id))continue;const m=a.find(g=>g.pageId==l.id);yield n.subscribeApps(l,m)}alert(n.translateService.instant("fb-page.connected-successfully")),yield t.dismiss(),yield n.reload()}else yield t.dismiss()})()}subscribeApps(n,t){var i=this;return(0,p.Z)(function*(){const a=yield(0,F.H5)("/"+n.id+"/subscribed_apps","POST",{subscribed_fields:"feed,messages",access_token:n.access_token});a&&!a.error?(t?(t.isConnected=!0,t.accessToken=n.access_token,t.name=n.name):t={id:0,pageId:n.id,accessToken:n.access_token,name:n.name,isConnected:!0},yield i.omniChannelService.savePage(t)):alert(i.translateService.instant("fb-page.login-fail-alert"))})()}autoReplyConfig(){!this.validPlan()||this.navCtrl.push("/fbpage/auto-reply")}openLiveStream(){!this.validPlan()||this.navCtrl.push("/fbpage/livestream")}autoOrder(){!this.validPlan()||this.navCtrl.push("/fbpage/auto-order")}dismiss(){var n=this;return(0,p.Z)(function*(){if(n.callback)return n.callback(null),void(yield n.navCtrl.back());n.modalController.dismiss()})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(I.Q),e.Y36(N.G),e.Y36(r.IN),e.Y36(T.sK),e.Y36(H.K),e.Y36(Pt.D),e.Y36(J.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fb-page"]],decls:20,vars:18,consts:[["slot","start"],[3,"click",4,"ngIf"],["menu","first",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],["style","padding: 10px; margin: 10px; background-color: #f0ad4e; color: white; border-radius: 10px;",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],[3,"click"],["name","close"],["menu","first"],["color","primary",3,"click"],["name","home"],[2,"padding","10px","margin","10px","background-color","#f0ad4e","color","white","border-radius","10px"],[2,"margin","5px 5px 5px 5px"],["color","success","fill","solid",3,"click"],["name","gift","slot","start"],["name","earth-outline","slot","start"],["size-xs","3","size-sm","3","size-md","2","size-md","2"],["lines","none",2,"border","1px solid #bbb","border-radius","10px","height","105px","cursor","pointer","--padding-start","3px","--inner-padding-end","0",3,"click"],[1,"ion-text-wrap","ion-text-center"],["name","logo-facebook",2,"color","#4267B2"],[1,"ion-text-wrap"],["name","arrow-undo",2,"color","#f88962"],["name","chatbubbles","color","success"],["name","basket","color","tertiary"],[3,"ngModel","ngModelChange"],["value","page"],["value","chat","class","ion-text-wrap",4,"ngIf"],["value","comment","class","ion-text-wrap",4,"ngIf"],["value","chat",1,"ion-text-wrap"],["color","danger","style","font-weight: bold",4,"ngIf"],["color","danger",2,"font-weight","bold"],["value","comment",1,"ion-text-wrap"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],[3,"src"],[1,"ion-text-wrap",2,"padding-left","5px"],[2,"white-space","pre-wrap"],["color","secondary"],["color","success",4,"ngIf"],["color","dark",4,"ngIf"],["color","success"],["color","dark"],[3,"innerHTML"],["style","margin:8px; border-radius: 5px; border: 1px solid #ccc",3,"color","click",4,"ngFor","ngForOf"],[2,"margin","8px","border-radius","5px","border","1px solid #ccc",3,"color","click"],["name","person","slot","start",4,"ngIf"],["slot","start",4,"ngIf"],["style","white-space: pre-wrap; font-weight: bold; ",4,"ngIf"],["style","font-size: 0.85em;",4,"ngIf"],[2,"font-size","0.85em"],["name","person","slot","start"],[2,"white-space","pre-wrap","font-weight","bold"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.YNc(3,Ot,2,0,"ion-button",1),e.YNc(4,Qt,1,0,"ion-menu-button",2),e.YNc(5,Yt,2,0,"ion-button",3),e.qZA(),e.TgZ(6,"ion-title"),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"ion-content"),e.YNc(10,Kt,8,6,"div",4),e.YNc(11,Ht,8,6,"div",4),e.YNc(12,Et,34,28,"ion-grid",5),e.YNc(13,Bt,6,6,"ion-segment",6),e.YNc(14,zt,2,4,"ion-searchbar",7),e.YNc(15,to,3,2,"ion-list",5),e.YNc(16,oo,2,4,"ion-searchbar",7),e.YNc(17,mo,3,2,"ion-list",5),e.YNc(18,go,2,4,"ion-searchbar",7),e.YNc(19,To,3,2,"ion-list",5),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngIf",t.searchMode),e.xp6(1),e.Q6J("ngIf",!t.searchMode),e.xp6(1),e.Q6J("ngIf",!t.searchMode),e.xp6(2),e.Oqu(e.lcZ(8,16,"fb-page.title")),e.xp6(2),e.Akn(t.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(1),e.Q6J("ngIf",!t.currentPlan&&!t.isOnTrial),e.xp6(1),e.Q6J("ngIf",!t.navCtrl.isNotCordova()),e.xp6(1),e.Q6J("ngIf",!t.searchMode),e.xp6(1),e.Q6J("ngIf",!t.searchMode),e.xp6(1),e.Q6J("ngIf","page"===t.tab),e.xp6(1),e.Q6J("ngIf","page"===t.tab),e.xp6(1),e.Q6J("ngIf","chat"===t.tab&&!t.searchMode),e.xp6(1),e.Q6J("ngIf","chat"===t.tab&&!t.searchMode),e.xp6(1),e.Q6J("ngIf","comment"===t.tab&&!t.searchMode),e.xp6(1),e.Q6J("ngIf","comment"===t.tab&&!t.searchMode))},dependencies:[v.sg,v.O5,A.JJ,A.On,r.BJ,r.YG,r.Sm,r.wI,r.W2,r.jY,r.Gu,r.gu,r.Xz,r.Ie,r.Q$,r.q_,r.fG,r.Nd,r.VI,r.cJ,r.GO,r.yW,r.Bs,r.wd,r.sr,r.QI,r.j9,T.X$],encapsulation:2}),o})();const yo=[{path:"",component:ne},{path:"detail",component:Lt},{path:"messages",component:xt},{path:"comments",component:mn},{path:"notifications",component:St},{path:"auto-reply",component:ke},{path:"auto-reply-add",component:Fe},{path:"search-page",component:ne},{path:"livestream",component:$n},{path:"auto-order",component:Ze},{path:"auto-order-add",component:_e}];let Ao=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[D.Bz.forChild(yo),D.Bz]}),o})(),Fo=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[v.ez,A.u5,r.Pc,Ao,$.m,E.uH,T.aw.forChild({loader:{provide:T.Zw,useFactory:$.x,deps:[G.eN]}})]}),o})()}}]);