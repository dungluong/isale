"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3742],{3742:(U,m,n)=>{n.r(m),n.d(m,{ExcelReportModule:()=>S});var Z=n(6895),f=n(4006),l=n(191),a=n(3306),v=n(529),d=n(3196),s=n(5861),e=n(6738),g=n(5851),A=n(323),y=n(7060),R=n(7488);const C=[{path:"",component:(()=>{class o{constructor(t,r,i,u,p,h){this.navCtrl=t,this.analyticsService=r,this.excelService=i,this.alertCtrl=u,this.translateService=p,this.userService=h,this.staffsToSelect=[]}ionViewWillEnter(){var t=this;return(0,s.Z)(function*(){yield t.analyticsService.setCurrentScreen("excel-report")})()}exportSalesReportByOrder(){this.navCtrl.push("/order/export",{reportType:0})}exportSalesReportByProduct(){this.navCtrl.push("/order/export",{reportType:1})}exportSalesReportByCustomer(){this.navCtrl.push("/order/export",{reportType:2})}exportSalesReportByStaff(){this.navCtrl.push("/order/export",{reportType:3})}exportProductNotesReport(t){this.navCtrl.push("/product/export",{reportType:t})}exportProductsReport(){var t=this;return(0,s.Z)(function*(){const r="products-report.xlsx",i=yield t.navCtrl.loading();t.excelService.downloadProductsReport(r).then(function(){var u=(0,s.Z)(function*(p){t.analyticsService.logEvent("product-export-to-excel-success"),yield i.dismiss(),t.navCtrl.isNotCordova()||(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.confirm"),message:t.translateService.instant("report.file-save-alert")+p,buttons:[{text:t.translateService.instant("common.agree"),handler:()=>{}}]})).present(),t.userService.shareFileUrl(r,r,p))});return function(p){return u.apply(this,arguments)}}())})()}gotoPage(t){this.navCtrl.push(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.G),e.Y36(A.y),e.Y36(y.x),e.Y36(l.Br),e.Y36(a.sK),e.Y36(R.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["excel-report-home"]],decls:70,vars:41,consts:[["slot","start"],["menu","first"],["color","primary",3,"click"],["name","home"],[2,"padding-left","10px","padding-right","10px"],["expand","block","fill","outline",3,"click"],["name","receipt"],["name","document"],["name","person"],["name","reader"],["name","newspaper"],["name","bar-chart"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button",1),e.TgZ(4,"ion-button",2),e.NdJ("click",function(){return r.navCtrl.home()}),e._UZ(5,"ion-icon",3),e.qZA()(),e.TgZ(6,"ion-title"),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"ion-content")(10,"p",4),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-grid")(14,"ion-row")(15,"ion-col")(16,"ion-button",5),e.NdJ("click",function(){return r.exportSalesReportByOrder()}),e._UZ(17,"ion-icon",6),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"ion-col")(21,"ion-button",5),e.NdJ("click",function(){return r.exportSalesReportByProduct()}),e._UZ(22,"ion-icon",7),e._uU(23),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"ion-col")(26,"ion-button",5),e.NdJ("click",function(){return r.exportSalesReportByCustomer()}),e._UZ(27,"ion-icon",8),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"ion-col")(31,"ion-button",5),e.NdJ("click",function(){return r.exportSalesReportByStaff()}),e._UZ(32,"ion-icon",8),e._uU(33),e.ALo(34,"translate"),e.qZA()()()(),e.TgZ(35,"p",4),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"ion-grid")(39,"ion-row")(40,"ion-col")(41,"ion-button",5),e.NdJ("click",function(){return r.exportProductsReport()}),e._UZ(42,"ion-icon",9),e._uU(43),e.ALo(44,"translate"),e.qZA()(),e.TgZ(45,"ion-col")(46,"ion-button",5),e.NdJ("click",function(){return r.exportProductNotesReport(0)}),e._UZ(47,"ion-icon",7),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"ion-col")(51,"ion-button",5),e.NdJ("click",function(){return r.exportProductNotesReport(1)}),e._UZ(52,"ion-icon",10),e._uU(53),e.ALo(54,"translate"),e.qZA()()()(),e.TgZ(55,"p",4),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"ion-grid")(59,"ion-row")(60,"ion-col")(61,"ion-button",5),e.NdJ("click",function(){return r.gotoPage("report")}),e._UZ(62,"ion-icon",11),e._uU(63),e.ALo(64,"translate"),e.qZA()(),e.TgZ(65,"ion-col")(66,"ion-button",5),e.NdJ("click",function(){return r.gotoPage("debt-report")}),e._UZ(67,"ion-icon",11),e._uU(68),e.ALo(69,"translate"),e.qZA()()()()()),2&t&&(e.xp6(7),e.Oqu(e.lcZ(8,15,"excel-report-home.title")),e.xp6(2),e.Akn(r.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(2),e.Oqu(e.lcZ(12,17,"excel-report-home.sales-report")),e.xp6(7),e.hij("\xa0 ",e.lcZ(19,19,"excel-report-home.sales-report-by-order")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(24,21,"excel-report-home.sales-report-by-product")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(29,23,"excel-report-home.sales-report-by-customer")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(34,25,"excel-report-home.sales-report-by-staff")," "),e.xp6(3),e.Oqu(e.lcZ(37,27,"product.title")),e.xp6(7),e.hij("\xa0 ",e.lcZ(44,29,"product.export-to-excel")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(49,31,"product-note-export.report-type-summary")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(54,33,"product-note-export.report-type-detail")," "),e.xp6(3),e.Oqu(e.lcZ(57,35,"product.chart")),e.xp6(7),e.hij("\xa0 ",e.lcZ(64,37,"report.title-all")," "),e.xp6(5),e.hij("\xa0 ",e.lcZ(69,39,"debt-report.title")," "))},dependencies:[l.YG,l.Sm,l.wI,l.W2,l.jY,l.Gu,l.gu,l.fG,l.Nd,l.wd,l.sr,a.X$],encapsulation:2}),o})()}];let T=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.Bz.forChild(C),d.Bz]}),o})();var x=n(3093),_=n(2216);let S=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[Z.ez,f.u5,l.Pc,T,x.m,_.uH,a.aw.forChild({loader:{provide:a.Zw,useFactory:x.x,deps:[v.eN]}})]}),o})()}}]);