"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6769],{8257:(E,Z,l)=>{l.d(Z,{r:()=>a});var g=l(6900);class a{constructor(C=0,T="",A="",N="",I=!1){this.id=0,this.code="",this.staffId=0,this.businessTypeId=0,this.salesLineId=0,this.avatarUrl="",this.fullName="",this.mobile="",this.isImportant=!1,this.gender="",this.email="",this.address="",this.dateOfBirth="",this.lastActive="",this.lastAction="",this.onlineId=0,this.staff=new g.O,this.businessType=null,this.salesLine=null,this.point=0,this.levelId=0,this.level=null,this.buyCount=0,this.fbUserId=null,this.source=null,this.id=C,this.avatarUrl=T,this.fullName=A,this.mobile=N,this.isImportant=I}}},6900:(E,Z,l)=>{l.d(Z,{O:()=>g});class g{constructor(n=0,C="",T="",A=""){this.hourLimit=1,this.storeId=0,this.store=null,this.isCollaborator=!1,this.shiftId=0,this.shift=null,this.blockViewingQuantity=!1,this.id=0,this.avatarUrl="",this.name="",this.userName="",this.shopName="",this.createdAt="",this.hasFullAccess=!1,this.canCreateOrder=!1,this.canUpdateDeleteOrder=!1,this.canCreateNewTransaction=!1,this.canUpdateDeleteTransaction=!1,this.canCreateUpdateNote=!1,this.canCreateUpdateDebt=!1,this.canUpdateDeleteProduct=!1,this.canViewProductCostPrice=!1,this.canUpdateProductCostPrice=!1,this.canViewAllContacts=!1,this.canManageContacts=!1,this.updateStatusExceptDone=!1,this.blockEditingOrderPrice=!1,this.id=n,this.avatarUrl=C,this.name=T,this.userName=A}}},2795:(E,Z,l)=>{l.r(Z),l.d(Z,{MoneyAccountModule:()=>ct});var g=l(6895),a=l(4006),n=l(191),C=l(3306),T=l(529),A=l(3093),N=l(2216),I=l(3196),v=l(5861),x=l(7489),U=l(6841),F=l(2145),f=l(6723),h=l(1914),t=l(6738),i=l(5851),u=l(7488),d=l(212),c=l(4433),b=l(2126),O=l(7060),S=l(323),k=l(3604);function J(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t._UZ(2,"br"),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Oqu(e.account.bankName)}}function Y(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t._UZ(2,"br"),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Oqu(e.account.bankAccountName)}}function B(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Oqu(e.account.bankNumber)}}function K(r,p){if(1&r&&(t.TgZ(0,"p"),t.YNc(1,J,3,1,"span",10),t.YNc(2,Y,3,1,"span",10),t.YNc(3,B,2,1,"span",10),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.account.bankName),t.xp6(1),t.Q6J("ngIf",e.account.bankAccountName),t.xp6(1),t.Q6J("ngIf",e.account.bankNumber)}}function G(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t._UZ(4,"br"),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.HOy(" ",t.lcZ(2,4,"common.from")," ",e.dateFormat(e.dateFrom)," ",t.lcZ(3,6,"common.to")," ",e.dateFormat(e.dateTo)," ")}}function Q(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"trade-item",15),t.NdJ("onClick",function(){const s=t.CHM(e).$implicit,_=t.oxw();return t.KtG(_.selectTrade(s.id))}),t.qZA()}if(2&r){const e=p.$implicit,o=t.oxw();t.Q6J("showContact",!1)("trade",e)("currency",o.currency)}}const V=function(r,p,e){return[r,p,"symbol","1.0-2",e]};let R=(()=>{class r{constructor(e,o,m,s,_,y,M,P,D,st,lt){this.navCtrl=e,this.translateService=o,this.userService=m,this.modalCtrl=s,this.moneyAccountService=_,this.file=y,this.tradeService=M,this.excelService=P,this.actionSheetCtrl=D,this.alertCtrl=st,this.analyticsService=lt,this.params=null,this.account=new F.C,this.arr=[],this.dateFrom="",this.dateTo="",this.trades=[],this.total=0;const L=ut=>{this.account&&ut.detail.id===this.account.id&&this.reload()};this.navCtrl.unsubscribe("reloadMoneyAccount",L),this.navCtrl.subscribe("reloadMoneyAccount",L)}ionViewWillEnter(){var e=this;return(0,v.Z)(function*(){yield e.analyticsService.setCurrentScreen("money-account-detail")})()}ngOnInit(){this.reload()}actionIcon(e){return f.W.actionIcon(e)}reload(){var e=this;return(0,v.Z)(function*(){const o=yield e.navCtrl.loading();e.currency=yield e.userService.getAttr("current-currency"),e.params=e.navCtrl.getParams(e.params),e.account=new F.C,e.params&&e.params.id&&e.params.id>0?e.moneyAccountService.get(e.params.id).then(function(){var s=(0,v.Z)(function*(_){yield o.dismiss(),e.account=_,e.dateFrom=e.params.dateFrom?e.params.dateFrom:e.dateFrom?e.dateFrom:h.C.GetFirstDateOfMonth(),e.dateTo=e.params.dateTo?e.params.dateTo:e.dateTo?e.dateTo:h.C.GetEndDateOfMonth(),e.tradeService.getTradesByAccount(_.id,e.dateFrom,e.dateTo).then(y=>{y&&y.length>0&&(y=x.orderBy(y,["modifiedAt"],["desc"])),e.trades=y,e.total=x.sumBy(e.trades,M=>M.value*(M.isReceived?1:-1))})});return function(_){return s.apply(this,arguments)}}()):yield o.dismiss()})()}dateFormat(e){return h.C.toUiDateString(e)}dateTimeFormat(e){return h.C.toUiString(e)}edit(){this.navCtrl.push("/money-account/add",{id:this.account.id})}presentActionSheet(){var e=this;return(0,v.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:e.translateService.instant("action.action"),buttons:[{text:e.translateService.instant("export.export-trade"),handler:()=>{e.exportTradeToExcel()}},{text:e.translateService.instant("money-account-detail.delete"),role:"destructive",handler:()=>{e.deleteProduct()}},{text:e.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}exportTradeToExcel(){var e=this;const o=[];if(o.push([this.translateService.instant("export.product-transaction-report")]),o.push([this.translateService.instant("export.product")+": "+this.account.accountName]),this.dateFrom&&this.dateTo){const _=this.translateService.instant("common.from"),y=this.translateService.instant("common.to"),M=`${_} ${this.dateFormat(this.dateFrom)} ${y} ${this.dateFormat(this.dateTo)}`;o.push([M])}o.push([`${this.translateService.instant("common.total")}: ${this.total} ${this.currency}`]),o.push([this.translateService.instant("export.accountName"),this.translateService.instant("export.note"),this.translateService.instant("export.value"),this.translateService.instant("export.transferFee"),this.translateService.instant("export.unit"),this.translateService.instant("export.date")]);for(const _ of this.trades)o.push([_.moneyAccount.accountName,_.note,_.value,0,this.currency,this.dateFormat(_.createdAt)]);const m=this.excelService.createSheetData(o),s="product-transactions-report-"+this.account.id+"-"+f.W.getCurrentDate()+".xlsx";this.excelService.exportExcel(m,s).then(function(){var _=(0,v.Z)(function*(y){e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+e.file.externalDataDirectory+s,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFile(null,y))});return function(y){return _.apply(this,arguments)}}())}deleteProduct(){var e=this;return(0,v.Z)(function*(){yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("money-account-detail.delete-alert"),buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{e.moneyAccountService.deleteMoneyAccount(e.account).then((0,v.Z)(function*(){e.analyticsService.logEvent("money-account-detail-delete-success"),e.navCtrl.publish("reloadMoneyAccountList"),e.navCtrl.publish("reloadHome"),e.navCtrl.pop()}))}},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}selectDateRangeForTrade(){var e=this;return(0,v.Z)(function*(){const o=yield e.modalCtrl.create({component:U.S,componentProps:{dateFromInput:e.dateFrom,dateToInput:e.dateTo}});yield o.present();const{data:m}=yield o.onDidDismiss();m&&(e.dateFrom=""!=m.dateFrom?h.C.toDbString(m.dateFrom,h.C.getDbFormat()):"",e.dateTo=""!=m.dateTo?h.C.toDbString(m.dateTo,h.C.getDbFormat()):"",e.tradeService.getTradesByAccount(e.account.id,e.dateFrom,e.dateTo).then(s=>{s&&s.length>0&&(s=x.orderBy(s,["modifiedAt"],["desc"])),e.trades=s,e.total=x.sumBy(e.trades,_=>_.value*(_.isReceived?1:-1))}))})()}productName(e){return e.accountName}transfer(){this.navCtrl.push("/money-account/transfer",{id:this.account.id})}selectTrade(e){this.navCtrl.push("/trade/detail",{id:e})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(i.G),t.Y36(C.sK),t.Y36(u.K),t.Y36(n.IN),t.Y36(d.U),t.Y36(c.$),t.Y36(b.X),t.Y36(O.x),t.Y36(n.BX),t.Y36(n.Br),t.Y36(S.y))},r.\u0275cmp=t.Xpm({type:r,selectors:[["money-account-detail"]],decls:42,vars:42,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"click"],["name","swap-horizontal"],["name","create"],["name","ellipsis-vertical"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap"],["color","secondary"],[4,"ngIf"],[3,"color"],["fill","clear","color","primary","slot","end",3,"click"],["name","funnel"],[3,"showContact","trade","currency","onClick",4,"ngFor","ngForOf"],[3,"showContact","trade","currency","onClick"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return o.transfer()}),t._UZ(9,"ion-icon",4),t.qZA(),t.TgZ(10,"ion-button",3),t.NdJ("click",function(){return o.edit()}),t._UZ(11,"ion-icon",5),t.qZA(),t.TgZ(12,"ion-button",3),t.NdJ("click",function(){return o.presentActionSheet()}),t._UZ(13,"ion-icon",6),t.qZA()()()(),t.TgZ(14,"ion-content")(15,"ion-list")(16,"ion-item")(17,"ion-label",7)(18,"span",8),t._uU(19),t.ALo(20,"translate"),t.qZA(),t._UZ(21,"br"),t.TgZ(22,"ion-text",9),t._uU(23),t.ALo(24,"currency"),t.qZA(),t.YNc(25,K,4,3,"p",10),t.qZA()()(),t.TgZ(26,"ion-list")(27,"ion-list-header")(28,"ion-label"),t._uU(29),t.ALo(30,"translate"),t.qZA()(),t.TgZ(31,"ion-item")(32,"ion-label",7),t.YNc(33,G,5,8,"span",10),t._uU(34),t.ALo(35,"translate"),t.TgZ(36,"ion-text",11),t._uU(37),t.ALo(38,"currency"),t.qZA()(),t.TgZ(39,"ion-button",12),t.NdJ("click",function(){return o.selectDateRangeForTrade()}),t._UZ(40,"ion-icon",13),t.qZA()(),t.YNc(41,Q,1,3,"trade-item",14),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,14,"money-account-detail.title")),t.xp6(9),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(5),t.AsE("",t.lcZ(20,16,"money-account.name-header"),": ",o.productName(o.account),""),t.xp6(4),t.Oqu(t.G7q(24,18,t.kEZ(34,V,o.account.total,o.currency,o.translateService.currentLang))),t.xp6(2),t.Q6J("ngIf",o.account.bankName||o.account.bankAccountName||o.account.bankNumber),t.xp6(4),t.Oqu(t.lcZ(30,24,"money-account-detail.history")),t.xp6(4),t.Q6J("ngIf",""!=o.dateFrom||""!=o.dateTo),t.xp6(1),t.hij(" ",t.lcZ(35,26,"common.total"),":\xa0 "),t.xp6(2),t.s9C("color",o.total>=0?"secondary":"danger"),t.xp6(1),t.AsE("",o.total>=0?"+":""," ",t.G7q(38,28,t.kEZ(38,V,o.total,o.currency,o.translateService.currentLang)),"."),t.xp6(4),t.Q6J("ngForOf",o.trades))},dependencies:[g.sg,g.O5,n.oU,n.YG,n.Sm,n.W2,n.Gu,n.gu,n.Ie,n.Q$,n.q_,n.yh,n.yW,n.wd,n.sr,n.cs,k._,g.H9,C.X$],encapsulation:2}),r})();var H=l(316);let W=(()=>{class r{constructor(){this.table="money_account",this.fieldsList=["accountName","total","isDefault","bankName","bankAccountName","bankNumber"],this.validateFields=["accountName"],this.fieldInstructions={total:{type:"money"},isDefault:{type:"toggle"}}}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["money-account-add"]],inputs:{table:"table",fieldsList:"fieldsList",validateFields:"validateFields",fieldInstructions:"fieldInstructions"},decls:1,vars:3,consts:[["table","money_account",3,"fieldsList","validateFields","fieldInstructions"]],template:function(e,o){1&e&&t._UZ(0,"form-add",0),2&e&&t.Q6J("fieldsList",o.fieldsList)("validateFields",o.validateFields)("fieldInstructions",o.fieldInstructions)},dependencies:[H.D],encapsulation:2}),r})();var w=l(4220),q=l(7604),$=l(7613);function j(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.AsE("(",e.currency.symbol_native," - ",e.currency.code,")")}}function X(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.AsE("(",e.currency.symbol_native," - ",e.currency.code,")")}}function z(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"ion-text",15),t.NdJ("click",function(){t.CHM(e);const m=t.oxw();return t.KtG(m.showSearchMoneyAccount())}),t._uU(1),t.qZA()}if(2&r){const e=t.oxw();t.xp6(1),t.hij(" ",e.moneyAccountSelected.accountName," ")}}function tt(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"ion-text",16),t.NdJ("click",function(){t.CHM(e);const m=t.oxw();return t.KtG(m.showSearchMoneyAccount())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&r&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"trade-add.select-money-account")," "))}function et(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"ion-button",17),t.NdJ("click",function(){t.CHM(e);const m=t.oxw();return t.KtG(m.removeMoneyAccount())}),t._UZ(1,"ion-icon",18),t.qZA()}}const nt=function(r,p,e){return[r,p,!0,"1.0-2",e]};let ot=(()=>{class r{constructor(e,o,m,s,_,y,M,P){this.navCtrl=e,this.translateService=o,this.userService=m,this.modalCtrl=s,this.productService=_,this.transactionService=y,this.tradeService=M,this.analyticsService=P,this.params=null,this.currentMoneyAccount=new F.C,this.transferValue=0,this.transferFee=0,this.arr=[],this.dateFrom="",this.dateTo="",this.trades=[],this.total=0,this.onKeyPress=D=>{!D.target||"body"!==D.target.localName||("s"===D.key||"S"===D.key)&&this.save()}}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,v.Z)(function*(){yield e.analyticsService.setCurrentScreen("money-account-transfer")})()}ngOnInit(){this.reload()}actionIcon(e){return f.W.actionIcon(e)}reload(){this.userService.getAttr("current-currency").then(o=>{this.currencyCode=o,this.currency=f.W.getCurrencyByCode(o)});const e=this.params?this.params:this.navCtrl.getParams();this.params=e,this.currentMoneyAccount=new F.C,e&&e.id&&e.id>0&&this.productService.get(e.id).then(m=>{this.currentMoneyAccount=m,this.dateFrom=e.dateFrom?e.dateFrom:this.dateFrom?this.dateFrom:h.C.GetFirstDateOfMonth(),this.dateTo=e.dateTo?e.dateTo:this.dateTo?this.dateTo:h.C.GetEndDateOfMonth(),this.tradeService.getMoneyAccountTransactionsByAccount(m.id,this.dateFrom,this.dateTo).then(s=>{s&&s.length>0&&(s=x.orderBy(s,["createdAt"],["desc"])),this.trades=s,this.total=m.total})})}dateFormat(e){return h.C.toUiDateString(e)}dateTimeFormat(e){return h.C.toUiString(e)}selectDateRangeForTrade(){var e=this;return(0,v.Z)(function*(){const o=yield e.modalCtrl.create({component:U.S,componentProps:{dateFromInput:e.dateFrom,dateToInput:e.dateTo}});yield o.present();const{data:m}=yield o.onDidDismiss();m&&(e.dateFrom=""!=m.dateFrom?h.C.toDbString(m.dateFrom,h.C.getDbFormat()):"",e.dateTo=""!=m.dateTo?h.C.toDbString(m.dateTo,h.C.getDbFormat()):"",e.tradeService.getMoneyAccountTransactionsByAccount(e.currentMoneyAccount.id,e.dateFrom,e.dateTo).then(s=>{s&&s.length>0&&(s=x.orderBy(s,["modifiedAt"],["desc"])),e.trades=s,e.total=e.currentMoneyAccount.total}))})()}productName(e){return e.accountName}showSearchMoneyAccount(){var e=this;return(0,v.Z)(function*(){e.navCtrl.push("/money-account",{callback:m=>{const s=m;if(s){if(s.id==e.currentMoneyAccount.id)return void alert(e.translateService.instant("money-account-transfer.account-selected-duplicate-alert"));e.moneyAccountSelected=s}},searchMode:!0})})()}removeMoneyAccount(){this.moneyAccountSelected=null}selectAll(e){f.W.selectAll(e)}save(){var e=this;if(!this.moneyAccountSelected)return void alert(this.translateService.instant("money-account-transfer.no-to-account-selected-alert"));if(!this.transferValue||this.transferValue<=0)return void alert(this.translateService.instant("money-account-transfer.transfer-value-zero-alert"));if(this.transferFee<0)return void alert(this.translateService.instant("money-account-transfer.transfer-fee-zero-alert"));const o=+this.transferValue+ +this.transferFee,m=[],s=new w.h;s.isReceived=!1,s.value=o,s.moneyAccountId=this.currentMoneyAccount.id,s.note=this.transferText(this.currentMoneyAccount,this.moneyAccountSelected,this.transferFee);const _=this.transactionService.saveTrade(s),y=new w.h;y.isReceived=!0,y.value=this.transferValue,y.moneyAccountId=this.moneyAccountSelected.id,y.note=this.transferText(this.currentMoneyAccount,this.moneyAccountSelected,this.transferFee);const M=this.transactionService.saveTrade(y);m.push(_),m.push(M),Promise.all(m).then((0,v.Z)(function*(){e.analyticsService.logEvent("money-account-transfer-save-success"),e.exitPage()}))}transferText(e,o,m){let s=this.translateService.instant("money-account-transfer.transfer-money-from-to");return s=s.replace("{0}",e.accountName),s=s.replace("{1}",o.accountName),s=s.replace("{2}",m),s}exitPage(){var e=this;return(0,v.Z)(function*(){yield e.navCtrl.popOnly(),e.navCtrl.publish("reloadMoneyAccountList"),e.navCtrl.publish("reloadMoneyAccount",e.currentMoneyAccount),e.navCtrl.publish("reloadMoneyAccount",e.moneyAccountSelected)})()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(i.G),t.Y36(C.sK),t.Y36(u.K),t.Y36(n.IN),t.Y36(d.U),t.Y36(b.X),t.Y36(q.y),t.Y36(S.y))},r.\u0275cmp=t.Xpm({type:r,selectors:[["money-account-transfer"]],decls:44,vars:47,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"click"],["name","checkmark"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap"],["color","secondary"],["position","stacked","color","primary"],[4,"ngIf"],[3,"clear","placeholder","moneyValue","moneyValueChange"],["color","primary"],["color","dark","slot","end",3,"click",4,"ngIf"],["slot","end",3,"click",4,"ngIf"],["fill","outline","slot","end",3,"click",4,"ngIf"],["color","dark","slot","end",3,"click"],["slot","end",3,"click"],["fill","outline","slot","end",3,"click"],["name","close"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return o.save()}),t._UZ(9,"ion-icon",4),t._uU(10),t.ALo(11,"translate"),t.qZA()()()(),t.TgZ(12,"ion-content")(13,"ion-list")(14,"ion-item")(15,"ion-label",5)(16,"span",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"ion-text",7),t._uU(21),t.ALo(22,"currency"),t.qZA()()(),t.TgZ(23,"ion-item")(24,"ion-label",8),t._uU(25),t.ALo(26,"translate"),t.YNc(27,j,2,2,"span",9),t.qZA(),t.TgZ(28,"money-input",10),t.NdJ("moneyValueChange",function(s){return o.transferValue=s}),t.ALo(29,"translate"),t.qZA()(),t.TgZ(30,"ion-item")(31,"ion-label",8),t._uU(32),t.ALo(33,"translate"),t.YNc(34,X,2,2,"span",9),t.qZA(),t.TgZ(35,"money-input",10),t.NdJ("moneyValueChange",function(s){return o.transferFee=s}),t.ALo(36,"translate"),t.qZA()(),t.TgZ(37,"ion-item")(38,"ion-text",11),t._uU(39),t.ALo(40,"translate"),t.qZA(),t.YNc(41,z,2,1,"ion-text",12),t.YNc(42,tt,3,3,"ion-text",13),t.YNc(43,et,2,0,"ion-button",14),t.qZA()()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,21,"money-account-detail.transfer")),t.xp6(5),t.hij(" \xa0",t.lcZ(11,23,"action.save")," "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(5),t.AsE("",t.lcZ(18,25,"money-account.name-header"),": ",o.productName(o.currentMoneyAccount),""),t.xp6(4),t.Oqu(t.G7q(22,27,t.kEZ(43,nt,o.currentMoneyAccount.total,o.currencyCode,o.translateService.currentLang))),t.xp6(4),t.hij("",t.lcZ(26,33,"money-account-transfer.money")," "),t.xp6(2),t.Q6J("ngIf",o.currency),t.xp6(1),t.s9C("placeholder",t.lcZ(29,35,"money-account-transfer.enter-money")),t.Q6J("clear",!0)("moneyValue",o.transferValue),t.xp6(4),t.hij("",t.lcZ(33,37,"money-account-transfer.transfer-fee")," "),t.xp6(2),t.Q6J("ngIf",o.currency),t.xp6(1),t.s9C("placeholder",t.lcZ(36,39,"money-account-transfer.enter-transfer-fee")),t.Q6J("clear",!0)("moneyValue",o.transferFee),t.xp6(4),t.Oqu(t.lcZ(40,41,"trade-add.money-account")),t.xp6(2),t.Q6J("ngIf",o.moneyAccountSelected&&o.moneyAccountSelected.id>0),t.xp6(1),t.Q6J("ngIf",!o.moneyAccountSelected||0==o.moneyAccountSelected.id),t.xp6(1),t.Q6J("ngIf",o.moneyAccountSelected&&o.moneyAccountSelected.id>0))},dependencies:[g.O5,n.oU,n.YG,n.Sm,n.W2,n.Gu,n.gu,n.Ie,n.Q$,n.q_,n.yW,n.wd,n.sr,n.cs,$.F,g.H9,C.X$],encapsulation:2}),r})();var at=l(2402);const rt=[{path:"",component:(()=>{class r{constructor(e,o,m){this.currencyPipe=e,this.translateService=o,this.userService=m,this.itemTemplate={h2:{field:"account-name"},pList:[{field:"total",valueFunc:s=>this.currencyPipe.transform(s.total,this.currency,"symbol","1.0-2",this.translateService.currentLang)},{field:"bank-name"},{field:"bank-account-name"},{field:"bank-number"}]},this.searchFields=["accountName","bankName","bankAccountName","bankNumber"]}ngOnInit(){var e=this;return(0,v.Z)(function*(){e.currency=yield e.userService.getAttr("current-currency")})()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(g.H9),t.Y36(C.sK),t.Y36(u.K))},r.\u0275cmp=t.Xpm({type:r,selectors:[["money-account"]],decls:1,vars:2,consts:[["table","money_account",3,"itemTemplate","searchFields"]],template:function(e,o){1&e&&t._UZ(0,"list",0),2&e&&t.Q6J("itemTemplate",o.itemTemplate)("searchFields",o.searchFields)},dependencies:[at.n],encapsulation:2}),r})()},{path:"detail",component:R},{path:"add",component:W},{path:"transfer",component:ot}];let it=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[I.Bz.forChild(rt),I.Bz]}),r})(),ct=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[g.ez,a.u5,n.Pc,it,A.m,N.uH,C.aw.forChild({loader:{provide:C.Zw,useFactory:A.x,deps:[T.eN]}})]}),r})()},7613:(E,Z,l)=>{l.d(Z,{F:()=>F});var g=l(5861),a=l(6738),n=l(6895),C=l(4006),T=l(191);const A=["template"],N=["input1"],I=["input2"];function v(f,h){if(1&f){const t=a.EpF();a.TgZ(0,"ion-input",4,5),a.NdJ("ngModelChange",function(u){a.CHM(t);const d=a.oxw(2);return a.KtG(d.moneyValueString=u)})("ionBlur",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.ionBlur())})("ionFocus",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.ionFocus())})("keyup.enter",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.onEnter())}),a.qZA()}if(2&f){const t=a.oxw(2);a.Q6J("placeholder",t.placeholder)("disabled",t.disabled)("ngModel",t.moneyValueString)}}function x(f,h){if(1&f){const t=a.EpF();a.TgZ(0,"ion-input",6,7),a.NdJ("ngModelChange",function(u){a.CHM(t);const d=a.oxw(2);return a.KtG(d.moneyValueString=u)})("ionBlur",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.ionBlur())})("ionFocus",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.ionFocus())})("keyup.enter",function(){a.CHM(t);const u=a.oxw(2);return a.KtG(u.onEnter())}),a.qZA()}if(2&f){const t=a.oxw(2);a.Q6J("disabled",t.disabled)("placeholder",t.placeholder)("ngModel",t.moneyValueString)}}function U(f,h){if(1&f){const t=a.EpF();a.YNc(0,v,2,3,"ion-input",1),a.YNc(1,x,2,3,"ion-input",2),a.TgZ(2,"ion-input",3),a.NdJ("ngModelChange",function(u){a.CHM(t);const d=a.oxw();return a.KtG(d.moneyValue=u)})("ngModelChange",function(u){a.CHM(t);const d=a.oxw();return a.KtG(d.change(u))})("ionChange",function(){a.CHM(t);const u=a.oxw();return a.KtG(u.change(u.moneyValue))}),a.qZA()}if(2&f){const t=a.oxw();a.Q6J("ngIf",t.clear),a.xp6(1),a.Q6J("ngIf",!t.clear),a.xp6(1),a.Q6J("hidden",!0)("ngModel",t.moneyValue)}}let F=(()=>{class f{constructor(t){this.viewContainerRef=t,this.moneyValueChange=new a.vpe,this.clear=!1,this.decimal=".",this.thousands=",",this.decimalCount=2,this.changing=!1}ngOnInit(){var t=this;return(0,g.Z)(function*(){t.thousands=t.thousandsSeparator(),t.decimal="."===t.thousands?",":".",setTimeout(()=>{t.moneyValueString=t.moneyValue?t.formatMoney(t.moneyValue):t.moneyValue},1e3),t.viewContainerRef.createEmbeddedView(t.template)})()}getMoneyValueStringToNumber(t){if(t){let i=t.split(this.decimal).join("");return i=i.split(this.thousands).join(this.thousandsSeparator()),+i}return t}change(t){this.moneyValue=t,t?(this.moneyValueString=this.formatMoney(t),this.oldValue=this.moneyValueString):(this.moneyValueString=t,this.oldValue=t)}ionFocus(){return(0,g.Z)(function*(){})()}ionBlur(){if(this.moneyValueString){let t=this.moneyValueString.split(this.decimal).join("");t=t.split(this.thousands).join(this.thousandsSeparator()),this.moneyValue=+t,this.moneyValueString!=this.oldValue&&(this.moneyValueChange.emit(+t),this.oldValue=this.moneyValueString)}else this.moneyValue=this.moneyValueString,this.moneyValueString!=this.oldValue&&(this.moneyValueChange.emit(this.moneyValueString),this.oldValue=this.moneyValueString);this.moneyValueString=this.formatMoney(this.moneyValue),setTimeout(()=>{this.changing=!1},300)}formatMoney(t){if(!t)return t;const i=this.decimalCount,d=this.decimal,c=this.thousands;try{const b="\\d(?=(\\d{3})+"+(i>0?"\\D":"$")+")",O=t.toFixed(Math.max(0,~~i));let S=(c?O.replace(".",c):O).replace(new RegExp(b,"g"),"$&"+(d||","));return S&&(S.indexOf(this.thousands+"00")&&(S=S.split(this.thousands+"00").join("")),S)}catch(b){console.error(b)}}thousandsSeparator(){return parseFloat(.55.toString()).toLocaleString().indexOf(",55")>=0?",":"."}select(t){this.moneyValueString=t,this.ionBlur()}onEnter(){var t=this;return(0,g.Z)(function*(){const i=t.input1?t.input1:t.input2;if(!i)return;const u=yield i.getInputElement();!u||u.blur()})()}}return f.\u0275fac=function(t){return new(t||f)(a.Y36(a.s_b))},f.\u0275cmp=a.Xpm({type:f,selectors:[["money-input"]],viewQuery:function(t,i){if(1&t&&(a.Gf(A,7),a.Gf(N,5),a.Gf(I,5)),2&t){let u;a.iGM(u=a.CRH())&&(i.template=u.first),a.iGM(u=a.CRH())&&(i.input1=u.first),a.iGM(u=a.CRH())&&(i.input2=u.first)}},inputs:{moneyValue:"moneyValue",placeholder:"placeholder",disabled:"disabled",clear:"clear"},outputs:{moneyValueChange:"moneyValueChange"},decls:2,vars:0,consts:[["template",""],["type","text","inputmode","numeric",3,"placeholder","disabled","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter",4,"ngIf"],["inputmode","numeric","style","background-color: #efefef; border-radius: 5px; color: #000; margin-bottom: 5px;","type","text",3,"disabled","placeholder","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter",4,"ngIf"],[3,"hidden","ngModel","ngModelChange","ionChange"],["type","text","inputmode","numeric",3,"placeholder","disabled","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter"],["input1",""],["inputmode","numeric","type","text",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"disabled","placeholder","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter"],["input2",""]],template:function(t,i){1&t&&a.YNc(0,U,3,4,"ng-template",null,0,a.W1O)},dependencies:[n.O5,C.JJ,C.On,T.pK,T.j9],encapsulation:2}),f})()},3604:(E,Z,l)=>{l.d(Z,{_:()=>t});var g=l(6723),a=l(1914),n=l(6738),C=l(3306),T=l(6895),A=l(191);function N(i,u){if(1&i&&(n.TgZ(0,"p"),n._uU(1),n.qZA()),2&i){const d=n.oxw();n.xp6(1),n.Oqu(d.trade.contact.fullName)}}function I(i,u){if(1&i&&(n.TgZ(0,"p",3)(1,"b"),n._uU(2),n.qZA()()),2&i){const d=n.oxw();n.xp6(2),n.Oqu(d.productName(d.trade.product.code,d.trade.product.title))}}function v(i,u){if(1&i&&(n.TgZ(0,"p"),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&i){const d=n.oxw();n.xp6(1),n.lnq(" ",n.lcZ(2,3,"trade.buy")," ",d.trade.productCount," ",d.trade.product.unit?"("+d.trade.product.unit+")":""," ")}}function x(i,u){if(1&i&&(n.TgZ(0,"p"),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&i){const d=n.oxw();n.xp6(1),n.lnq(" ",n.lcZ(2,3,"trade.sale")," ",d.trade.productCount," ",d.trade.product.unit?"("+d.trade.product.unit+")":""," ")}}function U(i,u){if(1&i&&(n.TgZ(0,"p")(1,"i",7),n._uU(2),n.ALo(3,"translate"),n.qZA()()),2&i){const d=n.oxw();n.xp6(2),n.AsE("",n.lcZ(3,2,"trade.staff")," ",d.trade.staff.name,"")}}function F(i,u){if(1&i&&(n.TgZ(0,"ion-avatar",8),n._UZ(1,"img",9),n.qZA()),2&i){const d=n.oxw();n.xp6(1),n.Q6J("src",d.contactImageOrPlaceholder(d.trade.contact),n.LSH)}}function f(i,u){if(1&i&&(n.TgZ(0,"ion-avatar",8),n._UZ(1,"img",9),n.qZA()),2&i){const d=n.oxw();n.xp6(1),n.Q6J("src",d.trade.product.avatarUrl,n.LSH)}}const h=function(i,u,d){return[i,u,"symbol","1.0-2",d]};let t=(()=>{class i{constructor(d){this.translateService=d,this.isStaff=!1,this.showProduct=!0,this.onPress=new n.vpe,this.onClick=new n.vpe}dateFormat(d){return a.C.toUiDateString(d)}contactImageOrPlaceholder(d){return g.W.contactImageOrPlaceholder(d.avatarUrl)}productName(d,c){return g.W.productName(d,c)}limitText(d,c=200){return g.W.limitText(d,c)}press(){this.onPress.emit()}click(){this.onClick.emit()}}return i.\u0275fac=function(d){return new(d||i)(n.Y36(C.sK))},i.\u0275cmp=n.Xpm({type:i,selectors:[["trade-item"]],inputs:{currency:"currency",showContact:"showContact",isStaff:"isStaff",showProduct:"showProduct",trade:"trade"},outputs:{onPress:"onPress",onClick:"onClick"},decls:17,vars:22,consts:[[3,"press","click"],[1,"ion-text-wrap"],[3,"color"],[2,"white-space","pre-wrap"],[4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["slot","end",4,"ngIf"],[2,"font-size","11px"],["slot","end"],[3,"src"]],template:function(d,c){1&d&&(n.TgZ(0,"ion-item",0),n.NdJ("press",function(){return c.press()})("click",function(){return c.click()}),n.TgZ(1,"ion-label",1)(2,"ion-text",2),n._uU(3),n.ALo(4,"currency"),n.qZA(),n._UZ(5,"br"),n.TgZ(6,"ion-text",3),n._uU(7),n.qZA(),n.YNc(8,N,2,1,"p",4),n.YNc(9,I,3,1,"p",5),n.YNc(10,v,3,5,"p",4),n.YNc(11,x,3,5,"p",4),n.TgZ(12,"p"),n._uU(13),n.qZA(),n.YNc(14,U,4,4,"p",4),n.qZA(),n.YNc(15,F,2,1,"ion-avatar",6),n.YNc(16,f,2,1,"ion-avatar",6),n.qZA()),2&d&&(n.xp6(2),n.s9C("color",(c.trade.isReceived?1:-1)*c.trade.value>=0?"secondary":"danger"),n.xp6(1),n.AsE("",c.trade.isReceived&&c.trade.value>0?"+":c.trade.isReceived?"":"-","",n.G7q(4,12,n.kEZ(18,h,c.trade.value,c.currency,c.translateService.currentLang)),""),n.xp6(4),n.Oqu(c.limitText(c.trade.note)),n.xp6(1),n.Q6J("ngIf",c.trade.contactId&&0!=c.trade.contactId&&c.trade.contact&&c.showContact),n.xp6(1),n.Q6J("ngIf",c.trade.productId&&0!=c.trade.productId&&c.trade.product&&c.showProduct),n.xp6(1),n.Q6J("ngIf",c.trade.productId&&0!=c.trade.productId&&c.trade.product&&c.trade.isPurchase&&!c.trade.isReceived),n.xp6(1),n.Q6J("ngIf",c.trade.productId&&0!=c.trade.productId&&c.trade.product&&c.trade.isPurchase&&c.trade.isReceived),n.xp6(2),n.hij(" ",c.dateFormat(c.trade.createdAt)," "),n.xp6(1),n.Q6J("ngIf",c.trade.staffId&&0!=c.trade.staffId&&c.trade.staff&&!c.isStaff),n.xp6(1),n.Q6J("ngIf",c.trade.contactId&&0!=c.trade.contactId&&c.trade.contact&&c.showContact),n.xp6(1),n.Q6J("ngIf",c.trade.productId&&0!=c.trade.productId&&c.trade.product&&c.trade.product.avatarUrl&&c.showProduct))},dependencies:[T.O5,A.BJ,A.Ie,A.Q$,A.yW,T.H9,C.X$],encapsulation:2}),i})()}}]);