"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9433],{2975:(bt,et,C)=>{C.d(et,{p:()=>xt});var f=C(5861),x=C(1914),q=C(6723),n=C(6738),J=C(5851),g=C(191),t=C(3306),B=C(7488),R=C(667),H=C(6961),N=C(323),M=C(6895),L=C(4006);function X(p,Z){if(1&p&&(n.TgZ(0,"ion-avatar",3),n._UZ(1,"img",18),n.qZA()),2&p){const r=n.oxw(2);n.xp6(1),n.Q6J("src",r.mainProduct.avatarUrl,n.LSH)}}const nt=function(p,Z,r){return[p,Z,"symbol","1.0-2",r]};function ot(p,Z){if(1&p&&(n.TgZ(0,"ion-item",15)(1,"ion-text",16),n._uU(2),n.ALo(3,"currency"),n.qZA(),n.YNc(4,X,2,1,"ion-avatar",17),n.qZA()),2&p){const r=n.oxw();n.xp6(1),n.Udp("font-weight",r.mainProduct.count>0?"bold":"normal"),n.Q6J("color",r.mainProduct.count>0?"primary":"normal"),n.xp6(1),n.HOy(" ",r.productName(r.mainProduct.code,r.mainProduct.title)," | ",r.mainProduct.count," ",r.mainProduct.unit," | ",n.G7q(3,8,n.kEZ(14,nt,r.mainProduct.total,r.currency,r.translateService.currentLang))," "),n.xp6(2),n.Q6J("ngIf",r.mainProduct.avatarUrl)}}function rt(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-searchbar",19),n.NdJ("ionClear",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.clearSearch())})("ionChange",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.search())})("ngModelChange",function(_){n.CHM(r);const d=n.oxw();return n.KtG(d.searchKey=_)}),n.ALo(1,"translate"),n.qZA()}if(2&p){const r=n.oxw();n.s9C("placeholder",n.lcZ(1,2,"product-attribute-selector.filter-by-words")),n.Q6J("ngModel",r.searchKey)}}function U(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-item",20)(1,"ion-label",21),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.select(d))}),n._uU(2),n.qZA(),n.TgZ(3,"ion-toggle",22),n.NdJ("ngModelChange",function(_){const P=n.CHM(r).$implicit;return n.KtG(P.isSelected=_)})("ionChange",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.onChange(d))}),n.qZA()()}if(2&p){const r=Z.$implicit;n.xp6(1),n.Udp("font-weight",r.isSelected?"bold":"normal"),n.Q6J("color",r.isSelected?"primary":"normal"),n.xp6(1),n.hij(" ",r.title," "),n.xp6(1),n.Q6J("ngModel",r.isSelected)}}function G(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-item",20)(1,"ion-label",21),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.select(d))}),n._uU(2),n.qZA(),n.TgZ(3,"ion-toggle",22),n.NdJ("ngModelChange",function(_){const P=n.CHM(r).$implicit;return n.KtG(P.isSelected=_)})("ionChange",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.onChange(d))}),n.qZA()()}if(2&p){const r=Z.$implicit;n.xp6(1),n.Udp("font-weight",r.isSelected?"bold":"normal"),n.Q6J("color",r.isSelected?"primary":"normal"),n.xp6(1),n.hij(" ",r.title," "),n.xp6(1),n.Q6J("ngModel",r.isSelected)}}function ct(p,Z){1&p&&(n.TgZ(0,"ion-item",20),n._UZ(1,"div",23),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Q6J("innerHTML",n.lcZ(2,1,"product-attribute-selector.no-attribute"),n.oJD))}let it=(()=>{class p{constructor(r,s,_,d,P,F,j){var S=this;this.navCtrl=r,this.modalCtrl=s,this.translateService=_,this.userService=d,this.staffService=P,this.productService=F,this.analyticsService=j,this.attributes=[],this.selectedAttributes=[],this.originalAttributes=[],this.searchKey="",this.tab="all",this.reloadProducts=(0,f.Z)(function*(){const $=yield S.navCtrl.loading();S.currency=yield S.userService.getAttr("current-currency"),S.productService.getProductAttributes(S.mainProduct.id).then(function(){var V=(0,f.Z)(function*(O){const A=JSON.parse(JSON.stringify(O));if(A&&A.length){const w=[];for(const k of A)!(S.mainProduct.attributes&&S.mainProduct.attributes.length&&S.mainProduct.attributes.find(D=>D.id===k.id))||(k.isSelected=!0,w.push(k));S.selectedAttributes=w}S.attributes=A,S.originalAttributes=A,yield $.dismiss()});return function(O){return V.apply(this,arguments)}}())})}ionViewWillEnter(){var r=this;return(0,f.Z)(function*(){yield r.analyticsService.setCurrentScreen("product-attribute-selector")})()}select(r){r.isSelected=!r.isSelected,this.onChange(r,!0)}onChange(r,s=!1){if(r.isSelected){if(this.selectedAttributes.findIndex(d=>d.id==r.id)>=0)return;this.analyticsService.logEvent("product-attribute-selector-selected"),this.selectedAttributes.push(r)}else{this.analyticsService.logEvent("product-attribute-selector-deselected");const _=this.selectedAttributes.findIndex(d=>d.id==r.id);_>=0&&this.selectedAttributes.splice(_,1),(!this.selectedAttributes||!this.selectedAttributes.length)&&"all"!==this.tab&&(this.tab="all")}}ngOnInit(){this.reloadProducts()}dateFormat(r){return x.C.toUiString(r)}search(){var r=this;return(0,f.Z)(function*(){r.analyticsService.logEvent("product-attribute-selector-search");let s=r.originalAttributes;if(null!==r.searchKey&&""!==r.searchKey){const _=r.searchKey.toLowerCase();s=s.filter(d=>d.title&&-1!==d.title.toLowerCase().indexOf(_))}r.attributes=s})()}clearSearch(){var r=this;return(0,f.Z)(function*(){r.analyticsService.logEvent("product-attribute-selector-clear-search"),r.searchKey=null,r.attributes=r.originalAttributes})()}dismiss(){this.modalCtrl.dismiss()}ok(){var r=this;return(0,f.Z)(function*(){r.analyticsService.logEvent("product-attribute-selector-ok"),r.modalCtrl.dismiss(r.selectedAttributes)})()}productName(r,s){return q.W.productName(r,s)}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(J.G),n.Y36(g.IN),n.Y36(t.sK),n.Y36(B.K),n.Y36(R.x),n.Y36(H.M),n.Y36(N.y))},p.\u0275cmp=n.Xpm({type:p,selectors:[["product-attribute-selector"]],inputs:{mainProduct:"mainProduct"},decls:37,vars:28,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["name","checkmark"],[1,"ion-padding"],["color","danger"],["text-wrap","","lines","none",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","all"],["value","selected"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],[3,"hidden"],["text-wrap","",4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["text-wrap","","lines","none"],[2,"padding-top","8px","padding-bottom","8px",3,"color"],["slot","end",4,"ngIf"],[3,"src"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["text-wrap",""],[1,"ion-text-wrap",2,"padding-top","8px","padding-bottom","8px",3,"color","click"],["slot","end",3,"ngModel","ngModelChange","ionChange"],[3,"innerHTML"]],template:function(r,s){1&r&&(n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),n.NdJ("click",function(){return s.dismiss()}),n._UZ(4,"ion-icon",2),n.qZA()(),n.TgZ(5,"ion-title"),n._uU(6),n.ALo(7,"translate"),n.qZA(),n.TgZ(8,"ion-buttons",3)(9,"ion-button",1),n.NdJ("click",function(){return s.ok()}),n._UZ(10,"ion-icon",4),n._uU(11),n.ALo(12,"translate"),n.qZA()()(),n.TgZ(13,"div",5)(14,"ion-text",6)(15,"strong")(16,"i"),n._uU(17),n.ALo(18,"translate"),n.qZA()()()(),n.YNc(19,ot,5,18,"ion-item",7),n.TgZ(20,"ion-segment",8),n.NdJ("ngModelChange",function(d){return s.tab=d}),n.TgZ(21,"ion-segment-button",9),n._uU(22),n.ALo(23,"translate"),n.qZA(),n.TgZ(24,"ion-segment-button",10)(25,"ion-text"),n._uU(26),n.ALo(27,"translate"),n.TgZ(28,"ion-text",6),n._uU(29),n.qZA()()()(),n.YNc(30,rt,2,4,"ion-searchbar",11),n.qZA(),n.TgZ(31,"ion-content")(32,"ion-list",12),n.YNc(33,U,4,5,"ion-item",13),n.qZA(),n.TgZ(34,"ion-list",12),n.YNc(35,G,4,5,"ion-item",13),n.YNc(36,ct,3,3,"ion-item",14),n.qZA()()),2&r&&(n.xp6(6),n.hij(" ",n.lcZ(7,18,"product-attribute-selector.title")," "),n.xp6(5),n.hij("\xa0",n.lcZ(12,20,"action.save")," "),n.xp6(6),n.hij("* ",n.lcZ(18,22,"product-type.recommend"),""),n.xp6(2),n.Q6J("ngIf",s.mainProduct),n.xp6(1),n.Q6J("ngModel",s.tab),n.xp6(2),n.hij(" ",n.lcZ(23,24,"product-attribute-selector.filter-all")," "),n.xp6(3),n.Udp("font-weight",s.selectedAttributes&&s.selectedAttributes.length?"bold":"normal"),n.xp6(1),n.hij(" ",n.lcZ(27,26,"product-attribute-selector.filter-selected")," "),n.xp6(3),n.hij(" (",s.selectedAttributes?s.selectedAttributes.length:0,")"),n.xp6(1),n.Q6J("ngIf","all"==s.tab),n.xp6(1),n.Akn(s.navCtrl.hasAds()?"--padding-bottom: 60px":""),n.xp6(1),n.Q6J("hidden","all"==s.tab),n.xp6(1),n.Q6J("ngForOf",s.selectedAttributes),n.xp6(1),n.Q6J("hidden","selected"==s.tab),n.xp6(1),n.Q6J("ngForOf",s.attributes),n.xp6(1),n.Q6J("ngIf",!s.originalAttributes||0===s.originalAttributes.length))},dependencies:[M.sg,M.O5,L.JJ,L.On,g.BJ,g.YG,g.Sm,g.W2,g.Gu,g.gu,g.Ie,g.Q$,g.q_,g.VI,g.cJ,g.GO,g.yW,g.wd,g.ho,g.sr,g.w,g.QI,g.j9,M.H9,t.X$],encapsulation:2}),p})();const at=["barcodeInput"];function st(p,Z){1&p&&n._UZ(0,"br")}function lt(p,Z){if(1&p&&(n.TgZ(0,"ion-text",22),n._uU(1),n.qZA()),2&p){const r=n.oxw(2);n.xp6(1),n.hij(" ",r.getAttributesString(r.mainProduct)," ")}}function ut(p,Z){if(1&p&&(n.TgZ(0,"ion-avatar",3),n._UZ(1,"img",23),n.qZA()),2&p){const r=n.oxw(2);n.xp6(1),n.Q6J("src",r.mainProduct.avatarUrl,n.LSH)}}const y=function(p,Z,r){return[p,Z,"symbol","1.0-2",r]};function _t(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-item",15)(1,"ion-text",16),n._uU(2),n.ALo(3,"currency"),n.YNc(4,st,1,0,"br",17),n.YNc(5,lt,2,1,"ion-text",18),n.qZA(),n.YNc(6,ut,2,1,"ion-avatar",19),n.TgZ(7,"ion-buttons",3)(8,"ion-button",20),n.NdJ("click",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.addAttributes())}),n._UZ(9,"ion-icon",21),n.qZA()()()}if(2&p){const r=n.oxw();n.xp6(1),n.Udp("font-weight",r.mainProduct.count>0?"bold":"normal"),n.Q6J("color",r.mainProduct.count>0?"primary":"normal"),n.xp6(1),n.HOy(" ",r.productName(r.mainProduct.code,r.mainProduct.title)," | ",r.mainProduct.count," ",r.mainProduct.unit," | ",n.G7q(3,10,n.kEZ(16,y,r.mainProduct.total,r.currency,r.translateService.currentLang))," "),n.xp6(2),n.Q6J("ngIf",r.mainProduct.attributes&&r.mainProduct.attributes.length),n.xp6(1),n.Q6J("ngIf",r.mainProduct.attributes&&r.mainProduct.attributes.length),n.xp6(1),n.Q6J("ngIf",r.mainProduct.avatarUrl)}}function pt(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-searchbar",24,25),n.NdJ("ionClear",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.clearSearch())})("ionChange",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.search())})("ngModelChange",function(_){n.CHM(r);const d=n.oxw();return n.KtG(d.searchKey=_)})("ngModelChange",function(){n.CHM(r);const _=n.oxw();return n.KtG(_.barcodeChanged())}),n.ALo(2,"translate"),n.qZA()}if(2&p){const r=n.oxw();n.s9C("placeholder",n.lcZ(2,2,"product-selector.filter-by-words")),n.Q6J("ngModel",r.searchKey)}}function dt(p,Z){if(1&p&&(n.TgZ(0,"ion-avatar",3),n._UZ(1,"img",23),n.qZA()),2&p){const r=n.oxw().$implicit;n.xp6(1),n.Q6J("src",r.avatarUrl,n.LSH)}}function gt(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-item",26)(1,"ion-text",27),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.increase(d))}),n._uU(2),n.ALo(3,"currency"),n._UZ(4,"br"),n.TgZ(5,"span",28),n._uU(6),n.ALo(7,"translate"),n.qZA()(),n.YNc(8,dt,2,1,"ion-avatar",19),n.TgZ(9,"ion-buttons",3)(10,"ion-button",20),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.decrease(d))}),n._UZ(11,"ion-icon",29),n.qZA(),n.TgZ(12,"ion-button",20),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.increase(d))}),n._UZ(13,"ion-icon",30),n.qZA()()()}if(2&p){const r=Z.$implicit,s=n.oxw();n.xp6(1),n.Udp("font-weight",r.count>0?"bold":"normal"),n.Q6J("color",r.count>0?"primary":"normal"),n.xp6(1),n.HOy(" ",s.productName(r.code,r.title)," | ",r.count," ",r.unit," | ",n.G7q(3,11,n.kEZ(19,y,r.total,s.currency,s.translateService.currentLang))," "),n.xp6(4),n.lnq("",n.lcZ(7,17,"product-selector.quantity-left"),": ",r.quantity-r.count>0?r.quantity-r.count:0," ",r.unit,""),n.xp6(2),n.Q6J("ngIf",r.avatarUrl)}}function mt(p,Z){if(1&p&&(n.TgZ(0,"ion-avatar",3),n._UZ(1,"img",23),n.qZA()),2&p){const r=n.oxw().$implicit;n.xp6(1),n.Q6J("src",r.avatarUrl,n.LSH)}}function ft(p,Z){if(1&p){const r=n.EpF();n.TgZ(0,"ion-item",26)(1,"ion-text",27),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.increase(d))}),n._uU(2),n.ALo(3,"currency"),n._UZ(4,"br"),n.TgZ(5,"span",28),n._uU(6),n.ALo(7,"translate"),n.qZA()(),n.YNc(8,mt,2,1,"ion-avatar",19),n.TgZ(9,"ion-buttons",3)(10,"ion-button",20),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.decrease(d))}),n._UZ(11,"ion-icon",31),n.qZA(),n.TgZ(12,"ion-button",20),n.NdJ("click",function(){const d=n.CHM(r).$implicit,P=n.oxw();return n.KtG(P.increase(d))}),n._UZ(13,"ion-icon",32),n.qZA()()()}if(2&p){const r=Z.$implicit,s=n.oxw();n.xp6(1),n.Udp("font-weight",r.count>0?"bold":"normal"),n.Q6J("color",r.count>0?"primary":"normal"),n.xp6(1),n.HOy(" ",s.productName(r.code,r.title)," | ",r.count," ",r.unit," | ",n.G7q(3,11,n.kEZ(19,y,r.total,s.currency,s.translateService.currentLang))," "),n.xp6(4),n.lnq("",n.lcZ(7,17,"product-selector.quantity-left"),": ",r.quantity-r.count>0?r.quantity-r.count:0," ",r.unit,""),n.xp6(2),n.Q6J("ngIf",r.avatarUrl)}}function ht(p,Z){1&p&&(n.TgZ(0,"ion-item",26),n._UZ(1,"div",33),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Q6J("innerHTML",n.lcZ(2,1,"product-selector.no-product"),n.oJD))}let xt=(()=>{class p{constructor(r,s,_,d,P,F,j){var S=this;this.navCtrl=r,this.modalCtrl=s,this.userService=_,this.staffService=d,this.translateService=P,this.productService=F,this.analyticsService=j,this.products=[],this.selectedProducts=[],this.originalProducts=[],this.searchKey="",this.tab="all",this.reloadProducts=(0,f.Z)(function*(){S.params=S.navCtrl.getParams(S.params),S.params&&(S.mainProduct=S.params.mainProduct,S.callback=S.params.callback);const $=yield S.navCtrl.loading();S.currency=yield S.userService.getAttr("current-currency"),S.productService.getAllProductsAreOption().then(function(){var V=(0,f.Z)(function*(O){const A=JSON.parse(JSON.stringify(O));if(A&&A.length)for(const w of A)w.total=0,w.quantity=w.count,w.count=0;if(S.originalProducts=A,S.products=A,S.products&&S.products.length){const w=[];for(const k of S.products){const K=S.mainProduct.options&&S.mainProduct.options.length?S.mainProduct.options.find(D=>D.id==k.id):null;!K||(k.total=K.total,k.count=K.count,w.push(k))}S.selectedProducts=w}yield $.dismiss(),S.barcodeFocus()});return function(O){return V.apply(this,arguments)}}())})}ionViewWillEnter(){var r=this;return(0,f.Z)(function*(){yield r.analyticsService.setCurrentScreen("product-option-selector")})()}tabChanged(){this.barcodeFocus()}barcodeChanged(){var r=this;return(0,f.Z)(function*(){!r.searchKey||r.searchKey.length<5||(r.analyticsService.logEvent("product-option-selector-barcode-entered"),r.productService.searchByBarcode(r.searchKey).then(s=>{if(!s)return;r.analyticsService.logEvent("product-option-selector-barcode-entered-ok");let _=r.originalProducts;if(_=_.filter(d=>d.id===s.id),_&&_.length)for(const d of _)r.increase(d);r.products=_}))})()}barcodeFocus(){!this.navCtrl.isNotCordova()||"all"===this.tab&&setTimeout(()=>{typeof this.barcodeInput<"u"&&this.barcodeInput.setFocus()},600)}reCalc(r){r.total=r.count*r.price,this.applyItemTotal()}applyItemTotal(){let r=0;for(const s of this.selectedProducts)r+=1*s.total;this.mainProduct.total=(this.mainProduct.price+r)*this.mainProduct.count}increase(r){var s=this;return(0,f.Z)(function*(){s.selectedProducts.find(d=>d.id===r.id)||s.selectedProducts.push(r),r.count++,r.count>=2&&s.analyticsService.logEvent("product-option-selector-increase-2"),s.reCalc(r),s.barcodeFocus()})()}decrease(r){var s=this;return(0,f.Z)(function*(){if(r&&0===r.count)s.barcodeFocus();else{if(s.analyticsService.logEvent("product-option-selector-decrease"),r.count--,0===r.count){const _=s.selectedProducts.findIndex(d=>d.id===r.id);_>=0&&s.selectedProducts.splice(_,1),(!s.selectedProducts||!s.selectedProducts.length)&&"all"!==s.tab&&(s.tab="all",s.tabChanged())}s.reCalc(r),s.barcodeFocus()}})()}ngOnInit(){this.reloadProducts()}dateFormat(r){return x.C.toUiString(r)}search(){var r=this;return(0,f.Z)(function*(){r.analyticsService.logEvent("product-option-selector-search");let s=r.originalProducts;if(null!==r.searchKey&&""!==r.searchKey){const _=r.searchKey.toLowerCase();s=s.filter(d=>d.title&&-1!==d.title.toLowerCase().indexOf(_)||d.code&&-1!==d.code.toLowerCase().indexOf(_))}r.products=s})()}clearSearch(){var r=this;return(0,f.Z)(function*(){r.analyticsService.logEvent("product-option-selector-clear-search"),r.searchKey=null,r.products=r.originalProducts,r.barcodeFocus()})()}dismiss(){var r=this;return(0,f.Z)(function*(){if(r.callback)return r.callback(null),void(yield r.navCtrl.back());r.modalCtrl.dismiss()})()}ok(){var r=this;return(0,f.Z)(function*(){if(r.analyticsService.logEvent("product-option-selector-ok"),r.callback)return r.callback({options:r.selectedProducts,attributes:r.mainProduct.attributes}),void r.navCtrl.back();r.modalCtrl.dismiss({options:r.selectedProducts,attributes:r.mainProduct.attributes})})()}productName(r,s){return q.W.productName(r,s)}addAttributes(){var r=this;return(0,f.Z)(function*(){const s=yield r.modalCtrl.create({component:it,componentProps:{mainProduct:r.mainProduct}});yield s.present();const{data:_}=yield s.onWillDismiss();_&&(r.mainProduct.attributes=_)})()}getAttributesString(r){return q.W.getAttributesString(r)}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(J.G),n.Y36(g.IN),n.Y36(B.K),n.Y36(R.x),n.Y36(t.sK),n.Y36(H.M),n.Y36(N.y))},p.\u0275cmp=n.Xpm({type:p,selectors:[["product-option-selector"]],viewQuery:function(r,s){if(1&r&&n.Gf(at,5),2&r){let _;n.iGM(_=n.CRH())&&(s.barcodeInput=_.first)}},inputs:{mainProduct:"mainProduct"},decls:37,vars:28,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["name","checkmark"],[1,"ion-padding"],["color","danger"],["text-wrap","","lines","none",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","all"],["value","selected"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],[3,"hidden"],["text-wrap","",4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["text-wrap","","lines","none"],[2,"padding-top","8px","padding-bottom","8px",3,"color"],[4,"ngIf"],["style","font-size: 0.8em",4,"ngIf"],["slot","end",4,"ngIf"],["fill","clear",3,"click"],["slot","icon-only","name","options"],[2,"font-size","0.8em"],[3,"src"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["barcodeInput",""],["text-wrap",""],[2,"padding-top","8px","padding-bottom","8px",3,"color","click"],[2,"font-size","0.7em"],["slot","icon-only","name","remove"],["slot","icon-only","name","add"],["slot","icon-only","size","large","name","remove"],["slot","icon-only","size","large","name","add"],[3,"innerHTML"]],template:function(r,s){1&r&&(n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),n.NdJ("click",function(){return s.dismiss()}),n._UZ(4,"ion-icon",2),n.qZA()(),n.TgZ(5,"ion-title"),n._uU(6),n.ALo(7,"translate"),n.qZA(),n.TgZ(8,"ion-buttons",3)(9,"ion-button",1),n.NdJ("click",function(){return s.ok()}),n._UZ(10,"ion-icon",4),n._uU(11),n.ALo(12,"translate"),n.qZA()()(),n.TgZ(13,"div",5)(14,"ion-text",6)(15,"strong")(16,"i"),n._uU(17),n.ALo(18,"translate"),n.qZA()()()(),n.YNc(19,_t,10,20,"ion-item",7),n.TgZ(20,"ion-segment",8),n.NdJ("ngModelChange",function(d){return s.tab=d})("ngModelChange",function(){return s.tabChanged()}),n.TgZ(21,"ion-segment-button",9),n._uU(22),n.ALo(23,"translate"),n.qZA(),n.TgZ(24,"ion-segment-button",10)(25,"ion-text"),n._uU(26),n.ALo(27,"translate"),n.TgZ(28,"ion-text",6),n._uU(29),n.qZA()()()(),n.YNc(30,pt,3,4,"ion-searchbar",11),n.qZA(),n.TgZ(31,"ion-content")(32,"ion-list",12),n.YNc(33,gt,14,23,"ion-item",13),n.qZA(),n.TgZ(34,"ion-list",12),n.YNc(35,ft,14,23,"ion-item",13),n.YNc(36,ht,3,3,"ion-item",14),n.qZA()()),2&r&&(n.xp6(6),n.hij(" ",n.lcZ(7,18,"product-option-selector.title")," "),n.xp6(5),n.hij("\xa0",n.lcZ(12,20,"action.save")," "),n.xp6(6),n.hij("* ",n.lcZ(18,22,"product-type.suggestion"),""),n.xp6(2),n.Q6J("ngIf",s.mainProduct),n.xp6(1),n.Q6J("ngModel",s.tab),n.xp6(2),n.hij(" ",n.lcZ(23,24,"product-selector.filter-all")," "),n.xp6(3),n.Udp("font-weight",s.selectedProducts&&s.selectedProducts.length?"bold":"normal"),n.xp6(1),n.hij(" ",n.lcZ(27,26,"product-selector.filter-selected")," "),n.xp6(3),n.hij(" (",s.selectedProducts?s.selectedProducts.length:0,")"),n.xp6(1),n.Q6J("ngIf","all"===s.tab),n.xp6(1),n.Akn(s.navCtrl.hasAds()?"--padding-bottom: 60px":""),n.xp6(1),n.Q6J("hidden","all"===s.tab),n.xp6(1),n.Q6J("ngForOf",s.selectedProducts),n.xp6(1),n.Q6J("hidden","selected"===s.tab),n.xp6(1),n.Q6J("ngForOf",s.products),n.xp6(1),n.Q6J("ngIf",!s.originalProducts||0===s.originalProducts.length))},dependencies:[M.sg,M.O5,L.JJ,L.On,g.BJ,g.YG,g.Sm,g.W2,g.Gu,g.gu,g.Ie,g.q_,g.VI,g.cJ,g.GO,g.yW,g.wd,g.sr,g.QI,g.j9,M.H9,t.X$],encapsulation:2}),p})()},423:(bt,et,C)=>{C.d(et,{c:()=>ce});var f=C(5861),x=C(191),q=C(5439),n=C(7489),J=C(1914),g=C(6723),t=C(6738),B=C(5851),R=C(7488),H=C(667),N=C(3306),M=C(6961),L=C(7696),X=C(323),nt=C(6861),ot=C(3876),rt=C(7852),U=C(6895),G=C(4006),ct=C(2216),it=C(7613);function at(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" (",e.product.unit,")")}}function st(i,u){if(1&i&&(t.TgZ(0,"ion-thumbnail",6),t._UZ(1,"img",21),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("src",e.product.avatarUrl,t.LSH)}}function lt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.showOptions(c.product))}),t._UZ(1,"ion-icon",23),t.qZA()}}function ut(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.decrease(c.product))}),t._UZ(1,"ion-icon",24),t.qZA()}}const y=function(i,u,e){return[i,u,"symbol","1.0-2",e]};function _t(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t._UZ(4,"br"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"product-add.cost-price"),": ",t.G7q(3,4,t.kEZ(10,y,e.product.costPrice,e.currency,e.translateService.currentLang)),"")}}function pt(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t._UZ(4,"br"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"product-detail.base-price"),": ",t.G7q(3,4,t.kEZ(10,y,e.product.basePrice,e.currency,e.translateService.currentLang)),"")}}function dt(i,u){if(1&i&&(t.TgZ(0,"p",25),t.YNc(1,_t,5,14,"span",4),t.YNc(2,pt,5,14,"span",4),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.product.costPrice&&e.isShopAdmin),t.xp6(1),t.Q6J("ngIf",e.product.basePrice)}}function gt(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.customer-price")))}function mt(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.staff-price")))}function ft(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.collaborator-price")))}function ht(i,u){if(1&i&&(t.TgZ(0,"p"),t.YNc(1,gt,3,3,"span",4),t.YNc(2,mt,3,3,"span",4),t.YNc(3,ft,3,3,"span",4),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.product.isCustomerPrice),t.xp6(1),t.Q6J("ngIf",e.product.isStaffPrice),t.xp6(1),t.Q6J("ngIf",e.product.isCollaboratorPrice)}}function xt(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.AsE("",e.toFixQuantity(e.product.count),"\xa0",e.product.unit," \xd7 ")}}function p(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" - ",t.G7q(2,1,t.kEZ(7,y,e.product.discount,e.currency,e.translateService.currentLang)),"")}}function Z(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("| ",t.G7q(2,1,t.kEZ(7,y,e.product.total,e.currency,e.translateService.currentLang)),"")}}function r(i,u){if(1&i&&(t.TgZ(0,"span",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.lnq("",t.lcZ(2,3,"product-selector.quantity-left"),": ",e.product.quantity-e.product.count>0?e.toFixQuantity(e.product.quantity-e.product.count):0," ",e.product.unit,"")}}function s(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",26),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.showTypes(c.product))}),t._UZ(1,"ion-icon",27),t.TgZ(2,"ion-text",11),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"product-selector.show-types")))}function _(i,u){1&i&&t._UZ(0,"br")}function d(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",28),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.showOthers(c.product))}),t._UZ(1,"ion-icon",29),t.TgZ(2,"ion-text",11),t._uU(3),t.ALo(4,"translate"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("name",e.product.showOthers?"chevron-up-outline":"chevron-down-outline"),t.xp6(2),t.hij(" ",t.lcZ(4,2,"product-selector.other-units"),"")}}function P(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.getAttributesString(e.product)," ")}}function F(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.getTypeAttributesString(e.product)," ")}}function j(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.AsE(" | ",e.count," \xd7 ",t.G7q(2,2,t.kEZ(8,y,e.price,o.currency,o.translateService.currentLang)),"")}}function S(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function $(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11),t._uU(3),t.YNc(4,j,3,12,"span",4),t._uU(5," | "),t.YNc(6,S,2,0,"span",4),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.BQk()),2&i){const e=u.$implicit,o=t.oxw(2);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(8,6,t.kEZ(12,y,e.total,o.currency,o.translateService.currentLang))," ")}}function V(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11)(3,"strong"),t._uU(4),t.qZA()()(),t.YNc(5,$,9,16,"ng-container",19),t.BQk()),2&i){const e=u.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngForOf",e.values)}}function O(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.ALo(3,"currency"),t.ALo(4,"currency"),t.qZA()()),2&i){const e=u.$implicit,o=t.oxw(2);t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.xDo(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," \xd7 ",t.G7q(3,7,t.kEZ(19,y,e.price,o.currency,o.translateService.currentLang))," | +",t.G7q(4,13,t.kEZ(23,y,e.total,o.currency,o.translateService.currentLang)),"")}}function A(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11)(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()()(),t.YNc(6,O,5,27,"p",31),t.BQk()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,2,"order-add.added-products")),t.xp6(2),t.Q6J("ngForOf",e.product.options)}}function w(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid",32)(1,"ion-row")(2,"ion-col")(3,"ion-label",33),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"money-input",34),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.product.price=c)})("moneyValueChange",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.reCalc(c.product))}),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"ion-col")(9,"ion-label",33),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"ion-input",35),t.NdJ("ngModelChange",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.product.count=c)})("ngModelChange",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.changeCount(c.product))})("focus",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.selectAll(c))}),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col")(15,"ion-label",33),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"money-input",36),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.product.discount=c)})("moneyValueChange",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.reCalc(c.product))}),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"ion-text",37),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.openProductDiscountPercent(c.product))}),t._uU(21),t.qZA()(),t.TgZ(22,"ion-col")(23,"ion-label",33),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"money-input",36),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.product.total=c)}),t.ALo(27,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,19,"order-add.product-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(7,21,"order-add.enter-product-price")),t.Q6J("disabled",e.blockEditingOrderPrice)("clear",!0)("moneyValue",e.product.price),t.xp6(4),t.hij(" ",t.lcZ(11,23,"order-add.product-count")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(13,25,"order-add.enter-product-count")),t.Q6J("ngModel",e.product.count),t.xp6(4),t.hij(" ",t.lcZ(17,27,"order-add.product-discount"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(19,29,"order-add.enter-product-discount")),t.Q6J("clear",!0)("moneyValue",e.product.discount),t.xp6(2),t.Udp("background-color",e.product.discountPercent?"#3880ff":"#ccc"),t.xp6(1),t.hij(" ",e.product.discountPercent?e.product.discountPercent.toFixed(0)+"%":"%"," "),t.xp6(3),t.hij(" ",t.lcZ(25,31,"order-add.product-total")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(27,33,"order-add.enter-product-total")),t.Q6J("clear",!0)("moneyValue",e.product.total)}}function k(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" (",e.unit,")")}}function K(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.customer-price")))}function D(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.staff-price")))}function Tt(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-detail.collaborator-price")))}function At(i,u){if(1&i&&(t.TgZ(0,"p"),t.YNc(1,K,3,3,"span",4),t.YNc(2,D,3,3,"span",4),t.YNc(3,Tt,3,3,"span",4),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.isCustomerPrice),t.xp6(1),t.Q6J("ngIf",e.isStaffPrice),t.xp6(1),t.Q6J("ngIf",e.isCollaboratorPrice)}}function vt(i,u){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.hij(" - ",t.G7q(2,1,t.kEZ(7,y,e.discount,o.currency,o.translateService.currentLang)),"")}}function wt(i,u){if(1&i&&(t.TgZ(0,"span",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.lnq("",t.lcZ(2,3,"product-selector.quantity-left"),": ",e.quantity-e.count>0?o.toFixQuantity(e.quantity-e.count):0," ",e.unit,"")}}function It(i,u){if(1&i&&(t.TgZ(0,"ion-thumbnail",6),t._UZ(1,"img",21),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function Jt(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",o.getAttributesString(e)," ")}}function kt(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",o.getTypeAttributesString(e)," ")}}function qt(i,u){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Mt(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11),t._uU(3),t.YNc(4,qt,2,0,"span",4),t._uU(5),t.ALo(6,"currency"),t.qZA()(),t.BQk()),2&i){const e=u.$implicit,o=t.oxw(4);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.AsE(" ",e.title," | +",e.count," | "),t.xp6(1),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(6,6,t.kEZ(12,y,e.total,o.currency,o.translateService.currentLang))," ")}}function Ut(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11)(3,"strong"),t._uU(4),t.qZA()()(),t.YNc(5,Mt,7,16,"ng-container",19),t.BQk()),2&i){const e=u.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngForOf",e.values)}}function Nt(i,u){if(1&i&&(t.TgZ(0,"p",30)(1,"ion-text",11),t._uU(2),t.ALo(3,"currency"),t.ALo(4,"currency"),t.qZA()()),2&i){const e=u.$implicit,o=t.oxw(4);t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.xDo(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," \xd7 ",t.G7q(3,7,t.kEZ(19,y,e.price,o.currency,o.translateService.currentLang))," | +",t.G7q(4,13,t.kEZ(23,y,e.total,o.currency,o.translateService.currentLang)),"")}}function Ot(i,u){if(1&i&&(t.ynx(0),t.TgZ(1,"p",30)(2,"ion-text",11)(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()()(),t.YNc(6,Nt,5,27,"p",31),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(t.lcZ(5,2,"order-add.added-products")),t.xp6(2),t.Q6J("ngForOf",e.options)}}function Qt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid",32)(1,"ion-row")(2,"ion-col")(3,"ion-label",33),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"money-input",36),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.price=c)})("moneyValueChange",function(){t.CHM(e);const c=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.reCalc(c))}),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"ion-col")(9,"ion-label",33),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"ion-input",41),t.NdJ("ngModelChange",function(c){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.count=c)})("ngModelChange",function(){t.CHM(e);const c=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.changeCount(c))}),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col")(15,"ion-label",33),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"money-input",36),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.discount=c)})("moneyValueChange",function(){t.CHM(e);const c=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.reCalc(c))}),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"ion-text",37),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(3);return t.KtG(c.openProductDiscountPercent(c.product))}),t._uU(21),t.qZA()(),t.TgZ(22,"ion-col")(23,"ion-label",33),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"money-input",36),t.NdJ("moneyValueChange",function(c){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.total=c)}),t.ALo(27,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,18,"order-add.product-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(7,20,"order-add.enter-product-price")),t.Q6J("clear",!0)("moneyValue",e.price),t.xp6(4),t.hij(" ",t.lcZ(11,22,"order-add.product-count")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(13,24,"order-add.enter-product-count")),t.Q6J("ngModel",e.count),t.xp6(4),t.hij(" ",t.lcZ(17,26,"order-add.product-discount"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(19,28,"order-add.enter-product-discount")),t.Q6J("clear",!0)("moneyValue",e.discount),t.xp6(2),t.Udp("background-color",o.product.discountPercent?"#3880ff":"#ccc"),t.xp6(1),t.hij(" ",e.discountPercent?e.discountPercent.toFixed(0)+"%":"%"," "),t.xp6(3),t.hij(" ",t.lcZ(25,30,"order-add.product-total")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(27,32,"order-add.enter-product-total")),t.Q6J("clear",!0)("moneyValue",e.total)}}function Lt(i,u){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",0)(2,"ion-buttons")(3,"ion-button",1),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.expand(a))}),t._UZ(4,"fa-icon",2),t.qZA()(),t.TgZ(5,"ion-text",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.increase(a))}),t._uU(6),t.YNc(7,k,2,1,"span",4),t.qZA(),t.TgZ(8,"ion-buttons",6)(9,"ion-button",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.decrease(a))}),t._UZ(10,"ion-icon",24),t.qZA(),t.TgZ(11,"ion-button",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.increase(a))}),t._UZ(12,"ion-icon",10),t.qZA(),t.TgZ(13,"ion-button",22),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.showOptions(a))}),t._UZ(14,"ion-icon",23),t.qZA()()(),t.TgZ(15,"ion-item",0)(16,"ion-text",3),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.increase(a))}),t.TgZ(17,"ion-text",11),t.YNc(18,At,4,3,"p",4),t._uU(19),t.ALo(20,"currency"),t.YNc(21,vt,3,11,"span",4),t._uU(22),t.ALo(23,"currency"),t.qZA(),t._UZ(24,"br"),t.YNc(25,wt,3,5,"span",13),t.qZA(),t.YNc(26,It,2,1,"ion-thumbnail",5),t.TgZ(27,"ion-buttons",6)(28,"ion-button",39),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.showTypes(a))}),t._UZ(29,"ion-icon",40),t.TgZ(30,"ion-text",11),t._uU(31),t.ALo(32,"translate"),t.qZA()()()(),t.TgZ(33,"ion-item",17)(34,"ion-text",3),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.increase(a))}),t.YNc(35,Jt,3,1,"p",18),t.YNc(36,kt,3,3,"p",18),t.YNc(37,Ut,6,2,"ng-container",19),t.YNc(38,Ot,7,4,"ng-container",4),t.qZA()(),t.YNc(39,Qt,28,34,"ion-grid",20),t.BQk()}if(2&i){const e=u.$implicit,o=t.oxw(2);t.xp6(4),t.s9C("icon",e.isExpand?"compress-arrows-alt":"edit"),t.xp6(1),t.Q6J("color",e.count>0?"primary":"normal"),t.xp6(1),t.hij(" ",o.productName(e.code,e.title),""),t.xp6(1),t.Q6J("ngIf",e.unitsJson),t.xp6(9),t.Q6J("color",e.count>0?"primary":"normal"),t.xp6(2),t.Q6J("ngIf",e.isCustomerPrice||e.isStaffPrice||e.isCollaboratorPrice),t.xp6(1),t.lnq(" ",o.toFixQuantity(e.count)," ",e.unit," \xd7 ",t.G7q(20,20,t.kEZ(34,y,e.price+o.getOptionPrices(e),o.currency,o.translateService.currentLang)),""),t.xp6(2),t.Q6J("ngIf",e.discount),t.xp6(1),t.hij(" | ",t.G7q(23,26,t.kEZ(38,y,e.total,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",!e.isService&&!e.isCombo),t.xp6(1),t.Q6J("ngIf",e.avatarUrl),t.xp6(5),t.hij("",t.lcZ(32,32,"product-selector.show-types")," "),t.xp6(3),t.Q6J("color",e.count>0?"primary":"normal"),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngIf",e.typeAttributes&&e.typeAttributes.length),t.xp6(1),t.Q6J("ngForOf",e.typeOptions),t.xp6(1),t.Q6J("ngIf",e.options&&e.options.length),t.xp6(1),t.Q6J("ngIf",e.isExpand)}}function Gt(i,u){if(1&i&&(t.ynx(0),t.YNc(1,Lt,40,42,"ng-container",19),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.others)}}let Kt=(()=>{class i{constructor(e,o,c,a){this.staffService=e,this.translateService=o,this.analyticsService=c,this.alertCtrl=a,this.onReCalc=new t.vpe,this.onIncrease=new t.vpe,this.onDecrease=new t.vpe,this.onChangeCount=new t.vpe,this.onShowOptions=new t.vpe,this.onShowTypes=new t.vpe,this.onExpand=new t.vpe,this.onAdd=new t.vpe,this.onApplyItemTotal=new t.vpe,this.isShopAdmin=!1,this.product=null,this.blockEditingOrderPrice=!1,this.blockEditingOrderPrice=this.staffService.permissionValue("block-editing-order-price")}openProductDiscountPercent(e){var o=this;return(0,f.Z)(function*(){var a;yield(yield o.alertCtrl.create({message:o.translateService.instant("order-add.discount-percent-message"),inputs:[{name:"discountPercent",placeholder:o.translateService.instant("order-add.enter-discount-percent"),type:"number",min:0,max:100,value:e.discountPercent}],buttons:[{text:o.translateService.instant("order-add.remove-percent"),handler:()=>{e.discountPercent=0,e.discount=0,o.onReCalc.emit(e)}},{text:o.translateService.instant("common.agree"),handler:(a=(0,f.Z)(function*(h){if(!h)return;const T=+h.discountPercent;T<0||T>100?alert(o.translateService.instant("order-add.discount-percent-not-valid")):(o.analyticsService.logEvent("order-add-change-discount-percent"),T&&(e.discountPercent=T,e.discount=e.price*e.count*T/100,o.onReCalc.emit(e)))}),function(T){return a.apply(this,arguments)})},{text:o.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}changeCount(e){this.onChangeCount.emit(e)}toFixQuantity(e){return g.W.toFixQuantity(e)}increase(e){this.onIncrease.emit(e)}decrease(e){this.onDecrease.emit(e)}dateFormat(e){return J.C.toUiString(e)}productName(e,o){return g.W.productName(e,o)}showOptions(e){this.onShowOptions.emit(e)}getOptionPrices(e){return g.W.getOptionPrices(e)}showTypes(e){this.onShowTypes.emit(e)}showOthers(e){e.showOthers=!e.showOthers}getAttributesString(e){return g.W.getAttributesString(e)}getTypeAttributesString(e){return g.W.getTypeAttributesString(e)}getTypeOptions(e){return g.W.getTypeOptions(e)}expand(e){this.onExpand.emit(e)}reCalc(e){this.onReCalc.emit(e)}add(){this.onAdd.emit()}applyItemTotal(){this.onApplyItemTotal.emit()}selectAll(e){g.W.selectAll(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(H.x),t.Y36(N.sK),t.Y36(X.y),t.Y36(x.Br))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-selector-item"]],inputs:{isShopAdmin:"isShopAdmin",product:"product",currency:"currency",blockViewingQuantity:"blockViewingQuantity"},outputs:{onReCalc:"onReCalc",onIncrease:"onIncrease",onDecrease:"onDecrease",onChangeCount:"onChangeCount",onShowOptions:"onShowOptions",onShowTypes:"onShowTypes",onExpand:"onExpand",onAdd:"onAdd",onApplyItemTotal:"onApplyItemTotal"},decls:37,vars:35,consts:[["text-wrap","","lines","none",2,"--min-height","0"],["fill","clear","color","medium",3,"click"],[3,"icon"],[2,"padding","0",3,"color","click"],[4,"ngIf"],["slot","end",4,"ngIf"],["slot","end"],["size","small","fill","clear","color","medium",3,"click",4,"ngIf"],["fill","clear","size","large",3,"click",4,"ngIf"],["fill","clear","size","large",3,"click"],["slot","icon-only","size","large","name","add"],[2,"font-size","0.8em"],["style","margin: 0; font-size: 0.8em; font-style: italic;",4,"ngIf"],["style","font-size: 0.8em",4,"ngIf"],["slot","end",1,"ion-text-right",2,"padding","0","margin","0"],["size","medium","fill","clear",3,"click",4,"ngIf"],["color","secondary","fill","clear",3,"click",4,"ngIf"],["text-wrap","",2,"--padding-bottom","10px","--min-height","0"],["style","padding: 0; margin: 0",4,"ngIf"],[4,"ngFor","ngForOf"],["style","padding-left: 15px; padding-right: 15px; margin: 0;","color","light",4,"ngIf"],[3,"src"],["size","small","fill","clear","color","medium",3,"click"],["slot","icon-only","size","small","name","cog"],["slot","icon-only","size","large","name","remove"],[2,"margin","0","font-size","0.8em","font-style","italic"],["size","medium","fill","clear",3,"click"],["slot","start","name","options"],["color","secondary","fill","clear",3,"click"],["slot","start",3,"name"],[2,"padding","0","margin","0"],["style","padding: 0; margin: 0",4,"ngFor","ngForOf"],["color","light",2,"padding-left","15px","padding-right","15px","margin","0"],["position","stacked","color","primary"],[3,"disabled","clear","placeholder","moneyValue","moneyValueChange"],["clearInput","","type","number",3,"placeholder","ngModel","ngModelChange","focus"],[3,"clear","placeholder","moneyValue","moneyValueChange"],[1,"ion-text-nowrap",2,"margin-left","3px","margin-top","3px","font-size","0.7em","background-color","#3880ff","color","white","padding","3px","border-radius","5px","font-weight","bold",3,"click"],[2,"padding","0","font-style","italic",3,"color","click"],["size","small","fill","clear",3,"click"],["slot","start","size","small","name","options"],["clearInput","","type","number",3,"placeholder","ngModel","ngModelChange"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-item",0)(1,"ion-buttons")(2,"ion-button",1),t.NdJ("click",function(){return o.expand(o.product)}),t._UZ(3,"fa-icon",2),t.qZA()(),t.TgZ(4,"ion-text",3),t.NdJ("click",function(){return o.increase(o.product)}),t._uU(5),t.YNc(6,at,2,1,"span",4),t.qZA(),t.YNc(7,st,2,1,"ion-thumbnail",5),t.TgZ(8,"ion-buttons",6),t.YNc(9,lt,2,0,"ion-button",7),t.YNc(10,ut,2,0,"ion-button",8),t.TgZ(11,"ion-button",9),t.NdJ("click",function(){return o.increase(o.product)}),t._UZ(12,"ion-icon",10),t.qZA()()(),t.TgZ(13,"ion-item",0)(14,"ion-text",3),t.NdJ("click",function(){return o.increase(o.product)}),t.TgZ(15,"span",11),t.YNc(16,dt,3,2,"p",12),t.YNc(17,ht,4,3,"p",4),t.YNc(18,xt,2,2,"span",4),t._uU(19),t.ALo(20,"currency"),t.YNc(21,p,3,11,"span",4),t.YNc(22,Z,3,11,"span",4),t.qZA(),t._UZ(23,"br"),t.YNc(24,r,3,5,"span",13),t.qZA(),t.TgZ(25,"ion-label",14),t.YNc(26,s,5,3,"ion-button",15),t.YNc(27,_,1,0,"br",4),t.YNc(28,d,5,4,"ion-button",16),t.qZA()(),t.TgZ(29,"ion-item",17)(30,"ion-text",3),t.NdJ("click",function(){return o.increase(o.product)}),t.YNc(31,P,3,3,"p",18),t.YNc(32,F,3,3,"p",18),t.YNc(33,V,6,2,"ng-container",19),t.YNc(34,A,7,4,"ng-container",4),t.qZA()(),t.YNc(35,w,28,35,"ion-grid",20),t.YNc(36,Gt,2,1,"ng-container",4)),2&e&&(t.xp6(3),t.s9C("icon",o.product.isExpand?"compress-arrows-alt":"edit"),t.xp6(1),t.Q6J("color",o.product.count>0?"primary":"normal"),t.xp6(1),t.hij(" ",o.productName(o.product.code,o.product.title),""),t.xp6(1),t.Q6J("ngIf",o.product.unitsJson),t.xp6(1),t.Q6J("ngIf",o.product.avatarUrl),t.xp6(2),t.Q6J("ngIf",o.product.count),t.xp6(1),t.Q6J("ngIf",o.product.count),t.xp6(4),t.Q6J("color",o.product.count>0?"primary":"normal"),t.xp6(2),t.Q6J("ngIf",o.product.costPrice&&o.isShopAdmin||o.product.basePrice),t.xp6(1),t.Q6J("ngIf",o.product.isCustomerPrice||o.product.isStaffPrice||o.product.isCollaboratorPrice),t.xp6(1),t.Q6J("ngIf",o.product.count),t.xp6(1),t.Oqu(t.G7q(20,25,t.kEZ(31,y,o.product.price+o.getOptionPrices(o.product),o.currency,o.translateService.currentLang))),t.xp6(2),t.Q6J("ngIf",o.product.discount),t.xp6(1),t.Q6J("ngIf",o.product.count),t.xp6(2),t.Q6J("ngIf",!(o.product.isService||o.product.isCombo||o.product.materials&&o.product.materials.length||o.blockViewingQuantity)),t.xp6(2),t.Q6J("ngIf",o.product.count),t.xp6(1),t.Q6J("ngIf",o.product.count),t.xp6(1),t.Q6J("ngIf",o.product.others&&o.product.others.length),t.xp6(2),t.Q6J("color",o.product.count>0?"primary":"normal"),t.xp6(1),t.Q6J("ngIf",o.product.attributes&&o.product.attributes.length),t.xp6(1),t.Q6J("ngIf",o.product.typeAttributes&&o.product.typeAttributes.length),t.xp6(1),t.Q6J("ngForOf",o.product.typeOptions),t.xp6(1),t.Q6J("ngIf",o.product.options&&o.product.options.length),t.xp6(1),t.Q6J("ngIf",o.product.isExpand),t.xp6(1),t.Q6J("ngIf",o.product.showOthers))},dependencies:[U.sg,U.O5,G.JJ,G.On,x.YG,x.Sm,x.wI,x.jY,x.gu,x.pK,x.Ie,x.Q$,x.Nd,x.yW,x.Bs,x.as,ct.BN,it.F,U.H9,N.X$],encapsulation:2}),i})();const Et=["barcodeInput"];function Yt(i,u){1&i&&(t.TgZ(0,"ion-title"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-selector.title")," "))}function Ht(i,u){1&i&&(t.TgZ(0,"ion-title"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-selector.title-material")," "))}function Ft(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",28)(1,"ion-label",29),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.exitStore())}),t._UZ(5,"ion-icon",31),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function jt(i,u){1&i&&(t.TgZ(0,"ion-segment-button",32),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-selector.filter-hot")," "))}function $t(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-searchbar",33,34),t.NdJ("ionClear",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.clearSearch())})("ionChange",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.search())})("ngModelChange",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.searchKey=c)})("ngModelChange",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.barcodeChanged())}),t.ALo(2,"translate"),t.qZA()}if(2&i){const e=t.oxw();t.s9C("placeholder",t.lcZ(2,2,"product-selector.filter-by-words")),t.Q6J("ngModel",e.searchKey)}}function Vt(i,u){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"product-selector-item",35),t.NdJ("onReCalc",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.reCalc(c))})("onIncrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.increase(c))})("onDecrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.decrease(c))})("onChangeCount",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.changeCount(c))})("onShowOptions",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showOptions(c))})("onShowTypes",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showTypes(c))})("onExpand",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.expand(c))})("onAdd",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.add(c))})("onApplyItemTotal",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.applyItemTotal())}),t.qZA(),t.BQk()}if(2&i){const e=u.$implicit,o=t.oxw();t.xp6(1),t.Q6J("product",e)("currency",o.currency)("isShopAdmin",null===o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)("blockViewingQuantity",o.blockViewingQuantity)}}function Dt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",36),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.showSearchCategory())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.categorySelected.title," ")}}function zt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.showSearchCategory())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"promotion-add.select-category")," "))}function Wt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.removeCategory())}),t._UZ(1,"ion-icon",37),t.qZA()}}function Bt(i,u){if(1&i&&(t.TgZ(0,"ion-label",43),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"common.page")," ",e.currentPage+1," ")}}function Rt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",44),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.previousPage())}),t._UZ(2,"ion-icon",45),t.qZA(),t.TgZ(3,"ion-button",44),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.nextPage())}),t._UZ(4,"ion-icon",46),t.qZA()()}}function Xt(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",38)(1,"ion-item",26)(2,"ion-buttons")(3,"ion-button",39),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.changeSortOrder())}),t._uU(4),t.ALo(5,"translate"),t._UZ(6,"ion-icon",40),t.qZA()(),t.YNc(7,Bt,3,4,"ion-label",41),t.YNc(8,Rt,5,0,"ion-buttons",42),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,4,"common.sort")," "),t.xp6(2),t.Q6J("name","desc"===e.sortOrder?"arrow-down-outline":"arrow-up-outline"),t.xp6(1),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function te(i,u){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"product-selector-item",35),t.NdJ("onReCalc",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.reCalc(c))})("onIncrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.increase(c))})("onDecrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.decrease(c))})("onChangeCount",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.changeCount(c))})("onShowOptions",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showOptions(c))})("onShowTypes",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showTypes(c))})("onExpand",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.expand(c))})("onAdd",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.add(c))})("onApplyItemTotal",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.applyItemTotal())}),t.qZA(),t.BQk()}if(2&i){const e=u.$implicit,o=t.oxw();t.xp6(1),t.Q6J("product",e)("currency",o.currency)("isShopAdmin",null===o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)("blockViewingQuantity",o.blockViewingQuantity)}}function ee(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",43),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-buttons",4)(5,"ion-button",44),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.previousPage())}),t._UZ(6,"ion-icon",45),t.qZA(),t.TgZ(7,"ion-button",44),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.nextPage())}),t._UZ(8,"ion-icon",46),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,2,"common.page")," ",e.currentPage+1," ")}}function ne(i,u){1&i&&(t.TgZ(0,"ion-item",47),t._UZ(1,"div",48),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product-selector.no-product"),t.oJD))}function oe(i,u){1&i&&(t.TgZ(0,"ion-select-option",49),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product.list-option-customer-price"),""))}function re(i,u){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"product-selector-item",35),t.NdJ("onReCalc",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.reCalc(c))})("onIncrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.increase(c))})("onDecrease",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.decrease(c))})("onChangeCount",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.changeCount(c))})("onShowOptions",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showOptions(c))})("onShowTypes",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.showTypes(c))})("onExpand",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.expand(c))})("onAdd",function(c){t.CHM(e);const a=t.oxw();return t.KtG(a.add(c))})("onApplyItemTotal",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.applyItemTotal())}),t.qZA(),t.BQk()}if(2&i){const e=u.$implicit,o=t.oxw();t.xp6(1),t.Q6J("product",e)("currency",o.currency)("isShopAdmin",null===o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)("blockViewingQuantity",o.blockViewingQuantity)}}let ce=(()=>{class i{constructor(e,o,c,a,h,T,z,ie,ae,se,le,ue){var l=this;this.navCtrl=e,this.userService=o,this.staffService=c,this.translateService=a,this.productService=h,this.contactService=T,this.analyticsService=z,this.alertCtrl=ie,this.planService=ae,this.storeService=se,this.storageService=le,this.modalCtrl=ue,this.selectedProducts=[],this.hotProducts=[],this.products=[],this.originalProducts=[],this.isMaterial=!1,this.searchKey="",this.tab="all",this.start=0,this.end=19,this.pageSize=20,this.currentPage=0,this.outStock=!1,this.listOption="all",this.customerPrices=[],this.collaboratorPrices=[],this.staffPrices=[],this.checkProduct=0,this.currentPlan=null,this.blockViewingQuantity=!1,this.sortOrder="asc",this.reloadProducts=(0,f.Z)(function*(){l.currentPlan=yield l.planService.getCurrentPlan(),l.currentPlan||(l.checkProduct=yield l.planService.checkProduct(),l.checkProduct>=30&&(l.isOnTrial=yield l.planService.isOnTrial(l.currentPlan))),l.params=l.navCtrl.getParams(l.params),l.params&&l.params.callback&&(l.callback=l.params.callback),l.params&&l.params.contactId&&(l.contactId=l.params.contactId),l.params&&l.params.categorySelected&&(l.categorySelected=l.params.categorySelected),l.params&&l.params.staffId&&(l.staffId=l.params.staffId),l.isMaterial=l.params&&l.params.isMaterial;const _e=yield l.navCtrl.loading(3e4);l.currency=yield l.userService.getAttr("current-currency"),l.outStock=yield l.userService.getAttr("out-stock"),l.staffPrices=yield l.getProductsWithStaffPrice(),l.customerPrices=yield l.getProductsWithCustomerPrice(),l.collaboratorPrices=yield l.getProductsWithCollaboratorPrice(),l.selectedStaff=l.staffService.selectedStaff,l.blockViewingQuantity=l.selectedStaff&&l.selectedStaff.blockViewingQuantity,l.store=yield l.storeService.getCurrentStore(),l.checkStore=l.store?l.translateService.instant("store.check-store",{shop:l.store.name}):null;const Ct=l.store?l.store.id:0;("all"===l.listOption?l.productService.getProducts(Ct,l.categorySelected?l.categorySelected.id:0,l.isMaterial):"expiry"===l.listOption?l.productService.getProductsExpiry(Ct,l.categorySelected?l.categorySelected.id:0,l.isMaterial):"quantity"===l.listOption?l.productService.getProductsQuantity(Ct,l.categorySelected?l.categorySelected.id:0,l.isMaterial):Promise.resolve(l.customerPrices)).then(function(){var pe=(0,f.Z)(function*(St){let tt=n.orderBy(St,["title"],[l.sortOrder]);const Zt=[],W=[],Pt=[];for(const m of tt){m.units=m.unitsJson?JSON.parse(m.unitsJson):[],m.materials=m.materialsJson?JSON.parse(m.materialsJson):[];let E=!1;if(m.units&&m.units.length)for(const b of m.units)if(b.isDefault){E=!0;break}let v=E?null:m;const Q=[];if(Q.push(m),m.units&&m.units.length)for(const b of m.units){const I=JSON.parse(JSON.stringify(m));I.unit=b.unit,I.basicUnit=m.unit,I.unitExchange=b.exchange,I.price=b.price,I.costPrice=b.costPrice?b.costPrice:b.price,I.count=Math.floor(m.count/b.exchange),b.isDefault&&(v=I),Q.push(I)}else m.unitsJson=null;m.units=null,v||(v=m),v.others=[];for(const b of Q)b.unit!==v.unit&&(v.others.push(b),W.push(b));Zt.push(v),W.push(v),v.isHotProduct&&Pt.push(v)}if(W&&W.length)for(const m of W){m.shopPrice=m.price;const E=l.staffPrices&&l.staffPrices.length?l.staffPrices.filter(Y=>Y.id===m.id):[],v=E&&E.length?E[0]:null,Q=l.customerPrices&&l.customerPrices.length?l.customerPrices.filter(Y=>Y.id===m.id):[],b=Q&&Q.length?Q[0]:null,I=l.collaboratorPrices&&l.collaboratorPrices.length?l.collaboratorPrices.filter(Y=>Y&&Y.id===m.id):[],yt=I&&I.length?I[0]:null;m.total=0,m.quantity=l.store?m.storeQuantity?m.storeQuantity:0:m.count,m.count=0,m.isStaffPrice=!1,m.isCustomerPrice=!1,m.isCollaboratorPrice=!1,b?(m.basePrice=m.price,m.price=b.price,m.isCustomerPrice=!0):v?(m.basePrice=m.price,m.price=v.price,m.isStaffPrice=!0):yt&&(m.basePrice=m.price,m.price=yt.price,m.isCollaboratorPrice=!0)}tt=Zt,l.originalProducts=tt,l.products=tt,l.hotProducts=Pt;const de=yield l.storageService.get("product-selector-tab");l.tab="hot"===de&&l.hotProducts&&l.hotProducts.length?"hot":"all",yield _e.dismiss()});return function(St){return pe.apply(this,arguments)}}())}),this.navCtrl.removeEventListener("reloadProductSelector",this.reloadProducts),this.navCtrl.addEventListener("reloadProductSelector",this.reloadProducts)}ionViewWillEnter(){var e=this;return(0,f.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-selector")})()}tabChanged(){var e=this;return(0,f.Z)(function*(){("hot"==e.tab||"all"==e.tab)&&(yield e.storageService.set("product-selector-tab",e.tab))})()}barcodeChanged(){var e=this;return(0,f.Z)(function*(){!e.searchKey||e.searchKey.length<5||(e.analyticsService.logEvent("product-selector-barcode-entered"),e.productService.searchByBarcode(e.searchKey).then(o=>{if(!o)return;e.analyticsService.logEvent("product-selector-barcode-entered-ok");let c=e.originalProducts;if(c=c.filter(a=>a.id===o.id),c&&c.length)for(const a of c)e.increase(a);e.products=c}))})()}getProductsWithCustomerPrice(){var e=this;return(0,f.Z)(function*(){if(!e.contactId)return null;const o=yield e.contactService.getCustomerPricesByContact(e.contactId);if(!o||!o.length)return[];for(const c of o)c.product&&(c.product.price=c.price);return o.map(c=>c.product)})()}getProductsWithStaffPrice(){var e=this;return(0,f.Z)(function*(){if(!e.staffService.isStaff()&&!e.staffId)return null;const o=e.staffService.isStaff()?e.staffService.selectedStaff.id:e.staffId,c=yield e.contactService.getCustomerPricesByStaff(o);if(!c||!c.length)return[];for(const a of c)a.product&&(a.product.price=a.price);return c.map(a=>a.product)})()}getProductsWithCollaboratorPrice(){var e=this;return(0,f.Z)(function*(){if(!e.staffService.isStaff()&&!e.staffId)return null;const o=yield e.contactService.getCollaboratorPrices();if(!o||!o.length)return[];for(const c of o)c.product&&(c.product.price=c.price);return o.map(c=>c.product)})()}reCalc(e){const o=e.count*e.price;if(e.total=o,e.options&&e.options.length){let a=0;for(const h of e.options)a+=1*h.total;e.total=(e.price+a)*e.count}e.total=o-(e.discount?e.discount:0)}changeCount(e){var o=this;return(0,f.Z)(function*(){const c=e.materialsJson?JSON.parse(e.materialsJson):[];if(o.outStock&&e.quantity-e.count<=0&&!e.isService&&!e.isCombo&&(!c||!c.length))return o.analyticsService.logEvent("product-selector-outstock-alert"),void alert(o.translateService.instant("order-add.outstock-alert"));if(!o.selectedProducts.find(h=>h.id===e.id&&h.unit===e.unit)){if(e.expiredAt&&q(e.expiredAt).utc().format(J.C.getDateDbFormat())<q(new Date).format(J.C.getDateDbFormat()))return void(yield(yield o.alertCtrl.create({header:o.translateService.instant("common.confirm"),message:o.translateService.instant("product.expired-alert",{expiryDate:J.C.toDbDateOnlyString(e.expiredAt)}),buttons:[{text:o.translateService.instant("common.cancel"),handler:()=>{}},{text:o.translateService.instant("common.agree"),handler:()=>{o.selectedProducts.push(e),e.count++,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),e.count>=2&&o.analyticsService.logEvent("product-selector-increase-2"),o.reCalc(e)}}]})).present());o.selectedProducts.push(e)}e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),e.count>=2&&o.analyticsService.logEvent("product-selector-increase-2"),o.reCalc(e)})()}increase(e){var o=this;return(0,f.Z)(function*(){const c=e.materialsJson?JSON.parse(e.materialsJson):[];if(o.outStock&&e.quantity-e.count<=0&&!e.isService&&!e.isCombo&&(!c||!c.length))return o.analyticsService.logEvent("product-selector-outstock-alert"),void alert(o.translateService.instant("order-add.outstock-alert"));if(!o.selectedProducts.find(h=>h.id===e.id&&h.unit===e.unit)){if(e.expiredAt&&q(e.expiredAt).utc().format(J.C.getDateDbFormat())<q(new Date).format(J.C.getDateDbFormat()))return void(yield(yield o.alertCtrl.create({header:o.translateService.instant("common.confirm"),message:o.translateService.instant("product.expired-alert",{expiryDate:J.C.toDbDateOnlyString(e.expiredAt)}),buttons:[{text:o.translateService.instant("common.cancel"),handler:()=>{}},{text:o.translateService.instant("common.agree"),handler:()=>{o.selectedProducts.push(e),e.count++,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),e.count>=2&&o.analyticsService.logEvent("product-selector-increase-2"),o.reCalc(e)}}]})).present());o.selectedProducts.push(e)}e.count++,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),e.count>=2&&o.analyticsService.logEvent("product-selector-increase-2"),o.reCalc(e)})()}decrease(e){var o=this;return(0,f.Z)(function*(){if(!e||0!==e.count){if(o.analyticsService.logEvent("product-selector-decrease"),e.count--,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),0===e.count){const c=o.selectedProducts.findIndex(a=>a.id===e.id&&a.unit===e.unit);c>=0&&o.selectedProducts.splice(c,1),(!o.selectedProducts||!o.selectedProducts.length)&&"all"!==o.tab&&(o.tab="all",o.tabChanged())}o.reCalc(e)}})()}ngOnInit(){this.reloadProducts()}dateFormat(e){return J.C.toUiString(e)}search(){var e=this;return(0,f.Z)(function*(){e.analyticsService.logEvent("product-selector-search");let o=e.originalProducts;if(null!==e.searchKey&&""!==e.searchKey){e.start=0,e.end=19,e.currentPage=0;const c=e.searchKey.toLowerCase();o=o.filter(a=>a.title&&-1!==a.title.toLowerCase().indexOf(c)||a.code&&-1!==a.code.toLowerCase().indexOf(c))}e.products=o})()}clearSearch(){var e=this;return(0,f.Z)(function*(){e.start=0,e.end=19,e.currentPage=0,e.analyticsService.logEvent("product-selector-clear-search"),e.searchKey=null,e.products=e.originalProducts})()}dismiss(){var e=this;return(0,f.Z)(function*(){if(e.callback)return e.callback(null),void(yield e.navCtrl.back());e.modalCtrl.dismiss()})()}ok(){var e=this;return(0,f.Z)(function*(){if(e.analyticsService.logEvent("product-selector-ok"),e.callback)return e.callback(e.selectedProducts),void(yield e.navCtrl.back());e.modalCtrl.dismiss(e.selectedProducts)})()}showOptions(e){var o=this;return(0,f.Z)(function*(){o.analyticsService.logEvent("product-selector-show-options"),yield o.navCtrl.push("/order/option-selector",{callback:a=>{a&&(e.options=a.options,e.attributes=a.attributes,e.count<=0&&(e.count=1,o.selectedProducts.find(T=>e.id===T.id)||o.selectedProducts.push(e)),o.reCalc(e))},mainProduct:JSON.parse(JSON.stringify(e))})})()}showTypes(e){var o=this;return(0,f.Z)(function*(){o.analyticsService.logEvent("product-selector-show-types");const a=JSON.parse(JSON.stringify(e));a.price=e.initPrice?e.initPrice:e.price,a.changedPrice=0,yield o.navCtrl.push("/product/type-selector",{callback:h=>{h&&(e.types=h.types,e.typeOptions=o.getTypeOptions(h.types),e.typeAttributes=o.getTypeAttributesString(e),e.initPrice=h.initPrice,e.price=h.price?h.price:e.initPrice,e.count<=0&&(e.count=1,o.selectedProducts.find(z=>e.id===z.id)||o.selectedProducts.push(e)),o.reCalc(e))},mainProduct:a})})()}showOthers(e){e.showOthers=!e.showOthers}getTypeAttributesString(e){return g.W.getTypeAttributesString(e)}get isShowPaging(){return!!(this.products&&this.products.length>this.pageSize)}previousPage(){this.currentPage<=0?this.currentPage=0:(this.currentPage--,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.content.scrollToTop())}getTypeOptions(e){return g.W.getTypeOptions(e)}changeSortOrder(){this.sortOrder="desc"===this.sortOrder?"asc":"desc",this.reloadProducts()}nextPage(){(this.currentPage+1)*this.pageSize>=this.products.length||(this.currentPage++,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.content.scrollToTop())}expand(e){var o=this;return(0,f.Z)(function*(){const c=!e.isExpand;for(const a of o.products)a.isExpand=!1;e.isExpand=c,c&&o.analyticsService.logEvent("product-selector-expand")})()}changeListOption(){this.start=0,this.end=19,this.currentPage=0,this.reloadProducts()}add(){if(!this.currentPlan&&this.checkProduct>=30&&!this.isOnTrial)return this.analyticsService.logEvent("check-product-alert"),void alert(this.translateService.instant("product.check-product-alert",{total:this.checkProduct}));this.navCtrl.push("/product/quick-add",{fromSearch:!0})}exitStore(){var e=this;return(0,f.Z)(function*(){var c;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(c=(0,f.Z)(function*(){yield e.storeService.exitStore(),yield e.reloadProducts()}),function(){return c.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}showSearchCategory(){var e=this;return(0,f.Z)(function*(){e.analyticsService.logEvent("product-filter-by-category"),e.navCtrl.push("/trade-category",{callback:c=>{c&&(e.categorySelected=c,e.reloadProducts())},searchMode:!0})})()}removeCategory(){this.categorySelected=null,this.reloadProducts()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(B.G),t.Y36(R.K),t.Y36(H.x),t.Y36(N.sK),t.Y36(M.M),t.Y36(L.y),t.Y36(X.y),t.Y36(x.Br),t.Y36(nt.D),t.Y36(ot.d),t.Y36(rt.V),t.Y36(x.IN))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-selector"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Et,5),t.Gf(x.W2,7)),2&e){let c;t.iGM(c=t.CRH())&&(o.barcodeInput=c.first),t.iGM(c=t.CRH())&&(o.content=c.first)}},decls:87,vars:74,consts:[["slot","start"],[3,"click"],["name","close"],[4,"ngIf"],["slot","end"],["name","add"],["name","checkmark"],["lines","none","color","success",4,"ngIf"],["color","primary",3,"ngModel","ngModelChange"],["value","hot",4,"ngIf"],["value","all"],["value","selected"],["color","danger"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange",4,"ngIf"],[3,"hidden"],[4,"ngFor","ngForOf"],["size","6",1,"ion-no-padding"],["position","stacked","color","primary",1,"ion-text-wrap"],[2,"max-width","100% !important",3,"placeholder","ngModel","ngModelChange"],["value","expiry"],["value","quantity"],["color","dark","size","small",3,"click",4,"ngIf"],["size","small",3,"click",4,"ngIf"],["size","12","class","ion-no-padding",4,"ngIf"],["text-wrap","",4,"ngIf"],[1,"ion-text-wrap",2,"font-style","italic","font-size","0.8em"],["lines","none",1,"ion-no-padding"],["value","customer-price",4,"ngIf"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],["value","hot"],["autofocus","true","debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["barcodeInput",""],[3,"product","currency","isShopAdmin","blockViewingQuantity","onReCalc","onIncrease","onDecrease","onChangeCount","onShowOptions","onShowTypes","onExpand","onAdd","onApplyItemTotal"],["color","dark","size","small",3,"click"],["slot","icon-only","name","close"],["size","12",1,"ion-no-padding"],["color","tertiary","fill","outline","size","small",3,"click"],[3,"name"],["class","ion-text-wrap ion-text-right",4,"ngIf"],["slot","end",4,"ngIf"],[1,"ion-text-wrap","ion-text-right"],["fill","solid",3,"click"],["slot","icon-only","name","arrow-back-circle"],["slot","icon-only","name","arrow-forward-circle"],["text-wrap",""],[3,"innerHTML"],["value","customer-price"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.YNc(5,Yt,3,3,"ion-title",3),t.YNc(6,Ht,3,3,"ion-title",3),t.TgZ(7,"ion-buttons",4)(8,"ion-button",1),t.NdJ("click",function(){return o.add()}),t._UZ(9,"ion-icon",5),t.qZA(),t.TgZ(10,"ion-button",1),t.NdJ("click",function(){return o.ok()}),t._UZ(11,"ion-icon",6),t._uU(12),t.ALo(13,"translate"),t.qZA()()(),t.YNc(14,Ft,8,4,"ion-item",7),t.TgZ(15,"ion-segment",8),t.NdJ("ngModelChange",function(a){return o.tab=a})("ngModelChange",function(){return o.tabChanged()}),t.YNc(16,jt,3,3,"ion-segment-button",9),t.TgZ(17,"ion-segment-button",10),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"ion-segment-button",11)(21,"ion-text"),t._uU(22),t.ALo(23,"translate"),t.TgZ(24,"ion-text",12),t._uU(25),t.qZA()()()(),t.YNc(26,$t,3,4,"ion-searchbar",13),t.qZA(),t.TgZ(27,"ion-content")(28,"ion-list",14),t.YNc(29,Vt,2,4,"ng-container",15),t.qZA(),t.TgZ(30,"ion-list",14)(31,"ion-grid")(32,"ion-row")(33,"ion-col",16)(34,"ion-label",17),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"div")(38,"ion-select",18),t.NdJ("ngModelChange",function(a){return o.listOption=a})("ngModelChange",function(){return o.changeListOption()}),t.ALo(39,"translate"),t.TgZ(40,"ion-select-option",10),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"ion-select-option",19),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"ion-select-option",20),t._uU(47),t.ALo(48,"translate"),t.qZA()()()(),t.TgZ(49,"ion-col",16)(50,"ion-label",17),t._uU(51),t.ALo(52,"translate"),t.qZA(),t.TgZ(53,"div")(54,"ion-buttons"),t.YNc(55,Dt,2,1,"ion-button",21),t.YNc(56,zt,3,3,"ion-button",22),t.YNc(57,Wt,2,0,"ion-button",22),t.qZA()()(),t.YNc(58,Xt,9,6,"ion-col",23),t.qZA()(),t.YNc(59,te,2,4,"ng-container",15),t.ALo(60,"slice"),t.YNc(61,ee,9,4,"ion-item",3),t.YNc(62,ne,3,3,"ion-item",24),t.qZA(),t.TgZ(63,"ion-list",14)(64,"ion-grid")(65,"ion-row")(66,"ion-col")(67,"ion-label",25),t._uU(68),t.ALo(69,"translate"),t.qZA()()(),t.TgZ(70,"ion-row")(71,"ion-col",16)(72,"ion-item",26)(73,"ion-select",18),t.NdJ("ngModelChange",function(a){return o.listOption=a})("ngModelChange",function(){return o.changeListOption()}),t.ALo(74,"translate"),t.TgZ(75,"ion-select-option",10),t._uU(76),t.ALo(77,"translate"),t.qZA(),t.TgZ(78,"ion-select-option",19),t._uU(79),t.ALo(80,"translate"),t.qZA(),t.TgZ(81,"ion-select-option",20),t._uU(82),t.ALo(83,"translate"),t.qZA(),t.YNc(84,oe,3,3,"ion-select-option",27),t.qZA()()()()(),t.YNc(85,re,2,4,"ng-container",15),t.ALo(86,"slice"),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf",!o.isMaterial),t.xp6(1),t.Q6J("ngIf",o.isMaterial),t.xp6(6),t.hij("\xa0",t.lcZ(13,38,"action.save")," "),t.xp6(2),t.Q6J("ngIf",o.checkStore&&(null===o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.Q6J("ngModel",o.tab),t.xp6(1),t.Q6J("ngIf",o.hotProducts&&o.hotProducts.length),t.xp6(2),t.hij(" ",t.lcZ(19,40,"product-selector.filter-all")," "),t.xp6(3),t.Udp("font-weight",o.selectedProducts&&o.selectedProducts.length?"bold":"normal"),t.xp6(1),t.hij(" ",t.lcZ(23,42,"product-selector.filter-selected")," "),t.xp6(3),t.hij(" (",o.selectedProducts?o.selectedProducts.length:0,")"),t.xp6(1),t.Q6J("ngIf","all"===o.tab),t.xp6(2),t.Q6J("hidden","all"===o.tab||"hot"===o.tab),t.xp6(1),t.Q6J("ngForOf",o.selectedProducts),t.xp6(1),t.Q6J("hidden","selected"===o.tab||"hot"===o.tab),t.xp6(5),t.hij(" ",t.lcZ(36,44,"product.filter-by")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(39,46,"product.select-option")),t.Q6J("ngModel",o.listOption),t.xp6(3),t.Oqu(t.lcZ(42,48,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(45,50,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(48,52,"product.list-option-quantiy")),t.xp6(4),t.hij(" ",t.lcZ(52,54,"promotion-add.category")," "),t.xp6(4),t.Q6J("ngIf",o.categorySelected&&o.categorySelected.id>0),t.xp6(1),t.Q6J("ngIf",!o.categorySelected||0===o.categorySelected.id),t.xp6(1),t.Q6J("ngIf",o.categorySelected&&o.categorySelected.id>0),t.xp6(1),t.Q6J("ngIf",o.products&&o.products.length),t.xp6(1),t.Q6J("ngForOf",t.Dn7(60,56,o.products,o.start,o.end+1)),t.xp6(2),t.Q6J("ngIf",o.isShowPaging&&o.products&&o.products.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Q6J("hidden","selected"===o.tab||"all"===o.tab),t.xp6(5),t.hij(" ",t.lcZ(69,60,"product-selector.filter-hot-description")," "),t.xp6(5),t.s9C("placeholder",t.lcZ(74,62,"product.select-option")),t.Q6J("ngModel",o.listOption),t.xp6(3),t.Oqu(t.lcZ(77,64,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(80,66,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(83,68,"product.list-option-quantiy")),t.xp6(2),t.Q6J("ngIf",o.contactId),t.xp6(1),t.Q6J("ngForOf",t.Dn7(86,70,o.hotProducts,o.start,o.end+1)))},dependencies:[U.sg,U.O5,G.JJ,G.On,x.YG,x.Sm,x.wI,x.W2,x.jY,x.Gu,x.gu,x.Ie,x.Q$,x.q_,x.Nd,x.VI,x.cJ,x.GO,x.t9,x.n0,x.yW,x.wd,x.sr,x.QI,x.j9,Kt,U.OU,N.X$],encapsulation:2}),i})()}}]);