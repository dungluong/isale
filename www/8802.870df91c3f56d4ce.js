"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8802],{8802:(G,C,r)=>{r.r(C),r.d(C,{LoginPageModule:()=>j});var h=r(3306),Z=r(6895),y=r(4006),a=r(191),L=r(3196),c=r(5861),e=r(6738),A=r(5851),x=r(7488),b=r(8272),T=r(3142),_=r(3876),M=r(667),k=r(323),U=r(3736),N=r(2703);function w(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.changeto("vn"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.vietnamese"),""))}function F(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",15),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.changeto("vn"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.vietnamese"),""))}function O(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.changeto("en"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.english"),""))}function Y(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",15),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.changeto("en"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.english"),""))}const J=[{path:"",component:(()=>{class o{constructor(t,n,s,i,m,g,l,p,f,d,v){this.navCtrl=t,this.userService=n,this.translateService=s,this.activityService=i,this.dataService=m,this.storeService=g,this.staffService=l,this.alertCtrl=p,this.analyticsService=f,this.firebase=d,this.fcmTokenService=v,this.username="",this.password="",this.hasNoOfflineUser=!1,this.language="vn",this.isRemember=!1,this.reload=()=>{this.userService.getLastLogin().then(S=>{!S||(this.username=S.userName)}),null!=this.userService.loggedUser?this.navCtrl.navigateRoot("/home"):this.activityService.logActivity({feature:"Login",action:"",note:""})},this.navCtrl.removeEventListener("reloadLogin",this.reload),this.navCtrl.addEventListener("reloadLogin",this.reload)}ionViewWillEnter(){var t=this;return(0,c.Z)(function*(){yield t.analyticsService.setCurrentScreen("login"),t.language=yield t.userService.getAttr("current-language")})()}ngOnInit(){this.reload()}getShopConfig(){var t=this;return(0,c.Z)(function*(){const n=yield t.dataService.getFirstObject("shop_config");if(!n)return t.logout(),n;const s=n&&n.language?n.language:"vn",m=n&&n.dateFormat?n.dateFormat:"DD/MM/YYYY",g=n&&n.timeFormat?n.timeFormat:"HH:mm",l=!(!n||!n.outStockNotSell)&&n.outStockNotSell,p=!(!n||!n.printOrderLikeInvoice)&&n.printOrderLikeInvoice,f=!(!n||!n.hideTax)&&n.hideTax,d=!(!n||!n.hideTablesFunction)&&n.hideTablesFunction,v=!(!n||!n.hideCalendarFunction)&&n.hideCalendarFunction,S=!(!n||!n.hideMaterials)&&n.hideMaterials,q=n.orderInvoiceMaxEmptyRows?n.orderInvoiceMaxEmptyRows:10,H=!!n.hideDiscountColumn,P=!!n.showStaffNameUnderSign;return t.userService.setAttr("current-currency",n&&n.currency?n.currency:"VND"),t.userService.setCurrentLanguage(s),t.userService.setAttr("date-format",m),t.userService.setAttr("time-format",g),t.userService.setAttr("out-stock",l),t.userService.setAttr("print-order-like-invoice",p),t.userService.setAttr("hide-tax",f),t.userService.setAttr("hide-tables-function",d),t.userService.setAttr("hide-calendar-function",v),t.userService.setAttr("hide-materials",S),t.userService.setAttr("order-invoice-max-empty-rows",q),t.userService.setAttr("hide-discount-column",H),t.userService.setAttr("show-staff-name-under-sign",P),n})()}tryLogin(t,n,s){var i=this;return(0,c.Z)(function*(){const m=yield i.navCtrl.loading();yield i.userService.getUserByNameAndPassword(t.trim(),n,s).then(function(){var g=(0,c.Z)(function*(l){if(l){i.analyticsService.logEvent("login-successfully");const p=l;p.isRemember=s,i.navCtrl.isNotCordova()||i.firebase.getToken().then(function(){var d=(0,c.Z)(function*(v){yield i.fcmTokenService.saveToken(v)});return function(v){return d.apply(this,arguments)}}(),d=>{console.error(d)}),(yield i.getShopConfig())?(i.userService.setLoggedUser(p),yield i.navCtrl.navigateRoot("/home")):yield(yield i.alertCtrl.create({header:i.translateService.instant("common.alert"),subHeader:i.translateService.instant("login.alert-username-orpassword-notcorrect"),buttons:["OK"]})).present()}else yield(yield i.alertCtrl.create({header:i.translateService.instant("common.alert"),subHeader:i.translateService.instant("login.alert-username-orpassword-notcorrect"),buttons:["OK"]})).present();yield m.dismiss()});return function(l){return g.apply(this,arguments)}}(),function(){var g=(0,c.Z)(function*(l){console.error(l),alert("Check your internet connection - Ki\u1ec3m tra l\u1ea1i k\u1ebft n\u1ed1i m\u1ea1ng"),yield m.dismiss()});return function(l){return g.apply(this,arguments)}}()).catch(function(){var g=(0,c.Z)(function*(l){console.error(l),alert("Check your internet connection - Ki\u1ec3m tra l\u1ea1i k\u1ebft n\u1ed1i m\u1ea1ng"),yield m.dismiss()});return function(l){return g.apply(this,arguments)}}())})()}register(){this.navCtrl.navigateForward("/register")}disableLogin(){this.userService.disableLogin().then(()=>{this.userService.setLoggedUser(null),this.navCtrl.navigateForward("/home")})}changeLanguage(){this.analyticsService.logEvent("login-change-language"),this.userService.setCurrentLanguage(this.language)}changeto(t){this.language=t,this.changeLanguage()}openWeb(){var t=this;return(0,c.Z)(function*(){t.analyticsService.logEvent("open-web-on-login"),t.navCtrl.openExternalUrl("https://isale.online/app")})()}openAppAndroid(){var t=this;return(0,c.Z)(function*(){t.analyticsService.logEvent("open-app-on-home"),t.navCtrl.openExternalUrl("https://play.google.com/store/apps/details?id=com.dlv.isale")})()}openAppIos(){this.analyticsService.logEvent("open-app-on-home-ios"),this.navCtrl.openExternalUrl("https://apps.apple.com/us/app/isale-management/id1485080690")}login(){var t=this;return(0,c.Z)(function*(){t.username&&""!==t.username.trim()?t.password&&""!==t.password?yield t.tryLogin(t.username,t.password,t.isRemember):yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-password-required"),buttons:["OK"]})).present():yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-username-required"),buttons:["OK"]})).present()})()}logout(){var t=this;this.userService.removeRefreshToken().then((0,c.Z)(function*(){t.analyticsService.logEvent("logout-successfully"),yield t.storeService.exitStore(),yield t.fcmTokenService.removeLoggedTokens(),t.userService.setLoggedUser(null,!1),t.staffService.hasChooseStaff=!1,t.staffService.selectedStaff=null,t.staffService.staffsToSelect=null;const n=[];n.push(t.userService.removeAttr("current-language")),n.push(t.userService.removeAttr("current-currency")),n.push(t.userService.removeAttr("date-format")),n.push(t.userService.removeLastBackup()),n.push(t.userService.removeLastLogin()),n.push(t.userService.removeAttr("time-format")),n.push(t.userService.removeOutstock()),yield Promise.all(n),yield t.userService.removeRefreshToken(),t.navCtrl.navigateRoot("/login")}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(A.G),e.Y36(x.K),e.Y36(h.sK),e.Y36(b.M),e.Y36(T.D),e.Y36(_.d),e.Y36(M.x),e.Y36(a.Br),e.Y36(k.y),e.Y36(U.L),e.Y36(N.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["login"]],decls:61,vars:48,consts:[["slot","start"],["menu","first"],["color","primary"],["color","primary","fill","solid",3,"click",4,"ngIf"],["color","primary","fill","clear",3,"click",4,"ngIf"],["position","stacked","color","primary"],["type","text","tabindex","1",3,"placeholder","ngModel","ngModelChange"],["type","password","tabindex","2",3,"placeholder","ngModel","ngModelChange"],["tabindex","3",3,"ngModel","ngModelChange"],["color","primary","expand","block",3,"click"],["color","secondary","expand","block",3,"click"],[1,"ion-text-wrap"],["lines","none",2,"padding-top","0px !important"],[1,"ion-text-wrap",2,"font-size","0.7em"],["color","primary","fill","solid",3,"click"],["color","primary","fill","clear",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA()()(),e.TgZ(7,"ion-content")(8,"ion-list")(9,"ion-item")(10,"ion-label",2),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-buttons"),e.YNc(14,w,3,3,"ion-button",3),e.YNc(15,F,3,3,"ion-button",4),e.YNc(16,O,3,3,"ion-button",3),e.YNc(17,Y,3,3,"ion-button",4),e.qZA()(),e.TgZ(18,"ion-item")(19,"ion-label",5),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"ion-input",6),e.NdJ("ngModelChange",function(i){return n.username=i}),e.ALo(23,"translate"),e.qZA()(),e.TgZ(24,"ion-item")(25,"ion-label",5),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"ion-input",7),e.NdJ("ngModelChange",function(i){return n.password=i}),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"ion-item")(31,"ion-label"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"ion-checkbox",8),e.NdJ("ngModelChange",function(i){return n.isRemember=i}),e.qZA()()(),e.TgZ(35,"ion-grid")(36,"ion-row")(37,"ion-col")(38,"ion-button",9),e.NdJ("click",function(){return n.login()}),e._uU(39),e.ALo(40,"translate"),e.qZA()(),e.TgZ(41,"ion-col")(42,"ion-button",10),e.NdJ("click",function(){return n.register()}),e._uU(43),e.ALo(44,"translate"),e.qZA()()()(),e.TgZ(45,"ion-item")(46,"ion-label",11),e._uU(47),e.ALo(48,"translate"),e.qZA()(),e.TgZ(49,"ion-item")(50,"ion-label",11),e._uU(51),e.ALo(52,"translate"),e.qZA()(),e.TgZ(53,"ion-item",12)(54,"ion-label",11),e._uU(55),e.ALo(56,"translate"),e.qZA()(),e.TgZ(57,"ion-item")(58,"ion-label",13),e._uU(59),e.ALo(60,"translate"),e.qZA()()()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,22,"login.title")),e.xp6(2),e.Akn(n.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(4),e.Oqu(e.lcZ(12,24,"language.language")),e.xp6(3),e.Q6J("ngIf","vn"===n.language),e.xp6(1),e.Q6J("ngIf","en"===n.language),e.xp6(1),e.Q6J("ngIf","en"===n.language),e.xp6(1),e.Q6J("ngIf","vn"===n.language),e.xp6(3),e.hij("",e.lcZ(21,26,"login.username")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(23,28,"login.enter-username")),e.Q6J("ngModel",n.username),e.xp6(4),e.Oqu(e.lcZ(27,30,"login.password")),e.xp6(2),e.s9C("placeholder",e.lcZ(29,32,"login.enter-password")),e.Q6J("ngModel",n.password),e.xp6(4),e.Oqu(e.lcZ(33,34,"login.remember")),e.xp6(2),e.Q6J("ngModel",n.isRemember),e.xp6(5),e.Oqu(e.lcZ(40,36,"action.login")),e.xp6(4),e.Oqu(e.lcZ(44,38,"login.register")),e.xp6(4),e.Oqu(e.lcZ(48,40,"login.forgot-password")),e.xp6(4),e.Oqu(e.lcZ(52,42,"login.first-time")),e.xp6(4),e.hij(" ",e.lcZ(56,44,"common.app-version")," "),e.xp6(4),e.hij("",e.lcZ(60,46,"common.version"),": 0.3.39 - \xa9 2023 DLV Studio"))},dependencies:[Z.O5,y.JJ,y.On,a.YG,a.Sm,a.nz,a.wI,a.W2,a.jY,a.Gu,a.pK,a.Ie,a.Q$,a.q_,a.fG,a.Nd,a.wd,a.sr,a.w,a.j9,h.X$],encapsulation:2}),o})()}];let E=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[L.Bz.forChild(J),L.Bz]}),o})();var I=r(2216),R=r(529),K=r(3093);let j=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[Z.ez,y.u5,a.Pc,E,I.uH,h.aw.forChild({loader:{provide:h.Zw,useFactory:K.x,deps:[R.eN]}})]}),o})()}}]);