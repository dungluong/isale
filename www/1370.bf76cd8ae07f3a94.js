"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1370],{8257:(V,I,_)=>{_.d(I,{r:()=>s});var p=_(6900);class s{constructor(T=0,N="",P="",O="",u=!1){this.id=0,this.code="",this.staffId=0,this.businessTypeId=0,this.salesLineId=0,this.avatarUrl="",this.fullName="",this.mobile="",this.isImportant=!1,this.gender="",this.email="",this.address="",this.dateOfBirth="",this.lastActive="",this.lastAction="",this.onlineId=0,this.staff=new p.O,this.businessType=null,this.salesLine=null,this.point=0,this.levelId=0,this.level=null,this.buyCount=0,this.fbUserId=null,this.source=null,this.id=T,this.avatarUrl=N,this.fullName=P,this.mobile=O,this.isImportant=u}}},6900:(V,I,_)=>{_.d(I,{O:()=>p});class p{constructor(l=0,T="",N="",P=""){this.hourLimit=1,this.storeId=0,this.store=null,this.isCollaborator=!1,this.shiftId=0,this.shift=null,this.blockViewingQuantity=!1,this.id=0,this.avatarUrl="",this.name="",this.userName="",this.shopName="",this.createdAt="",this.hasFullAccess=!1,this.canCreateOrder=!1,this.canUpdateDeleteOrder=!1,this.canCreateNewTransaction=!1,this.canUpdateDeleteTransaction=!1,this.canCreateUpdateNote=!1,this.canCreateUpdateDebt=!1,this.canUpdateDeleteProduct=!1,this.canViewProductCostPrice=!1,this.canUpdateProductCostPrice=!1,this.canViewAllContacts=!1,this.canManageContacts=!1,this.updateStatusExceptDone=!1,this.blockEditingOrderPrice=!1,this.id=l,this.avatarUrl=T,this.name=N,this.userName=P}}},1370:(V,I,_)=>{_.r(I),_.d(I,{QuoteModule:()=>To});var p=_(6895),s=_(4006),l=_(191),T=_(3306),N=_(529),P=_(2216),O=_(3196),u=_(5861),J=_(5439),y=_(7489),v=_(6026),h=_(6723),q=_(1914),D=_(8257),t=_(6738),C=_(9645),x=_(7696),w=_(6961),B=_(2077),H=_(667),K=_(7720),L=_(7395),$=_(7488),st=_(2126),z=_(5851),tt=_(7852),et=_(3876),W=_(323),at=_(360),lt=_(7613),ut=_(8851);const dt=["selectTax"],pt=["barcodeInput"];function _t(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSearchStaff())}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.staffSelected.name," ")}}function mt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSearchStaff())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"quote-add.select-collaborator")," "))}function gt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.removeStaff())}),t._UZ(1,"ion-icon",35),t.qZA()}}function ht(o,r){if(1&o&&(t.TgZ(0,"ion-col")(1,"ion-label",30),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,_t,2,1,"ion-button",31),t.YNc(5,mt,3,3,"ion-button",32),t.YNc(6,gt,2,0,"ion-button",32),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,4,"quote-add.collaborator-info")," "),t.xp6(2),t.Q6J("ngIf",e.staffSelected&&e.staffSelected.id>0),t.xp6(1),t.Q6J("ngIf",!e.staffSelected||0===e.staffSelected.id),t.xp6(1),t.Q6J("ngIf",e.staffSelected&&e.staffSelected.id>0)}}const k=function(o,r,e){return[o,r,"symbol","1.0-2",e]};function ft(o,r){if(1&o&&(t.TgZ(0,"p",56),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(4);t.xp6(1),t.HOy(" ",n.productName(e.productCode,e.productName)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,4,t.kEZ(10,k,e.price,n.currency.code,n.translateService.currentLang))," ")}}function xt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",56)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,ft,3,14,"p",57),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.combo-products")),t.xp6(2),t.Q6J("ngForOf",e.items)}}function qt(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.hij(" - ",t.G7q(2,1,t.kEZ(7,k,e.discount,n.currency.code,n.translateService.currentLang)),"")}}function Zt(o,r){if(1&o&&(t.TgZ(0,"p",61)(1,"ion-text"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getTypeAttributesString(e)," ")}}function Ct(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text"),t._uU(3),t.qZA()(),t.BQk()),2&o){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getAttributesString(e)," ")}}function At(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(5);t.xp6(1),t.AsE(" | ",e.count," \xd7 ",t.G7q(2,2,t.kEZ(8,k,e.price,n.currency.code,n.translateService.currentLang)),"")}}function yt(o,r){1&o&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Tt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text"),t._uU(3),t.YNc(4,At,3,12,"span",11),t._uU(5," | "),t.YNc(6,yt,2,0,"span",11),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(5);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(8,6,t.kEZ(12,k,e.total,n.currency.code,n.translateService.currentLang))," ")}}function vt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text")(3,"strong"),t._uU(4),t.qZA()()(),t.YNc(5,Tt,9,16,"ng-container",36),t.BQk()),2&o){const e=r.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngForOf",e.values)}}function bt(o,r){if(1&o&&(t.TgZ(0,"p",61),t._uU(1),t.ALo(2,"currency"),t.ALo(3,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(5);t.xp6(1),t.xDo(" ",n.productName(e.code,e.title)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,5,t.kEZ(17,k,e.price,n.currency.code,n.translateService.currentLang))," | +",t.G7q(3,11,t.kEZ(21,k,e.total,n.currency.code,n.translateService.currentLang))," ")}}function Qt(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,bt,4,25,"p",62),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.added-products")),t.xp6(2),t.Q6J("ngForOf",e.options)}}function St(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"ion-item",58)(2,"ion-text",59),t.YNc(3,Zt,3,3,"p",60),t.YNc(4,Ct,4,3,"ng-container",11),t.YNc(5,vt,6,2,"ng-container",36),t.YNc(6,Qt,6,4,"ng-container",11),t.qZA()(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.typeAttributes&&e.typeAttributes.length),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.typeOptions),t.xp6(1),t.Q6J("ngIf",e.options&&e.options.length)}}function wt(o,r){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",37)(2,"ion-buttons")(3,"ion-button",14),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.expand(a))}),t._UZ(4,"fa-icon",38),t.qZA()(),t.TgZ(5,"ion-text",39),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.expand(a))}),t._uU(6),t.YNc(7,xt,6,4,"ng-container",11),t.qZA(),t.TgZ(8,"ion-buttons",40)(9,"ion-button",41),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.decrease(a))}),t._UZ(10,"ion-icon",42),t.qZA(),t.TgZ(11,"ion-button",43),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.increase(a))}),t._UZ(12,"ion-icon",44),t.qZA(),t.TgZ(13,"ion-button",45),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.showTypes(a))}),t._UZ(14,"ion-icon",46),t.qZA(),t.TgZ(15,"ion-button",45),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.showOptions(a))}),t._UZ(16,"ion-icon",47),t.qZA()()(),t.TgZ(17,"ion-item",48)(18,"ion-text",39),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.expand(a))}),t._uU(19),t.ALo(20,"currency"),t.YNc(21,qt,3,11,"span",11),t._uU(22),t.ALo(23,"currency"),t.qZA(),t.TgZ(24,"ion-buttons",49)(25,"ion-button",50),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.removeProduct(a))}),t._UZ(26,"ion-icon",51),t.qZA()()(),t.YNc(27,St,7,6,"ng-container",11),t.TgZ(28,"ion-grid",52)(29,"ion-row")(30,"ion-col")(31,"ion-label",9),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"money-input",53),t.NdJ("moneyValueChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.price=i)})("moneyValueChange",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.reCalc(a))}),t.ALo(35,"translate"),t.qZA()(),t.TgZ(36,"ion-col")(37,"ion-label",9),t._uU(38),t.ALo(39,"translate"),t.qZA(),t.TgZ(40,"ion-input",54),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.count=i)})("ngModelChange",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.changeCount(a))})("focus",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.selectAll(i))}),t.ALo(41,"translate"),t.qZA()(),t.TgZ(42,"ion-col")(43,"ion-label",9),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"money-input",53),t.NdJ("moneyValueChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.discount=i)})("moneyValueChange",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.reCalc(a))}),t.ALo(47,"translate"),t.qZA(),t.TgZ(48,"ion-text",55),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.openProductDiscountPercent(a))}),t._uU(49),t.qZA()(),t.TgZ(50,"ion-col")(51,"ion-label",9),t._uU(52),t.ALo(53,"translate"),t.qZA(),t.TgZ(54,"money-input",53),t.NdJ("moneyValueChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.total=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.applyItemTotal())}),t.ALo(55,"translate"),t.qZA()()()(),t.BQk()}if(2&o){const e=r.$implicit,n=t.oxw(2);t.xp6(4),t.s9C("icon",e.isExpand?"compress-arrows-alt":"edit"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.AsE(" ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," "),t.xp6(1),t.Q6J("ngIf",e.items&&e.items.length),t.xp6(10),t.Q6J("lines",n.hasOptionsOrAttributes(e)?"none":"inset"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.lnq(" ",e.count," ",e.unit," \xd7 ",t.G7q(20,34,t.kEZ(62,k,e.price+n.getOptionPrices(e),n.currency.code,n.translateService.currentLang)),""),t.xp6(2),t.Q6J("ngIf",e.discount),t.xp6(1),t.hij(" | ",t.G7q(23,40,t.kEZ(66,k,e.total,n.currency.code,n.translateService.currentLang))," "),t.xp6(5),t.Q6J("ngIf",n.hasOptionsOrAttributes(e)),t.xp6(1),t.Q6J("hidden",!e.isExpand),t.xp6(4),t.hij(" ",t.lcZ(33,46,"quote-add.product-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(35,48,"quote-add.enter-product-price")),t.Q6J("clear",!0)("moneyValue",e.price),t.xp6(4),t.hij(" ",t.lcZ(39,50,"quote-add.product-count")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(41,52,"quote-add.enter-product-count")),t.Q6J("ngModel",e.count),t.xp6(4),t.hij(" ",t.lcZ(45,54,"quote-add.product-discount"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(47,56,"quote-add.enter-product-discount")),t.Q6J("clear",!0)("moneyValue",e.discount),t.xp6(2),t.Udp("background-color",e.discountPercent?"#3880ff":"#ccc"),t.xp6(1),t.hij(" ",e.discountPercent?e.discountPercent.toFixed(0)+"%":"%"," "),t.xp6(3),t.hij(" ",t.lcZ(53,58,"quote-add.product-total")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(55,60,"quote-add.enter-product-total")),t.Q6J("clear",!0)("moneyValue",e.total)}}function Ut(o,r){if(1&o&&(t.ynx(0),t.YNc(1,wt,56,70,"ng-container",36),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.quote.items)}}function It(o,r){1&o&&(t._UZ(0,"div",63),t.ALo(1,"translate")),2&o&&t.Q6J("innerHTML",t.lcZ(1,1,"quote-add.no-product"),t.oJD)}function Nt(o,r){1&o&&(t._UZ(0,"div",63),t.ALo(1,"translate")),2&o&&t.Q6J("innerHTML",t.lcZ(1,1,"quote-add.no-product-short"),t.oJD)}function Pt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",64),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hideNoProductDescription())}),t._UZ(1,"ion-icon",35),t.qZA()}}function Jt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",72),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSearchContact())}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.contactSelected.fullName," ")}}function Lt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.scanContact())}),t._UZ(1,"ion-icon",16),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&o&&(t.xp6(2),t.hij(" \xa0",t.lcZ(3,1,"quote-add.mobile-scan")," "))}function Mt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",74),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showSearchContact())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"trade-add.select-contact")," "))}function kt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",75),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.removeContact())}),t._UZ(1,"ion-icon",35),t.qZA()}}function Ot(o,r){if(1&o&&(t.TgZ(0,"ion-item",76)(1,"ion-text",77),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"quote-add.contact-points"),": ",e.totalPoints," ")}}function Dt(o,r){if(1&o&&(t.TgZ(0,"ion-list",65)(1,"ion-item",66)(2,"ion-text",7),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,Jt,2,1,"ion-button",67),t.YNc(6,Lt,4,3,"ion-button",68),t.YNc(7,Mt,3,3,"ion-button",69),t.YNc(8,kt,2,0,"ion-button",70),t.qZA(),t.YNc(9,Ot,4,4,"ion-item",71),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,6,"quote-add.contact-info")),t.xp6(2),t.Q6J("ngIf",e.contactSelected&&e.contactSelected.id>0),t.xp6(1),t.Q6J("ngIf",!e.contactSelected||0===e.contactSelected.id),t.xp6(1),t.Q6J("ngIf",!e.contactSelected||0===e.contactSelected.id),t.xp6(1),t.Q6J("ngIf",e.contactSelected&&e.contactSelected.id>0),t.xp6(1),t.Q6J("ngIf",e.contactSelected&&e.totalPoints)}}function Yt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-grid",78)(1,"ion-row")(2,"ion-col")(3,"ion-label",9),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-input",79),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.quote.contactName=i)}),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-label",9),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"ion-input",80),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.quote.contactPhone=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.changePhone())}),t.qZA()()(),t.TgZ(12,"ion-row")(13,"ion-col")(14,"ion-label",9),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ion-input",81),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.quote.contactAddress=i)}),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.hij("",t.lcZ(5,6,"contact-add.full-name")," "),t.xp6(2),t.Q6J("ngModel",e.quote.contactName),t.xp6(3),t.hij("",t.lcZ(10,8,"contact-add.phone")," "),t.xp6(2),t.Q6J("ngModel",e.quote.contactPhone),t.xp6(4),t.hij("",t.lcZ(16,10,"contact-add.address")," "),t.xp6(2),t.Q6J("ngModel",e.quote.contactAddress)}}function Et(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-list",66)(1,"ion-grid",82)(2,"ion-row")(3,"ion-col")(4,"ion-textarea",83),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.quote.note=i)}),t.ALo(5,"translate"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.s9C("placeholder",t.lcZ(5,2,"quote-add.enter-note")),t.Q6J("ngModel",e.quote.note)}}function Ft(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col",87)(2,"ion-label",88),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"money-input",89),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.totalProductAmount=i)}),t.qZA()(),t.TgZ(6,"ion-col",87)(7,"ion-label",9),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"money-input",85),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.shippingFee=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.reCalcTotal())}),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"ion-col",87)(13,"ion-label",90),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"ion-toggle",91),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.shipCostOnCustomer=i)})("ionChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.reCalcTotal(!0))}),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,8,"quote-add.total-product-amount")," "),t.xp6(2),t.Q6J("moneyValue",e.totalProductAmount)("disabled",!0),t.xp6(3),t.hij("",t.lcZ(9,10,"quote-add.shipping-fee")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(11,12,"quote-add.enter-shipping-fee")),t.Q6J("moneyValue",e.quote.shippingFee),t.xp6(4),t.hij("",t.lcZ(15,14,"quote-add.shipping-fee-for-customer")," "),t.xp6(3),t.Q6J("ngModel",e.quote.shipCostOnCustomer)}}function Ht(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col")(1,"ion-label",9),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-grid",93)(5,"ion-row")(6,"ion-col",94)(7,"money-input",85),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.quote.tax=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.reCalcTotal())}),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"ion-col",95)(10,"ion-text",55),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.openTaxType())}),t._uU(11),t.qZA(),t.TgZ(12,"ion-select",96,97),t.NdJ("ionChange",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.taxTypeChanged(!0))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.quote.taxType=i)}),t.TgZ(14,"ion-select-option",98),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ion-select-option",98),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"ion-select-option",98),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"ion-select-option",98),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"ion-select-option",98),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"ion-select-option",98),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"ion-select-option",98),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"ion-select-option",98),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"ion-select-option",98),t._uU(39),t.ALo(40,"translate"),t.qZA(),t.TgZ(41,"ion-select-option",98),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"ion-select-option",98),t._uU(45),t.ALo(46,"translate"),t.qZA()()()()()()}if(2&o){const e=t.oxw(3);t.xp6(2),t.hij("",t.lcZ(3,28,"quote-add.tax")," "),t.xp6(5),t.s9C("placeholder",t.lcZ(8,30,"quote-add.enter-tax")),t.Q6J("moneyValue",e.quote.tax),t.xp6(4),t.hij(" ",(100*e.taxTypeToRate()).toFixed(0)+"%"," "),t.xp6(1),t.Q6J("hidden",!0)("ngModel",e.quote.taxType),t.xp6(2),t.Q6J("value",0),t.xp6(1),t.hij("",t.lcZ(16,32,"quote-add.no-tax")," "),t.xp6(2),t.Q6J("value",10),t.xp6(1),t.hij("",t.lcZ(19,34,"quote-add.tax-8")," "),t.xp6(2),t.Q6J("value",1),t.xp6(1),t.hij("",t.lcZ(22,36,"quote-add.tax-10")," "),t.xp6(2),t.Q6J("value",2),t.xp6(1),t.hij("",t.lcZ(25,38,"quote-add.tax-15")," "),t.xp6(2),t.Q6J("value",3),t.xp6(1),t.hij("",t.lcZ(28,40,"quote-add.tax-20")," "),t.xp6(2),t.Q6J("value",4),t.xp6(1),t.hij("",t.lcZ(31,42,"quote-add.tax-25")," "),t.xp6(2),t.Q6J("value",5),t.xp6(1),t.hij("",t.lcZ(34,44,"quote-add.tax-30")," "),t.xp6(2),t.Q6J("value",6),t.xp6(1),t.hij("",t.lcZ(37,46,"quote-add.tax-35")," "),t.xp6(2),t.Q6J("value",7),t.xp6(1),t.hij("",t.lcZ(40,48,"quote-add.tax-40")," "),t.xp6(2),t.Q6J("value",8),t.xp6(1),t.hij("",t.lcZ(43,50,"quote-add.tax-45")," "),t.xp6(2),t.Q6J("value",9),t.xp6(1),t.hij("",t.lcZ(46,52,"quote-add.tax-50")," ")}}function Gt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-label",92),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"money-input",85),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.netValue=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.reCalcTotal(!0))}),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-label",9),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"ion-grid",93)(12,"ion-row")(13,"ion-col",94)(14,"money-input",85),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.discountOnTotal=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.changeDiscountOnTotal())}),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"ion-col",95)(17,"ion-text",55),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.openDiscountPercent())}),t._uU(18),t.qZA()()()()(),t.YNc(19,Ht,47,54,"ion-col",11),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij("",t.lcZ(4,10,"quote-add.net-value")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(6,12,"quote-add.enter-net-value")),t.Q6J("moneyValue",e.quote.netValue),t.xp6(4),t.hij(" ",t.lcZ(10,14,"quote-add.discount")," "),t.xp6(5),t.s9C("placeholder",t.lcZ(15,16,"quote-add.enter-discount")),t.Q6J("moneyValue",e.quote.discountOnTotal),t.xp6(3),t.Udp("background-color",e.discountPercent?"#3880ff":"#ccc"),t.xp6(1),t.hij(" ",e.discountPercent?e.discountPercent.toFixed(0)+"%":"%"," "),t.xp6(1),t.Q6J("ngIf",!e.hideTax)}}function jt(o,r){if(1&o&&(t.TgZ(0,"p",105),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.AsE(" 1 ",t.lcZ(2,2,"point-add.point")," = ",t.G7q(3,4,t.kEZ(10,k,e.pointPaymentConfig.pointPaymentExchange,e.currency.code,e.translateService.currentLang))," ")}}function Vt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-label",99),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,jt,4,14,"p",100),t._UZ(6,"br"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ion-col")(11,"ion-label",99),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"money-input",101),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.amountFromPoint=i)}),t.qZA(),t.TgZ(15,"p",102)(16,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.spendAll())}),t._uU(17," + Ti\xeau h\u1ebft "),t.qZA()()(),t.TgZ(18,"ion-col")(19,"ion-label",99),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"ion-input",103),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.quote.pointAmount=i)})("ionChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.reCalcTotal())}),t.qZA(),t.TgZ(23,"p",102)(24,"ion-button",104),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clearAll())}),t._uU(25," - B\u1ecf "),t.qZA()()()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,10,"quote-add.pay-by-point")," "),t.xp6(2),t.Q6J("ngIf",e.pointPaymentConfig.pointPaymentExchange),t.xp6(2),t.lnq(" ",t.lcZ(8,12,"quote-add.max-point-amount"),": ",e.contactSelected.point," ",t.lcZ(9,14,"point-add.point")," "),t.xp6(5),t.hij("",t.lcZ(13,16,"quote-add.amount-point-converted")," "),t.xp6(2),t.Q6J("disabled",!0)("moneyValue",e.quote.amountFromPoint),t.xp6(6),t.Oqu(t.lcZ(21,18,"quote-add.point-amount")),t.xp6(2),t.Q6J("ngModel",e.quote.pointAmount)}}function Bt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-list",66)(1,"ion-grid",82),t.YNc(2,Ft,18,16,"ion-row",11),t.YNc(3,Gt,20,18,"ion-row",11),t.YNc(4,Vt,26,20,"ion-row",11),t.TgZ(5,"ion-row")(6,"ion-col")(7,"ion-label",84),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"money-input",85),t.NdJ("moneyValueChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.quote.total=i)})("moneyValueChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.reCalcTotal())}),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"ion-row")(13,"ion-text",86),t._uU(14),t.ALo(15,"translate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.isCollapsed),t.xp6(1),t.Q6J("ngIf",!e.isCollapsed),t.xp6(1),t.Q6J("ngIf",e.contactSelected&&e.contactSelected.point&&e.pointPaymentConfig&&e.pointPaymentConfig.allowPointPayment&&e.contactSelected.buyCount&&e.contactSelected.buyCount>=e.pointPaymentConfig.pointPaymentAfterBuyCount),t.xp6(4),t.hij(" ",t.lcZ(9,8,"quote-add.total")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(11,10,"quote-add.enter-total")),t.Q6J("moneyValue",e.quote.total),t.xp6(4),t.AsE("* ",t.lcZ(15,12,"config.money"),": ",e.currency?e.currency.code:"","")}}let Kt=(()=>{class o{constructor(e,n,i,a,c,d,Z,f,m,A,U,F,G,M,j,ot,g){this.barcodeScanner=e,this.contactService=n,this.productService=i,this.shiftService=a,this.staffService=c,this.pointService=d,this.quoteService=Z,this.translateService=f,this.userService=m,this.toastCtrl=A,this.tradeService=U,this.alertCtrl=F,this.modalCtrl=G,this.navCtrl=M,this.storage=j,this.storeService=ot,this.analyticsService=g,this.tab="payment",this.params=null,this.discounts=[],this.prices=[],this.quote={items:[],total:0,netValue:0,tax:0,discountOnTotal:0,shippingFee:0,discount:0,discountType:0,shipCostOnCustomer:!0},this.oldQuote=null,this.currency={code:"vnd"},this.isNew=!0,this.hideTax=!1,this.barcode="",this.saveDisabled=!1,this.outStock=!1,this.isCollapsed=!1,this.noPrompt=!0,this.discountPercent=0,this.totalProductAmount=0,this.totalPoints=0,this.isHideNoProductDescription=!0,this.tradeToCategories=[],this.shifts=[],this.onKeyPress=S=>{if(S.target&&"body"===S.target.localName)("s"===S.key||"S"===S.key)&&this.save();else{if(!S.target||"input"!==S.target.localName)return;("Escape"===S.key||"Esc"===S.key)&&(this.barcode="")}}}ionViewDidEnter(){var e=this;return(0,u.Z)(function*(){e.shifts=yield e.shiftService.getAll(),e.navCtrl.addEventListener("keyup",e.onKeyPress)})()}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ngOnInit(){var e=this;return(0,u.Z)(function*(){const n=yield e.userService.getAttr("current-currency");e.hideTax=yield e.userService.getAttr("hide-tax"),e.currency=h.W.getCurrencyByCode(n);const i=yield e.quoteService.getNewOrderData();e.outStock=yield e.userService.getAttr("out-stock"),e.pointPaymentConfig=e.pointService.getPointPaymentConfigByInput(i.shopConfigs),e.pointConfigs=i.pointConfigs,e.quote={items:[],total:0,netValue:0,tax:0,discountOnTotal:0,shippingFee:0,discount:0,discountType:0,shipCostOnCustomer:!0},e.pointPaymentConfig&&e.pointPaymentConfig.pointPaymentExchange&&(e.quote.pointPaymentExchange=e.pointPaymentConfig.pointPaymentExchange),e.quote.createdAt=J(new Date).format(q.C.getDateTimeDbFormat()),e.params=e.navCtrl.getParams(e.params);const a=yield e.storage.get("hide-no-product");e.isHideNoProductDescription=a&&"1"===a;let c=0,d=0,Z=0;if(e.store=yield e.storeService.getCurrentStore(),e.noPrompt=!0,e.params){if(e.params&&e.params.id?(c=e.params.id,e.isNew=!1):e.params&&e.params.contact?d=+e.params.contact:e.params&&e.params.product&&(Z=+e.params.product,e.params&&e.params.fromUnit&&(e.fromUnit=e.params.fromUnit)),e.params.table&&(e.table=e.params.table,e.quote.tableId=e.table.id),e.params&&e.params.convert&&(e.quote.contactAddress=e.params.convert.contactAddress,e.quote.contactName=e.params.convert.contactName,e.quote.contactPhone=e.params.convert.contactPhone,e.quote.itemsJson=e.params.convert.itemsJson,e.quote.items=JSON.parse(e.quote.itemsJson),e.quote.total=0,e.quote.netValue=0,e.quote.paid=0,e.quote.change=0,e.quote.discountOnTotal=0,e.quote.tax=0,e.quote.shippingFee=0,e.quote.items&&e.quote.items.length))for(const f of e.quote.items)e.reCalc(f);if(e.params&&e.params.quote&&"copy"===e.params.mode){const f=JSON.parse(JSON.stringify(e.params.quote));f.id=0,f.createdAt=null,e.contactSelected=f.contact,e.staffSelected=f.staff,e.contactSelected=f.contact,e.quote=f}}if(e.prices=i.customerPrices,e.discounts=i.customerDiscounts,c&&c>0){const f=yield e.navCtrl.loading();e.quoteService.get(c).then(function(){var m=(0,u.Z)(function*(A){yield f.dismiss(),e.contactSelected=A.contact&&0!==A.contact.id?A.contact:null,e.staffSelected=A.staff&&0!==A.staff.id?A.staff:null,e.quote=A,e.pointPaymentConfig&&e.pointPaymentConfig.pointPaymentExchange&&(e.quote.pointPaymentExchange=e.pointPaymentConfig.pointPaymentExchange),e.table=e.quote.table,e.oldQuote=JSON.parse(JSON.stringify(A)),e.quote.items=JSON.parse(e.quote.itemsJson),e.totalProductAmount=e.quote.items&&e.quote.items.length?y.sumBy(e.quote.items,U=>U.total):0,setTimeout(()=>{e.noPrompt=!1},2e3)});return function(A){return m.apply(this,arguments)}}())}else{const f=yield e.storage.get("tax-type");if(e.quote.taxType=f?+f:0,e.staffService.isStaff()&&(e.staffSelected=e.staffService.selectedStaff),d&&d>0){const m=yield e.contactService.get(d);e.contactSelected=m,e.quote.contactId=m.id}else if(Z&&Z>0){const m=yield e.productService.get(Z,e.store?e.store.id:0);e.fromUnit&&(m.fromUnit=e.fromUnit),e.addProduct(m)}if(e.params&&e.params.flow&&e.params.flow.fromUserId){e.flow=e.params.flow;const m=yield e.contactService.searchContactByFbUserId(e.params.flow.fromUserId);m?(e.contactSelected=m,e.quote.contactId=m.id):e.quote.contactName=e.flow.fromUserName}if(e.params&&e.params.fbcomment&&e.params.fbcomment.fromUserId){const m=yield e.contactService.searchContactByFbUserId(e.params.fbcomment.fromUserId);m?(e.contactSelected=m,e.quote.contactId=m.id):e.quote.contactName=e.params.fbcomment.fromUserName}if(e.params&&e.params.products)for(const m of e.params.products)yield e.addProduct(m);e.barcodeFocus(),setTimeout(()=>{e.noPrompt=!1},2e3)}e.params&&e.params.convert&&e.reCalcTotal()})()}calculatePoints(){if(this.totalPoints=0,this.pointConfigs&&this.pointConfigs.length&&this.quote.items&&this.quote.items.length)for(const e of this.quote.items){let n=null;for(const a of this.pointConfigs)if(a.forAllCustomer||a.contactId==this.quote.contactId){if(a.productId==e.productId){n=a;break}if(0===a.productId){for(const c of this.tradeToCategories)if(c.tradeId==e.productId&&c.categoryId==a.categoryId){n=a;break}if(0==a.categoryId){if(a.contactId==this.quote.contactId){n=a;break}0==a.contactId&&(n=a)}}}null!=n&&(this.totalPoints+=e.total/n.exchange)}}checkDiscountOnChangeCustomer(){if(!this.discounts||!this.discounts.length)return;let e=!1;for(const n of this.quote.items)this.checkDiscount(n)&&(this.reCalc(n),e=!0);e&&this.reCalcTotal()}checkPriceOnChangeCustomer(){if(!this.prices||!this.prices.length)return;let e=!1;for(const n of this.quote.items)this.checkPrice(n)&&(this.reCalc(n),e=!0);e&&this.reCalcTotal()}calcDiscount(e,n){return 0===n.type?n.discountValue:e.price*e.count*n.discountValue/100}ionViewWillEnter(){var e=this;return(0,u.Z)(function*(){yield e.analyticsService.setCurrentScreen("quote-add")})()}showSearchContact(){var e=this;return(0,u.Z)(function*(){e.analyticsService.logEvent("quote-add-search-contact");const n=function(){var i=(0,u.Z)(function*(a){const c=a;if(c)return e.contactSelected=c,e.quote.contactId=c.id,e.quote.contactName=c?c.fullName:null,e.quote.contactPhone=c?c.mobile:null,e.quote.contactAddress=c?c.address:null,e.checkDiscountOnChangeCustomer(),e.checkPriceOnChangeCustomer(),e.quote.pointAmount=0,e.quote.amountFromPoint&&(e.quote.amountFromPoint=0,e.reCalcTotal()),void e.calculatePoints()});return function(c){return i.apply(this,arguments)}}();e.navCtrl.push("/contact",{callback:n,searchMode:!0})})()}showSearchStaff(){var e=this;return(0,u.Z)(function*(){e.analyticsService.logEvent("quote-add-search-staff");const n=function(){var a=(0,u.Z)(function*(c){const d=c;d&&(e.staffSelected=d,e.quote.collaboratorId=d.id,e.checkPriceOnChangeCustomer(),e.checkDiscountOnChangeCustomer())});return function(d){return a.apply(this,arguments)}}();let i=-1;if(e.shifts&&e.shifts.length){const a=J(new Date).format("HH:mm:ss");for(const c of e.shifts)if(a>=c.startTime&&a<=c.endTime){i=c.id;break}}e.navCtrl.push("/staff",{callback:n,storeFilter:e.store?e.store.id:-1,shiftFilter:i,searchMode:!0})})()}ionViewLoaded(){this.barcodeFocus()}barcodeFocus(){!this.navCtrl.isNotCordova()||setTimeout(()=>{this.barcodeInput.setFocus()},600)}validate(){return this.quote.name?this.contactSelected&&this.contactSelected.point&&this.pointPaymentConfig.allowPointPayment&&this.pointPaymentConfig.pointPaymentExchange&&this.contactSelected.buyCount>=this.pointPaymentConfig.pointPaymentAfterBuyCount&&this.quote.pointAmount&&this.quote.pointAmount>this.contactSelected.point?(alert(this.translateService.instant("quote-add.poin-amount-limit-alert")),!1):!(!this.quote.items||!this.quote.items.length)||(alert(this.translateService.instant("quote-add.no-items-alert")),!1):(alert(this.translateService.instant("quote-add.no-name")),!1)}save(){var e=this;return(0,u.Z)(function*(){if(e.saveDisabled||!e.validate())return;e.saveDisabled=!0;for(const i of e.quote.items)delete i.quantity;e.quote.itemsJson=JSON.stringify(e.quote.items),e.staffService.isStaff()&&(e.quote.staffId=e.staffService.selectedStaff.id);const n=yield e.navCtrl.loading();if(!e.contactSelected&&e.quote&&e.quote.contactName&&e.quote.contactPhone){e.analyticsService.logEvent("quote-add-new-contact");let i=null,a=null;const c=yield e.contactService.searchContactByPhone(e.quote.contactPhone);c&&confirm(e.translateService.instant("quote-add.contact-phone-duplicated",{name:c.fullName,phone:c.mobile}))?(i=c,a=c.id):(i=new D.r,i.fullName=e.quote.contactName,i.mobile=e.quote.contactPhone,i.address=e.quote.contactAddress,i.staffId=e.quote.staffId,a=yield e.contactService.saveContact(i)),e.contactSelected=i,e.quote.contactId=a}e.quote.storeId=e.store?e.store.id:0,e.quote.saveProductNotes=!0,e.quote.lang=yield e.userService.getAttr("current-language"),e.quoteService.save(e.quote).then((0,u.Z)(function*(){e.analyticsService.logEvent("quote-add-save-success");const i=[];if(e.contactSelected){const a=e.saveLastActive();i.push(a)}Promise.all(i).then((0,u.Z)(function*(){yield n.dismiss(),e.saveDisabled=!1,e.exitPage()}))}))})()}saveLastActive(){return this.contactSelected.lastActive=q.C.toDbString(),this.contactSelected.lastAction="trade",this.contactService.saveContact(this.contactSelected).then(n=>(this.navCtrl.publish("reloadContactList"),this.navCtrl.publish("reloadContact",this.contactSelected),this.navCtrl.publish("reloadContactQuote",this.contactSelected.id),n))}exitPage(){var e=this;return(0,u.Z)(function*(){yield e.navCtrl.popOnly(),e.navCtrl.publish("reloadQuoteList"),e.navCtrl.publish("reloadQuote",e.quote),e.quote.contact&&e.contactSelected&&(e.navCtrl.publish("reloadContact",e.contactSelected),e.navCtrl.publish("reloadContactQuote",e.contactSelected.id)),e.quote.tableId>0&&(e.navCtrl.publish("reloadTable",e.table),e.navCtrl.publish("reloadTableList")),e.isNew&&0===e.quote.tableId&&(yield e.navCtrl.navigateForward("/quote/detail",{id:e.quote.id}))})()}removeStaff(){this.staffSelected=null,this.quote.collaboratorId=0,this.quote.staffId=0,this.checkDiscountOnChangeCustomer(),this.checkPriceOnChangeCustomer()}removeContact(){this.contactSelected=null,this.quote.contactId=0,this.quote.contactName=null,this.quote.contactPhone=null,this.quote.contactAddress=null,this.checkDiscountOnChangeCustomer(),this.checkPriceOnChangeCustomer(),this.quote.pointAmount=0,this.quote.amountFromPoint&&(this.quote.amountFromPoint=0,this.reCalcTotal())}dateFormat(e){return q.C.toUiLocalDateString(e)}productName(e,n){return h.W.productName(e,n)}selectAll(e){h.W.selectAll(e)}showProductSelector(){var e=this;return(0,u.Z)(function*(){e.analyticsService.logEvent("quote-add-search-product");const n=function(){var i=(0,u.Z)(function*(a){if(!a||!a.length)return;for(const d of e.quote.items)d.isExpand=!1;const c=[];for(const d of a)c.push(d.id);e.tradeToCategories=yield e.tradeService.getCategoriesOfProducts(c);for(const d of a)e.addProductFromArr(d,e.tradeToCategories);e.applyItemTotal(),e.barcodeFocus()});return function(c){return i.apply(this,arguments)}}();yield e.navCtrl.push("/quote/product-selector",{callback:n,contactId:e.contactSelected?e.contactSelected.id:null,staffId:e.staffSelected?e.staffSelected.id:null})})()}addProductFromArr(e,n){var i=this;return(0,u.Z)(function*(){if(!e)return;const a={};a.price=e.price,a.quantity=e.quantity,a.discountPercent=e.discountPercent,a.discountType=0,a.costPrice=e.costPrice?e.costPrice:null,a.productId=e.id,a.isCombo=e.isCombo,a.productCode=e.code,a.productName=e.title,a.productAvatar=e.avatarUrl,a.description=e.description,a.unit=e.unit,a.basicUnit=e.basicUnit,a.unitExchange=e.unitExchange,a.discount=e.discount?e.discount:0,a.count=e.count,a.isExpand=!1,a.options=e.options,a.attributes=e.attributes,a.initPrice=e.initPrice,a.types=e.types,a.typeAttributes=e.typeAttributes,a.shopPrice=e.shopPrice,a.typeOptions=e.typeOptions,a.items=e.itemsJson?JSON.parse(e.itemsJson):[],a.materials=e.materials&&e.materials.length?e.materials:e.materialsJson?JSON.parse(e.materialsJson):e.materials;const c=[];if(n&&n.length)for(const Z of n)Z.tradeId==a.productId&&c.push(Z);a.categories=c,i.checkDiscount(a),i.checkPrice(a),i.quote.items.unshift(a),i.reCalc(a);const d=i.translateService.instant("quote-add.added-product",{product:h.W.productName(e.code,e.title)});i.presentToast(d)})()}checkPrice(e){let n=this.prices.find(i=>i.product&&i.product.id===e.productId&&this.contactSelected&&i.contact&&i.contact.id==this.contactSelected.id);return n||(n=this.prices.find(i=>i.product&&i.product.id===e.productId&&this.staffSelected&&i.staff&&i.staff.id==this.staffSelected.id&&!i.contact)),n||(n=this.prices.find(i=>i.product&&i.product.id===e.productId&&this.staffSelected&&i.isCollaboratorPrice&&!i.contact&&!i.staff)),n||(n=this.prices.find(i=>i.product&&i.product.id===e.productId&&!i.contact&&!i.staff&&!i.isCollaboratorPrice)),n?(n.orginalPrice=e.price,e.price=n.price,e.priceInfo=n,!0):!(!e.priceInfo||!(!this.contactSelected&&e.priceInfo.contact||!this.staffSelected&&e.priceInfo.staff||!this.staffSelected&&e.priceInfo.isCollaboratorPrice)||(e.price=e.priceInfo.orginalPrice,e.priceInfo=null,0))}checkDiscount(e){let n=this.discounts.find(i=>(i.product&&i.product.id===e.productId||i.category&&e.categories&&null!=e.categories.find(a=>a.categoryId==i.category.id))&&this.contactSelected&&i.contact&&i.contact.id==this.contactSelected.id);return n||(n=this.discounts.find(i=>(i.product&&i.product.id===e.productId||i.category&&e.categories&&null!=e.categories.find(a=>a.categoryId==i.category.id))&&this.staffSelected&&i.staff&&i.staff.id==this.staffSelected.id&&!i.contact)),n||(n=this.discounts.find(i=>(i.product&&i.product.id===e.productId||i.category&&e.categories&&null!=e.categories.find(a=>a.categoryId==i.category.id))&&this.staffSelected&&i.isCollaboratorPrice&&!i.contact&&!i.staff)),n||(n=this.discounts.find(i=>(i.product&&i.product.id===e.productId||i.category&&e.categories&&null!=e.categories.find(a=>a.categoryId==i.category.id))&&!i.contact&&!i.staff&&!i.isCollaboratorPrice)),n?!(n.conditionQuantity&&!(n.conditionQuantity&&e.count>=n.conditionQuantity)||(e.discount=this.calcDiscount(e,n),e.discountPercent=0!==n.type?n.discountValue:0,e.discountInfo=n,0)):!(!e.discountInfo||!(!this.contactSelected&&e.discountInfo.contact||!this.staffSelected&&e.discountInfo.staff||!this.staffSelected&&e.discountInfo.isCollaboratorPrice)||(e.discount=0,e.discountPercent=0,e.discountInfo=null,0))}addProduct(e){var n=this;return(0,u.Z)(function*(){if(e){for(const m of n.quote.items)m.isExpand=!1;const i=n.quote.items.findIndex(m=>!(m.productId!==e.id||m.attributes&&m.attributes.length||m.options&&m.options.length||m.typeOptions&&m.typeOptions.length||m.typeAttributes&&m.typeAttributes.length));if(i>=0){const m=n.quote.items[i];m.isExpand=!0,m.count=1*m.count+1,n.checkDiscount(m),n.checkPrice(m),n.reCalc(m);const A=n.translateService.instant("quote-add.qty-product",{product:m.productName,count:m.count+""}),U=e.count-m.count,F=n.translateService.instant("product-selector.quantity-left")+": "+U;return void n.presentToast(A+". "+F)}let a=null;if(e.fromUnit){const m=e.unitsJson?JSON.parse(e.unitsJson):null;if(m&&m.length)for(const A of m)if(A&&A.unit===e.fromUnit){a=A;break}}const c={};c.price=a?a.price:e.price,c.quantity=e.quantity?e.quantity:e.count,c.discouantType=0,c.costPrice=e.costPrice?e.costPrice:null,c.discountPercent=0,c.productId=e.id,c.basicUnit=a?e.unit:null,c.unitExchange=a?a.exchange:null,c.isCombo=e.isCombo,c.productCode=e.code,c.productName=e.title,c.productAvatar=e.avatarUrl,c.unit=a?a.unit:e.unit,c.count=1,c.isExpand=!1,c.shopPrice=e.shopPrice,c.items=e.itemsJson?JSON.parse(e.itemsJson):[],c.materials=e.materials&&e.materials.length?e.materials:e.materialsJson?JSON.parse(e.materialsJson):e.materials,n.tradeToCategories=yield n.tradeService.getCategoriesToTrade(c.productId),c.categories=n.tradeToCategories,n.quote.items.unshift(c),n.checkDiscount(c),n.checkPrice(c),n.reCalc(c);const d=n.translateService.instant("quote-add.added-product",{product:h.W.productName(e.code,e.title)});n.presentToast(d);const Z=e.count-c.count,f=n.translateService.instant("product-selector.quantity-left")+": "+Z;n.presentToast(d+". "+f),n.barcodeFocus()}})()}barcodeChanged(){var e=this;return(0,u.Z)(function*(){!e.barcode||e.barcode.length<5||(e.analyticsService.logEvent("quote-add-barcode-entered"),e.productService.searchByBarcode(e.barcode).then(function(){var n=(0,u.Z)(function*(i){if(i){if(e.outStock&&i.count<=0)return e.analyticsService.logEvent("product-selector-outstock-alert"),void alert(e.translateService.instant("quote-add.outstock-alert"));e.analyticsService.logEvent("quote-add-barcode-entered-ok"),e.addProduct(i),e.barcode="",e.barcodeFocus()}});return function(i){return n.apply(this,arguments)}}()))})()}presentToast(e){var n=this;return(0,u.Z)(function*(){yield(yield n.toastCtrl.create({message:e,duration:3e3,position:"bottom",color:"danger"})).present()})()}removeProduct(e){var n=this;return(0,u.Z)(function*(){const i=n.quote.items.findIndex(a=>a.productId===e.productId&&a.unit===e.unit);i>=0&&n.quote.items.splice(i,1),n.analyticsService.logEvent("quote-add-remove-item"),n.applyItemTotal()})()}getOptionPrices(e){return h.W.getOptionPrices(e)}reCalc(e){let n=0,i=0;if(e.options&&e.options.length)for(const f of e.options)n+=f.count*f.price,i+=f.costPrice?f.count*f.costPrice:0;const a=e.count*(e.price+n);e.total=a-(e.discount?0===e.discountType?1*e.discount:a*e.discount/100:0),e.totalCostPrice=e.count*((e.costPrice?e.costPrice:0)+i)||null,this.applyItemTotal()}changeCount(e){e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),this.reCalc(e)}applyItemTotal(){let e=0,n=0;for(const i of this.quote.items)e+=1*i.total,n+=1*i.discount;this.totalProductAmount=e,this.quote.discount=1*n,this.discountPercent&&(this.quote.discountOnTotal=e*this.discountPercent/100),this.quote.discount+=this.quote.discountOnTotal,e-=this.quote.discountOnTotal,this.quote.netValue=e,this.taxTypeChanged(),this.calculatePoints()}changeDiscountOnTotal(){this.applyItemTotal()}expand(e){var n=this;return(0,u.Z)(function*(){const i=!e.isExpand;for(const a of n.quote.items)a.isExpand=!1;e.isExpand=i,i&&n.analyticsService.logEvent("quote-add-expand")})()}reCalcTotal(e=!1){let n=0;this.contactSelected&&this.contactSelected.point&&this.pointPaymentConfig&&this.pointPaymentConfig.allowPointPayment&&this.quote.pointAmount&&this.pointPaymentConfig.pointPaymentExchange&&(n=this.quote.pointAmount*this.pointPaymentConfig.pointPaymentExchange,this.quote.pointPaymentExchange=this.pointPaymentConfig.pointPaymentExchange);const i=1*this.quote.netValue+1*this.quote.tax+(this.quote.shipCostOnCustomer?1*this.quote.shippingFee:0)-n;this.quote.amountFromPoint=n,this.quote.total=i>=0?i:0,e&&(this.quote.tax=0===this.quote.taxType?0:this.taxTypeToRate()*(this.quote.netValue-this.quote.discountOnTotal))}reCalcChange(){const e=+this.quote.paid-+this.quote.total;this.quote.change=e>0?e:0}scan(){var e=this;return(0,u.Z)(function*(){if(e.analyticsService.logEvent("quote-add-scan-barcode"),e.navCtrl.isNotCordova()){const n=yield e.modalCtrl.create({component:v.k});yield n.present();const{data:i}=yield n.onDidDismiss();i&&i.barcode&&e.checkBarcodeScaned(i.barcode,!0)}else e.barcodeScanner.scan().then(n=>{!n||!n.text||e.checkBarcodeScaned(n.text,!1)})})()}checkBarcodeScaned(e,n){var i=this;this.productService.searchByBarcode(e).then(function(){var a=(0,u.Z)(function*(c){if(c){if(i.outStock&&c.count<=0)return i.analyticsService.logEvent("quote-add-outstock-alert"),void alert(i.translateService.instant("quote-add.outstock-alert"));i.analyticsService.logEvent("quote-add-scan-from-"+(n?"web":"mobile")+"-ok"),i.addProduct(c),i.barcodeFocus()}});return function(c){return a.apply(this,arguments)}}())}checkContactBarcodeScaned(e){var n=this;this.contactService.get(+e).then(function(){var i=(0,u.Z)(function*(a){!a||(n.analyticsService.logEvent("quote-add-scan-contact-ok"),n.contactSelected=a)});return function(a){return i.apply(this,arguments)}}())}increase(e){var n=this;return(0,u.Z)(function*(){n.analyticsService.logEvent("quote-add-increase"),e.count++,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),n.reCalc(e),n.barcodeFocus()})()}decrease(e){var n=this;return(0,u.Z)(function*(){e&&0===e.count||(n.analyticsService.logEvent("quote-add-decrease"),e.count--,e.discountPercent&&(e.discount=e.price*e.count*e.discountPercent/100),n.reCalc(e),n.barcodeFocus())})()}showOptions(e){var n=this;return(0,u.Z)(function*(){const i={};i.price=e.price,i.id=e.productId,i.code=e.productCode,i.title=e.productName,i.avatarUrl=e.productAvatar,i.unit=e.unit,i.count=e.count,i.options=e.options,i.total=e.total,i.attributes=e.attributes,n.analyticsService.logEvent("quote-add-show-options"),yield n.navCtrl.push("/quote/option-selector",{callback:c=>{c&&(e.options=c.options,e.attributes=c.attributes,n.reCalc(e))},mainProduct:JSON.parse(JSON.stringify(i))})})()}getAttributesString(e){return h.W.getAttributesString(e)}hasOptionsOrAttributes(e){return h.W.hasOptionsOrAttributes(e)}goHelpPage(e){this.navCtrl.push("/help/"+e)}taxTypeToRate(){return 0===this.quote.taxType?0:.05*((10!==this.quote.taxType?this.quote.taxType:.6)-1)+.1}taxTypeChanged(e=!1){var n=this;return(0,u.Z)(function*(){if(!n.noPrompt&&e&&(yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("quote-add.save-tax-type-alert"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,u.Z)(function*(){yield n.storage.set("tax-type",n.quote.taxType+"")}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("quote-add.save-tax-type-only-one"),handler:()=>{}}]})).present(),n.analyticsService.logEvent("quote-add-tax-type-changed")),0===n.quote.taxType)return n.quote.tax=0,void n.reCalcTotal();var a;n.quote.tax=n.taxTypeToRate()*n.quote.netValue,n.reCalcTotal()})()}openTaxType(){this.analyticsService.logEvent("quote-add-tax-type-open"),this.selectTax.open()}openProductDiscountPercent(e){var n=this;return(0,u.Z)(function*(){var a;yield(yield n.alertCtrl.create({message:n.translateService.instant("quote-add.discount-percent-message"),inputs:[{name:"discountPercent",placeholder:n.translateService.instant("quote-add.enter-discount-percent"),type:"number",min:0,max:100,value:e.discountPercent}],buttons:[{text:n.translateService.instant("quote-add.remove-percent"),handler:()=>{e.discountPercent=0,e.discount=0,n.reCalc(e)}},{text:n.translateService.instant("common.agree"),handler:(a=(0,u.Z)(function*(c){if(!c)return;const d=+c.discountPercent;d<0||d>100?alert(n.translateService.instant("quote-add.discount-percent-not-valid")):(n.analyticsService.logEvent("quote-add-change-discount-percent"),d&&(e.discountPercent=d,e.discount=e.price*e.count*d/100,n.reCalc(e)))}),function(d){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}openDiscountPercent(){var e=this;return(0,u.Z)(function*(){var i;yield(yield e.alertCtrl.create({message:e.translateService.instant("quote-add.discount-percent-message"),inputs:[{name:"discountPercent",placeholder:e.translateService.instant("quote-add.enter-discount-percent"),type:"number",min:0,max:100}],buttons:[{text:e.translateService.instant("quote-add.remove-percent"),handler:()=>{e.discountPercent=0,e.applyItemTotal()}},{text:e.translateService.instant("common.agree"),handler:(i=(0,u.Z)(function*(a){if(!a)return;const c=+a.discountPercent;c<0||c>100?alert(e.translateService.instant("quote-add.discount-percent-not-valid")):(e.analyticsService.logEvent("quote-add-change-discount-percent"),e.discountPercent=c,e.applyItemTotal())}),function(c){return i.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}getTypeAttributesString(e){return h.W.getTypeAttributesString(e)}showTypes(e){var n=this;return(0,u.Z)(function*(){n.analyticsService.logEvent("quote-add-show-types");const i={};i.price=e.price,i.id=e.productId,i.code=e.productCode,i.title=e.productName,i.avatarUrl=e.productAvatar,i.unit=e.unit,i.count=e.count,i.options=e.options,i.total=e.total,i.types=e.types,i.typeOptions=e.typeOptions,i.typeAttributes=e.typeAttributes,i.initPrice=e.initPrice;const c=JSON.parse(JSON.stringify(i));c.price=i.initPrice?i.initPrice:i.price,c.changedPrice=0,yield n.navCtrl.push("/product/type-selector",{callback:d=>{d&&(e.types=d.types,e.typeOptions=n.getTypeOptions(d.types),e.typeAttributes=n.getTypeAttributesString(e),e.initPrice=d.initPrice,e.price=d.price?d.price:e.initPrice,n.reCalc(e))},mainProduct:c})})()}getTypeOptions(e){return h.W.getTypeOptions(e)}hideNoProductDescription(){var e=this;return(0,u.Z)(function*(){e.isHideNoProductDescription=!0,yield e.storage.set("hide-no-product","1")})()}changePhone(){var e=this;return(0,u.Z)(function*(){if(e.contactSelected||!e.quote.contactPhone)return;const n=yield e.contactService.searchContactByPhone(e.quote.contactPhone);if(n){const i=e.translateService.instant("quote-add.found-phone",{contact:n.fullName,mobile:n.mobile});confirm(i)&&(e.contactSelected=n,e.quote.contactId=n.id,e.quote.contactName=n?n.fullName:null,e.quote.contactPhone=n?n.mobile:null,e.quote.contactAddress=n?n.address:null)}})()}spendAll(){!this.contactSelected||!this.contactSelected.point||(this.quote.pointAmount=this.contactSelected.point)}clearAll(){this.quote.pointAmount=null}changeUsePointPayment(){this.quote.amountFromPoint=0,this.quote.pointPaymentExchange=0,this.quote.pointAmount=0,this.reCalcTotal()}scanContact(){var e=this;return(0,u.Z)(function*(){if(e.analyticsService.logEvent("quote-add-scan-contact-barcode"),e.navCtrl.isNotCordova()){const n=yield e.modalCtrl.create({component:v.k});yield n.present();const{data:i}=yield n.onDidDismiss();i&&i.barcode&&e.checkContactBarcodeScaned(i.barcode)}else e.barcodeScanner.scan().then(n=>{!n||!n.text||e.checkContactBarcodeScaned(n.text)})})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(C.m),t.Y36(x.y),t.Y36(w.M),t.Y36(B.D),t.Y36(H.x),t.Y36(K.H),t.Y36(L.P),t.Y36(T.sK),t.Y36($.K),t.Y36(l.yF),t.Y36(st.X),t.Y36(l.Br),t.Y36(l.IN),t.Y36(z.G),t.Y36(tt.V),t.Y36(et.d),t.Y36(W.y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["quote-add"]],viewQuery:function(e,n){if(1&e&&(t.Gf(dt,5),t.Gf(pt,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.selectTax=i.first),t.iGM(i=t.CRH())&&(n.barcodeInput=i.first)}},decls:76,vars:60,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"disabled","click"],["name","checkmark"],[2,"padding","0 !important","margin","0 !important"],["size","12","size-sm",""],["color","primary"],["clearInput","","type","text",3,"ngModel","placeholder","ngModelChange"],["position","stacked","color","primary"],["type","datetime-local","pickerId","quoteAddPicker","min","2015-01-01","max","2025-12-31",3,"date","dateChange"],[4,"ngIf"],["color","light"],["color","primary",1,"ion-text-wrap"],["fill","clear","color","primary",3,"click"],["name","add"],["name","barcode"],["clearInput","","autofocus","true","type","text",3,"placeholder","ngModel","ngModelChange"],["barcodeInput",""],["color","light",1,"ion-text-wrap",3,"hidden"],["style","padding-top: 5px; padding-bottom: 5px;",3,"innerHTML",4,"ngIf"],["size","small","fill","clear","slot","end",3,"click",4,"ngIf"],[1,"ion-text-wrap",3,"ngModel","scrollable","ngModelChange"],["value","payment",1,"ion-text-wrap",2,"font-size","1em","padding","3px"],["value","contact",1,"ion-text-wrap",2,"font-size","1em","padding","3px"],["value","note",1,"ion-text-wrap",2,"font-size","1em","padding","3px"],["class","ion-no-padding","style","padding-top: 0px !important; padding-bottom: 0px !important; ",4,"ngIf"],["style","padding-top: 0px !important; padding-bottom: 0px !important; ",4,"ngIf"],["lines","none",4,"ngIf"],[1,"ion-padding",2,"padding-top","0 !important"],["position","stacked","color","primary",1,"ion-text-wrap"],["color","dark","size","small",3,"click",4,"ngIf"],["size","small",3,"click",4,"ngIf"],["color","dark","size","small",3,"click"],["size","small",3,"click"],["slot","icon-only","name","close"],[4,"ngFor","ngForOf"],["text-wrap","","lines","none","color","light",2,"--min-height","0"],["size","xs",3,"icon"],[2,"padding","0","margin","0",3,"click"],["slot","end",2,"padding","0","margin","0"],["fill","clear","size","large",2,"padding","0","margin","0",3,"click"],["slot","icon-only","size","large","name","remove"],["fill","clear","size","large",3,"click"],["slot","icon-only","size","large","name","add"],["fill","clear","size","small","color","medium",3,"click"],["slot","icon-only","size","small","name","options"],["slot","icon-only","size","small","name","cog"],["text-wrap","","color","light",2,"--min-height","0",3,"lines"],["slot","end",2,"--padding-bottom","0","--padding-top","0","height","20px","--padding-start","0","--padding-end","0"],["color","danger","fill","clear","size","small",2,"--padding-bottom","0","--padding-top","0","height","20px","--padding-start","0","--padding-end","0",3,"click"],["slot","icon-only","size","small","name","close"],["color","light",2,"padding-left","15px","padding-right","15px","margin","0",3,"hidden"],[3,"clear","placeholder","moneyValue","moneyValueChange"],["clearInput","","type","number",3,"placeholder","ngModel","ngModelChange","focus"],[1,"ion-text-nowrap",2,"margin-left","3px","margin-top","3px","font-size","0.7em","background-color","#3880ff","color","white","padding","3px","border-radius","5px","font-weight","bold",3,"click"],[2,"padding","0","margin","0","font-size","0.68em"],["style","padding: 0; margin: 0; font-size: 0.68em;",4,"ngFor","ngForOf"],["lines","inset","color","light",2,"--min-height","0"],[1,"ion-text-wrap",2,"font-size","0.8em"],["style","padding: 0; margin: 0",4,"ngIf"],[2,"padding","0","margin","0"],["style","padding: 0; margin: 0",4,"ngFor","ngForOf"],[2,"padding-top","5px","padding-bottom","5px",3,"innerHTML"],["size","small","fill","clear","slot","end",3,"click"],[1,"ion-no-padding",2,"padding-top","0px !important","padding-bottom","0px !important"],["lines","none"],["slot","end","ion-text","","color","dark",3,"click",4,"ngIf"],["slot","end","color","secondary",3,"click",4,"ngIf"],["slot","end",3,"click",4,"ngIf"],["slot","end","fill","clear",3,"click",4,"ngIf"],["lines","none","style","--padding-top: 5px; --min-height: 0;",4,"ngIf"],["slot","end","ion-text","","color","dark",3,"click"],["slot","end","color","secondary",3,"click"],["slot","end",3,"click"],["slot","end","fill","clear",3,"click"],["lines","none",2,"--padding-top","5px","--min-height","0"],["color","danger",2,"font-size","0.8em"],[2,"padding-top","0px !important","padding-bottom","0px !important"],["clearInput","","type","text","placeholder","Vd: John London",2,"background-color","#efefef","border-radius","5px","color","#000",3,"ngModel","ngModelChange"],["debounce","700","clearInput","","type","tel","placeholder","Vd: 09123456789",2,"background-color","#efefef","border-radius","5px","color","#000",3,"ngModel","ngModelChange"],["clearInput","","type","text","placeholder","Vd: London, UK",2,"background-color","#efefef","border-radius","5px","color","#000",3,"ngModel","ngModelChange"],[2,"padding-top","0px !important"],["clearInput","",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange"],["position","stacked","color","danger"],[3,"placeholder","moneyValue","moneyValueChange"],[1,"ion-float-right",2,"font-style","italic","font-size","0.8em"],["size","4"],["position","stacked","color","dark",2,"font-weight","bold","font-size","0.8em"],[3,"moneyValue","disabled","moneyValueChange"],["position","stacked","color","primary",2,"font-weight","bold","font-size","0.8em"],[3,"ngModel","ngModelChange","ionChange"],["position","stacked","color","secondary"],[1,"ion-no-padding"],["size","9",1,"ion-no-padding"],["size","3",1,"ion-no-padding"],[2,"margin-left","3px","margin-top","3px","font-size","0.5em","background-color","#efefef","color","#886aea","padding","3px","border-radius","5px","font-weight","bold",3,"hidden","ngModel","ionChange","ngModelChange"],["selectTax",""],[3,"value"],["position","stacked","color","warning"],["style","font-size: 0.65em; padding: 0; margin: 0",4,"ngIf"],[3,"disabled","moneyValue","moneyValueChange"],[2,"font-size","0.8em"],["clearInput","","type","number","type","text",2,"background-color","#efefef","border-radius","5px","color","#000",3,"ngModel","ngModelChange","ionChange"],["color","secondary","size","small",3,"click"],[2,"font-size","0.65em","padding","0","margin","0"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return n.save()}),t._UZ(9,"ion-icon",4),t._uU(10),t.ALo(11,"translate"),t.qZA()()()(),t.TgZ(12,"ion-content")(13,"ion-grid",5)(14,"ion-row")(15,"ion-col",6)(16,"ion-grid")(17,"ion-row")(18,"ion-col")(19,"ion-label",7),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"ion-input",8),t.NdJ("ngModelChange",function(a){return n.quote.name=a}),t.ALo(23,"translate"),t.qZA()(),t.TgZ(24,"ion-col")(25,"ion-label",9),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div")(29,"date-picker",10),t.NdJ("dateChange",function(a){return n.quote.createdAt=a}),t.qZA()()()(),t.TgZ(30,"ion-row"),t.YNc(31,ht,7,6,"ion-col",11),t.qZA()(),t.TgZ(32,"ion-list")(33,"ion-item-divider",12),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.TgZ(36,"ion-item",12)(37,"ion-text",13),t._uU(38),t.ALo(39,"translate"),t.ALo(40,"translate"),t.qZA(),t.TgZ(41,"ion-buttons")(42,"ion-button",14),t.NdJ("click",function(){return n.showProductSelector()}),t._UZ(43,"ion-icon",15),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"ion-button",14),t.NdJ("click",function(){return n.scan()}),t._UZ(47,"ion-icon",16),t._uU(48),t.ALo(49,"translate"),t.qZA()()(),t.TgZ(50,"ion-item",12)(51,"ion-input",17,18),t.NdJ("ngModelChange",function(a){return n.barcode=a})("ngModelChange",function(){return n.barcodeChanged()}),t.ALo(53,"translate"),t.qZA()(),t.YNc(54,Ut,2,1,"ng-container",11),t.qZA(),t.TgZ(55,"ion-item",19),t.YNc(56,It,2,3,"div",20),t.YNc(57,Nt,2,3,"div",20),t.YNc(58,Pt,2,0,"ion-button",21),t.qZA()(),t.TgZ(59,"ion-col",6)(60,"ion-segment",22),t.NdJ("ngModelChange",function(a){return n.tab=a}),t.TgZ(61,"ion-segment-button",23),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.TgZ(64,"ion-segment-button",24),t._uU(65),t.ALo(66,"translate"),t.qZA(),t.TgZ(67,"ion-segment-button",25),t._uU(68),t.ALo(69,"translate"),t.qZA()(),t.YNc(70,Dt,10,8,"ion-list",26),t.YNc(71,Yt,18,12,"ion-grid",27),t.YNc(72,Et,6,4,"ion-list",28),t.YNc(73,Bt,16,14,"ion-list",28),t.qZA()()(),t.TgZ(74,"div",29),t._UZ(75,"support"),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,32,"quote-add.title")),t.xp6(3),t.Q6J("disabled",n.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(11,34,"action.save")," "),t.xp6(2),t.Akn(n.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(8),t.hij("",t.lcZ(21,36,"quote-add.name")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(23,38,"quote-add.enter-name")),t.Q6J("ngModel",n.quote.name),t.xp6(4),t.hij("",t.lcZ(27,40,"quote-add.quote-date")," "),t.xp6(3),t.Q6J("date",n.quote.createdAt),t.xp6(2),t.Q6J("ngIf",null===n.staffService.selectedStaff||n.staffService.selectedStaff.hasFullAccess),t.xp6(3),t.hij(" ",t.lcZ(35,42,"quote-add.product")," "),t.xp6(4),t.AsE("",t.lcZ(39,44,"quote-add.enter-barcode")," ",t.lcZ(40,46,"quote-add.or"),"..."),t.xp6(6),t.hij(" \xa0",t.lcZ(45,48,"quote-add.add-manual")," "),t.xp6(4),t.hij(" \xa0",t.lcZ(49,50,"quote-add.mobile-scan")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(53,52,"quote-add.enter-barcode-placeholder")),t.Q6J("ngModel",n.barcode),t.xp6(3),t.Q6J("ngIf",n.quote.items&&n.quote.items.length),t.xp6(1),t.Q6J("hidden",n.quote.items&&n.quote.items.length>0),t.xp6(1),t.Q6J("ngIf",!n.isHideNoProductDescription),t.xp6(1),t.Q6J("ngIf",n.isHideNoProductDescription),t.xp6(1),t.Q6J("ngIf",!n.isHideNoProductDescription),t.xp6(2),t.Q6J("ngModel",n.tab)("scrollable",!0),t.xp6(2),t.hij(" ",t.lcZ(63,54,"quote-add.payment")," "),t.xp6(3),t.hij(" ",t.lcZ(66,56,"quote-add.contact-info")," "),t.xp6(3),t.hij(" ",t.lcZ(69,58,"quote-add.note")," "),t.xp6(2),t.Q6J("ngIf","contact"===n.tab),t.xp6(1),t.Q6J("ngIf",!n.isCollapsed&&"contact"===n.tab),t.xp6(1),t.Q6J("ngIf",!n.isCollapsed&&"note"===n.tab),t.xp6(1),t.Q6J("ngIf","payment"===n.tab))},dependencies:[p.sg,p.O5,s.JJ,s.On,l.oU,l.YG,l.Sm,l.wI,l.W2,l.jY,l.Gu,l.gu,l.pK,l.Ie,l.rH,l.Q$,l.q_,l.Nd,l.cJ,l.GO,l.t9,l.n0,l.yW,l.g2,l.wd,l.ho,l.sr,l.w,l.as,l.QI,l.j9,l.cs,at.Y,lt.F,ut.L,P.BN,p.H9,T.X$],encapsulation:2}),o})();var nt=_(7060),rt=_(4433),$t=_(6861),zt=_(666);function Wt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item",24)(1,"ion-label",25),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exitStore())}),t._UZ(5,"ion-icon",27),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function Rt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",28)(1,"p",29),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.navCtrl.push("/request-pro"))}),t._UZ(5,"ion-icon",31),t._uU(6),t.ALo(7,"translate"),t.qZA()()}2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"quote.no-pro-plan")),t.xp6(4),t.hij("\xa0 ",t.lcZ(7,4,"home.request-pro-plan")," "))}function Xt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-buttons",0)(1,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showSelect())}),t._UZ(2,"ion-icon",33),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"product-detail.multi-select")," "))}function te(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-buttons",0)(1,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.multiDelete())}),t._uU(2),t.ALo(3,"translate"),t._UZ(4,"ion-icon",35),t.qZA(),t.TgZ(5,"ion-button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exitSelectMode())}),t._uU(6),t.ALo(7,"translate"),t._UZ(8,"ion-icon",36),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"product-detail.delete-multi")," "),t.xp6(4),t.hij(" ",t.lcZ(7,4,"product-detail.exit-select-mode")," "))}function ee(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",37)(1,"ion-label",38),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"ion-buttons",39)(6,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previousPage())}),t._UZ(7,"ion-icon",41),t.qZA(),t.TgZ(8,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.nextPage())}),t._UZ(9,"ion-icon",42),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,2,"common.page")," ",e.currentPage+1," ")}}function ne(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-checkbox",44),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.isSelectAll=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.selectAll())}),t.qZA(),t.TgZ(2,"ion-buttons")(3,"ion-button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.multiDelete())}),t._uU(4),t.ALo(5,"translate"),t._UZ(6,"ion-icon",35),t.qZA(),t.TgZ(7,"ion-button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.exitSelectMode())}),t._uU(8),t.ALo(9,"translate"),t._UZ(10,"ion-icon",36),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.isSelectAll),t.xp6(3),t.hij(" ",t.lcZ(5,3,"product-detail.delete-multi")," "),t.xp6(4),t.hij(" ",t.lcZ(9,5,"product-detail.exit-select-mode")," ")}}function oe(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"quote-list-item",45),t.NdJ("onPress",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.presentActionSheet(a))})("onClick",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectQuote(a.id))}),t.qZA()}if(2&o){const e=r.$implicit,n=t.oxw(2);t.Q6J("quote",e)("currency",n.currency)("showContact",!0)("selectMode",n.selectMode)("isSelected",e.isSelected)}}function ie(o,r){if(1&o&&(t.ynx(0),t.YNc(1,ne,11,7,"ion-item",17),t.YNc(2,oe,1,5,"quote-list-item",43),t.ALo(3,"slice"),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(1),t.Q6J("ngForOf",t.Dn7(3,2,e.quotes,e.start,e.end+1))}}function ae(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",49)(1,"ion-checkbox",50),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.isSelectAll=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.selectAll())}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.isSelectAll)}}function re(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",49)(1,"ion-checkbox",50),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.isSelected=i)}),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.isSelected)}}const E=function(o,r,e){return[o,r,"symbol","1.0-2",e]};function ce(o,r){if(1&o&&(t.TgZ(0,"p",55)(1,"ion-text",56),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.ALo(5,"translate"),t.qZA()()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(2),t.HOy("",t.lcZ(3,4,"quote-add.pay-by-point"),": ",t.G7q(4,6,t.kEZ(14,E,e.amountFromPoint,n.currency,n.translateService.currentLang))," / ",e.pointAmount," ",t.lcZ(5,12,"point-add.point")," ")}}function se(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.contact.fullName,"")}}function le(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.contactName)}}function ue(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.contactPhone)}}function de(o,r){if(1&o&&(t.TgZ(0,"p",59),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.limitText(e.note)," ")}}function pe(o,r){if(1&o&&(t.TgZ(0,"p",60),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(5);t.xp6(1),t.HOy(" ",n.productName(e.productCode,e.productName)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,4,t.kEZ(10,E,e.price,n.currency,n.translateService.currentLang))," ")}}function _e(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",60)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,pe,3,14,"p",61),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.combo-products")),t.xp6(2),t.Q6J("ngForOf",e.items)}}function me(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(6);t.xp6(1),t.AsE(" | ",e.count," \xd7 ",t.G7q(2,2,t.kEZ(8,E,e.price,n.currency,n.translateService.currentLang)),"")}}function ge(o,r){1&o&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function he(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",62)(2,"ion-text",57),t._uU(3),t.YNc(4,me,3,12,"span",17),t._uU(5," | "),t.YNc(6,ge,2,0,"span",17),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(6);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(8,6,t.kEZ(12,E,e.total,n.currency,n.translateService.currentLang))," ")}}function fe(o,r){if(1&o&&(t.ynx(0),t.YNc(1,he,9,16,"ng-container",53),t.BQk()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngForOf",e.values)}}function xe(o,r){if(1&o&&(t.ynx(0),t.YNc(1,fe,2,1,"ng-container",53),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.typeOptions)}}function qe(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",62)(2,"ion-text",57),t._uU(3),t.ALo(4,"currency"),t.qZA()(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(5);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.xDo(" ",e.code?e.code.toUpperCase()+"-":"","",e.title," | ",e.count," ",e.unit," | ",t.G7q(4,7,t.kEZ(13,E,e.total,n.currency,n.translateService.currentLang))," ")}}function Ze(o,r){1&o&&(t.ynx(0),t.TgZ(1,"p",62)(2,"ion-text",57),t._uU(3," ... "),t.qZA()(),t.BQk()),2&o&&(t.xp6(2),t.Udp("font-weight","normal"))}function Ce(o,r){if(1&o&&(t.ynx(0),t.YNc(1,qe,5,17,"ng-container",53),t.ALo(2,"slice"),t.YNc(3,Ze,4,2,"ng-container",17),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.Dn7(2,2,e.options,0,2)),t.xp6(2),t.Q6J("ngIf",e.options.length>=3)}}function Ae(o,r){if(1&o&&(t.TgZ(0,"span")(1,"ion-text",57),t._uU(2),t.ALo(3,"currency"),t.YNc(4,de,2,1,"p",58),t.YNc(5,_e,6,4,"ng-container",17),t.YNc(6,xe,2,1,"ng-container",17),t.YNc(7,Ce,4,6,"ng-container",17),t.qZA(),t._UZ(8,"br"),t.qZA()),2&o){const e=r.$implicit,n=r.index,i=t.oxw(3);t.xp6(2),t.gL8(" ",n+1,".",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," | ",t.G7q(3,10,t.kEZ(16,E,e.total,i.currency,i.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",e.note),t.xp6(1),t.Q6J("ngIf",e.items&&e.items.length),t.xp6(1),t.Q6J("ngIf",e.typeOptions&&e.typeOptions.length),t.xp6(1),t.Q6J("ngIf",e.options&&e.options.length)}}function ye(o,r){1&o&&(t.TgZ(0,"span")(1,"ion-text",57),t._uU(2,"..."),t.qZA()())}function Te(o,r){if(1&o&&(t.TgZ(0,"span",57),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.hij(" ",n.limitText(e.note)," ")}}function ve(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" - ",e.store.name,"")}}function be(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.YNc(2,ve,2,1,"span",17),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.staff.name,""),t.xp6(1),t.Q6J("ngIf",e.store)}}function Qe(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.store.name)}}function Se(o,r){if(1&o&&(t.TgZ(0,"p"),t.YNc(1,Qe,2,1,"span",17),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.store)}}function we(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-row",51),t.NdJ("press",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.presentActionSheet(a))})("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectQuote(a.id))}),t.YNc(1,re,2,1,"ion-col",47),t.TgZ(2,"ion-col"),t._uU(3),t.qZA(),t.TgZ(4,"ion-col"),t._uU(5),t.ALo(6,"currency"),t.YNc(7,ce,6,18,"p",52),t.qZA(),t.TgZ(8,"ion-col"),t.YNc(9,se,2,1,"p",17),t.YNc(10,le,2,1,"p",17),t.YNc(11,ue,2,1,"p",17),t.qZA(),t.TgZ(12,"ion-col"),t.YNc(13,Ae,9,20,"span",53),t.ALo(14,"slice"),t.YNc(15,ye,3,0,"span",17),t.qZA(),t.TgZ(16,"ion-col",25),t.YNc(17,Te,2,1,"span",54),t.qZA(),t.TgZ(18,"ion-col",25),t.YNc(19,be,3,2,"p",17),t.YNc(20,Se,2,1,"p",17),t.qZA(),t.TgZ(21,"ion-col",25),t._uU(22),t.qZA()()}if(2&o){const e=r.$implicit,n=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(1),t.Q6J("ngIf",n.selectMode),t.xp6(2),t.hij(" ",e.name," "),t.xp6(2),t.hij(" ",t.G7q(6,15,t.kEZ(25,E,e.total,n.currency,n.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",e.amountFromPoint&&e.pointAmount),t.xp6(2),t.Q6J("ngIf",e.contactId&&0!==e.contactId&&e.contact),t.xp6(1),t.Q6J("ngIf",!e.contactId&&e.contactName),t.xp6(1),t.Q6J("ngIf",!e.contactId&&e.contactPhone),t.xp6(2),t.Q6J("ngForOf",t.Dn7(14,21,e.items,0,2)),t.xp6(2),t.Q6J("ngIf",e.items.length>=3),t.xp6(2),t.Q6J("ngIf",e.note),t.xp6(2),t.Q6J("ngIf",e.staffId&&0!==e.staffId&&e.staff&&!n.staffService.isStaff()),t.xp6(1),t.Q6J("ngIf",!(e.staffId&&0!==e.staffId&&e.staff&&!n.staffService.isStaff())&&e.store),t.xp6(2),t.hij(" ",n.dateFormat(e.createdAt)," ")}}function Ue(o,r){if(1&o&&(t.TgZ(0,"ion-grid",46)(1,"ion-row",11),t.YNc(2,ae,2,1,"ion-col",47),t.TgZ(3,"ion-col")(4,"strong"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-col")(8,"strong"),t._uU(9),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"ion-col")(12,"strong"),t._uU(13),t.ALo(14,"translate"),t.qZA()(),t.TgZ(15,"ion-col")(16,"strong"),t._uU(17),t.ALo(18,"translate"),t.qZA()(),t.TgZ(19,"ion-col")(20,"strong"),t._uU(21),t.ALo(22,"translate"),t.qZA()(),t.TgZ(23,"ion-col")(24,"strong"),t._uU(25),t.ALo(26,"translate"),t.qZA()(),t.TgZ(27,"ion-col")(28,"strong"),t._uU(29),t.ALo(30,"translate"),t.qZA()()(),t.YNc(31,we,23,29,"ion-row",48),t.ALo(32,"slice"),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.selectMode),t.xp6(3),t.Oqu(t.lcZ(6,9,"quote-add.name")),t.xp6(4),t.Oqu(t.lcZ(10,11,"quote-add.total")),t.xp6(4),t.Oqu(t.lcZ(14,13,"quote-add.contact-info")),t.xp6(4),t.Oqu(t.lcZ(18,15,"quote-add.product")),t.xp6(4),t.Oqu(t.lcZ(22,17,"quote-add.note")),t.xp6(4),t.Oqu(t.lcZ(26,19,"trade.staff")),t.xp6(4),t.Oqu(t.lcZ(30,21,"quote.created-at")),t.xp6(2),t.Q6J("ngForOf",t.Dn7(32,23,e.quotes,e.start,e.end+1))}}function Ie(o,r){1&o&&(t.TgZ(0,"ion-item",63),t._UZ(1,"div",64),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"quote.no-quote"),t.oJD))}function Ne(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item",65)(1,"ion-label",66),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-buttons",67)(5,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previousPage())}),t._UZ(6,"ion-icon",41),t.qZA(),t.TgZ(7,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.nextPage())}),t._UZ(8,"ion-icon",42),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,2,"common.page")," ",e.currentPage+1," ")}}function Pe(o,r){1&o&&(t.TgZ(0,"div",68),t._UZ(1,"support"),t.qZA())}let Je=(()=>{class o{constructor(e,n,i,a,c,d,Z,f,m,A,U,F,G,M,j,ot){var g=this;this.platform=e,this.quoteService=n,this.translateService=i,this.userService=a,this.productService=c,this.barcodeScanner=d,this.excelService=Z,this.modalCtrl=f,this.actionSheetCtrl=m,this.alertCtrl=A,this.file=U,this.storeService=F,this.navCtrl=G,this.analyticsService=M,this.planService=j,this.staffService=ot,this.params=null,this.searchKey="",this.noteFilter="frequency",this.total=0,this.isMobile=!0,this.checkQuote=0,this.currentPlan=null,this.isOnTrial=!1,this.selectedStaff=null,this.start=0,this.pageSize=40,this.end=39,this.currentPage=0,this.selectMode=!1,this.isSelectAll=!1,this.reload=(0,u.Z)(function*(){const S=yield g.navCtrl.loading();g.isMobile=g.platform.width()<720,g.currency=yield g.userService.getAttr("current-currency"),g.currentPlan=yield g.planService.getCurrentPlan(),g.stores=yield g.storeService.getStores(),g.selectedStaff=g.staffService.selectedStaff,g.currentPlan||(g.isOnTrial=yield g.planService.isOnTrial(g.currentPlan)),g.params=g.navCtrl.getParams(g.params),g.params&&g.params.selectedStaff&&(g.selectedStaff=g.params.selectedStaff),g.params||(g.params={selectedStaff:null}),g.store=yield g.storeService.getCurrentStore(),g.checkStore=g.store?g.translateService.instant("store.check-store",{shop:g.store.name}):null,g.quoteService.getQuotes(g.selectedStaff?g.selectedStaff.id:null).then(function(){var R=(0,u.Z)(function*(X){const it=[];if(X&&X.length)for(const Y of X)Y.items=JSON.parse(Y.itemsJson),Y.store=!g.checkStore&&Y.storeId&&g.stores&&g.stores.length?g.stores.find(vo=>vo.id===Y.storeId):null,it.push(Y);g.originalQuotes=JSON.parse(JSON.stringify(it)),g.quotes=it,g.total=y.sumBy(g.quotes,Y=>Y.total),g.filter(),yield S.dismiss()});return function(X){return R.apply(this,arguments)}}()).catch((0,u.Z)(function*(){yield S.dismiss()}))}),this.doEnteredBarcode=S=>{!S||this.productService.searchByBarcode(S).then(R=>{if(R)return this.analyticsService.logEvent("quote-scan-barcode-ok"),void this.navCtrl.push("/quote/add",{product:R.id})})},this.navCtrl.removeEventListener("reloadQuoteList",this.reload),this.navCtrl.addEventListener("reloadQuoteList",this.reload)}ngOnInit(){this.platform.resize.subscribe(()=>{this.isMobile=this.platform.width()<720}),this.reload()}ionViewWillEnter(){var e=this;return(0,u.Z)(function*(){yield e.analyticsService.setCurrentScreen("quote")})()}openQuoteAdd(){if(!this.currentPlan&&!this.isOnTrial)return this.analyticsService.logEvent("check-quote-alert"),void alert(this.translateService.instant("quote.check-quote-alert",{total:this.checkQuote}));this.navCtrl.navigateForward("/quote/add",null)}search(){var e=this;return(0,u.Z)(function*(){e.analyticsService.logEvent("quote-search");let n=JSON.parse(JSON.stringify(e.originalQuotes));if(null!==e.searchKey&&""!==e.searchKey){e.start=0,e.end=e.pageSize-1,e.currentPage=0;const i=e.searchKey.toLowerCase();n=n.filter(a=>a.contact&&a.contact.fullName&&-1!==a.contact.fullName.toLowerCase().indexOf(i)||a.contact&&a.contact.mobile&&-1!==a.contact.mobile.toLowerCase().indexOf(i)||a.contactName&&-1!==a.contactName.toLowerCase().indexOf(i)||a.staff&&-1!==a.staff.name.toLowerCase().indexOf(i)||a.staff&&-1!==a.staff.userName.toLowerCase().indexOf(i)||a.store&&a.store.name&&-1!==a.store.name.toLowerCase().indexOf(i)||a.contactPhone&&-1!==a.contactPhone.toLowerCase().indexOf(i)||a.note&&-1!==a.note.toLowerCase().indexOf(i)||a.name&&-1!==a.name.toLowerCase().indexOf(i)||a.hasShipInfo&&a.billOfLadingCode&&-1!==a.billOfLadingCode.toLowerCase().indexOf(i)||a.hasShipInfo&&a.shippingPartner&&-1!==a.shippingPartner.toLowerCase().indexOf(i)||a.hasShipInfo&&a.shipperName&&-1!==a.shipperName.toLowerCase().indexOf(i)||a.hasShipInfo&&a.shipperPhone&&-1!==a.shipperPhone.toLowerCase().indexOf(i)||a.hasShipInfo&&a.deliveryAddress&&-1!==a.deliveryAddress.toLowerCase().indexOf(i)||a.items&&a.items.length&&a.items.filter(c=>c.productCode&&-1!==c.productCode.toLowerCase().indexOf(i)||c.productName&&-1!==c.productName.toLowerCase().indexOf(i)||c.note&&-1!==c.note.toLowerCase().indexOf(i)).length>0)}e.quotes=n,e.total=y.sumBy(e.quotes,i=>i.total)})()}clearSearch(){this.start=0,this.end=this.pageSize-1,this.currentPage=0,this.searchKey=null,this.reload()}filter(){let e=JSON.parse(JSON.stringify(this.originalQuotes));e=this.sortByModifiedAt(e),this.quotes=e}sortByModifiedAt(e){return e?y.orderBy(e,["createdAt"],["desc"]):null}dateOnlyFormat(e){return q.C.toUiDateString(e)}selectQuote(e){this.selectMode||this.navCtrl.navigateForward("/quote/detail",{id:e})}copyQuote(e){this.navCtrl.push("/quote/add",{quote:e,mode:"copy"})}deleteQuote(e){var n=this;return(0,u.Z)(function*(){var a;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("order.delete-alert"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,u.Z)(function*(){n.quoteService.delete(e).then((0,u.Z)(function*(){n.analyticsService.logEvent("order-delete-success");let c=n.quotes.findIndex(d=>d.id===e.id);c>=0&&(n.quotes.splice(c,1),n.total=y.sumBy(n.quotes,d=>d.total)),c=n.originalQuotes.findIndex(d=>d.id===e.id),c>=0&&n.originalQuotes.splice(c,1)}))}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}presentOtherActionSheet(){var e=this;return(0,u.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:e.translateService.instant("action.action"),buttons:[{text:e.translateService.instant("export.export-to-excel"),handler:()=>{e.exportExcel()}},{text:e.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}exportExcel(){var e=this;const n=[];n.push([this.translateService.instant("export.order-report")]),n.push([this.translateService.instant("common.total")+": "+this.total+" "+this.currency]),n.push([this.translateService.instant("export.order-code"),this.translateService.instant("export.contact"),this.translateService.instant("export.money"),this.translateService.instant("export.unit"),this.translateService.instant("export.date")]);for(const c of this.quotes)n.push([c.quoteCode,0!==c.contactId&&c.contact?c.contact.fullName:"",c.total,this.currency,this.dateFormat(c.createdAt)]);const i=this.excelService.createSheetData(n),a="order-report-"+h.W.getCurrentDate()+".xlsx";this.excelService.exportExcel(i,a).then(function(){var c=(0,u.Z)(function*(d){e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+e.file.externalDataDirectory+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFile(null,d))});return function(d){return c.apply(this,arguments)}}())}dateFormat(e){let n=e;return e.indexOf(":00Z")<0&&(n=J(e).format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(n)}presentActionSheet(e){var n=this;return(0,u.Z)(function*(){yield(yield n.actionSheetCtrl.create({header:n.translateService.instant("action.action"),buttons:[{text:n.translateService.instant("quote.delete-quote"),role:"destructive",handler:()=>{n.deleteQuote(e)}},{text:n.translateService.instant("quote.edit-quote"),handler:()=>{n.selectQuote(e.id)}},{text:n.translateService.instant("quote.copy"),handler:()=>{n.copyQuote(e)}},{text:n.translateService.instant("product-detail.multi-select"),handler:()=>{n.selectMode=!0}},{text:n.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}isNotCordova(){return this.navCtrl.isNotCordova()}scan(){var e=this;return(0,u.Z)(function*(){if(e.analyticsService.logEvent("quote-scan-barcode"),e.isNotCordova()){const n=yield e.modalCtrl.create({component:v.k});yield n.present();const{data:i}=yield n.onDidDismiss();i&&i.barcode&&e.doEnteredBarcode(i.barcode)}else e.barcodeScanner.scan().then(n=>{!n||!n.text||e.doEnteredBarcode(n.text)})})()}goHelpPage(e){this.navCtrl.push("/help/"+e)}requestProPlan(){this.navCtrl.push("/request-pro")}limitText(e,n=200){return h.W.limitText(e,n)}exitStore(){var e=this;return(0,u.Z)(function*(){var i;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(i=(0,u.Z)(function*(){yield e.storeService.exitStore(),yield e.reload()}),function(){return i.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}productName(e,n){return h.W.productName(e,n)}get isShowPaging(){return!!(this.quotes&&this.quotes.length>this.pageSize)}previousPage(){this.currentPage<=0?this.currentPage=0:(this.currentPage--,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.content.scrollToTop())}nextPage(){(this.currentPage+1)*this.pageSize>=this.quotes.length||(this.currentPage++,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.content.scrollToTop())}showSelect(){this.selectMode=!0,this.isSelectAll=!1}exitSelectMode(){this.selectMode=!1,this.isSelectAll=!1;for(const e of this.quotes)e.isSelected=!1}multiDelete(){var e=this;return(0,u.Z)(function*(){const n=e.quotes?e.quotes.filter(a=>a.isSelected).length:0;var a;0!==n?yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("quote-detail.multi-delete-alert",{count:n}),buttons:[{text:e.translateService.instant("common.agree"),handler:(a=(0,u.Z)(function*(){const c=yield e.navCtrl.loading(),d=[],Z=[];for(const f of e.quotes)f.isSelected&&(d.push(f),Z.push(e.quoteService.delete(f)));yield Promise.all(Z);for(const f of d){e.analyticsService.logEvent("quote-delete-success");let m=e.quotes.findIndex(A=>A.id===f.id);m>=0&&e.quotes.splice(m,1),m=e.originalQuotes.findIndex(A=>A.id===f.id),m>=0&&e.originalQuotes.splice(m,1)}e.selectMode=!1,yield c.dismiss()}),function(){return a.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present():alert(e.translateService.instant("quote-detail.multi-delete-no-quote-alert"))})()}selectAll(){for(const e of this.quotes)e.isSelected=!1;for(let e=this.start;e<this.end;e++)this.quotes[e].isSelected=this.isSelectAll}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.t4),t.Y36(L.P),t.Y36(T.sK),t.Y36($.K),t.Y36(w.M),t.Y36(C.m),t.Y36(nt.x),t.Y36(l.IN),t.Y36(l.BX),t.Y36(l.Br),t.Y36(rt.$),t.Y36(et.d),t.Y36(z.G),t.Y36(W.y),t.Y36($t.D),t.Y36(H.x))},o.\u0275cmp=t.Xpm({type:o,selectors:[["quote"]],viewQuery:function(e,n){if(1&e&&t.Gf(l.W2,7),2&e){let i;t.iGM(i=t.CRH())&&(n.content=i.first)}},decls:38,vars:26,consts:[["slot","start"],["menu","first"],["color","primary",3,"click"],["name","home"],["slot","end"],[3,"click"],["slot","icon-only","name","add-circle"],["slot","icon-only","name","ellipsis-vertical"],["lines","none","color","success",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["style","padding: 10px; margin: 10px; background-color: #f0ad4e; color: white; border-radius: 10px;",4,"ngIf"],[2,"border-bottom","1px solid #ccc"],[3,"size"],["lines","none",1,"ion-text-wrap","ion-no-padding"],["slot","start",4,"ngIf"],["color","primary"],["size","4","class","ion-text-right",4,"ngIf"],[4,"ngIf"],["class","ion-padding",4,"ngIf"],["text-wrap","","lines","none","style","padding-top: 10px;",4,"ngIf"],["class","ion-no-padding","lines","none",4,"ngIf"],["class","ion-padding","style","padding-top: 0 !important;",4,"ngIf"],["vertical","bottom","horizontal","start","slot","fixed"],["name","add"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],[2,"padding","10px","margin","10px","background-color","#f0ad4e","color","white","border-radius","10px"],[2,"margin","5px 5px 5px 5px"],["color","success","fill","solid",3,"click"],["name","gift","slot","start"],["color","primary","fill","clear",3,"click"],["slot","start","name","list-outline"],["color","danger",3,"click"],["name","trash","slot","end"],["name","exit-outline","slot","end"],["size","4",1,"ion-text-right"],[1,"ion-text-wrap","ion-text-right"],[1,"ion-float-right"],["fill","solid","size","small",3,"click"],["slot","icon-only","name","arrow-back-circle"],["slot","icon-only","name","arrow-forward-circle"],[3,"quote","currency","showContact","selectMode","isSelected","onPress","onClick",4,"ngFor","ngForOf"],["slot","start","color","primary",3,"ngModel","ngModelChange"],[3,"quote","currency","showContact","selectMode","isSelected","onPress","onClick"],[1,"ion-padding"],["size","auto",4,"ngIf"],["style","border-bottom: 1px solid #ccc;",3,"cursor","press","click",4,"ngFor","ngForOf"],["size","auto"],["color","primary",3,"ngModel","ngModelChange"],[2,"border-bottom","1px solid #ccc",3,"press","click"],["style","padding: 0; margin: 0; font-size: 0.8em;",4,"ngIf"],[4,"ngFor","ngForOf"],["style","font-size: 0.8em;",4,"ngIf"],[2,"padding","0","margin","0","font-size","0.8em"],["color","secondary"],[2,"font-size","0.8em"],["style","font-size: 0.8em; margin: 3px 0 0 0;",4,"ngIf"],[2,"font-size","0.8em","margin","3px 0 0 0"],[2,"padding","0","margin","0","font-size","0.68em"],["style","padding: 0; margin: 0; font-size: 0.68em;",4,"ngFor","ngForOf"],[2,"padding","0","margin","0"],["text-wrap","","lines","none",2,"padding-top","10px"],[3,"innerHTML"],["lines","none",1,"ion-no-padding"],["slot","end",1,"ion-text-right"],["slot","end",1,"ion-float-right"],[1,"ion-padding",2,"padding-top","0 !important"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-menu-button",1),t.TgZ(4,"ion-button",2),t.NdJ("click",function(){return n.navCtrl.home()}),t._UZ(5,"ion-icon",3),t.qZA()(),t.TgZ(6,"ion-title"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"ion-buttons",4)(10,"ion-button",5),t.NdJ("click",function(){return n.openQuoteAdd()}),t._UZ(11,"ion-icon",6),t.qZA(),t.TgZ(12,"ion-button",2),t.NdJ("click",function(){return n.presentOtherActionSheet()}),t._UZ(13,"ion-icon",7),t.qZA()()(),t.YNc(14,Wt,8,4,"ion-item",8),t.TgZ(15,"ion-searchbar",9),t.NdJ("ionClear",function(){return n.clearSearch()})("ionChange",function(){return n.search()})("ngModelChange",function(a){return n.searchKey=a}),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"ion-content"),t.YNc(18,Rt,8,6,"div",10),t.TgZ(19,"ion-list")(20,"ion-grid")(21,"ion-row",11)(22,"ion-col",12)(23,"ion-item",13),t.YNc(24,Xt,5,3,"ion-buttons",14),t.YNc(25,te,9,6,"ion-buttons",14),t.TgZ(26,"ion-label",15),t._uU(27),t.ALo(28,"translate"),t.qZA()()(),t.YNc(29,ee,10,4,"ion-col",16),t.qZA()(),t.YNc(30,ie,4,6,"ng-container",17),t.YNc(31,Ue,33,27,"ion-grid",18),t.YNc(32,Ie,3,3,"ion-item",19),t.YNc(33,Ne,9,4,"ion-item",20),t.qZA(),t.YNc(34,Pe,2,0,"div",21),t.TgZ(35,"ion-fab",22)(36,"ion-fab-button",5),t.NdJ("click",function(){return n.openQuoteAdd()}),t._UZ(37,"ion-icon",23),t.qZA()()()),2&e&&(t.xp6(7),t.Oqu(t.lcZ(8,20,"quote.title")),t.xp6(7),t.Q6J("ngIf",n.checkStore&&(null===n.selectedStaff||n.selectedStaff.hasFullAccess&&!n.selectedStaff.storeId)),t.xp6(1),t.s9C("placeholder",t.lcZ(16,22,"quote.search")),t.Q6J("ngModel",n.searchKey),t.xp6(2),t.Akn(n.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.Q6J("ngIf",!n.currentPlan&&!n.isOnTrial),t.xp6(4),t.Q6J("size",n.isShowPaging&&n.quotes&&n.quotes.length?8:12),t.xp6(2),t.Q6J("ngIf",!n.selectMode&&!n.isMobile),t.xp6(1),t.Q6J("ngIf",n.selectMode&&!n.isMobile),t.xp6(2),t.AsE(" ",n.quotes&&n.quotes.length?n.quotes.length:0," ",t.lcZ(28,24,"quote.quote(s)")," "),t.xp6(2),t.Q6J("ngIf",n.isShowPaging&&n.quotes&&n.quotes.length),t.xp6(1),t.Q6J("ngIf",n.isMobile),t.xp6(1),t.Q6J("ngIf",!n.isMobile&&n.quotes&&n.quotes.length),t.xp6(1),t.Q6J("ngIf",!n.originalQuotes||0===n.originalQuotes.length),t.xp6(1),t.Q6J("ngIf",n.isShowPaging&&n.quotes&&n.quotes.length),t.xp6(1),t.Q6J("ngIf",!n.originalQuotes||0===n.originalQuotes.length),t.xp6(1),t.Akn(n.navCtrl.hasAds()?"margin-bottom: 60px":""))},dependencies:[p.sg,p.O5,s.JJ,s.On,l.YG,l.Sm,l.nz,l.wI,l.W2,l.IJ,l.W4,l.jY,l.Gu,l.gu,l.Ie,l.Q$,l.q_,l.fG,l.Nd,l.VI,l.yW,l.wd,l.sr,l.w,l.j9,zt.p,at.Y,p.OU,p.H9,T.X$],encapsulation:2}),o})();var Le=_(9854);function Me(o,r){if(1&o&&(t.TgZ(0,"ion-col",7)(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"ion-text"),t._uU(6),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,2,"trade.staff")),t.xp6(4),t.Oqu(e.quote.staff.name)}}function ke(o,r){1&o&&(t.TgZ(0,"ion-item-divider",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"quote-add.contact-info")," "))}function Oe(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.quote.contact.address)}}function De(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item-sliding")(1,"ion-item",23)(2,"ion-avatar",0),t._UZ(3,"img",24),t.qZA(),t.TgZ(4,"ion-label")(5,"h2")(6,"b"),t._uU(7),t.qZA()(),t.TgZ(8,"p"),t._uU(9),t.qZA(),t.YNc(10,Oe,2,1,"p",16),t.qZA(),t.TgZ(11,"ion-icon",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copy(i.quote.contact.fullName+(i.quote.contact.mobile?"\n"+i.quote.contact.mobile:"")+(i.quote.contact.address?"\n"+i.quote.contact.address:"")))}),t.qZA()(),t.TgZ(12,"ion-item-options",26)(13,"ion-item-option",3),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.text())}),t._UZ(14,"ion-icon",27),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ion-item-option",28),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.call())}),t._UZ(18,"ion-icon",29),t._uU(19),t.ALo(20,"translate"),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(3),t.Q6J("src",e.contactImageOrPlaceholder(),t.LSH),t.xp6(4),t.Oqu(e.quote.contact.fullName),t.xp6(2),t.Oqu(e.quote.contact.mobile),t.xp6(1),t.Q6J("ngIf",e.quote.contact.address),t.xp6(5),t.hij(" ",t.lcZ(16,6,"action.text")," "),t.xp6(4),t.hij(" ",t.lcZ(20,8,"action.call")," ")}}function Ye(o,r){if(1&o&&(t.TgZ(0,"h2")(1,"b"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(e.quote.contactName)}}function Ee(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.quote.contactPhone)}}function Fe(o,r){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.quote.contactAddress)}}function He(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item",23)(1,"ion-label"),t.YNc(2,Ye,3,1,"h2",16),t.YNc(3,Ee,2,1,"p",16),t.YNc(4,Fe,2,1,"p",16),t.qZA(),t.TgZ(5,"ion-icon",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copy(i.quote.contactName+(i.quote.contactPhone?"\n"+i.quote.contactPhone:"")+(i.quote.contactAddress?"\n"+i.quote.contactAddress:"")))}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.quote.contactName),t.xp6(1),t.Q6J("ngIf",e.quote.contactPhone),t.xp6(1),t.Q6J("ngIf",e.quote.contactAddress)}}function Ge(o,r){if(1&o&&(t.TgZ(0,"p",34),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.note)}}function je(o,r){if(1&o&&(t.TgZ(0,"p",37)(1,"ion-text"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getTypeAttributesString(e)," ")}}function Ve(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",37)(2,"ion-text"),t._uU(3),t.qZA()(),t.BQk()),2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getAttributesString(e)," ")}}const b=function(o,r,e){return[o,r,"symbol","1.0-2",e]};function Be(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.AsE(" | ",e.count," \xd7 ",t.G7q(2,2,t.kEZ(8,b,e.price,n.currency,n.translateService.currentLang)),"")}}function Ke(o,r){1&o&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function $e(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",37)(2,"ion-text"),t._uU(3),t.YNc(4,Be,3,12,"span",16),t._uU(5," | "),t.YNc(6,Ke,2,0,"span",16),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(4);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(8,6,t.kEZ(12,b,e.total,n.currency,n.translateService.currentLang))," ")}}function ze(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",37)(2,"ion-text")(3,"strong"),t._uU(4),t.qZA()()(),t.YNc(5,$e,9,16,"ng-container",20),t.BQk()),2&o){const e=r.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngForOf",e.values)}}function We(o,r){if(1&o&&(t.TgZ(0,"p",37),t._uU(1),t.ALo(2,"currency"),t.ALo(3,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(4);t.xp6(1),t.xDo(" ",n.productName(e.code,e.title)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,5,t.kEZ(17,b,e.price,n.currency,n.translateService.currentLang))," | +",t.G7q(3,11,t.kEZ(21,b,e.total,n.currency,n.translateService.currentLang))," ")}}function Re(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",37)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,We,4,25,"p",38),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.added-products")),t.xp6(2),t.Q6J("ngForOf",e.options)}}function Xe(o,r){if(1&o&&(t.TgZ(0,"ion-text",35),t.YNc(1,je,3,3,"p",36),t.YNc(2,Ve,4,3,"ng-container",16),t.YNc(3,ze,6,2,"ng-container",20),t.YNc(4,Re,6,4,"ng-container",16),t.qZA()),2&o){const e=t.oxw().$implicit;t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.typeAttributes&&e.typeAttributes.length),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.typeOptions),t.xp6(1),t.Q6J("ngIf",e.options&&e.options.length)}}function tn(o,r){if(1&o&&(t.TgZ(0,"p",39),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(3);t.xp6(1),t.HOy(" ",n.productName(e.productCode,e.productName)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,4,t.kEZ(10,b,e.price,n.currency,n.translateService.currentLang))," ")}}function en(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",39)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,tn,3,14,"p",40),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.combo-products")),t.xp6(2),t.Q6J("ngForOf",e.items)}}function nn(o,r){if(1&o&&(t.TgZ(0,"ion-thumbnail",2),t._UZ(1,"img",24),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.productAvatar,t.LSH)}}function on(o,r){if(1&o&&(t.TgZ(0,"span",41),t._UZ(1,"br"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,2,"quote-add.product-discount-short"),": -",t.G7q(4,4,t.kEZ(10,b,e.discount,n.currency,n.translateService.currentLang)),"")}}function an(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",21),t._uU(2),t.ALo(3,"currency"),t.YNc(4,Ge,2,1,"p",30),t.YNc(5,Xe,5,6,"ion-text",31),t.YNc(6,en,6,4,"ng-container",16),t.qZA(),t.YNc(7,nn,2,1,"ion-thumbnail",32),t.TgZ(8,"ion-text",22),t._uU(9),t.ALo(10,"currency"),t.YNc(11,on,5,14,"span",33),t.qZA()()),2&o){const e=r.$implicit,n=r.index,i=t.oxw();t.xp6(2),t.xDo(" ",n+1,". ",i.productName(e.productCode,e.productName)," | ",e.count," ",e.unit," \xd7 ",t.G7q(3,11,t.kEZ(23,b,e.price+i.getOptionPrices(e),i.currency,i.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",e.note),t.xp6(1),t.Q6J("ngIf",i.hasOptionsOrAttributes(e)),t.xp6(1),t.Q6J("ngIf",e.items&&e.items.length),t.xp6(1),t.Q6J("ngIf",e.productAvatar),t.xp6(2),t.hij("+",t.G7q(10,17,t.kEZ(27,b,e.total,i.currency,i.translateService.currentLang)),""),t.xp6(2),t.Q6J("ngIf",e.discount)}}function rn(o,r){1&o&&(t.TgZ(0,"ion-item-divider",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"quote-add.note")," "))}function cn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text"),t._uU(2),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.quote.note)}}function sn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",42),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.discount"),":"),t.xp6(3),t.hij("-",t.G7q(6,4,t.kEZ(10,b,e.quote.discountOnTotal,e.currency,e.translateService.currentLang)),"")}}function ln(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",43)(2,"b"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"span",2),t._uU(6),t.ALo(7,"currency"),t.ALo(8,"translate"),t.qZA()()),2&o){const e=t.oxw();t.xp6(3),t.hij("",t.lcZ(4,4,"quote-add.pay-by-point"),":"),t.xp6(3),t.lnq("-",t.G7q(7,6,t.kEZ(14,b,e.quote.amountFromPoint,e.currency,e.translateService.currentLang))," (",e.quote.pointAmount," ",t.lcZ(8,12,"point-add.point"),")")}}function un(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.tax"),":"),t.xp6(3),t.hij("+",t.G7q(6,4,t.kEZ(10,b,e.quote.tax,e.currency,e.translateService.currentLang)),"")}}function dn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.shipping-fee"),":"),t.xp6(3),t.hij("+",t.G7q(6,4,t.kEZ(10,b,e.quote.shippingFee,e.currency,e.translateService.currentLang)),"")}}function pn(o,r){1&o&&(t.TgZ(0,"ion-item-divider",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"quote-add.shipping")," "))}function _n(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.bill-of-lading-code"),":"),t.xp6(3),t.Oqu(e.quote.billOfLadingCode)}}function mn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.shipping-partner"),":"),t.xp6(3),t.Oqu(e.quote.shippingPartner)}}function gn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.shipper-name"),":"),t.xp6(3),t.Oqu(e.quote.shipperName)}}function hn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.shipper-phone"),":"),t.xp6(3),t.Oqu(e.quote.shipperPhone)}}function fn(o,r){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-text",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",2),t._uU(5),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"quote-add.delivery-address"),":"),t.xp6(3),t.Oqu(e.quote.deliveryAddress)}}let xn=(()=>{class o{constructor(e,n,i,a,c,d,Z,f,m,A,U,F,G){this.navCtrl=e,this.file=n,this.translateService=i,this.quoteService=a,this.contactService=c,this.userService=d,this.actionSheetCtrl=Z,this.excelService=f,this.alertCtrl=m,this.analyticsService=A,this.toastCtrl=U,this.storage=F,this.platform=G,this.params=null,this.quote={},this.isDisabled=!1,this.hideTax=!1,this.totalProductsAmount=0,this.totalProductsQuantity=0,this.lang="vn",this.showDes=!1,this.showImage=!0,this.onKeyPress=M=>{!M.target||"body"!==M.target.localName||("p"===M.key||"P"===M.key)&&this.printQuote()},this.onLoadQuote=M=>{this.quote&&M.detail.id===this.quote.id&&this.reload()},this.navCtrl.removeEventListener("reloadQuote",this.onLoadQuote),this.navCtrl.addEventListener("reloadQuote",this.onLoadQuote)}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,u.Z)(function*(){yield e.analyticsService.setCurrentScreen("quote-detail")})()}ngOnInit(){this.reload()}reload(){var e=this;return(0,u.Z)(function*(){const n=yield e.navCtrl.loading();e.currency=yield e.userService.getAttr("current-currency"),e.hideTax=yield e.userService.getAttr("hide-tax"),e.quote={};const i=e.params?e.params:e.navCtrl.getParams();e.params=i,i&&i.id&&i.id>0&&e.quoteService.get(i.id).then(function(){var c=(0,u.Z)(function*(d){yield n.dismiss(),e.quote=d,e.quote.items=d&&d.itemsJson?JSON.parse(d.itemsJson):[],e.totalProductsAmount=e.quote.items&&e.quote.items.length?y.sumBy(e.quote.items,m=>m.total):0,e.totalProductsQuantity=e.quote.items&&e.quote.items.length?y.sumBy(e.quote.items,m=>m.count):0;const Z=yield e.storage.get("quote-show-Image");e.showImage=Z&&"1"===Z;const f=yield e.storage.get("quote-show-Des");e.showDes=f&&"1"===f});return function(d){return c.apply(this,arguments)}}())})()}isNotCordova(){return this.navCtrl.isNotCordova()}createOrder(){var e=this;return(0,u.Z)(function*(){yield e.analyticsService.setCurrentScreen("quote-detail-create-order"),e.navCtrl.push("/order/add",{quote:e.quote})})()}call(){this.saveLastActive("call"),h.W.callPhone(this.quote.contact.mobile)}text(){this.saveLastActive("text"),h.W.sendSms(this.quote.contact.mobile)}saveLastActive(e){return this.quote.contact.lastActive=q.C.toDbString(),this.quote.contact.lastAction=e,this.contactService.saveContact(this.quote.contact).then(n=>(this.navCtrl.publish("reloadContactList"),this.navCtrl.publish("reloadContact",this.quote.contact),n))}contactImageOrPlaceholder(){return h.W.contactImageOrPlaceholder(this.quote.contact.avatarUrl)}dateFormat(e){let n=e;return e&&e.indexOf(":00Z")<0&&(n=J(e).format(q.C.getDateTimeDbFormat())),q.C.toUiLocalDateTimeString(n)}actionIcon(e){return h.W.actionIcon(e)}dateTimeFormat(e){return q.C.toUiString(e)}edit(){this.navCtrl.navigateForward("/quote/add",{id:this.quote.id})}presentActionSheet(){var e=this;return(0,u.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:e.translateService.instant("action.action"),buttons:[{text:e.translateService.instant("quote.delete-quote"),role:"destructive",handler:()=>{e.deleteQuote()}},{text:e.translateService.instant("quote-detail.share"),handler:()=>{e.shareQuote()}},{text:e.translateService.instant("quote.copy"),handler:()=>{e.copyQuote()}},{text:e.translateService.instant("quote-detail.print"),handler:()=>{e.printQuote()}},{text:e.translateService.instant("quote-detail.export"),handler:()=>{e.exportQuote()}},{text:e.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}deleteQuote(){var e=this;return(0,u.Z)(function*(){var i;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("quote.delete-alert"),buttons:[{text:e.translateService.instant("common.agree"),handler:(i=(0,u.Z)(function*(){e.quoteService.delete(e.quote).then((0,u.Z)(function*(){e.analyticsService.logEvent("quote-detail-delete-success"),e.navCtrl.publish("reloadQuoteList"),e.navCtrl.publish("reloadContact",e.quote.contact),e.navCtrl.back()}))}),function(){return i.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}productName(e,n){return h.W.productName(e,n)}shareQuote(){this.navCtrl.push("/quote/detail-print",{quote:this.quote,mode:"share"})}copyQuote(){this.navCtrl.push("/quote/add",{quote:this.quote,mode:"copy"})}printQuote(){var e=this;return(0,u.Z)(function*(){e.navCtrl.push("/quote/detail-print",{quote:e.quote,mode:"print",showDes:e.showDes,showImage:e.showImage})})()}quoteShowField(e){var n=this;return(0,u.Z)(function*(){yield n.storage.set("quote-show-"+e,n["show"+e]?"1":"0")})()}exportQuote(){var e=this;const n=[];n.push([this.translateService.instant("quote-detail.title")]),n.push([this.translateService.instant("quote-add.name"),this.quote.name]),0!==this.quote.contactId&&this.quote.contact&&this.quote.contact.fullName&&n.push([this.translateService.instant("contact-add.full-name"),this.quote.contact.fullName]),0!==this.quote.contactId&&this.quote.contact&&this.quote.contact.mobile&&n.push([this.translateService.instant("contact-add.phone"),this.quote.contact.mobile]),0===this.quote.contactId&&this.quote.contactName&&n.push([this.translateService.instant("contact-add.full-name"),this.quote.contactName]),0===this.quote.contactId&&this.quote.contactPhone&&n.push([this.translateService.instant("contact-add.phone"),this.quote.contactPhone]),n.push([" "]),n.push([this.translateService.instant("quote-add.product-code"),this.translateService.instant("quote-add.product-name"),this.translateService.instant("quote-add.product-count"),this.translateService.instant("quote-add.product-unit"),this.translateService.instant("quote-add.product-price"),this.translateService.instant("quote-add.product-discount")+" ("+this.currency+")",this.translateService.instant("quote-add.product-total")+" ("+this.currency+")"]);for(const c of this.quote.items)n.push([c.productCode,c.productName,c.count,c.unit,c.price,c.discount,c.total]);n.push([" "]),n.push([this.translateService.instant("quote-add.net-value")+" ("+this.currency+")",this.quote.netValue]),n.push([this.translateService.instant("quote-add.shipping-fee")+" ("+this.currency+")",this.quote.shippingFee]),n.push([this.translateService.instant("quote-add.tax")+" ("+this.currency+")",this.quote.tax]),n.push([this.translateService.instant("quote-add.total")+" ("+this.currency+")",this.quote.total]);const i=this.excelService.createSheetData(n),a="quote-detail-"+this.quote.id+"-"+h.W.getCurrentDate()+".xlsx";this.excelService.exportExcel(i,a).then(function(){var c=(0,u.Z)(function*(d){e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+e.file.externalDataDirectory+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFile(null,d))});return function(d){return c.apply(this,arguments)}}())}addDebt(){this.navCtrl.navigateForward("/debt/add",{quote:this.quote.id})}getAttributesString(e){return h.W.getAttributesString(e)}hasOptionsOrAttributes(e){return h.W.hasOptionsOrAttributes(e)}presentToast(e){var n=this;return(0,u.Z)(function*(){yield(yield n.toastCtrl.create({message:e,duration:3e3,position:"top"})).present()})()}getTypeAttributesString(e){return h.W.getTypeAttributesString(e)}getOptionPrices(e){return h.W.getOptionPrices(e)}copy(e){var n=this;return(0,u.Z)(function*(){if(n.isCordova())return n.share(e);yield(0,Le.OR)(e);const i=n.translateService.instant("request-pro.copied")+e;yield(yield n.toastCtrl.create({message:i,duration:3e3,position:"bottom"})).present()})()}isCordova(){return this.platform.is("capacitor")||this.platform.is("cordova")}share(e){var n=this;return(0,u.Z)(function*(){yield n.userService.shareText(e)})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(z.G),t.Y36(rt.$),t.Y36(T.sK),t.Y36(L.P),t.Y36(x.y),t.Y36($.K),t.Y36(l.BX),t.Y36(nt.x),t.Y36(l.Br),t.Y36(W.y),t.Y36(l.yF),t.Y36(tt.V),t.Y36(l.t4))},o.\u0275cmp=t.Xpm({type:o,selectors:[["quote-detail"]],decls:106,vars:99,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"click"],["name","create"],["name","print"],["name","ellipsis-vertical"],["size-xs","6","size-sm","6","size-md","3"],["color","primary"],[2,"margin-top","5px"],["size-xs","6","size-sm","6","size-md","3",4,"ngIf"],["expand","full",3,"click"],["name","cart"],["size-xs","12","size-sm","12","size-md","6"],[3,"ngModel","enableOnOffLabels","ngModelChange"],["color","light",4,"ngIf"],[4,"ngIf"],["lines","none",4,"ngIf"],["color","light"],[3,"hidden"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap",2,"padding-top","8px","padding-bottom","8px"],["slot","end",1,"ion-text-wrap","ion-text-right"],["lines","none"],[3,"src"],["name","copy",3,"click"],["size","end"],["slot","start","name","send"],["color","secondary",3,"click"],["slot","start","name","call"],["style","font-size: 0.8em;",4,"ngIf"],["style","font-size: 0.8em;","class","ion-text-wrap",3,"fontWeight",4,"ngIf"],["slot","end",4,"ngIf"],["style","font-size: 0.75em",4,"ngIf"],[2,"font-size","0.8em"],[1,"ion-text-wrap",2,"font-size","0.8em"],["style","padding: 0; margin: 0",4,"ngIf"],[2,"padding","0","margin","0"],["style","padding: 0; margin: 0",4,"ngFor","ngForOf"],[2,"padding","0","margin","0","font-size","0.68em"],["style","padding: 0; margin: 0; font-size: 0.68em;",4,"ngFor","ngForOf"],[2,"font-size","0.75em"],["color","danger"],["color","secondary"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return n.edit()}),t._UZ(9,"ion-icon",4),t.qZA(),t.TgZ(10,"ion-button",3),t.NdJ("click",function(){return n.printQuote()}),t._UZ(11,"ion-icon",5),t.qZA(),t.TgZ(12,"ion-button",3),t.NdJ("click",function(){return n.presentActionSheet()}),t._UZ(13,"ion-icon",6),t.qZA()()()(),t.TgZ(14,"ion-content")(15,"ion-list")(16,"ion-grid")(17,"ion-row")(18,"ion-col",7)(19,"ion-text",8),t._uU(20),t.ALo(21,"translate"),t.qZA(),t._UZ(22,"br"),t.TgZ(23,"ion-text",9),t._uU(24),t.qZA()(),t.TgZ(25,"ion-col",7)(26,"ion-text",8),t._uU(27),t.ALo(28,"translate"),t.qZA(),t._UZ(29,"br"),t.TgZ(30,"ion-text"),t._uU(31),t.qZA()(),t.YNc(32,Me,7,4,"ion-col",10),t.TgZ(33,"ion-col",7)(34,"ion-button",11),t.NdJ("click",function(){return n.createOrder()}),t._UZ(35,"ion-icon",12),t._uU(36),t.ALo(37,"translate"),t.qZA()(),t.TgZ(38,"ion-col",13)(39,"ion-buttons")(40,"ion-text",8),t._uU(41),t.ALo(42,"translate"),t.qZA(),t._uU(43," \xa0 "),t.TgZ(44,"ion-text"),t._uU(45),t.ALo(46,"translate"),t.qZA(),t.TgZ(47,"ion-toggle",14),t.NdJ("ngModelChange",function(a){return n.showDes=a})("ngModelChange",function(){return n.quoteShowField("Des")}),t.qZA(),t.TgZ(48,"ion-text"),t._uU(49),t.ALo(50,"translate"),t.qZA(),t.TgZ(51,"ion-toggle",14),t.NdJ("ngModelChange",function(a){return n.showImage=a})("ngModelChange",function(){return n.quoteShowField("Image")}),t.qZA()()()()(),t.YNc(52,ke,3,3,"ion-item-divider",15),t.YNc(53,De,21,10,"ion-item-sliding",16),t.YNc(54,He,6,3,"ion-item",17),t.qZA(),t.TgZ(55,"ion-item-divider",18),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"ion-list",19),t.YNc(59,an,12,31,"ion-item",20),t.TgZ(60,"ion-item")(61,"ion-text",21),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.TgZ(64,"ion-text",22),t._uU(65),t.qZA()(),t.TgZ(66,"ion-item")(67,"ion-text",21)(68,"strong"),t._uU(69),t.ALo(70,"translate"),t.qZA()(),t.TgZ(71,"ion-text",22),t._uU(72),t.ALo(73,"currency"),t.qZA()()(),t.TgZ(74,"ion-list"),t.YNc(75,rn,3,3,"ion-item-divider",15),t.YNc(76,cn,3,1,"ion-item",16),t.TgZ(77,"ion-item-divider",18),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.YNc(80,sn,7,14,"ion-item",16),t.TgZ(81,"ion-item")(82,"ion-text",8),t._uU(83),t.ALo(84,"translate"),t.qZA(),t.TgZ(85,"span",2),t._uU(86),t.ALo(87,"currency"),t.qZA()(),t.YNc(88,ln,9,18,"ion-item",16),t.YNc(89,un,7,14,"ion-item",16),t.YNc(90,dn,7,14,"ion-item",16),t.TgZ(91,"ion-item")(92,"ion-text",8)(93,"b"),t._uU(94),t.ALo(95,"translate"),t.qZA()(),t.TgZ(96,"span",2)(97,"b"),t._uU(98),t.ALo(99,"currency"),t.qZA()()(),t.YNc(100,pn,3,3,"ion-item-divider",15),t.YNc(101,_n,6,4,"ion-item",16),t.YNc(102,mn,6,4,"ion-item",16),t.YNc(103,gn,6,4,"ion-item",16),t.YNc(104,hn,6,4,"ion-item",16),t.YNc(105,fn,6,4,"ion-item",16),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,43,"quote-detail.title")),t.xp6(9),t.Akn(n.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(6),t.hij("",t.lcZ(21,45,"quote-add.name"),":"),t.xp6(4),t.Oqu(n.quote.name),t.xp6(3),t.hij("",t.lcZ(28,47,"quote-add.quote-date"),":"),t.xp6(4),t.Oqu(n.dateFormat(n.quote.createdAt)),t.xp6(1),t.Q6J("ngIf",n.quote&&n.quote.staff),t.xp6(4),t.hij("\xa0",t.lcZ(37,49,"quote-detail.create-order")," "),t.xp6(5),t.hij("",t.lcZ(42,51,"quote-detail.for-print"),":"),t.xp6(4),t.Oqu(t.lcZ(46,53,"quote-detail.show-des")),t.xp6(2),t.Q6J("ngModel",n.showDes)("enableOnOffLabels",!0),t.xp6(2),t.Oqu(t.lcZ(50,55,"quote-detail.show-image")),t.xp6(2),t.Q6J("ngModel",n.showImage)("enableOnOffLabels",!0),t.xp6(1),t.Q6J("ngIf",0!==n.quote.contactId||n.quote.contactName||n.quote.contactPhone||n.quote.contactAddress),t.xp6(1),t.Q6J("ngIf",0!==n.quote.contactId&&n.quote.contact),t.xp6(1),t.Q6J("ngIf",(n.quote.contactName||n.quote.contactPhone||n.quote.contactAddress)&&0===n.quote.contactId),t.xp6(2),t.hij(" ",t.lcZ(57,57,"quote-add.product")," "),t.xp6(2),t.Q6J("hidden",!n.quote.items||0===n.quote.items.length),t.xp6(1),t.Q6J("ngForOf",n.quote.items),t.xp6(3),t.hij(" ",t.lcZ(63,59,"quote-detail.total-quantity")," "),t.xp6(3),t.hij(" ",n.totalProductsQuantity," "),t.xp6(4),t.Oqu(t.lcZ(70,61,"quote-detail.total-amount")),t.xp6(3),t.hij(" ",t.G7q(73,63,t.kEZ(87,b,n.totalProductsAmount,n.currency,n.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",n.quote.note),t.xp6(1),t.Q6J("ngIf",n.quote.note),t.xp6(2),t.hij(" ",t.lcZ(79,69,"quote-add.payment")," "),t.xp6(2),t.Q6J("ngIf",n.quote.discountOnTotal),t.xp6(3),t.hij("",t.lcZ(84,71,"quote-add.net-value"),":"),t.xp6(3),t.Oqu(t.G7q(87,73,t.kEZ(91,b,n.quote.netValue,n.currency,n.translateService.currentLang))),t.xp6(2),t.Q6J("ngIf",n.quote.amountFromPoint&&n.quote.pointAmount),t.xp6(1),t.Q6J("ngIf",!n.hideTax),t.xp6(1),t.Q6J("ngIf",n.quote.shippingFee),t.xp6(4),t.hij("",t.lcZ(95,79,"quote-add.total"),":"),t.xp6(4),t.Oqu(t.G7q(99,81,t.kEZ(95,b,n.quote.total,n.currency,n.translateService.currentLang))),t.xp6(2),t.Q6J("ngIf",n.quote.hasShipInfo),t.xp6(1),t.Q6J("ngIf",n.quote.billOfLadingCode),t.xp6(1),t.Q6J("ngIf",n.quote.shippingPartner),t.xp6(1),t.Q6J("ngIf",n.quote.shipperName),t.xp6(1),t.Q6J("ngIf",n.quote.shipperPhone),t.xp6(1),t.Q6J("ngIf",n.quote.deliveryAddress))},dependencies:[p.sg,p.O5,s.JJ,s.On,l.BJ,l.oU,l.YG,l.Sm,l.wI,l.W2,l.jY,l.Gu,l.gu,l.Ie,l.rH,l.u8,l.IK,l.td,l.Q$,l.q_,l.Nd,l.yW,l.Bs,l.wd,l.ho,l.sr,l.w,l.cs,p.H9,T.X$],encapsulation:2}),o})();var qn=_(9921),Zn=_(3142);function Cn(o,r){if(1&o&&(t.TgZ(0,"i"),t._uU(1),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Oqu(e.shop.shortDescription)}}function An(o,r){if(1&o&&(t.TgZ(0,"div",45)(1,"strong"),t._uU(2),t.qZA(),t._UZ(3,"br"),t.YNc(4,Cn,2,1,"i",8),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(e.shop.name.toUpperCase()),t.xp6(2),t.Q6J("ngIf",e.shop.shortDescription)}}function yn(o,r){if(1&o&&(t.TgZ(0,"td"),t._UZ(1,"img",46),t.qZA()),2&o){const e=t.oxw(2);t.Udp("width",e.shop.bankName?"20%":"40%"),t.xp6(1),t.Q6J("src",e.shop.iconUrl,t.LSH)}}function Tn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.phone"),t.oJD),t.xp6(2),t.hij(" ",e.shop.phone," ")}}function vn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.email"),t.oJD),t.xp6(2),t.hij(" ",e.shop.email," ")}}function bn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.facebook"),t.oJD),t.xp6(2),t.hij(" ",e.shop.facebook," ")}}function Qn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.address"),t.oJD),t.xp6(2),t.hij(" ",e.shop.address," ")}}function Sn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",48),t._uU(3),t.qZA()()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.bank-account-name"),t.oJD),t.xp6(2),t.hij(" ",e.shop.bankAccountName," ")}}function wn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.qZA()()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("innerHTML",e.toHtml("shop-add.bank-account-number"),t.oJD),t.xp6(2),t.hij(" ",e.shop.bankAccountNumber," ")}}function Un(o,r){if(1&o&&(t.TgZ(0,"td",47)(1,"table",4)(2,"tr")(3,"td",5),t._UZ(4,"strong",6),t.qZA(),t.TgZ(5,"td",7),t._uU(6),t.qZA()(),t.YNc(7,Sn,4,2,"tr",8),t.YNc(8,wn,4,2,"tr",8),t.qZA()()),2&o){const e=t.oxw(2);t.Udp("width",e.shop.iconUrl?"40%":"100%"),t.xp6(4),t.Q6J("innerHTML",e.toHtml("shop-add.bank-name"),t.oJD),t.xp6(2),t.hij(" ",e.shop.bankName," "),t.xp6(1),t.Q6J("ngIf",e.shop.bankAccountName),t.xp6(1),t.Q6J("ngIf",e.shop.bankAccountNumber)}}function In(o,r){if(1&o&&(t.TgZ(0,"div",39),t.YNc(1,An,5,2,"div",40),t.TgZ(2,"table",4)(3,"tr"),t.YNc(4,yn,2,3,"td",41),t.TgZ(5,"td",42)(6,"table",43),t.YNc(7,Tn,4,2,"tr",8),t.YNc(8,vn,4,2,"tr",8),t.YNc(9,bn,4,2,"tr",8),t.YNc(10,Qn,4,2,"tr",8),t.qZA()(),t.YNc(11,Un,9,6,"td",44),t.qZA()()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.shop.name),t.xp6(3),t.Q6J("ngIf",e.shop.iconUrl),t.xp6(1),t.Udp("width",e.shop.bankName&&e.shop.iconUrl?"40%":e.shop.bankName||e.shop.iconUrl?"60%":"100%"),t.xp6(2),t.Q6J("ngIf",e.shop&&e.shop.phone),t.xp6(1),t.Q6J("ngIf",e.shop&&e.shop.email),t.xp6(1),t.Q6J("ngIf",e.shop&&e.shop.facebook),t.xp6(1),t.Q6J("ngIf",e.shop&&e.shop.address),t.xp6(1),t.Q6J("ngIf",e.shop.bankName)}}function Nn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" - ",e.quote.staff.userName,"")}}function Pn(o,r){if(1&o&&(t.TgZ(0,"tr"),t._UZ(1,"td",9),t.TgZ(2,"td",7),t._uU(3),t.YNc(4,Nn,2,1,"span",8),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("innerHTML",e.toHtml("trade.staff",""),t.oJD),t.xp6(2),t.hij(" ",e.quote.staff.name,""),t.xp6(1),t.Q6J("ngIf",e.quote.staff.userName)}}function Jn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contact.fullName)}}function Ln(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contactName)}}function Mn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contact.mobile)}}function kn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contactPhone)}}function On(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contact.address)}}function Dn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.quote.contactAddress)}}function Yn(o,r){1&o&&(t.TgZ(0,"td",49)(1,"b"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"quote-print.image")))}function En(o,r){1&o&&(t.TgZ(0,"td",22)(1,"b"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"quote-print.head-des")))}function Fn(o,r){1&o&&(t.TgZ(0,"td",23)(1,"b"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"quote-print.head-discount-full")))}function Hn(o,r){if(1&o&&(t.TgZ(0,"td",55),t._UZ(1,"img",56),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.productAvatar,t.LSH)}}function Gn(o,r){if(1&o&&(t.TgZ(0,"p",57),t._uU(1),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(3);t.xp6(1),t.lnq(" ",n.productName(e.productCode,e.productName)," | ",e.count,"\xa0",e.unit," ")}}function jn(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",57)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,Gn,2,3,"p",58),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.combo-products")),t.xp6(2),t.Q6J("ngForOf",e.items)}}function Vn(o,r){if(1&o&&(t.TgZ(0,"p",61)(1,"ion-text"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getTypeAttributesString(e)," ")}}function Bn(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text"),t._uU(3),t.qZA()(),t.BQk()),2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",n.getAttributesString(e)," ")}}const Q=function(o,r){return[o,"","","1.0-2",r]};function Kn(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.AsE(" | ",e.count," \xd7 ",t.G7q(2,2,t.WLB(8,Q,e.price,n.translateService.currentLang)),"")}}function $n(o,r){1&o&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function zn(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text"),t._uU(3),t.YNc(4,Kn,3,11,"span",8),t._uU(5," | "),t.YNc(6,$n,2,0,"span",8),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.BQk()),2&o){const e=r.$implicit,n=t.oxw(4);t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(8,6,t.WLB(12,Q,e.total,n.translateService.currentLang))," ")}}function Wn(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"ion-text")(3,"strong"),t._uU(4),t.qZA()()(),t.YNc(5,zn,9,15,"ng-container",26),t.BQk()),2&o){const e=r.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngForOf",e.values)}}function Rn(o,r){if(1&o&&(t.TgZ(0,"p",61),t._uU(1),t.ALo(2,"currency"),t.ALo(3,"currency"),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(4);t.xp6(1),t.xDo(" ",n.productName(e.code,e.title)," | ",e.count," ",e.unit," \xd7 ",t.G7q(2,5,t.WLB(17,Q,e.price,n.translateService.currentLang))," | +",t.G7q(3,11,t.WLB(20,Q,e.total,n.translateService.currentLang))," ")}}function Xn(o,r){if(1&o&&(t.ynx(0),t.TgZ(1,"p",61)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,Rn,4,23,"p",62),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.Oqu(t.lcZ(4,2,"quote-add.added-products")),t.xp6(2),t.Q6J("ngForOf",e.options)}}function to(o,r){if(1&o&&(t.TgZ(0,"div",59),t.YNc(1,Vn,3,3,"p",60),t.YNc(2,Bn,4,3,"ng-container",8),t.YNc(3,Wn,6,2,"ng-container",26),t.YNc(4,Xn,6,4,"ng-container",8),t.qZA()),2&o){const e=t.oxw().$implicit;t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.typeAttributes&&e.typeAttributes.length),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.typeOptions),t.xp6(1),t.Q6J("ngIf",e.options&&e.options.length)}}function eo(o,r){if(1&o&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description,"")}}function no(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.hij("-",e.discountPercent,"%")}}function oo(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.hij("-",t.G7q(2,1,t.WLB(7,Q,e.discount,n.translateService.currentLang)),"")}}function io(o,r){if(1&o&&(t.TgZ(0,"td",28),t.YNc(1,no,2,1,"span",8),t.YNc(2,oo,3,10,"span",8),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.discountPercent),t.xp6(1),t.Q6J("ngIf",e.discount&&!e.discountPercent)}}function ao(o,r){if(1&o&&(t.TgZ(0,"span",63),t._UZ(1,"br"),t._uU(2),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.hij("(-",e.discountPercent,"%)")}}function ro(o,r){if(1&o&&(t.TgZ(0,"span",63),t._UZ(1,"br"),t._uU(2),t.ALo(3,"currency"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(2),t.hij("(-",t.G7q(3,1,t.WLB(7,Q,e.discount,n.translateService.currentLang)),")")}}function co(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",50),t._uU(2),t.qZA(),t.YNc(3,Hn,2,1,"td",51),t.TgZ(4,"td",27),t._uU(5),t.YNc(6,jn,6,4,"ng-container",8),t.YNc(7,to,5,6,"div",52),t.qZA(),t.YNc(8,eo,2,1,"td",29),t.TgZ(9,"td",27),t._uU(10),t.qZA(),t.TgZ(11,"td",28),t._uU(12),t.qZA(),t.TgZ(13,"td",28),t._uU(14),t.ALo(15,"currency"),t.qZA(),t.YNc(16,io,3,2,"td",53),t.TgZ(17,"td",30),t._uU(18),t.ALo(19,"currency"),t.YNc(20,ao,3,1,"span",54),t.YNc(21,ro,4,10,"span",54),t.qZA()()),2&o){const e=r.$implicit,n=r.index,i=t.oxw();t.xp6(2),t.hij(" ",n+1,""),t.xp6(1),t.Q6J("ngIf",i.showImage),t.xp6(2),t.hij(" ",i.productName(e.productCode,e.productName)," "),t.xp6(1),t.Q6J("ngIf",e.items&&e.items.length),t.xp6(1),t.Q6J("ngIf",i.hasOptionsOrAttributes(e)),t.xp6(1),t.Q6J("ngIf",i.showDes),t.xp6(2),t.hij(" ",e.unit,""),t.xp6(2),t.hij(" ",e.count," "),t.xp6(2),t.hij(" ",t.G7q(15,13,t.WLB(25,Q,e.price,i.translateService.currentLang)),""),t.xp6(2),t.Q6J("ngIf",!i.hideDiscountColumn),t.xp6(2),t.hij(" ",t.G7q(19,19,t.WLB(28,Q,e.total,i.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",i.hideDiscountColumn&&e.discountPercent),t.xp6(1),t.Q6J("ngIf",i.hideDiscountColumn&&e.discount&&!e.discountPercent)}}function so(o,r){1&o&&(t.TgZ(0,"td",27),t._uU(1,"\xa0"),t.qZA())}function lo(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.hideDiscountColumn?e.colspan2:e.colspan2+1),t.xp6(1),t.hij(" ",t.lcZ(3,3,"quote-add.discount")," "),t.xp6(3),t.hij(" -",t.G7q(6,5,t.WLB(11,Q,e.quote.discountOnTotal,e.translateService.currentLang))," ")}}function uo(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.hideDiscountColumn?e.colspan2:e.colspan2+1),t.xp6(1),t.hij(" ",t.lcZ(3,3,"quote-add.net-value")," "),t.xp6(3),t.hij(" ",t.G7q(6,5,t.WLB(11,Q,e.quote.netValue,e.translateService.currentLang))," ")}}function po(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.hideDiscountColumn?e.colspan2:e.colspan2+1),t.xp6(1),t.hij(" ",t.lcZ(3,3,"quote-add.pay-by-point")," "),t.xp6(3),t.hij(" -",t.G7q(6,5,t.WLB(11,Q,e.quote.amountFromPoint,e.translateService.currentLang))," ")}}function _o(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.hideDiscountColumn?e.colspan2:e.colspan2+1),t.xp6(1),t.hij(" ",t.lcZ(3,3,"quote-add.tax")," "),t.xp6(3),t.hij(" +",t.G7q(6,5,t.WLB(11,Q,e.quote.tax,e.translateService.currentLang))," ")}}function mo(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td",30),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.hideDiscountColumn?e.colspan2:e.colspan2+1),t.xp6(1),t.hij(" ",t.lcZ(3,3,"quote-add.shipping-fee")," "),t.xp6(3),t.hij(" +",t.G7q(6,5,t.WLB(11,Q,e.quote.shippingFee,e.translateService.currentLang))," ")}}function go(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td",14)(2,"table",11)(3,"tr"),t._UZ(4,"td",9),t.TgZ(5,"td",15)(6,"span"),t._uU(7),t.qZA()()()()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("innerHTML",e.toHtml("quote-add.note"),t.oJD),t.xp6(3),t.Oqu(e.quote.note)}}function ho(o,r){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" - ",e.quote.staff.userName,"")}}function fo(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td")(2,"span"),t._uU(3),t.YNc(4,ho,2,1,"span",8),t.qZA()()()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.quote.staff.name),t.xp6(1),t.Q6J("ngIf",e.quote.staff.userName)}}let xo=(()=>{class o{constructor(e,n,i,a,c,d,Z,f,m,A,U){this.navCtrl=e,this.platform=n,this.printer=i,this.translateService=a,this.userService=c,this.storeService=d,this.analyticsService=Z,this.dataService=f,this.excelService=m,this.storage=A,this.alertCtrl=U,this.params=null,this.mode="share",this.quote={},this.isMobile=!1,this.totalProductsAmount=0,this.totalProductsQuantity=0,this.hideTax=!1,this.hideDiscountColumn=!0,this.showStaffNameUnderSign=!1,this.hideProductCodePrint=!0,this.showImage=!0,this.showDes=!1}get colspan1(){let e=3;return this.showImage&&e++,this.showDes&&e++,e}get colspan2(){let e=5;return this.showImage&&e++,this.showDes&&e++,e}ionViewWillEnter(){var e=this;return(0,u.Z)(function*(){yield e.analyticsService.setCurrentScreen("quote-detail-print")})()}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.isMobile=e.platform.width()<720,e.platform.resize.subscribe(()=>{e.isMobile=e.platform.width()<720}),yield e.reload()})()}reload(){var e=this;return(0,u.Z)(function*(){e.currency=yield e.userService.getAttr("current-currency");const n=yield e.storeService.getCurrentStore();e.shop=n||(yield e.dataService.getFirstObject("shop")),e.hideTax=yield e.userService.getAttr("hide-tax"),e.hideDiscountColumn=yield e.userService.getAttr("hide-discount-column"),e.showStaffNameUnderSign=yield e.userService.getAttr("show-staff-name-under-sign"),e.hideProductCodePrint=yield e.userService.getAttr("hide-product-code-print"),e.quote={},e.params=e.navCtrl.getParams(e.params),e.params&&e.params.mode&&(e.mode=e.params.mode);const i=yield e.storage.get("quote-show-Image");e.showImage=i&&"1"===i;const a=yield e.storage.get("quote-show-Des");e.showDes=a&&"1"===a,e.params&&e.params.quote&&(e.quote=e.params.quote,e.totalProductsAmount=e.quote.items&&e.quote.items.length?y.sumBy(e.quote.items,c=>c.total):0,e.totalProductsQuantity=e.quote.items&&e.quote.items.length?y.sumBy(e.quote.items,c=>c.count):0,e.doPrintOrShare())})()}doPrintOrShare(){var e=this;setTimeout((0,u.Z)(function*(){const i=document.getElementById("print-page").innerHTML;if("print"!==e.mode){const a="quote-"+e.quote.id+".pdf";return yield e.excelService.downloadPdf(a,i,4).then(function(){var c=(0,u.Z)(function*(d){e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+d,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(a,a,d))});return function(d){return c.apply(this,arguments)}}()),void e.navCtrl.back()}if(e.navCtrl.isNotCordova())return h.W.webPrint(i,500),void e.navCtrl.back();yield e.printer.print(i,{orientation:"portrait"}).then(()=>{}),e.navCtrl.back()}),1e3)}toHtml(e,n=":"){return h.W.toHtml(this.translateService.instant(e),n)}numberArrays(e,n){return h.W.numberArrays(e,n)}dateFormat(e){return q.C.toUiDateString(e)}dateTimeFormat(e){return q.C.toUiString(e)}productName(e,n){return h.W.productName(this.hideProductCodePrint?"":e,n)}hasOptionsOrAttributes(e){return h.W.hasOptionsOrAttributes(e)}getAttributesString(e){return h.W.getAttributesString(e)}getTypeAttributesString(e){return h.W.getTypeAttributesString(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(z.G),t.Y36(l.t4),t.Y36(qn.F),t.Y36(T.sK),t.Y36($.K),t.Y36(et.d),t.Y36(W.y),t.Y36(Zn.D),t.Y36(nt.x),t.Y36(tt.V),t.Y36(l.Br))},o.\u0275cmp=t.Xpm({type:o,selectors:[["quote-detail-print"]],decls:143,vars:90,consts:[["id","print-page"],["style","border-bottom: 1px solid #000;",4,"ngIf"],[2,"text-align","center"],[2,"font-size","18px","text-transform","uppercase","font-weight","bold"],[2,"border","none","width","100%"],[2,"width","1px","white-space","nowrap","padding","0"],[3,"innerHTML"],["nowrap","",2,"padding","0 0 0 5px"],[4,"ngIf"],[2,"width","1px","white-space","nowrap","padding","0",3,"innerHTML"],[2,"width","40%","padding","0"],[2,"width","100%"],[2,"padding","0 0 0 5px","border-bottom","1px dotted #000"],[2,"padding","0"],["colspan","2",2,"padding","0"],[2,"border-bottom","1px dotted #000","padding","0 0 0 5px"],[2,"padding-left","5px","padding-right","5px"],[2,"margin-top","10px","margin-bottom","10px","width","100%","border-collapse","collapse"],[2,"border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","max-width","60px","text-align","center"],["style","border-right: 1px solid #000; border-top: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px; text-align: center;",4,"ngIf"],["nowrap","",2,"border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px"],["style","border-top: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px;",4,"ngIf"],[2,"border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px"],[2,"border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","right"],["style","border-top: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px; text-align: right;",4,"ngIf"],[2,"border-right","1px solid #000","border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","right"],[4,"ngFor","ngForOf"],[2,"border-left","1px solid #000","border-bottom","1px solid #000","padding","5px"],[2,"border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","right"],["style","border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px;",4,"ngIf"],[2,"border-right","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","right"],["cellpadding","0","cellspacing","0",2,"width","100%","border","none"],[2,"width","1px","white-space","nowrap",3,"innerHTML"],[2,"border-bottom","1px dotted #000"],["colspan","2",2,"border-bottom","1px dotted #000"],[2,"border","none","width","100%","margin-bottom","50px","margin-top","20px"],[2,"width","50%","text-align","center","vertical-align","text-top"],[2,"border","none","margin","0 auto"],[2,"text-transform","uppercase"],[2,"border-bottom","1px solid #000"],["style","width: 100%; text-align: center; margin-top: 5px;",4,"ngIf"],[3,"width",4,"ngIf"],[2,"vertical-align","top"],[2,"border","none","border-spacing","0","width","100%","left","50%"],["style","padding-left: 20px; vertical-align: text-top;",3,"width",4,"ngIf"],[2,"width","100%","text-align","center","margin-top","5px"],[2,"max-width","44px","float","left","max-height","44px",3,"src"],[2,"padding-left","20px","vertical-align","text-top"],[2,"padding","0 0 0 5px"],[2,"border-right","1px solid #000","border-top","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","center"],[2,"border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","max-width","60px","text-align","center"],["style","border-right: 1px solid #000; border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px; text-align: center;",4,"ngIf"],["style","font-size: 0.8em;","class","ion-text-wrap",3,"fontWeight",4,"ngIf"],["style","border-left: 1px solid #000; border-bottom: 1px solid #000; padding: 5px; text-align: right;",4,"ngIf"],["style","font-size: 0.8em",4,"ngIf"],[2,"border-right","1px solid #000","border-left","1px solid #000","border-bottom","1px solid #000","padding","5px","text-align","center"],[2,"max-width","150px","max-height","200px",3,"src"],[2,"padding","0","margin","0","font-size","0.68em"],["style","padding: 0; margin: 0; font-size: 0.68em;",4,"ngFor","ngForOf"],[1,"ion-text-wrap",2,"font-size","0.8em"],["style","padding: 0; margin: 0",4,"ngIf"],[2,"padding","0","margin","0"],["style","padding: 0; margin: 0",4,"ngFor","ngForOf"],[2,"font-size","0.8em"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,In,12,9,"div",1),t.TgZ(2,"div",2)(3,"h2",3),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"div")(7,"table",4)(8,"tr")(9,"td",5),t._UZ(10,"strong",6),t.qZA(),t.TgZ(11,"td",7),t._uU(12),t.qZA()(),t.YNc(13,Pn,5,3,"tr",8),t.TgZ(14,"tr"),t._UZ(15,"td",9),t.TgZ(16,"td",7),t._uU(17),t.qZA()()()(),t.TgZ(18,"table",4)(19,"tr")(20,"td",10)(21,"table",11)(22,"tr"),t._UZ(23,"td",9),t.TgZ(24,"td",12),t.YNc(25,Jn,2,1,"span",8),t.YNc(26,Ln,2,1,"span",8),t.qZA()()()(),t.TgZ(27,"td",13)(28,"table",11)(29,"tr"),t._UZ(30,"td",9),t.TgZ(31,"td",12),t.YNc(32,Mn,2,1,"span",8),t.YNc(33,kn,2,1,"span",8),t.qZA()()()()(),t.TgZ(34,"tr")(35,"td",14)(36,"table",11)(37,"tr"),t._UZ(38,"td",9),t.TgZ(39,"td",15),t.YNc(40,On,2,1,"span",8),t.YNc(41,Dn,2,1,"span",8),t.qZA()()()()()(),t.TgZ(42,"div",16)(43,"table",17)(44,"tr")(45,"td",18)(46,"b"),t._uU(47),t.ALo(48,"translate"),t.qZA()(),t.YNc(49,Yn,4,3,"td",19),t.TgZ(50,"td",20)(51,"b"),t._uU(52),t.ALo(53,"translate"),t.qZA()(),t.YNc(54,En,4,3,"td",21),t.TgZ(55,"td",22)(56,"b"),t._uU(57),t.ALo(58,"translate"),t.qZA()(),t.TgZ(59,"td",23)(60,"b"),t._uU(61),t.ALo(62,"translate"),t.qZA()(),t.TgZ(63,"td",23)(64,"b"),t._uU(65),t.ALo(66,"translate"),t.qZA()(),t.YNc(67,Fn,4,3,"td",24),t.TgZ(68,"td",25)(69,"b"),t._uU(70),t.ALo(71,"translate"),t.qZA()()(),t.YNc(72,co,22,31,"tr",26),t._UZ(73,"tr"),t.TgZ(74,"tr")(75,"td",27)(76,"strong"),t._uU(77),t.ALo(78,"translate"),t.qZA()(),t.TgZ(79,"td",28),t._uU(80),t.qZA(),t.YNc(81,so,2,0,"td",29),t.TgZ(82,"td",27),t._uU(83,"\xa0"),t.qZA(),t.TgZ(84,"td",30),t._uU(85),t.ALo(86,"currency"),t.qZA()(),t.YNc(87,lo,7,14,"tr",8),t.YNc(88,uo,7,14,"tr",8),t.YNc(89,po,7,14,"tr",8),t.YNc(90,_o,7,14,"tr",8),t.YNc(91,mo,7,14,"tr",8),t.TgZ(92,"tr")(93,"td",27)(94,"strong"),t._uU(95),t.ALo(96,"translate"),t.qZA()(),t.TgZ(97,"td",30),t._uU(98),t.ALo(99,"currency"),t.qZA()()()(),t.TgZ(100,"div")(101,"table",31)(102,"tr"),t._UZ(103,"td",32),t.TgZ(104,"td",33),t._uU(105," \xa0 "),t.qZA()(),t.TgZ(106,"tr")(107,"td",34),t._uU(108," \xa0 "),t.qZA()(),t.YNc(109,go,8,2,"tr",8),t.qZA()(),t.TgZ(110,"div")(111,"table",35)(112,"tr")(113,"td",36)(114,"table",37)(115,"tr")(116,"td")(117,"strong",38),t._uU(118),t.ALo(119,"translate"),t.qZA(),t._UZ(120,"br"),t._uU(121),t.ALo(122,"translate"),t.qZA()()()(),t.TgZ(123,"td",36)(124,"table",37)(125,"tr")(126,"td")(127,"strong",38),t._uU(128),t.ALo(129,"translate"),t.qZA(),t._UZ(130,"br"),t._uU(131),t.ALo(132,"translate"),t.qZA()(),t.TgZ(133,"tr")(134,"td"),t._uU(135,"\xa0"),t.qZA()(),t.TgZ(136,"tr")(137,"td"),t._uU(138,"\xa0"),t.qZA()(),t.TgZ(139,"tr")(140,"td"),t._uU(141,"\xa0"),t.qZA()(),t.YNc(142,fo,5,2,"tr",8),t.qZA()()()()()()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.shop),t.xp6(3),t.Oqu(t.lcZ(5,46,"quote-add.quote-print-title")),t.xp6(6),t.Q6J("innerHTML",n.toHtml("quote-add.name"),t.oJD),t.xp6(2),t.hij(" ",n.quote.name," "),t.xp6(1),t.Q6J("ngIf",n.quote.staff),t.xp6(2),t.Q6J("innerHTML",n.toHtml("quote-print.date"),t.oJD),t.xp6(2),t.hij(" ",n.dateFormat(n.quote.createdAt)," "),t.xp6(6),t.Q6J("innerHTML",n.toHtml("quote-print.customer"),t.oJD),t.xp6(2),t.Q6J("ngIf",n.quote.contact&&n.quote.contact.fullName),t.xp6(1),t.Q6J("ngIf",!n.quote.contact&&n.quote.contactName),t.xp6(4),t.Q6J("innerHTML",n.toHtml("contact-add.phone"),t.oJD),t.xp6(2),t.Q6J("ngIf",n.quote.contact&&n.quote.contact.mobile),t.xp6(1),t.Q6J("ngIf",!n.quote.contact&&n.quote.contactPhone),t.xp6(5),t.Q6J("innerHTML",n.toHtml("contact-add.address"),t.oJD),t.xp6(2),t.Q6J("ngIf",n.quote.contact&&n.quote.contact.address),t.xp6(1),t.Q6J("ngIf",!n.quote.contact&&n.quote.contactAddress),t.xp6(6),t.Oqu(t.lcZ(48,48,"quote-print.head-index")),t.xp6(2),t.Q6J("ngIf",n.showImage),t.xp6(3),t.Oqu(t.lcZ(53,50,"quote-print.head-name")),t.xp6(2),t.Q6J("ngIf",n.showDes),t.xp6(3),t.Oqu(t.lcZ(58,52,"quote-print.head-unit-full")),t.xp6(4),t.Oqu(t.lcZ(62,54,"quote-print.head-qty-full")),t.xp6(4),t.Oqu(t.lcZ(66,56,"quote-print.head-price-full")),t.xp6(2),t.Q6J("ngIf",!n.hideDiscountColumn),t.xp6(3),t.Oqu(t.lcZ(71,58,"quote-print.head-amount-full")),t.xp6(2),t.Q6J("ngForOf",n.quote.items),t.xp6(3),t.uIk("colspan",n.colspan1),t.xp6(2),t.Oqu(t.lcZ(78,60,"quote-detail.total-amount")),t.xp6(3),t.hij(" ",n.totalProductsQuantity," "),t.xp6(1),t.Q6J("ngIf",!n.hideDiscountColumn),t.xp6(4),t.hij(" ",t.G7q(86,62,t.WLB(84,Q,n.totalProductsAmount,n.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",n.quote.discountOnTotal),t.xp6(1),t.Q6J("ngIf",n.quote.netValue!==n.totalProductsAmount),t.xp6(1),t.Q6J("ngIf",n.quote.amountFromPoint&&n.quote.pointAmount),t.xp6(1),t.Q6J("ngIf",!n.hideTax&&0!==n.quote.tax),t.xp6(1),t.Q6J("ngIf",n.quote.shippingFee),t.xp6(2),t.uIk("colspan",n.hideDiscountColumn?n.colspan2:n.colspan2+1),t.xp6(2),t.Oqu(t.lcZ(96,68,"quote-add.total")),t.xp6(3),t.hij(" ",t.G7q(99,70,t.WLB(87,Q,n.quote.total,n.translateService.currentLang))," "),t.xp6(5),t.Q6J("innerHTML",n.toHtml("quote-print.total-written-in-letters"),t.oJD),t.xp6(6),t.Q6J("ngIf",n.quote.note),t.xp6(9),t.Oqu(t.lcZ(119,76,"quote-print.customer")),t.xp6(3),t.hij(" (",t.lcZ(122,78,"quote-print.sign-and-write-fullname"),") "),t.xp6(7),t.Oqu(t.lcZ(129,80,"quote-print.buyer")),t.xp6(3),t.hij(" (",t.lcZ(132,82,"quote-print.sign-and-write-fullname"),") "),t.xp6(11),t.Q6J("ngIf",n.quote&&n.quote.staff&&n.showStaffNameUnderSign))},dependencies:[p.sg,p.O5,l.yW,p.H9,T.X$],encapsulation:2}),o})();var qo=_(423),Zo=_(2975);const Ao=[{path:"",component:Je},{path:"detail",component:xn},{path:"detail-print",component:xo},{path:"select-filter",component:_(6841).S},{path:"add",component:Kt},{path:"product-selector",component:qo.c},{path:"option-selector",component:Zo.p}];let yo=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[O.Bz.forChild(Ao),O.Bz]}),o})();var ct=_(3093);let To=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,s.u5,l.Pc,yo,ct.m,P.uH,T.aw.forChild({loader:{provide:T.Zw,useFactory:ct.x,deps:[N.eN]}})]}),o})()},6026:(V,I,_)=>{_.d(I,{k:()=>O});var p=_(6738),s=_(191),l=_(6961),T=_(4006),N=_(3306);const P=["barcodeInput"];let O=(()=>{class u{constructor(y,v){this.viewCtrl=y,this.productService=v}ngOnInit(){this.barcodeFocus()}ionViewLoaded(){this.barcodeFocus()}barcodeFocus(){setTimeout(()=>{this.barcodeInput.setFocus()},600)}barcodeChanged(){!this.barcode||this.barcode.length<5||this.productService.searchByBarcode(this.barcode).then(y=>{!y||this.ok()})}dismiss(){this.viewCtrl.dismiss()}ok(){this.viewCtrl.dismiss({barcode:this.barcode})}}return u.\u0275fac=function(y){return new(y||u)(p.Y36(s.IN),p.Y36(l.M))},u.\u0275cmp=p.Xpm({type:u,selectors:[["barcode-input"]],viewQuery:function(y,v){if(1&y&&p.Gf(P,7),2&y){let h;p.iGM(h=p.CRH())&&(v.barcodeInput=h.first)}},decls:22,vars:13,consts:[["slot","start"],[3,"click"],["name","close"],[1,"ion-padding"],["clearInput","","autofocus","true","type","text",3,"placeholder","ngModel","ngModelChange"],["barcodeInput",""],["color","primary","expand","block",3,"click"],["color","secondary","expand","block",3,"click"]],template:function(y,v){1&y&&(p.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),p.NdJ("click",function(){return v.dismiss()}),p._UZ(4,"ion-icon",2),p.qZA()(),p.TgZ(5,"ion-title"),p._uU(6),p.ALo(7,"translate"),p.qZA()()(),p.TgZ(8,"ion-content",3)(9,"ion-input",4,5),p.NdJ("ngModelChange",function(q){return v.barcode=q})("ngModelChange",function(){return v.barcodeChanged()}),p.ALo(11,"translate"),p.qZA(),p.TgZ(12,"ion-grid")(13,"ion-row")(14,"ion-col")(15,"ion-button",6),p.NdJ("click",function(){return v.ok()}),p._uU(16),p.ALo(17,"translate"),p.qZA()(),p.TgZ(18,"ion-col")(19,"ion-button",7),p.NdJ("click",function(){return v.dismiss()}),p._uU(20),p.ALo(21,"translate"),p.qZA()()()()()),2&y&&(p.xp6(6),p.hij(" ",p.lcZ(7,5,"order-add.enter-barcode")," "),p.xp6(3),p.s9C("placeholder",p.lcZ(11,7,"order-add.enter-barcode-placeholder")),p.Q6J("ngModel",v.barcode),p.xp6(7),p.Oqu(p.lcZ(17,9,"common.agree")),p.xp6(4),p.hij("",p.lcZ(21,11,"common.cancel")," "))},dependencies:[T.JJ,T.On,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.pK,s.Nd,s.wd,s.sr,s.j9,N.X$],encapsulation:2}),u})()},7613:(V,I,_)=>{_.d(I,{F:()=>h});var p=_(5861),s=_(6738),l=_(6895),T=_(4006),N=_(191);const P=["template"],O=["input1"],u=["input2"];function J(q,D){if(1&q){const t=s.EpF();s.TgZ(0,"ion-input",4,5),s.NdJ("ngModelChange",function(x){s.CHM(t);const w=s.oxw(2);return s.KtG(w.moneyValueString=x)})("ionBlur",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.ionBlur())})("ionFocus",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.ionFocus())})("keyup.enter",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.onEnter())}),s.qZA()}if(2&q){const t=s.oxw(2);s.Q6J("placeholder",t.placeholder)("disabled",t.disabled)("ngModel",t.moneyValueString)}}function y(q,D){if(1&q){const t=s.EpF();s.TgZ(0,"ion-input",6,7),s.NdJ("ngModelChange",function(x){s.CHM(t);const w=s.oxw(2);return s.KtG(w.moneyValueString=x)})("ionBlur",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.ionBlur())})("ionFocus",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.ionFocus())})("keyup.enter",function(){s.CHM(t);const x=s.oxw(2);return s.KtG(x.onEnter())}),s.qZA()}if(2&q){const t=s.oxw(2);s.Q6J("disabled",t.disabled)("placeholder",t.placeholder)("ngModel",t.moneyValueString)}}function v(q,D){if(1&q){const t=s.EpF();s.YNc(0,J,2,3,"ion-input",1),s.YNc(1,y,2,3,"ion-input",2),s.TgZ(2,"ion-input",3),s.NdJ("ngModelChange",function(x){s.CHM(t);const w=s.oxw();return s.KtG(w.moneyValue=x)})("ngModelChange",function(x){s.CHM(t);const w=s.oxw();return s.KtG(w.change(x))})("ionChange",function(){s.CHM(t);const x=s.oxw();return s.KtG(x.change(x.moneyValue))}),s.qZA()}if(2&q){const t=s.oxw();s.Q6J("ngIf",t.clear),s.xp6(1),s.Q6J("ngIf",!t.clear),s.xp6(1),s.Q6J("hidden",!0)("ngModel",t.moneyValue)}}let h=(()=>{class q{constructor(t){this.viewContainerRef=t,this.moneyValueChange=new s.vpe,this.clear=!1,this.decimal=".",this.thousands=",",this.decimalCount=2,this.changing=!1}ngOnInit(){var t=this;return(0,p.Z)(function*(){t.thousands=t.thousandsSeparator(),t.decimal="."===t.thousands?",":".",setTimeout(()=>{t.moneyValueString=t.moneyValue?t.formatMoney(t.moneyValue):t.moneyValue},1e3),t.viewContainerRef.createEmbeddedView(t.template)})()}getMoneyValueStringToNumber(t){if(t){let C=t.split(this.decimal).join("");return C=C.split(this.thousands).join(this.thousandsSeparator()),+C}return t}change(t){this.moneyValue=t,t?(this.moneyValueString=this.formatMoney(t),this.oldValue=this.moneyValueString):(this.moneyValueString=t,this.oldValue=t)}ionFocus(){return(0,p.Z)(function*(){})()}ionBlur(){if(this.moneyValueString){let t=this.moneyValueString.split(this.decimal).join("");t=t.split(this.thousands).join(this.thousandsSeparator()),this.moneyValue=+t,this.moneyValueString!=this.oldValue&&(this.moneyValueChange.emit(+t),this.oldValue=this.moneyValueString)}else this.moneyValue=this.moneyValueString,this.moneyValueString!=this.oldValue&&(this.moneyValueChange.emit(this.moneyValueString),this.oldValue=this.moneyValueString);this.moneyValueString=this.formatMoney(this.moneyValue),setTimeout(()=>{this.changing=!1},300)}formatMoney(t){if(!t)return t;const C=this.decimalCount,w=this.decimal,B=this.thousands;try{const H="\\d(?=(\\d{3})+"+(C>0?"\\D":"$")+")",K=t.toFixed(Math.max(0,~~C));let L=(B?K.replace(".",B):K).replace(new RegExp(H,"g"),"$&"+(w||","));return L&&(L.indexOf(this.thousands+"00")&&(L=L.split(this.thousands+"00").join("")),L)}catch(H){console.error(H)}}thousandsSeparator(){return parseFloat(.55.toString()).toLocaleString().indexOf(",55")>=0?",":"."}select(t){this.moneyValueString=t,this.ionBlur()}onEnter(){var t=this;return(0,p.Z)(function*(){const C=t.input1?t.input1:t.input2;if(!C)return;const x=yield C.getInputElement();!x||x.blur()})()}}return q.\u0275fac=function(t){return new(t||q)(s.Y36(s.s_b))},q.\u0275cmp=s.Xpm({type:q,selectors:[["money-input"]],viewQuery:function(t,C){if(1&t&&(s.Gf(P,7),s.Gf(O,5),s.Gf(u,5)),2&t){let x;s.iGM(x=s.CRH())&&(C.template=x.first),s.iGM(x=s.CRH())&&(C.input1=x.first),s.iGM(x=s.CRH())&&(C.input2=x.first)}},inputs:{moneyValue:"moneyValue",placeholder:"placeholder",disabled:"disabled",clear:"clear"},outputs:{moneyValueChange:"moneyValueChange"},decls:2,vars:0,consts:[["template",""],["type","text","inputmode","numeric",3,"placeholder","disabled","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter",4,"ngIf"],["inputmode","numeric","style","background-color: #efefef; border-radius: 5px; color: #000; margin-bottom: 5px;","type","text",3,"disabled","placeholder","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter",4,"ngIf"],[3,"hidden","ngModel","ngModelChange","ionChange"],["type","text","inputmode","numeric",3,"placeholder","disabled","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter"],["input1",""],["inputmode","numeric","type","text",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"disabled","placeholder","ngModel","ngModelChange","ionBlur","ionFocus","keyup.enter"],["input2",""]],template:function(t,C){1&t&&s.YNc(0,v,3,4,"ng-template",null,0,s.W1O)},dependencies:[l.O5,T.JJ,T.On,N.pK,N.j9],encapsulation:2}),q})()}}]);