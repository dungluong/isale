"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7970],{7970:(q,f,o)=>{o.r(f),o.d(f,{RegisterModule:()=>O});var p=o(3306),y=o(6895),h=o(4006),s=o(191),Z=o(2216),S=o(3196),c=o(5861),e=o(6738),A=o(5851),b=o(7488),_=o(8272),T=o(3142),M=o(323),C=o(3736),x=o(2703);function R(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ion-button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeto("vn"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.vietnamese"),""))}function L(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ion-button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeto("vn"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.vietnamese"),""))}function Y(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ion-button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeto("en"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.english"),""))}function w(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ion-button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeto("en"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"language.english"),""))}const F=[{path:"",component:(()=>{class r{constructor(t,n,i,a,u,m,v,d,g){this.navCtrl=t,this.translateService=n,this.userService=i,this.activityService=a,this.alertCtrl=u,this.dataService=m,this.analyticsService=v,this.firebase=d,this.fcmTokenService=g,this.username="",this.password="",this.confirm="",this.language="vn",this.shop=""}ngOnInit(){this.userService.getAttr("current-language").then(t=>{this.language=t}),this.activityService.logActivity({feature:"Register",action:"",note:""})}ionViewWillEnter(){var t=this;return(0,c.Z)(function*(){yield t.analyticsService.setCurrentScreen("register")})()}register(){var t=this;return(0,c.Z)(function*(){if(!t.shop||""===t.shop.trim())return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-shop-required"),buttons:["OK"]})).present());if(!t.username||""===t.username.trim())return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-username-required"),buttons:["OK"]})).present());if(!t.validate(t.username.trim()))return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-email-phone-required"),buttons:["OK"]})).present());if(!t.password||""===t.password)return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-password-required"),buttons:["OK"]})).present());if(!t.confirm||""===t.confirm)return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-confirm-required"),buttons:["OK"]})).present());if(t.confirm!==t.password)return void(yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.alert-confirm-notmatch"),buttons:["OK"]})).present());const n=yield t.navCtrl.loading();t.userService.register(t.username.trim().toLowerCase(),t.password,t.shop).then((0,c.Z)(function*(){t.analyticsService.logEvent("register-successfully"),yield n.dismiss(),yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("register.register-successfully")+" "+t.username.trim(),buttons:["OK"]})).present(),yield t.tryLogin()}))})()}tryLogin(){var t=this;return(0,c.Z)(function*(){const n=yield t.navCtrl.loading();t.userService.getUserByNameAndPassword(t.username.trim(),t.password,!0).then(function(){var i=(0,c.Z)(function*(a){if(a){t.analyticsService.logEvent("login-successfully");const u=a;u.isRemember=!0,t.userService.setLoggedUser(u),t.navCtrl.isNotCordova()||t.firebase.getToken().then(function(){var d=(0,c.Z)(function*(g){yield t.fcmTokenService.saveToken(g)});return function(g){return d.apply(this,arguments)}}(),d=>{console.error(d)});const m={id:0,name:t.shop};yield t.dataService.save("shop",m);const v={id:0,language:t.language,currency:"en"===t.language?"USD":"VND",dateFormat:"en"===t.language?"MM/DD/YYYY":"DD/MM/YYYY",timeFormat:"HH:mm"};yield t.dataService.save("shop_config",v),yield t.getShopConfig(),t.navCtrl.navigateRoot("/home")}else yield(yield t.alertCtrl.create({header:t.translateService.instant("common.alert"),subHeader:t.translateService.instant("login.alert-username-orpassword-notcorrect"),buttons:["OK"]})).present();yield n.dismiss()});return function(a){return i.apply(this,arguments)}}(),function(){var i=(0,c.Z)(function*(a){console.error(a),alert("Check your internet connection - Ki\u1ec3m tra l\u1ea1i k\u1ebft n\u1ed1i m\u1ea1ng"),yield n.dismiss()});return function(a){return i.apply(this,arguments)}}()).catch(function(){var i=(0,c.Z)(function*(a){console.error(a),alert("Check your internet connection - Ki\u1ec3m tra l\u1ea1i k\u1ebft n\u1ed1i m\u1ea1ng"),yield n.dismiss()});return function(a){return i.apply(this,arguments)}}())})()}getShopConfig(){var t=this;return(0,c.Z)(function*(){yield t.dataService.getFirstObject("shop_config").then(n=>{const i=n&&n.language?n.language:"vn",u=n&&n.dateFormat?n.dateFormat:"DD/MM/YYYY",m=n&&n.timeFormat?n.timeFormat:"HH:mm",v=!(!n||!n.outStockNotSell)&&n.outStockNotSell,d=!(!n||!n.printOrderLikeInvoice)&&n.printOrderLikeInvoice,g=!(!n||!n.hideTax)&&n.hideTax,H=!(!n||!n.hideTablesFunction)&&n.hideTablesFunction,U=!(!n||!n.hideCalendarFunction)&&n.hideCalendarFunction,K=!(!n||!n.hideMaterials)&&n.hideMaterials,I=n.orderInvoiceMaxEmptyRows?n.orderInvoiceMaxEmptyRows:10,E=!!n.hideDiscountColumn,D=!!n.showStaffNameUnderSign;t.userService.setAttr("current-currency",n&&n.currency?n.currency:"VND"),t.userService.setCurrentLanguage(i),t.userService.setAttr("date-format",u),t.userService.setAttr("time-format",m),t.userService.setAttr("out-stock",v),t.userService.setAttr("print-order-like-invoice",d),t.userService.setAttr("hide-tax",g),t.userService.setAttr("hide-tables-function",H),t.userService.setAttr("hide-calendar-function",U),t.userService.setAttr("hide-materials",K),t.userService.setAttr("order-invoice-max-empty-rows",I),t.userService.setAttr("hide-discount-column",E),t.userService.setAttr("show-staff-name-under-sign",D)})})()}validate(t){return this.validateEmail(t)||this.validatePhonenumber(t)}validateEmail(t){return!!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)}validatePhonenumber(t){return!!t.match(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im)}changeLanguage(){this.analyticsService.logEvent("register-change-language"),this.userService.setCurrentLanguage(this.language)}changeto(t){this.language=t,this.changeLanguage()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(A.G),e.Y36(p.sK),e.Y36(b.K),e.Y36(_.M),e.Y36(s.Br),e.Y36(T.D),e.Y36(M.y),e.Y36(C.L),e.Y36(x.s))},r.\u0275cmp=e.Xpm({type:r,selectors:[["register"]],decls:46,vars:43,consts:[["slot","start"],["defaultHref","/home"],["color","primary"],["color","primary","fill","solid",3,"click",4,"ngIf"],["color","primary","fill","clear",3,"click",4,"ngIf"],["position","stacked"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["clearInput","","type","password",3,"placeholder","ngModel","ngModelChange"],["padding",""],["color","primary","expand","block",3,"click"],["color","primary","fill","solid",3,"click"],["color","primary","fill","clear",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.qZA()()(),e.TgZ(7,"ion-content")(8,"ion-list")(9,"ion-item")(10,"ion-label",2),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"ion-buttons"),e.YNc(14,R,3,3,"ion-button",3),e.YNc(15,L,3,3,"ion-button",4),e.YNc(16,Y,3,3,"ion-button",3),e.YNc(17,w,3,3,"ion-button",4),e.qZA()(),e.TgZ(18,"ion-item")(19,"ion-label",5),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"ion-input",6),e.NdJ("ngModelChange",function(a){return n.shop=a}),e.ALo(23,"translate"),e.qZA()(),e.TgZ(24,"ion-item")(25,"ion-label",5),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"ion-input",6),e.NdJ("ngModelChange",function(a){return n.username=a}),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"ion-item")(31,"ion-label",5),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"ion-input",7),e.NdJ("ngModelChange",function(a){return n.password=a}),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"ion-item")(37,"ion-label",5),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"ion-input",7),e.NdJ("ngModelChange",function(a){return n.confirm=a}),e.ALo(41,"translate"),e.qZA()()(),e.TgZ(42,"div",8)(43,"ion-button",9),e.NdJ("click",function(){return n.register()}),e._uU(44),e.ALo(45,"translate"),e.qZA()()()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,21,"register.title")),e.xp6(2),e.Akn(n.navCtrl.hasAds()?"--padding-bottom: 60px":""),e.xp6(4),e.Oqu(e.lcZ(12,23,"language.language")),e.xp6(3),e.Q6J("ngIf","vn"===n.language),e.xp6(1),e.Q6J("ngIf","en"===n.language),e.xp6(1),e.Q6J("ngIf","en"===n.language),e.xp6(1),e.Q6J("ngIf","vn"===n.language),e.xp6(3),e.Oqu(e.lcZ(21,25,"register.shop")),e.xp6(2),e.s9C("placeholder",e.lcZ(23,27,"register.enter-shop")),e.Q6J("ngModel",n.shop),e.xp6(4),e.hij("",e.lcZ(27,29,"login.username")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(29,31,"login.enter-username")),e.Q6J("ngModel",n.username),e.xp6(4),e.Oqu(e.lcZ(33,33,"login.password")),e.xp6(2),e.s9C("placeholder",e.lcZ(35,35,"login.enter-password")),e.Q6J("ngModel",n.password),e.xp6(4),e.Oqu(e.lcZ(39,37,"register.confirm-password")),e.xp6(2),e.s9C("placeholder",e.lcZ(41,39,"login.enter-password")),e.Q6J("ngModel",n.confirm),e.xp6(4),e.Oqu(e.lcZ(45,41,"register.register")))},dependencies:[y.O5,h.JJ,h.On,s.oU,s.YG,s.Sm,s.W2,s.Gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.sr,s.j9,s.cs,p.X$],encapsulation:2}),r})()}];let k=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[S.Bz.forChild(F),S.Bz]}),r})();var N=o(529),J=o(3093);let O=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[y.ez,h.u5,s.Pc,k,Z.uH,p.aw.forChild({loader:{provide:p.Zw,useFactory:J.x,deps:[N.eN]}})]}),r})()}}]);