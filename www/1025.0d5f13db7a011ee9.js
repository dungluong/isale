"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1025],{1025:(Pt,R,x)=>{x.r(R),x.d(R,{ProductsPageModule:()=>rs});var T=x(6895),P=x(4006),s=x(191),X=x(3196),l=x(5861),q=x(7489),Z=x(6723),Y=x(6026),C=x(1914),V=x(4372),t=x(6738),tt=x(9921),I=x(9645),N=x(6961),A=x(667),L=x(7833),b=x(3306),E=x(7488),et=x(3142),M=x(5851),Q=x(323),it=x(6861),D=x(3876),$=x(7060),ot=x(7613);function St(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.dismiss())}),t._UZ(1,"ion-icon",18),t.qZA()}}function wt(i,c){1&i&&t._UZ(0,"ion-menu-button",19)}function kt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.navCtrl.home())}),t._UZ(1,"ion-icon",21),t.qZA()}}function qt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",22)(1,"ion-label",23),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",25),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function Nt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",26)(1,"p",27),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.navCtrl.push("/request-pro"))}),t._UZ(5,"ion-icon",29),t._uU(6),t.ALo(7,"translate"),t.qZA()()}2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"product.no-pro-plan")),t.xp6(4),t.hij("\xa0 ",t.lcZ(7,4,"home.request-pro-plan")," "))}function Ut(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",30)(3,"ion-item",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.importProducts())}),t.TgZ(4,"ion-label",32),t._UZ(5,"ion-icon",33)(6,"br"),t.TgZ(7,"ion-text",34),t._uU(8),t.ALo(9,"translate"),t.qZA()()()(),t.TgZ(10,"ion-col",30)(11,"ion-item",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exportProductsReport())}),t.TgZ(12,"ion-label",32),t._UZ(13,"ion-icon",35)(14,"br"),t.TgZ(15,"ion-text",34),t._uU(16),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"ion-col",30)(19,"ion-item",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exportProductNotesReport(0))}),t.TgZ(20,"ion-label",32),t._UZ(21,"ion-icon",36)(22,"br"),t.TgZ(23,"ion-text",34),t._uU(24),t.ALo(25,"translate"),t.qZA()()()(),t.TgZ(26,"ion-col",30)(27,"ion-item",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exportProductNotesReport(1))}),t.TgZ(28,"ion-label",32),t._UZ(29,"ion-icon",37)(30,"br"),t.TgZ(31,"ion-text",34),t._uU(32),t.ALo(33,"translate"),t.qZA()()()()()()}2&i&&(t.xp6(8),t.hij("",t.lcZ(9,4,"product.import-from-excel")," "),t.xp6(8),t.hij("",t.lcZ(17,6,"product.export-to-excel")," "),t.xp6(8),t.hij(" ",t.lcZ(25,8,"product-note-export.report-type-summary")," "),t.xp6(8),t.hij(" ",t.lcZ(33,10,"product-note-export.report-type-detail")," "))}function It(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",52),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showSearchCategory())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.categorySelected.title," ")}}function Jt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showSearchCategory())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"promotion-add.select-category")," "))}function Mt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.removeCategory())}),t._UZ(1,"ion-icon",53),t.qZA()}}function Qt(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function Lt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",60),t.qZA(),t.TgZ(3,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",61),t.qZA()()}}function Et(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",54)(1,"ion-buttons")(2,"ion-button",55),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.changeSortOrder())}),t._uU(3),t.ALo(4,"translate"),t._UZ(5,"ion-icon",56),t.qZA()(),t.TgZ(6,"ion-label",57),t._uU(7),t.ALo(8,"translate"),t.YNc(9,Qt,3,4,"span",12),t.qZA(),t.YNc(10,Lt,5,0,"ion-buttons",58),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,6,"common.sort")," "),t.xp6(2),t.Q6J("name","desc"===e.sortOrder?"arrow-down-outline":"arrow-up-outline"),t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(8,8,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function Ot(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",65),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.multiDelete())}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"ion-icon",66),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-detail.delete-multi")," "))}function Yt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-checkbox",62),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.isSelectAll=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.selectAll())}),t.qZA(),t.TgZ(2,"ion-buttons"),t.YNc(3,Ot,4,3,"ion-button",63),t.TgZ(4,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exitSelectMode())}),t._uU(5),t.ALo(6,"translate"),t._UZ(7,"ion-icon",64),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.isSelectAll),t.xp6(2),t.Q6J("ngIf",!e.searchMode),t.xp6(2),t.hij(" ",t.lcZ(6,3,"product-detail.exit-select-mode")," ")}}function Ft(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",73),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.isSelected=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.productSelectedChange())}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.isSelected)}}const F=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function Gt(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3).$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,F,e.costPrice,o.currency,o.translateService.currentLang)))}}function Kt(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function Ht(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Gt,3,11,"span",12),t.YNc(4,Kt,2,0,"span",12),t.qZA()),2&i){const e=t.oxw(4);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function Dt(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function Bt(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function jt(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"product-detail.product-quantity"),": ",o.store?e.storeQuantity?e.storeQuantity:0:e.count,"")}}function $t(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-text"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA(),t.YNc(5,Ht,5,5,"span",12),t.TgZ(6,"span"),t.YNc(7,Dt,2,0,"span",12),t.YNc(8,Bt,2,0,"span",12),t.YNc(9,jt,3,4,"span",12),t._uU(10),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.AsE(" ",t.lcZ(3,7,"product-detail.product-unit-price"),": ",t.G7q(4,9,t.kEZ(15,F,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice),t.xp6(2),t.Q6J("ngIf",e.costPrice),t.xp6(1),t.Q6J("ngIf",!e.costPrice),t.xp6(1),t.Q6J("ngIf",!o.blockViewingQuantity),t.xp6(1),t.hij(" ",e.unit,"")}}function Vt(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3).$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,F,e.costPrice,o.currency,o.translateService.currentLang)))}}function zt(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function Wt(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Vt,3,11,"span",12),t.YNc(4,zt,2,0,"span",12),t.qZA()),2&i){const e=t.oxw(4);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function Rt(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function Xt(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function te(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,"product-detail.product-quantity"),": ",o.store?e.storeQuantity?e.storeQuantity:0:e.count,"")}}function ee(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._uU(4,"\xa0-\xa0 "),t.TgZ(5,"ion-text"),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"currency"),t.qZA(),t.YNc(9,Wt,5,5,"span",12),t.TgZ(10,"span"),t.YNc(11,Rt,2,0,"span",12),t.YNc(12,Xt,2,0,"span",12),t.YNc(13,te,3,4,"span",12),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,8,"product-add.unit"),": ",e.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(7,10,"product-detail.product-unit-price"),": ",t.G7q(8,12,t.kEZ(18,F,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice),t.xp6(2),t.Q6J("ngIf",e.costPrice),t.xp6(1),t.Q6J("ngIf",!e.costPrice),t.xp6(1),t.Q6J("ngIf",!o.blockViewingQuantity)}}function oe(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._UZ(3,"ion-icon",74),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(4),t.AsE(" \xa0",t.lcZ(5,2,"product-add.expired-date"),": ",o.dateFormat(e.expiredAt)," ")}}function ne(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",4),t._UZ(1,"img",75),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function ie(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(4);t.xp6(1),t.AsE(" - ",t.lcZ(2,2,"product-add.cost-price"),": ",t.G7q(3,4,t.kEZ(10,F,e.costPrice,o.currency,o.translateService.currentLang))," ")}}function re(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",77),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.selectProduct(n))})("press",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.presentActionSheet(n))}),t.TgZ(1,"ion-label",78)(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._uU(5,"\xa0-\xa0 "),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.YNc(10,ie,4,14,"span",12),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA()()()}if(2&i){const e=c.$implicit,o=c.index,n=t.oxw(2).$implicit,r=t.oxw(2);t.Q6J("lines",o===n.units.length-1?"":"none"),t.xp6(3),t.AsE("",t.lcZ(4,8,"product-add.unit"),": ",e.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(8,10,"product-detail.product-unit-price"),": ",t.G7q(9,12,t.kEZ(20,F,e.price,r.currency,r.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice&&r.canViewProductCostPrice),t.xp6(2),t.AsE(" - ",t.lcZ(13,18,"product-add.unit-exchange"),": ",e.exchange,"")}}function ce(i,c){if(1&i&&(t.ynx(0),t.YNc(1,re,14,24,"ion-item",76),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.units)}}function ae(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item-sliding")(2,"ion-item",67),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r))})("press",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))}),t.YNc(3,Ft,1,1,"ion-checkbox",68),t.TgZ(4,"ion-label",23)(5,"span",69)(6,"ion-text",70),t._uU(7),t.qZA()(),t._UZ(8,"br"),t.YNc(9,$t,11,19,"ng-container",12),t.YNc(10,ee,14,22,"ng-container",12),t.YNc(11,oe,6,4,"span",12),t.qZA(),t.YNc(12,ne,2,1,"ion-thumbnail",58),t.qZA(),t.TgZ(13,"ion-item-options",71)(14,"ion-item-option",16),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))}),t._UZ(15,"ion-icon",72),t.qZA()()(),t.YNc(16,ce,2,1,"ng-container",12),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(3),t.Q6J("ngIf",o.selectMode),t.xp6(4),t.Oqu(o.limitText(o.productName(e.code,e.title))),t.xp6(2),t.Q6J("ngIf",!e.units||!e.units.length),t.xp6(1),t.Q6J("ngIf",e.units&&e.units.length),t.xp6(1),t.Q6J("ngIf",e.expiredAt),t.xp6(1),t.Q6J("ngIf",e.avatarUrl),t.xp6(4),t.Q6J("ngIf",e&&e.units&&e.units.length)}}function se(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function de(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",60),t.qZA(),t.TgZ(3,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",61),t.qZA()()}}function le(i,c){if(1&i&&(t.TgZ(0,"ion-item",79)(1,"ion-label",57),t._uU(2),t.ALo(3,"translate"),t.YNc(4,se,3,4,"span",12),t.qZA(),t.YNc(5,de,5,0,"ion-buttons",58),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function ue(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-grid")(2,"ion-row")(3,"ion-col",38)(4,"ion-label",39),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"div")(8,"ion-select",40),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.listOption=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeListOption())}),t.ALo(9,"translate"),t.TgZ(10,"ion-select-option",41),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"ion-select-option",42),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"ion-select-option",43),t._uU(17),t.ALo(18,"translate"),t.qZA()()()(),t.TgZ(19,"ion-col",38)(20,"ion-label",39),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"div")(24,"ion-buttons"),t.YNc(25,It,2,1,"ion-button",44),t.YNc(26,Jt,3,3,"ion-button",45),t.YNc(27,Mt,2,0,"ion-button",45),t.qZA()()(),t.TgZ(28,"ion-col",46),t.YNc(29,Et,11,10,"ion-item",47),t.qZA()()(),t.YNc(30,Yt,8,5,"ion-item",12),t.YNc(31,ae,17,7,"ng-container",48),t.ALo(32,"slice"),t.TgZ(33,"ion-grid")(34,"ion-row")(35,"ion-col",49),t._uU(36," \xa0 "),t.qZA(),t.TgZ(37,"ion-col",50),t.YNc(38,le,6,6,"ion-item",51),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(5),t.hij(" ",t.lcZ(6,14,"product.filter-by")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(9,16,"product.select-option")),t.Q6J("ngModel",e.listOption),t.xp6(3),t.Oqu(t.lcZ(12,18,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(15,20,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(18,22,"product.list-option-quantiy")),t.xp6(4),t.hij(" ",t.lcZ(22,24,"promotion-add.category")," "),t.xp6(4),t.Q6J("ngIf",e.categorySelected&&e.categorySelected.id>0),t.xp6(1),t.Q6J("ngIf",!e.categorySelected||0===e.categorySelected.id),t.xp6(1),t.Q6J("ngIf",e.categorySelected&&e.categorySelected.id>0),t.xp6(2),t.Q6J("ngIf",e.products&&e.products.length),t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(1),t.Q6J("ngForOf",t.Dn7(32,26,e.products,e.start,e.end+1)),t.xp6(7),t.Q6J("ngIf",e.products&&e.products.length)}}function _e(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",92),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showSelect())}),t._UZ(1,"ion-icon",93),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product-detail.multi-select")," "))}function pe(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",92),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exitSelectMode())}),t._UZ(1,"ion-icon",93),t._uU(2),t.ALo(3,"translate"),t._UZ(4,"ion-icon",94),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product-detail.exit-select-mode")," "))}function me(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",52),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showSearchCategory())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.categorySelected.title," ")}}function ge(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showSearchCategory())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"promotion-add.select-category")," "))}function fe(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.removeCategory())}),t._UZ(1,"ion-icon",53),t.qZA()}}function xe(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function he(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",60),t.qZA(),t.TgZ(3,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",61),t.qZA()()}}function Ze(i,c){if(1&i&&(t.TgZ(0,"ion-item",54)(1,"ion-label",57),t._uU(2),t.ALo(3,"translate"),t.YNc(4,xe,3,4,"span",12),t.qZA(),t.YNc(5,he,5,0,"ion-buttons",58),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function Te(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",99),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.multiDelete())}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"ion-icon",100),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-detail.delete-multi")," "))}function Ae(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",92),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.printMultiBarcode())}),t._UZ(1,"ion-icon",101),t._uU(2),t.ALo(3,"translate"),t._UZ(4,"ion-icon",102),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product.print-barcodes")," "))}function Ce(i,c){if(1&i&&(t.TgZ(0,"ion-label"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE(" ",t.lcZ(2,2,"common.selected-item"),": ",e.selectedCount," ")}}function ye(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",92),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.multiEdit())}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"ion-icon",103),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"common.multi-edit")," "))}function be(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.multiEdit())}),t._UZ(1,"ion-icon",18),t.qZA()}}function ve(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.revertValues())}),t._UZ(1,"ion-icon",105),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" \xa0",t.lcZ(3,1,"common.revert-values")," "))}function Pe(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",106),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.saveMultiEdit())}),t._UZ(1,"ion-icon",107),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" \xa0",t.lcZ(3,1,"action.save")," "))}function Se(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.showHelpMultiEditForField())}),t._UZ(1,"ion-icon",108),t.qZA()}}function we(i,c){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col",95)(2,"ion-item",54)(3,"ion-buttons"),t.YNc(4,Te,4,3,"ion-button",96),t.YNc(5,Ae,5,3,"ion-button",81),t.YNc(6,Ce,3,4,"ion-label",12),t.qZA(),t.TgZ(7,"ion-buttons",4),t.YNc(8,ye,4,3,"ion-button",81),t.YNc(9,be,2,0,"ion-button",45),t.YNc(10,ve,4,3,"ion-button",97),t.YNc(11,Pe,4,3,"ion-button",98),t.YNc(12,Se,2,0,"ion-button",1),t.qZA()()()()),2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",!e.searchMode),t.xp6(1),t.Q6J("ngIf",!e.searchMode),t.xp6(1),t.Q6J("ngIf",e.selectedCount),t.xp6(2),t.Q6J("ngIf",!e.multiEditMode&&!e.searchMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode)}}function ke(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",62),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.isSelectAll=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.selectAll())}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("ngModel",e.isSelectAll)}}function qe(i,c){1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"product-add.cost-price")))}function Ne(i,c){1&i&&(t.TgZ(0,"ion-col",89)(1,"ion-item",54)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"product-add.unit")))}function Ue(i,c){1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"product-detail.photo")))}function Ie(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",87)(1,"ion-item",54)(2,"money-input",113),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(3);return t.KtG(r.costPrice=n)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-buttons")(5,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.applyMultiEditForField("costPrice"))}),t._UZ(6,"ion-icon",111),t.qZA()()()()}if(2&i){const e=t.oxw(3);t.xp6(2),t.s9C("placeholder",t.lcZ(3,2,"product-add.enter-price")),t.Q6J("moneyValue",e.costPrice)}}function Je(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",109)(1,"ion-col",49),t._uU(2," \xa0 "),t.qZA(),t.TgZ(3,"ion-col",87)(4,"ion-item",54)(5,"money-input",110),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.price=n)}),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons")(8,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.applyMultiEditForField("price"))}),t._UZ(9,"ion-icon",111),t.qZA()()()(),t.YNc(10,Ie,7,4,"ion-col",88),t.TgZ(11,"ion-col",87)(12,"ion-item",54)(13,"ion-input",112),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.quantity=n)})("focus",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.selectAll(n))}),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"ion-buttons")(16,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.applyMultiEditForField("count"))}),t._UZ(17,"ion-icon",111),t.qZA()()()()()}if(2&i){const e=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(5),t.s9C("placeholder",t.lcZ(6,7,"product-add.enter-price")),t.Q6J("moneyValue",e.price),t.xp6(5),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(3),t.s9C("placeholder",t.lcZ(14,9,"product-add.enter-count")),t.Q6J("ngModel",e.quantity)}}function Me(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",73),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.isSelected=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.productSelectedChange())}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.isSelected)}}function Qe(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0(",e.unit,")")}}function Le(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,F,e.price,o.currency,o.translateService.currentLang)))}}function Ee(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"money-input",119),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.price=n)})("moneyValueChange",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.changeValue(n,"price"))}),t.ALo(1,"translate"),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.s9C("placeholder",t.lcZ(1,2,"product-add.enter-price")),t.Q6J("moneyValue",e.price)}}function Oe(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,F,e.costPrice,o.currency,o.translateService.currentLang)))}}function Ye(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"money-input",121),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2).$implicit;return t.KtG(r.costPrice=n)})("moneyValueChange",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.changeValue(n,"costPrice"))}),t.ALo(1,"translate"),t.qZA()}if(2&i){const e=t.oxw(2).$implicit;t.s9C("placeholder",t.lcZ(1,2,"product-add.enter-price")),t.Q6J("moneyValue",e.costPrice)}}function Fe(i,c){if(1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54),t.YNc(2,Oe,3,11,"span",12),t.YNc(3,Ye,2,4,"money-input",120),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(2),t.Q6J("ngIf",!e.multiEditMode||!e.selectMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode&&e.selectMode)}}function Ge(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(o.store?e.storeQuantity?e.storeQuantity:0:e.count)}}function Ke(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-input",122),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.count=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.changeValue(n,"count"))}),t.ALo(1,"translate"),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.s9C("placeholder",t.lcZ(1,2,"product-add.enter-count")),t.Q6J("ngModel",e.count)}}function He(i,c){if(1&i&&(t.TgZ(0,"ion-col",89)(1,"ion-item",54),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.unit," ")}}function De(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",124),t._UZ(1,"img",75),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function Be(i,c){if(1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54),t.YNc(2,De,2,1,"ion-thumbnail",123),t.qZA()()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",e.avatarUrl)}}function je(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0(",e.unit,")")}}function $e(i,c){if(1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(3);t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,F,e.costPrice,o.currency,o.translateService.currentLang))," ")}}function Ve(i,c){if(1&i&&(t.TgZ(0,"ion-col",89)(1,"ion-item",54),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.unit," ")}}function ze(i,c){1&i&&(t.TgZ(0,"ion-col",87)(1,"ion-item",54),t._uU(2," \xa0 "),t.qZA()())}function We(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",114),t.NdJ("press",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.presentActionSheet(n))})("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.selectProduct(n))}),t.TgZ(1,"ion-col",49)(2,"ion-item",54),t._uU(3),t.YNc(4,je,2,1,"span",12),t.qZA()(),t.TgZ(5,"ion-col",87)(6,"ion-item",54),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.YNc(9,$e,4,11,"ion-col",88),t.TgZ(10,"ion-col",116)(11,"ion-item",54),t._uU(12),t.qZA()(),t.YNc(13,Ve,3,1,"ion-col",90),t.YNc(14,ze,3,0,"ion-col",88),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw().$implicit,n=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(3),t.hij(" ",n.limitText(n.productName(o.code,o.title)),""),t.xp6(1),t.Q6J("ngIf",o.units&&o.units.length),t.xp6(3),t.hij(" ",t.G7q(8,10,t.kEZ(16,F,e.price,n.currency,n.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",n.canViewProductCostPrice),t.xp6(1),t.Q6J("size",n.multiEditMode?2:1),t.xp6(2),t.hij(" ",n.store?o.storeQuantity?n.floor(o.storeQuantity*e.exchange):0:n.floor(o.count/e.exchange)," "),t.xp6(1),t.Q6J("ngIf",!n.multiEditMode),t.xp6(1),t.Q6J("ngIf",!n.multiEditMode)}}function Re(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-row",114),t.NdJ("press",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))})("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r))}),t.TgZ(2,"ion-col",49)(3,"ion-item",54),t.YNc(4,Me,1,1,"ion-checkbox",68),t._uU(5),t.YNc(6,Qe,2,1,"span",12),t.qZA()(),t.TgZ(7,"ion-col",87)(8,"ion-item",54),t.YNc(9,Le,3,11,"span",12),t.YNc(10,Ee,2,4,"money-input",115),t.qZA()(),t.YNc(11,Fe,4,2,"ion-col",88),t.TgZ(12,"ion-col",116)(13,"ion-item",54),t.YNc(14,Ge,2,1,"span",12),t.YNc(15,Ke,2,4,"ion-input",117),t.qZA()(),t.YNc(16,He,3,1,"ion-col",90),t.YNc(17,Be,3,1,"ion-col",88),t.qZA(),t.YNc(18,We,15,20,"ion-row",118),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(1),t.Udp("cursor","pointer"),t.xp6(3),t.Q6J("ngIf",o.selectMode),t.xp6(1),t.hij(" ",o.limitText(o.productName(e.code,e.title)),""),t.xp6(1),t.Q6J("ngIf",e.units&&e.units.length),t.xp6(3),t.Q6J("ngIf",!o.multiEditMode||!o.selectMode),t.xp6(1),t.Q6J("ngIf",o.multiEditMode&&o.selectMode),t.xp6(1),t.Q6J("ngIf",o.canViewProductCostPrice),t.xp6(1),t.Q6J("size",o.multiEditMode?2:1),t.xp6(2),t.Q6J("ngIf",!o.multiEditMode||!o.selectMode),t.xp6(1),t.Q6J("ngIf",o.multiEditMode&&o.selectMode),t.xp6(1),t.Q6J("ngIf",!o.multiEditMode),t.xp6(1),t.Q6J("ngIf",!o.multiEditMode),t.xp6(1),t.Q6J("ngForOf",e.units)}}function Xe(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function to(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",60),t.qZA(),t.TgZ(3,"ion-button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",61),t.qZA()()}}function eo(i,c){if(1&i&&(t.TgZ(0,"ion-item",54)(1,"ion-label",57),t._uU(2),t.ALo(3,"translate"),t.YNc(4,Xe,3,4,"span",12),t.qZA(),t.YNc(5,to,5,0,"ion-buttons",58),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function oo(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",80)(3,"ion-item",54)(4,"ion-buttons"),t.YNc(5,_e,4,3,"ion-button",81),t.YNc(6,pe,5,3,"ion-button",81),t.qZA(),t.TgZ(7,"ion-select",40),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.listOption=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeListOption())}),t.ALo(8,"translate"),t.TgZ(9,"ion-select-option",41),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"ion-select-option",42),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"ion-select-option",43),t._uU(16),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"ion-col",80)(19,"ion-item",54)(20,"ion-label",82),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"ion-buttons"),t.YNc(24,me,2,1,"ion-button",44),t.YNc(25,ge,3,3,"ion-button",45),t.YNc(26,fe,2,0,"ion-button",45),t.qZA()()(),t.TgZ(27,"ion-col",38),t.YNc(28,Ze,6,6,"ion-item",83),t.qZA()(),t.YNc(29,we,13,8,"ion-row",12),t.TgZ(30,"ion-row")(31,"ion-col",49)(32,"ion-item",54),t.YNc(33,ke,1,1,"ion-checkbox",84),t.TgZ(34,"strong"),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"ion-buttons")(38,"ion-button",85),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeSortOrder())}),t._UZ(39,"ion-icon",86),t.qZA()()()(),t.TgZ(40,"ion-col",87)(41,"ion-item",54)(42,"strong"),t._uU(43),t.ALo(44,"translate"),t.qZA()()(),t.YNc(45,qe,5,3,"ion-col",88),t.TgZ(46,"ion-col",89)(47,"ion-item",54)(48,"strong"),t._uU(49),t.ALo(50,"translate"),t.qZA()()(),t.YNc(51,Ne,5,3,"ion-col",90),t.YNc(52,Ue,5,3,"ion-col",88),t.qZA(),t.YNc(53,Je,18,11,"ion-row",91),t.YNc(54,Re,19,14,"ng-container",48),t.ALo(55,"slice"),t.TgZ(56,"ion-row")(57,"ion-col",49),t._uU(58," \xa0 "),t.qZA(),t.TgZ(59,"ion-col",50),t.YNc(60,eo,6,6,"ion-item",83),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngIf",!e.selectMode),t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(1),t.s9C("placeholder",t.lcZ(8,24,"product.select-option")),t.Q6J("ngModel",e.listOption),t.xp6(3),t.Oqu(t.lcZ(11,26,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(14,28,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(17,30,"product.list-option-quantiy")),t.xp6(5),t.hij(" ",t.lcZ(22,32,"promotion-add.category")," "),t.xp6(3),t.Q6J("ngIf",e.categorySelected&&e.categorySelected.id>0),t.xp6(1),t.Q6J("ngIf",!e.categorySelected||0===e.categorySelected.id),t.xp6(1),t.Q6J("ngIf",e.categorySelected&&e.categorySelected.id>0),t.xp6(2),t.Q6J("ngIf",e.products&&e.products.length),t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(4),t.Q6J("ngIf",e.selectMode),t.xp6(2),t.Oqu(t.lcZ(36,34,"product-add.product-title")),t.xp6(4),t.Q6J("name","desc"===e.sortOrder?"arrow-down-outline":"arrow-up-outline"),t.xp6(4),t.Oqu(t.lcZ(44,36,"product-add.price")),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(4),t.Oqu(t.lcZ(50,38,"product-add.count")),t.xp6(2),t.Q6J("ngIf",!e.multiEditMode),t.xp6(1),t.Q6J("ngIf",!e.multiEditMode),t.xp6(1),t.Q6J("ngIf",e.multiEditMode&&e.selectMode),t.xp6(1),t.Q6J("ngForOf",t.Dn7(55,40,e.products,e.start,e.end+1)),t.xp6(6),t.Q6J("ngIf",e.products&&e.products.length)}}function no(i,c){1&i&&(t.TgZ(0,"ion-item",125),t._UZ(1,"div",126),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product.no-product"),t.oJD))}function io(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",127),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.goHelpPage("product"))}),t._UZ(1,"ion-icon",128),t.TgZ(2,"ion-label",70),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"help-product.title")," "))}let ro=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U,v,f,w,S){var h=this;this.platform=e,this.printer=o,this.barcodeScanner=n,this.productService=r,this.staffService=a,this.debtService=d,this.translateService=u,this.userService=p,this.currencyPipe=_,this.actionSheetCtrl=g,this.alertCtrl=m,this.modalCtrl=y,this.dataService=k,this.navCtrl=J,this.analyticsService=U,this.planService=v,this.storeService=f,this.toastCtrl=w,this.excelService=S,this.searchKey="",this.isMobile=!0,this.checkProduct=0,this.currentPlan=null,this.start=0,this.end=20,this.pageSize=20,this.currentPage=0,this.listOption="all",this.selectMode=!1,this.isSelectAll=!1,this.canViewProductCostPrice=!1,this.multiEditMode=!1,this.sortOrder="asc",this.searchMode=!1,this.blockViewingQuantity=!1,this.reload=(0,l.Z)(function*(){const G=yield h.navCtrl.loading();h.isMobile=h.platform.width()<720,h.currency=yield h.userService.getAttr("current-currency"),h.currentPlan=yield h.planService.getCurrentPlan(),h.selectedStaff=h.staffService.selectedStaff,h.blockViewingQuantity=h.selectedStaff&&h.selectedStaff.blockViewingQuantity,h.store=yield h.storeService.getCurrentStore(),h.canViewProductCostPrice=!h.selectedStaff||h.selectedStaff.hasFullAccess||h.selectedStaff.canViewProductCostPrice,h.checkStore=h.store?h.translateService.instant("store.check-store",{shop:h.store.name}):null,h.currentPlan||(h.checkProduct=yield h.planService.checkProduct(),h.checkProduct>=30&&(h.isOnTrial=yield h.planService.isOnTrial(h.currentPlan))),("all"===h.listOption?h.productService.getProducts(h.store?h.store.id:0,h.categorySelected?h.categorySelected.id:0):"expiry"===h.listOption?h.productService.getProductsExpiry(h.store?h.store.id:0,h.categorySelected?h.categorySelected.id:0):h.productService.getProductsQuantity(h.store?h.store.id:0,h.categorySelected?h.categorySelected.id:0)).then(function(){var nt=(0,l.Z)(function*(pt){for(const mt of pt)mt.units=mt.unitsJson?JSON.parse(mt.unitsJson):[];const vt=q.orderBy(pt,["title"],[h.sortOrder]);h.originalProducts=JSON.parse(JSON.stringify(vt)),h.products=vt,yield G.dismiss()});return function(pt){return nt.apply(this,arguments)}}())}),this.doEnteredBarcode=(G,j=!1)=>{!G||this.productService.searchByBarcode(G).then(nt=>{if(nt)return j&&(this.searchKey=""),this.analyticsService.logEvent("product-scan-barcode-ok"),void this.navCtrl.push("/product/detail",{id:nt.id});j||this.navCtrl.push("/product/quick-add",{barcode:G})})},this.navCtrl.removeEventListener("reloadProductList",this.reload),this.navCtrl.addEventListener("reloadProductList",this.reload)}multiEdit(){this.multiEditMode=!this.multiEditMode}ngOnInit(){this.platform.resize.subscribe(()=>{this.isMobile=this.platform.width()<720}),this.reload()}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){e.params=e.navCtrl.getParams(e.params),e.params&&e.params.callback&&(e.callback=e.params.callback),e.params&&e.params.categorySelected&&(e.categorySelected=e.params.categorySelected),e.params&&e.params.searchMode&&(e.searchMode=e.params.searchMode),yield e.analyticsService.setCurrentScreen("product")})()}changeSortOrder(){this.sortOrder="desc"===this.sortOrder?"asc":"desc",this.reload()}openProductAdd(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct())return!e.currentPlan&&e.checkProduct>=30&&!e.isOnTrial?(e.analyticsService.logEvent("check-product-alert"),void alert(e.translateService.instant("product.check-product-alert",{total:e.checkProduct}))):void e.navCtrl.push("/product/quick-add");alert(e.translateService.instant("product.no-permission"))})()}isNotCordova(){return this.navCtrl.isNotCordova()}scanProduct(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-scan-barcode"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.doEnteredBarcode(n.barcode)}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.doEnteredBarcode(o.text)})})()}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-search");let o=JSON.parse(JSON.stringify(e.originalProducts));if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.code&&-1!==r.code.toLowerCase().indexOf(n)||r.title&&-1!==r.title.toLowerCase().indexOf(n)),(!o||!o.length)&&e.searchKey.length>=5&&e.doEnteredBarcode(e.searchKey,!0)}e.products=o,e.start=0,e.end=e.pageSize,e.currentPage=0})()}clearSearch(){this.searchKey=null,this.reload()}limitText(e,o=200){return Z.W.limitText(e,o)}selectProduct(e){var o=this;return(0,l.Z)(function*(){if(!o.selectMode){if(o.searchMode)return o.callback?(o.callback(e),void(yield o.navCtrl.back())):void o.modalCtrl.dismiss(e);o.navCtrl.push("/product/detail",{id:e.id})}})()}deleteProduct(e){var o=this;return(0,l.Z)(function*(){o.staffService.canAddUpdateProduct()?yield(yield o.alertCtrl.create({header:o.translateService.instant("common.confirm"),message:o.translateService.instant("product-detail.delete-alert"),buttons:[{text:o.translateService.instant("common.agree"),handler:()=>{o.productService.deleteProduct(e).then((0,l.Z)(function*(){o.analyticsService.logEvent("product-delete-success");let a=o.products.findIndex(d=>d.id===e.id);a>=0&&o.products.splice(a,1),a=o.originalProducts.findIndex(d=>d.id===e.id),a>=0&&o.originalProducts.splice(a,1)}))}},{text:o.translateService.instant("common.cancel"),handler:()=>{}}]})).present():alert(o.translateService.instant("product.no-permission"))})()}importProducts(){if(!this.currentPlan&&this.checkProduct>=30&&!this.isOnTrial)return this.analyticsService.logEvent("check-product-alert"),void alert(this.translateService.instant("product.check-product-alert",{total:this.checkProduct}));this.navCtrl.navigateForward("/product/import")}presentActionSheet(e){var o=this;return(0,l.Z)(function*(){yield(yield o.actionSheetCtrl.create({header:o.translateService.instant("action.action"),buttons:[{text:o.translateService.instant("product-detail.delete"),role:"destructive",handler:()=>{o.deleteProduct(e)}},{text:o.translateService.instant("product-detail.view-detail"),handler:()=>{o.selectProduct(e.id)}},{text:o.translateService.instant("product-detail.copy"),handler:()=>{o.copyProduct(e)}},{text:o.translateService.instant("product-detail.multi-select"),handler:()=>{o.selectMode=!0}},{text:o.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}copyProduct(e){var o=this;return(0,l.Z)(function*(){const n=JSON.parse(JSON.stringify(e));o.navCtrl.push("/product/quick-add",{copy:n})})()}productName(e,o){return Z.W.productName(e,o)}removeProductDebts(e){return new Promise((o,n)=>{this.debtService.getDebtsByContact(e).then(r=>{const a=[];if(r&&r.length>0)for(const d of r){d.productId=0;const u=this.debtService.saveDebt(d);a.push(u)}a.length>0?Promise.all(a).then(()=>{o(!0)}).catch(()=>{n(null)}):o(!0)}).catch(()=>{n(null)})})}exportProductNotesReport(e){this.navCtrl.navigateForward("/product/export",{reportType:e})}goHelpPage(e){this.navCtrl.push("/help/"+e)}exportProductsReport(){var e=this;return(0,l.Z)(function*(){const o="products-report.xlsx",n=yield e.navCtrl.loading();e.excelService.downloadProductsReport(o).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-export-to-excel-success"),yield n.dismiss(),e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(o,o,a))});return function(a){return r.apply(this,arguments)}}())})()}requestProPlan(){this.navCtrl.push("/request-pro")}dateFormat(e){return C.C.toUiDateString(e)}showExpiries(){this.navCtrl.navigateForward("/product/expiries")}get isShowPaging(){return!!(this.products&&this.products.length>this.pageSize)}previousPage(){this.currentPage<=0?this.currentPage=0:(this.currentPage--,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.isSelectAll=!1,this.content.scrollToTop())}nextPage(){(this.currentPage+1)*this.pageSize>=this.products.length||(this.currentPage++,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.isSelectAll=!1,this.content.scrollToTop())}changeListOption(){this.start=0,this.end=19,this.currentPage=0,this.reload()}showSelect(){this.selectMode=!0,this.isSelectAll=!1}exitSelectMode(){this.revertValues(),this.selectMode=!1,this.isSelectAll=!1;for(const e of this.products)e.isSelected=!1}multiDelete(){var e=this;return(0,l.Z)(function*(){const o=e.products?e.products.filter(r=>r.isSelected).length:0;var r;0!==o?yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-detail.multi-delete-alert",{count:o}),buttons:[{text:e.translateService.instant("common.agree"),handler:(r=(0,l.Z)(function*(){const a=yield e.navCtrl.loading(),d=[],u=[];for(const p of e.products)p.isSelected&&(d.push(p),u.push(e.productService.deleteProduct(p)));yield Promise.all(u);for(const p of d){e.analyticsService.logEvent("product-delete-success");let _=e.products.findIndex(g=>g.id===p.id);_>=0&&e.products.splice(_,1),_=e.originalProducts.findIndex(g=>g.id===p.id),_>=0&&e.originalProducts.splice(_,1)}e.selectMode=!1,yield a.dismiss()}),function(){return r.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present():alert(e.translateService.instant("product-detail.multi-delete-no-product-alert"))})()}selectAll(){for(const e of this.products)e.isSelected=!1;for(let e=this.start;e<this.end;e++)this.products[e].isSelected=this.isSelectAll;this.productSelectedChange()}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),yield e.reload()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}floor(e){return Math.floor(e)}showSearchCategory(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-filter-by-category"),e.navCtrl.push("/trade-category",{callback:n=>{n&&(e.categorySelected=n,e.reload())},searchMode:!0})})()}removeCategory(){this.categorySelected=null,this.reload()}showHelpMultiEditForField(){alert(this.translateService.instant("product.multi-edit-field-apply-des"))}applyMultiEditForField(e){const o="price"===e?this.price:"costPrice"===e?this.costPrice:this.quantity;if(!o)return void alert(this.translateService.instant("common.no-value-alert"));let n=0;for(const r of this.products)r.isSelected&&(r[e]=o,n++);n||alert(this.translateService.instant("common.no-selected-item-alert"))}saveMultiEdit(){var e=this;return(0,l.Z)(function*(){const o=yield e.navCtrl.loading();let n=0;for(const r of e.products)if(r.isSelected){const a=r.count,d=e.originalProducts.find(u=>u.id===r.id);if(!d)continue;if(r.count=d.count!==r.count?d.count:r.count,yield e.productService.saveProduct(r),d.count!==a){const u=new V.d;u.amount=0,u.unitPrice=r.price,u.unit=r.unit,u.quantity=a-d.count,u.productId=r.id,u.productCode=r.code,u.productName=r.title,u.discount=0,u.discountType=0,u.storeId=e.store?e.store.id:u.storeId,u.note=e.translateService.instant("product-add.update-quantity-manually"),u.staffId=e.staffService.isStaff()?e.staffService.selectedStaff.id:0,yield e.productService.saveProductNote(u)}n++,r.count=a,d.count=a,d.price=r.price,d.costPrice=r.costPrice}if(!n)return yield o.dismiss(),void alert(e.translateService.instant("common.no-selected-item-alert"));yield o.dismiss(),e.presentToast(e.translateService.instant("common.saved-item-alert",{count:n})),e.price=null,e.quantity=null,e.costPrice=null})()}revertValues(){let e=0;for(const o of this.products)if(o.isSelected){const n=this.originalProducts.find(r=>r.id===o.id);e++,o.count=n.count,o.price=n.price,o.costPrice=n.costPrice}e||alert(this.translateService.instant("common.no-selected-item-alert"))}productSelectedChange(){let e=0;for(const o of this.products)o.isSelected&&e++;this.selectedCount=e}presentToast(e){var o=this;return(0,l.Z)(function*(){yield(yield o.toastCtrl.create({message:e,duration:3e3,position:"bottom",color:"danger"})).present()})()}printMultiBarcode(){let e="",o=0;for(const n of this.products)if(n.isSelected&&n.barcode){const r=this.currencyPipe.transform(n.price,this.currency,"symbol","1.0-2",this.translateService.currentLang);e+=`\n          ${o?'<div style="break-after:page"></div>':""}\n          <div style='text-align: center;'>\n            <img src='${this.userService.apiUrl}/qrcode/barcode?code=${n.barcode}'/>       \n            <div>\n              <small>${n.barcode}</small>\n              <br>\n              <b>${n.title}.&nbsp;<span>${r}</span></b></span>\n            </div>\n          </div>\n          `,o++}o?this.navCtrl.isNotCordova()?Z.W.webPrint(e):this.printer.print(e).then(()=>{}):alert(this.translateService.instant("common.no-selected-item-alert"))}changeValue(e,o){const n=this.originalProducts.find(r=>r.id===e.id);!n||e[o]!==n[o]&&!e.isSelected&&(e.isSelected=!0,this.productSelectedChange())}dismiss(){var e=this;return(0,l.Z)(function*(){if(e.callback)return e.callback(null),void(yield e.navCtrl.back());e.modalCtrl.dismiss()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.t4),t.Y36(tt.F),t.Y36(I.m),t.Y36(N.M),t.Y36(A.x),t.Y36(L.E),t.Y36(b.sK),t.Y36(E.K),t.Y36(T.H9),t.Y36(s.BX),t.Y36(s.Br),t.Y36(s.IN),t.Y36(et.D),t.Y36(M.G),t.Y36(Q.y),t.Y36(it.D),t.Y36(D.d),t.Y36(s.yF),t.Y36($.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-products"]],viewQuery:function(e,o){if(1&e&&t.Gf(s.W2,7),2&e){let n;t.iGM(n=t.CRH())&&(o.content=n.first)}},decls:28,vars:22,consts:[["slot","start"],[3,"click",4,"ngIf"],["menu","first",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],["slot","end"],["size","large","color","success",3,"click"],["slot","icon-only","name","barcode-sharp"],["size","large","root","product-add",3,"click"],["slot","icon-only","name","add-circle-sharp"],["lines","none","color","success",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["style","padding: 10px; margin: 10px; background-color: #f0ad4e; color: white; border-radius: 10px;",4,"ngIf"],[4,"ngIf"],["class","ion-text-wrap","lines","none",4,"ngIf"],["button","","detail","","lines","none",3,"click",4,"ngIf"],["vertical","bottom","horizontal","start","slot","fixed",3,"hidden"],[3,"click"],["name","add"],["name","close"],["menu","first"],["color","primary",3,"click"],["name","home"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],[2,"padding","10px","margin","10px","background-color","#f0ad4e","color","white","border-radius","10px"],[2,"margin","5px 5px 5px 5px"],["color","success","fill","solid",3,"click"],["name","gift","slot","start"],["size-xs","3","size-sm","3","size-md","2","size-md","2",1,"ion-no-padding",2,"padding-right","0px","padding-left","9px"],["lines","none",1,"ion-no-padding",2,"border","1px solid #bbb","border-radius","10px","height","100px","cursor","pointer",3,"click"],[1,"ion-text-wrap","ion-text-center",2,"padding-left","5px","margin-right","0"],["name","document-attach","color","danger",2,"font-size","30px"],[1,"ion-text-wrap",2,"font-size","0.8em"],["name","reader","color","secondary",2,"font-size","30px"],["name","document","color","tertiary",2,"font-size","30px"],["name","newspaper","color","warning",2,"font-size","30px"],["size","6",1,"ion-no-padding"],["position","stacked","color","primary",1,"ion-text-wrap"],[2,"max-width","100% !important",3,"placeholder","ngModel","ngModelChange"],["value","all"],["value","expiry"],["value","quantity"],["color","dark","size","small",3,"click",4,"ngIf"],["size","small",3,"click",4,"ngIf"],["size","12",1,"ion-no-padding"],["lines","none","class","ion-no-padding",4,"ngIf"],[4,"ngFor","ngForOf"],["size","4",1,"ion-no-padding"],["size","8",1,"ion-no-padding"],["lines","none","class","ion-no-padding","lines","none",4,"ngIf"],["color","dark","size","small",3,"click"],["slot","icon-only","name","close"],["lines","none",1,"ion-no-padding"],["color","tertiary","fill","outline","size","small",3,"click"],[3,"name"],[1,"ion-text-wrap","ion-text-right"],["slot","end",4,"ngIf"],["fill","solid",3,"click"],["slot","icon-only","name","arrow-back-circle"],["slot","icon-only","name","arrow-forward-circle"],["slot","start","color","primary",3,"ngModel","ngModelChange"],["color","danger",3,"click",4,"ngIf"],["name","exit-outline"],["color","danger",3,"click"],["name","trash"],[3,"click","press"],["color","primary","slot","start",3,"ngModel","ngModelChange",4,"ngIf"],[2,"white-space","pre-wrap","font-weight","bproduct.storeQuantityold"],["color","primary"],["side","end"],["slot","icon-only","name","ellipsis-vertical"],["color","primary","slot","start",3,"ngModel","ngModelChange"],["name","calendar"],[3,"src"],["style","--min-height: 0",3,"lines","click","press",4,"ngFor","ngForOf"],[2,"--min-height","0",3,"lines","click","press"],[1,"ion-text-wrap",2,"margin","5px 0 0 0"],["lines","none","lines","none",1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["color","primary","fill","outline",3,"click",4,"ngIf"],["color","primary",1,"ion-text-wrap"],["class","ion-no-padding","lines","none",4,"ngIf"],["slot","start","color","primary",3,"ngModel","ngModelChange",4,"ngIf"],["color","tertiary",3,"click"],["slot","icon-only",3,"name"],["size","2",1,"ion-no-padding"],["class","ion-no-padding","size","2",4,"ngIf"],["size","1",1,"ion-no-padding"],["class","ion-no-padding","size","1",4,"ngIf"],["style","border-bottom: 1px solid #ccc;",3,"cursor",4,"ngIf"],["color","primary","fill","outline",3,"click"],["slot","start","name","list-outline"],["name","exit-outline","slot","end"],[1,"ion-no-padding"],["color","danger","fill","outline",3,"click",4,"ngIf"],["fill","outline","size","small",3,"click",4,"ngIf"],["fill","outline","size","small","color","primary",3,"click",4,"ngIf"],["color","danger","fill","outline",3,"click"],["name","trash","slot","end"],["name","print-outline","slot","start"],["name","barcode","slot","end"],["name","pencil","slot","end"],["fill","outline","size","small",3,"click"],["name","arrow-undo-outline"],["fill","outline","size","small","color","primary",3,"click"],["name","checkmark"],["slot","icon-only","name","help-circle-outline","color","danger","size","small"],[2,"border-bottom","1px solid #ccc"],[3,"placeholder","moneyValue","moneyValueChange"],["slot","icon-only","name","checkmark-done","color","tertiary","size","small"],["clearInput","","type","number","tabindex","3",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange","focus"],[3,"moneyValue","placeholder","moneyValueChange"],[2,"border-bottom","1px solid #ccc",3,"press","click"],["debounce","700",3,"placeholder","moneyValue","moneyValueChange",4,"ngIf"],[1,"ion-no-padding",3,"size"],["debounce","700","clearInput","","style","background-color: #efefef; border-radius: 5px; color: #000; margin-bottom: 5px;","type","number",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["style","border-bottom: 1px solid #ccc;",3,"cursor","press","click",4,"ngFor","ngForOf"],["debounce","700",3,"placeholder","moneyValue","moneyValueChange"],["debounce","700",3,"moneyValue","placeholder","moneyValueChange",4,"ngIf"],["debounce","700",3,"moneyValue","placeholder","moneyValueChange"],["debounce","700","clearInput","","type","number",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange"],["class","ion-item-right","size","small",4,"ngIf"],["size","small",1,"ion-item-right"],["lines","none",1,"ion-text-wrap"],[3,"innerHTML"],["button","","detail","","lines","none",3,"click"],["name","help","slot","start"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.YNc(3,St,2,0,"ion-button",1),t.YNc(4,wt,1,0,"ion-menu-button",2),t.YNc(5,kt,2,0,"ion-button",3),t.qZA(),t.TgZ(6,"ion-title"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"ion-buttons",4)(10,"ion-button",5),t.NdJ("click",function(){return o.scanProduct()}),t._UZ(11,"ion-icon",6),t.qZA(),t.TgZ(12,"ion-button",7),t.NdJ("click",function(){return o.openProductAdd()}),t._UZ(13,"ion-icon",8),t.qZA()()(),t.YNc(14,qt,8,4,"ion-item",9),t.TgZ(15,"ion-searchbar",10),t.NdJ("ionClear",function(){return o.clearSearch()})("ionChange",function(){return o.search()})("ngModelChange",function(r){return o.searchKey=r}),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"ion-content"),t.YNc(18,Nt,8,6,"div",11),t.YNc(19,Ut,34,12,"ion-grid",12),t.TgZ(20,"ion-list"),t.YNc(21,ue,39,30,"ng-container",12),t.YNc(22,oo,61,44,"ion-grid",12),t.YNc(23,no,3,3,"ion-item",13),t.YNc(24,io,5,3,"ion-item",14),t.qZA(),t.TgZ(25,"ion-fab",15)(26,"ion-fab-button",16),t.NdJ("click",function(){return o.openProductAdd()}),t._UZ(27,"ion-icon",17),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("ngIf",o.searchMode),t.xp6(1),t.Q6J("ngIf",!o.searchMode),t.xp6(1),t.Q6J("ngIf",!o.searchMode),t.xp6(2),t.Oqu(t.lcZ(8,18,"product.title")),t.xp6(7),t.Q6J("ngIf",o.checkStore&&(null===o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)&&!o.searchMode),t.xp6(1),t.s9C("placeholder",t.lcZ(16,20,"product.search")),t.Q6J("ngModel",o.searchKey),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.Q6J("ngIf",!o.currentPlan&&!o.isOnTrial&&!o.searchMode),t.xp6(1),t.Q6J("ngIf",!o.searchMode),t.xp6(2),t.Q6J("ngIf",o.isMobile),t.xp6(1),t.Q6J("ngIf",!o.isMobile&&o.products&&o.products.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"margin-bottom: 60px":""),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.nz,s.wI,s.W2,s.IJ,s.W4,s.jY,s.Gu,s.gu,s.pK,s.Ie,s.u8,s.IK,s.td,s.Q$,s.q_,s.fG,s.Nd,s.VI,s.t9,s.n0,s.yW,s.Bs,s.wd,s.sr,s.w,s.as,s.QI,s.j9,ot.F,T.OU,T.H9,b.X$],encapsulation:2}),i})();var rt=x(6841),K=x(1454),gt=x(2035),ct=x(3285),at=x(4433),st=x(2126),co=x(7696),ao=x(6391),so=x(3604),lo=x(3090),uo=x(8262);function _o(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.note.contact.fullName)}}function po(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"trade.staff")," ",e.note.staff.name,"")}}function mo(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"store.created-by")," ",e.note.store.name,"")}}function go(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",8),t._UZ(1,"img",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contactImageOrPlaceholder(e.note.contact),t.LSH)}}const z=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function fo(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",1),t.NdJ("press",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.press())})("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.click())}),t.TgZ(1,"ion-label",2)(2,"h2")(3,"ion-text",3),t._uU(4),t.ALo(5,"translate"),t.ALo(6,"currency"),t.qZA()(),t.TgZ(7,"h3")(8,"ion-text"),t._uU(9),t.qZA()(),t.TgZ(10,"ion-text",4),t._uU(11),t.qZA(),t.YNc(12,_o,2,1,"p",5),t.YNc(13,po,4,4,"p",5),t.YNc(14,mo,4,4,"p",5),t.TgZ(15,"p"),t._uU(16),t.qZA()(),t.YNc(17,go,2,1,"ion-avatar",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.lnq("",t.lcZ(5,12,"order-add.order")," #",e.note.order.orderCode," | +",t.G7q(6,14,t.kEZ(20,z,e.note.amount,e.currency,e.translateService.currentLang)),""),t.xp6(5),t.lnq(" ",e.note.productName," | -",e.note.quantity," ",e.note.unit," "),t.xp6(2),t.Oqu(e.limitText(e.note.note)),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact),t.xp6(1),t.Q6J("ngIf",e.note&&e.note.staff),t.xp6(1),t.Q6J("ngIf",e.note.store),t.xp6(2),t.hij(" ",e.dateFormat(e.note.createdAt)," "),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact)}}function xo(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("",e.note.productCode,"-")}}function ho(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" (",e.note.receivedNote.foreignCurrency,")")}}function Zo(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.YNc(2,ho,2,1,"ion-text",5),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" | ",e.note.amountForeign,"\xa0"),t.xp6(1),t.Q6J("ngIf",e.note.receivedNote&&e.note.receivedNote.foreignCurrency)}}function To(i,c){if(1&i&&(t.TgZ(0,"ion-text",4),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.limitText(e.note.note))}}function Ao(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.note.contact.fullName)}}function Co(i,c){if(1&i&&(t.TgZ(0,"p")(1,"span",12),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"received-note-add.cost-price"),": ",t.G7q(4,4,t.kEZ(10,z,e.note.unitPrice,e.currency,e.translateService.currentLang)),"")}}function yo(i,c){if(1&i&&(t.TgZ(0,"p")(1,"span",12),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"received-note-add.received-date"),": ",e.dateFormat(e.note.receivedDate),"")}}function bo(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"store.created-by")," ",e.note.store.name,"")}}function vo(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",8),t._UZ(1,"img",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contactImageOrPlaceholder(e.note.contact),t.LSH)}}function Po(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",1),t.NdJ("press",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.press())})("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.click())}),t.TgZ(1,"ion-label",2)(2,"h2")(3,"ion-text",10),t._uU(4),t.ALo(5,"translate"),t.ALo(6,"currency"),t.qZA()(),t.TgZ(7,"h3"),t.YNc(8,xo,2,1,"ion-text",5),t._uU(9),t.YNc(10,Zo,3,2,"ion-text",5),t.qZA(),t.YNc(11,To,2,1,"ion-text",11),t.YNc(12,Ao,2,1,"p",5),t.YNc(13,Co,5,14,"p",5),t.YNc(14,yo,4,4,"p",5),t.YNc(15,bo,4,4,"p",5),t.TgZ(16,"p"),t._uU(17),t.qZA()(),t.YNc(18,vo,2,1,"ion-avatar",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.lnq("",t.lcZ(5,15,"received-note-add.received-note")," #",e.note.receivedNoteId," | -",t.G7q(6,17,t.kEZ(23,z,e.note.amount,e.currency,e.translateService.currentLang)),""),t.xp6(4),t.Q6J("ngIf",e.note.productCode),t.xp6(1),t.lnq("",e.note.productName," | +",e.note.quantity," ",e.note.unit," "),t.xp6(1),t.Q6J("ngIf",e.note.amountForeign),t.xp6(1),t.Q6J("ngIf",e.note.note),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact),t.xp6(1),t.Q6J("ngIf",e.note.unitPrice),t.xp6(1),t.Q6J("ngIf",e.note.receivedDate),t.xp6(1),t.Q6J("ngIf",e.note.store),t.xp6(2),t.hij(" ",e.dateFormat(e.note.createdAt)," "),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact)}}function So(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("",e.note.productCode,"-")}}function wo(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function ko(i,c){if(1&i&&(t.TgZ(0,"ion-text",4),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.limitText(e.note.note))}}function qo(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"store.created-by")," ",e.note.store.name,"")}}function No(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",8),t._UZ(1,"img",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contactImageOrPlaceholder(e.note.contact),t.LSH)}}function Uo(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",1),t.NdJ("press",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.press())})("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.click())}),t.TgZ(1,"ion-label",2)(2,"h2")(3,"ion-text",13),t._uU(4),t.ALo(5,"translate"),t.ALo(6,"currency"),t.qZA()(),t.TgZ(7,"h3"),t.YNc(8,So,2,1,"ion-text",5),t._uU(9),t.YNc(10,wo,2,0,"span",5),t._uU(11),t.qZA(),t.YNc(12,ko,2,1,"ion-text",11),t.YNc(13,qo,4,4,"p",5),t.TgZ(14,"p"),t._uU(15),t.qZA()(),t.YNc(16,No,2,1,"ion-avatar",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.HOy("",t.lcZ(5,13,"transfer-note-add.transfer-note")," #",e.note.transferNoteId," | ",e.note.amount>0?"+":"","",t.G7q(6,15,t.kEZ(21,z,e.note.amount,e.currency,e.translateService.currentLang)),""),t.xp6(4),t.Q6J("ngIf",e.note.productCode),t.xp6(1),t.hij("",e.note.productName," | "),t.xp6(1),t.Q6J("ngIf",e.note.quantity>0),t.xp6(1),t.AsE("",e.note.quantity," ",e.note.unit," "),t.xp6(1),t.Q6J("ngIf",e.note.note),t.xp6(1),t.Q6J("ngIf",e.note.store),t.xp6(2),t.hij(" ",e.dateFormat(e.note.createdAt)," "),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact)}}function Io(i,c){1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij("",t.lcZ(2,1,"trade.sale")," -"))}function Jo(i,c){1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij("",t.lcZ(2,1,"trade.buy")," -"))}function Mo(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("",e.note.productCode,"-")}}function Qo(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" (",e.note.receivedNote.foreignCurrency,")")}}function Lo(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.YNc(2,Qo,2,1,"ion-text",5),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" | ",e.note.amountForeign,"\xa0"),t.xp6(1),t.Q6J("ngIf",e.note.receivedNote&&e.note.receivedNote.foreignCurrency)}}function Eo(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.note.note)}}function Oo(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.note.contact.fullName)}}function Yo(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"store.created-by")," ",e.note.store.name,"")}}function Fo(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",8),t._UZ(1,"img",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contactImageOrPlaceholder(e.note.contact),t.LSH)}}function Go(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",1),t.NdJ("press",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.press())})("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.click())}),t.TgZ(1,"ion-label",2)(2,"ion-text",14),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"currency"),t.qZA(),t.TgZ(6,"p"),t.YNc(7,Io,3,3,"ion-text",5),t.YNc(8,Jo,3,3,"ion-text",5),t.YNc(9,Mo,2,1,"ion-text",5),t._uU(10),t.YNc(11,Lo,3,2,"ion-text",5),t.qZA(),t.YNc(12,Eo,2,1,"p",5),t._UZ(13,"br"),t.TgZ(14,"ion-text",4),t._uU(15),t.qZA(),t.YNc(16,Oo,2,1,"p",5),t.YNc(17,Yo,4,4,"p",5),t.TgZ(18,"p"),t._uU(19),t.qZA()(),t.YNc(20,Fo,2,1,"ion-avatar",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.s9C("color",e.note.amount>0?"primary":"secondary"),t.xp6(1),t.HOy("",t.lcZ(4,19,"product-note.trade")," #",e.note.tradeId," | ",e.note.amount>0?"+":"","",t.G7q(5,21,t.kEZ(27,z,e.note.amount,e.currency,e.translateService.currentLang))," ABC "),t.xp6(4),t.Q6J("ngIf",e.note.amount>0),t.xp6(1),t.Q6J("ngIf",e.note.amount<=0),t.xp6(1),t.Q6J("ngIf",e.note.productCode),t.xp6(1),t.HOy("",e.note.productName," | ",e.note.amount>0?"-":"+","",e.note.quantity," ",e.note.unit," "),t.xp6(1),t.Q6J("ngIf",e.note.amountForeign),t.xp6(1),t.Q6J("ngIf",e.note.note),t.xp6(3),t.Oqu(e.limitText(e.note.note)),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact),t.xp6(1),t.Q6J("ngIf",e.note.store),t.xp6(2),t.hij(" ",e.dateFormat(e.note.createdAt)," "),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact)}}function Ko(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Ho(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.note.contact.fullName)}}function Do(i,c){if(1&i&&(t.TgZ(0,"p")(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,"store.created-by")," ",e.note.store.name,"")}}function Bo(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",8),t._UZ(1,"img",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.contactImageOrPlaceholder(e.note.contact),t.LSH)}}function jo(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",1),t.NdJ("press",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.press())})("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.click())}),t.TgZ(1,"ion-label",2)(2,"h3")(3,"ion-text"),t._uU(4),t.YNc(5,Ko,2,0,"span",5),t._uU(6),t.qZA()(),t.TgZ(7,"ion-text",4),t._uU(8),t.qZA(),t.YNc(9,Ho,2,1,"p",5),t.YNc(10,Do,4,4,"p",5),t.TgZ(11,"p"),t._uU(12),t.qZA()(),t.YNc(13,Bo,2,1,"ion-avatar",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.hij(" ",e.note.productName," | "),t.xp6(1),t.Q6J("ngIf",e.note.quantity>0),t.xp6(1),t.AsE("",e.note.quantity," ",e.note.unit," "),t.xp6(2),t.Oqu(e.limitText(e.note.note)),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact),t.xp6(1),t.Q6J("ngIf",e.note.store),t.xp6(2),t.hij(" ",e.dateFormat(e.note.createdAt)," "),t.xp6(1),t.Q6J("ngIf",e.note.contactId&&0!=e.note.contactId&&e.note.contact&&e.showContact)}}let $o=(()=>{class i{constructor(e){this.translateService=e,this.showContact=!0,this.isStaff=!1,this.showProduct=!0,this.onPress=new t.vpe,this.onClick=new t.vpe}dateFormat(e){return C.C.toUiDateString(e)}contactImageOrPlaceholder(e){return Z.W.contactImageOrPlaceholder(e.avatarUrl)}productName(e,o){return Z.W.productName(e,o)}limitText(e,o=200){return Z.W.limitText(e,o)}press(){this.onPress.emit()}click(){this.onClick.emit()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-note-item"]],inputs:{currency:"currency",showContact:"showContact",isStaff:"isStaff",showProduct:"showProduct",note:"note"},outputs:{onPress:"onPress",onClick:"onClick"},decls:5,vars:5,consts:[[3,"press","click",4,"ngIf"],[3,"press","click"],[1,"ion-text-wrap"],["color","primary"],[2,"white-space","pre-wrap"],[4,"ngIf"],["slot","end",4,"ngIf"],[2,"font-size","11px"],["slot","end"],[3,"src"],["color","secondary"],["style","white-space: pre-wrap;",4,"ngIf"],[2,"font-size","0.85em"],["color","success"],[3,"color"]],template:function(e,o){1&e&&(t.YNc(0,fo,18,24,"ion-item",0),t.YNc(1,Po,19,27,"ion-item",0),t.YNc(2,Uo,17,25,"ion-item",0),t.YNc(3,Go,21,31,"ion-item",0),t.YNc(4,jo,14,9,"ion-item",0)),2&e&&(t.Q6J("ngIf",o.note.orderId&&o.note.order),t.xp6(1),t.Q6J("ngIf",o.note.receivedNoteId),t.xp6(1),t.Q6J("ngIf",o.note.transferNoteId),t.xp6(1),t.Q6J("ngIf",o.note.tradeId&&o.note.trade),t.xp6(1),t.Q6J("ngIf",!(o.note.orderId||o.note.tradeId||o.note.receivedNoteId||o.note.transferNoteId)))},dependencies:[T.O5,s.BJ,s.Ie,s.Q$,s.yW,T.H9,b.X$],encapsulation:2}),i})();const Vo=["barcode"];function zo(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",31)(1,"ion-label",7),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",33),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}const H=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function Wo(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,H,e.product.costPrice,e.currency,e.translateService.currentLang)))}}function Ro(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function Xo(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Wo,3,11,"span",9),t.YNc(4,Ro,2,0,"span",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function tn(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function en(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function on(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-text"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA(),t.YNc(5,Xo,5,5,"span",9),t.TgZ(6,"span"),t.YNc(7,tn,2,0,"span",9),t.YNc(8,en,2,0,"span",9),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.AsE(" ",t.lcZ(3,8,"product-detail.product-unit-price"),": ",t.G7q(4,10,t.kEZ(18,H,e.product.price,e.currency,e.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.product.costPrice),t.xp6(2),t.Q6J("ngIf",e.product.costPrice&&e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.product.costPrice),t.xp6(1),t.lnq("",t.lcZ(10,16,"product-detail.product-quantity"),": ",e.store?e.product.storeQuantity?e.product.storeQuantity:0:e.product.count," ",e.product.unit,"")}}function nn(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,H,e.product.costPrice,e.currency,e.translateService.currentLang)))}}function rn(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function cn(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,nn,3,11,"span",9),t.YNc(4,rn,2,0,"span",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function an(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function sn(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function dn(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._uU(4,"\xa0-\xa0 "),t.TgZ(5,"ion-text"),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"currency"),t.qZA(),t.YNc(9,cn,5,5,"span",9),t.TgZ(10,"span"),t.YNc(11,an,2,0,"span",9),t.YNc(12,sn,2,0,"span",9),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,9,"product-add.unit"),": ",e.product.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(7,11,"product-detail.product-unit-price"),": ",t.G7q(8,13,t.kEZ(21,H,e.product.price,e.currency,e.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.product.costPrice),t.xp6(2),t.Q6J("ngIf",e.product.costPrice&&e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.product.costPrice),t.xp6(1),t.AsE("",t.lcZ(14,19,"product-detail.product-quantity"),": ",e.store?e.product.storeQuantity?e.product.storeQuantity:0:e.product.count,"")}}function ln(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._UZ(3,"ion-icon",34),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.AsE(" \xa0",t.lcZ(5,2,"product-add.expired-date"),": ",e.dateFormat(e.product.expiredAt)," ")}}function un(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.AsE(" - ",t.lcZ(2,2,"product-add.cost-price"),": ",t.G7q(3,4,t.kEZ(10,H,e.costPrice,o.currency,o.translateService.currentLang))," ")}}function _n(i,c){if(1&i&&(t.TgZ(0,"ion-item",36)(1,"ion-label",37)(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._uU(5,"\xa0-\xa0 "),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.YNc(10,un,4,14,"span",9),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA()()()),2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(3),t.AsE("",t.lcZ(4,7,"product-add.unit"),": ",e.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(8,9,"product-detail.product-unit-price"),": ",t.G7q(9,11,t.kEZ(19,H,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice&&o.canViewProductCostPrice),t.xp6(2),t.AsE(" - ",t.lcZ(13,17,"product-add.unit-exchange"),": ",e.exchange,"")}}function pn(i,c){if(1&i&&(t.ynx(0),t.YNc(1,_n,14,23,"ion-item",35),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.units)}}function mn(i,c){1&i&&(t.TgZ(0,"ion-item",38)(1,"ion-label",39),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product-detail.categories"),": "))}function gn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",41)(1,"ion-text",42),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.gotoCat(r.tradeCategory.id))}),t._uU(2),t.qZA()()}if(2&i){const e=c.$implicit;t.xp6(2),t.hij(" ",e.tradeCategory.title," ")}}function fn(i,c){if(1&i&&(t.TgZ(0,"ion-grid")(1,"ion-row"),t.YNc(2,gn,3,1,"ion-col",40),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.categories)}}function xn(i,c){1&i&&(t.TgZ(0,"ion-segment-button",43),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-detail.attributes")," "))}function hn(i,c){1&i&&(t.TgZ(0,"ion-segment-button",44),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-detail.combo-products")," "))}function Zn(i,c){1&i&&(t.TgZ(0,"ion-segment-button",45),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-detail.materials")," "))}function Tn(i,c){1&i&&(t.TgZ(0,"ion-segment-button",46),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"contact.prices")," "))}function An(i,c){1&i&&(t.TgZ(0,"ion-segment-button",47),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"contact.discounts")," "))}function Cn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",49)(1,"img",50),t.NdJ("click",function(){const r=t.CHM(e).index,a=t.oxw().index,d=t.oxw();return t.KtG(d.showImage(3*a+r))}),t.qZA()()}if(2&i){const e=c.$implicit;t.xp6(1),t.Q6J("src",e,t.LSH)}}function yn(i,c){if(1&i&&(t.TgZ(0,"ion-row"),t.YNc(1,Cn,2,1,"ion-col",48),t.qZA()),2&i){const e=c.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function bn(i,c){if(1&i&&(t.TgZ(0,"ion-label",7)(1,"ion-text"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"translate"),t.TgZ(8,"ion-text",55),t._uU(9),t.ALo(10,"currency"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(2),t.HOy(" ",t.lcZ(3,8,"common.from")," ",e.dateFormat(e.dateNoteFrom)," ",t.lcZ(4,10,"common.to")," ",e.dateFormat(e.dateNoteTo)," "),t.xp6(4),t.hij(" ",t.lcZ(7,12,"common.total"),":\xa0 "),t.xp6(2),t.s9C("color",e.totalNoteAmount>=0?"secondary":"danger"),t.xp6(1),t.AsE("",e.totalNoteAmount>=0?"+":""," ",t.G7q(10,14,t.kEZ(20,H,e.totalNoteAmount,e.currency,e.translateService.currentLang)),"")}}function vn(i,c){if(1&i&&(t.TgZ(0,"ion-item",56)(1,"ion-label",57),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-text",58),t._uU(5),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"order-add.collaborator-info")),t.xp6(3),t.hij(" ",e.filteredStaff.name," ")}}function Pn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"product-note-item",59),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectNote(r))}),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Q6J("showProduct",!1)("note",e)("currency",o.currency)}}function Sn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item"),t.YNc(2,bn,11,24,"ion-label",51),t.TgZ(3,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.selectDateRangeForNote())}),t._UZ(4,"ion-icon",52),t.qZA()(),t.YNc(5,vn,6,4,"ion-item",53),t.YNc(6,Pn,1,3,"product-note-item",54),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",""!=e.dateNoteFrom||""!=e.dateNoteTo),t.xp6(3),t.Q6J("ngIf",e.filteredStaff),t.xp6(1),t.Q6J("ngForOf",e.productNotes)}}function wn(i,c){if(1&i&&(t.TgZ(0,"ion-item"),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.xp6(1),t.hij(" ",e.title," ")}}function kn(i,c){if(1&i&&(t.TgZ(0,"ion-list"),t.YNc(1,wn,2,1,"ion-item",30),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.productAttributes)}}function qn(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t._UZ(4,"br"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.HOy(" ",t.lcZ(2,4,"common.from")," ",e.dateFormat(e.dateFrom)," ",t.lcZ(3,6,"common.to")," ",e.dateFormat(e.dateTo)," ")}}function Nn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"trade-item",61),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectTrade(r.id))}),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Q6J("showProduct",!1)("trade",e)("currency",o.currency)}}function Un(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item")(2,"ion-label",7),t.YNc(3,qn,5,8,"ion-text",9),t._uU(4),t.ALo(5,"translate"),t.TgZ(6,"ion-text",55),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.TgZ(9,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.selectDateRangeForTrade())}),t._UZ(10,"ion-icon",52),t.qZA()(),t.YNc(11,Nn,1,3,"trade-item",60),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",""!=e.dateFrom||""!=e.dateTo),t.xp6(1),t.hij(" ",t.lcZ(5,8,"common.total"),":\xa0 "),t.xp6(2),t.s9C("color",e.total>=0?"secondary":"danger"),t.xp6(1),t.HOy("",e.total>=0?"+":""," ",t.G7q(8,10,t.kEZ(16,H,e.total,e.currency,e.translateService.currentLang))," / ",e.totalProduct," ",e.product.unit,""),t.xp6(4),t.Q6J("ngForOf",e.trades)}}function In(i,c){if(1&i&&(t.TgZ(0,"ion-text"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t._UZ(4,"br"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.HOy(" ",t.lcZ(2,4,"common.from")," ",e.dateFormat(e.dateDebtFrom)," ",t.lcZ(3,6,"common.to")," ",e.dateFormat(e.dateDebtTo)," ")}}function Jn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"debt-item",64),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectDebt(r.id))}),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Q6J("showProduct",!1)("debt",e)("currency",o.currency)}}function Mn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item")(2,"ion-label",7),t.YNc(3,In,5,8,"ion-text",9),t._uU(4),t.ALo(5,"translate"),t.TgZ(6,"ion-text",62),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.TgZ(9,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.selectDateRangeForDebt())}),t._UZ(10,"ion-icon",52),t.qZA()(),t.YNc(11,Jn,1,3,"debt-item",63),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",""!=e.dateDebtFrom||""!=e.dateDebtTo),t.xp6(1),t.hij(" ",t.lcZ(5,4,"common.total"),":\xa0 "),t.xp6(3),t.hij("",t.G7q(8,6,t.kEZ(12,H,e.totalDebt,e.currency,e.translateService.currentLang))," "),t.xp6(4),t.Q6J("ngForOf",e.debts)}}function Qn(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",o.getAttributesString(e)," ")}}function Ln(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(2),t.lnq(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," ")}}function En(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-item",65)(2,"ion-text",66),t._uU(3),t.TgZ(4,"ion-text",67),t.YNc(5,Qn,3,1,"ng-container",9),t.YNc(6,Ln,3,3,"ng-container",30),t.qZA()()(),t.BQk()),2&i){const e=c.$implicit,o=c.index;t.xp6(2),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.xDo(" ",o+1,". ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.options)}}function On(i,c){if(1&i&&(t.ynx(0),t.YNc(1,En,7,11,"ng-container",30),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.items)}}function Yn(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(2),t.lnq(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," ")}}function Fn(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-item",65)(2,"ion-text",66),t._uU(3),t.TgZ(4,"ion-text",67),t.YNc(5,Yn,3,3,"ng-container",30),t.qZA()()(),t.BQk()),2&i){const e=c.$implicit,o=c.index;t.xp6(3),t.xDo(" ",o+1,". ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(1),t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngForOf",e.options)}}function Gn(i,c){if(1&i&&(t.ynx(0),t.YNc(1,Fn,6,8,"ng-container",30),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.materials)}}function Kn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"customer-price-item",71),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectCustomerPrice(r.id))}),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Q6J("showContact",!0)("showProduct",!1)("customerPrice",e)("currency",o.currency)}}function Hn(i,c){1&i&&(t.TgZ(0,"div",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"contact-detail.no-prices")))}function Dn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item")(2,"ion-label",7),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"ion-text",57),t._uU(6),t.qZA()(),t.TgZ(7,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addPrice())}),t._UZ(8,"ion-icon",68),t.qZA()(),t.YNc(9,Kn,1,4,"customer-price-item",69),t.YNc(10,Hn,3,3,"div",70),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,4,"common.total"),":\xa0 "),t.xp6(3),t.hij("",e.customerPrices&&e.customerPrices.length?e.customerPrices.length:0," "),t.xp6(3),t.Q6J("ngForOf",e.customerPrices),t.xp6(1),t.Q6J("ngIf",!e.customerPrices||!e.customerPrices.length)}}function Bn(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"customer-discount-item",74),t.NdJ("onClick",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectCustomerDiscount(r.id))}),t.qZA()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Q6J("showContact",!0)("showProduct",!1)("customerDiscount",e)("currency",o.currency)}}function jn(i,c){1&i&&(t.TgZ(0,"div",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"contact-detail.no-discounts")))}function $n(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item")(2,"ion-label",7),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"ion-text",57),t._uU(6),t.qZA()(),t.TgZ(7,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addDiscount())}),t._UZ(8,"ion-icon",68),t.qZA()(),t.YNc(9,Bn,1,4,"customer-discount-item",73),t.YNc(10,jn,3,3,"div",70),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,4,"common.total"),":\xa0 "),t.xp6(3),t.Oqu(e.customerDiscounts&&e.customerDiscounts.length?e.customerDiscounts.length:0),t.xp6(3),t.Q6J("ngForOf",e.customerDiscounts),t.xp6(1),t.Q6J("ngIf",!e.customerDiscounts||!e.customerDiscounts.length)}}let Vn=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U,v,f,w){this.navCtrl=e,this.file=o,this.printer=n,this.translateService=r,this.userService=a,this.modalCtrl=d,this.productService=u,this.tradeService=p,this.debtService=_,this.contactService=g,this.platform=m,this.excelService=y,this.storeService=k,this.staffService=J,this.actionSheetCtrl=U,this.alertCtrl=v,this.currencyPipe=f,this.analyticsService=w,this.params=null,this.product=new K.x,this.productAttributes=[],this.pictures=[],this.arr=[],this.dateFrom="",this.dateTo="",this.trades=[],this.total=0,this.totalProduct=0,this.tab="product-note",this.debts=[],this.dateDebtFrom="",this.dateDebtTo="",this.totalDebt=0,this.dateNoteFrom="",this.dateNoteTo="",this.productNotes=[],this.totalNoteAmount=0,this.customerPrices=[],this.customerDiscounts=[],this.staff=null,this.filteredStaff=null,this.categories=[],this.canViewProductCostPrice=!1,this.reloadProduct=S=>{this.product&&S.detail.id===this.product.id&&this.reload()},this.navCtrl.removeEventListener("reloadProduct",this.reloadProduct),this.navCtrl.addEventListener("reloadProduct",this.reloadProduct)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-detail")})()}gotoCat(e){this.navCtrl.push("/trade-category/detail",{id:e})}ngOnInit(){var e=this;return(0,l.Z)(function*(){yield e.reload()})()}actionIcon(e){return Z.W.actionIcon(e)}reload(){var e=this;return(0,l.Z)(function*(){const o=yield e.navCtrl.loading();e.currency=yield e.userService.getAttr("current-currency"),e.stores=yield e.storeService.getStores(),e.staff=e.staffService.selectedStaff,e.store=yield e.storeService.getCurrentStore(),e.canViewProductCostPrice=!e.staff||e.staff.hasFullAccess||e.staff.canViewProductCostPrice,e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null;const n=e.params?e.params:e.navCtrl.getParams();e.params=n,e.product=new K.x,n.tab&&(e.tab=n.tab),e.filteredStaff=n.selectedStaff;const r=n.id;e.productService.get(r,e.store?e.store.id:0).then(function(){var a=(0,l.Z)(function*(d){e.productAttributes=yield e.productService.getProductAttributes(r),yield o.dismiss(),e.product=d,e.product.barcode&&setTimeout(()=>{gt(e.barcode.nativeElement,e.product.barcode,{displayValue:!0,fontSize:12.5,textMargin:0,height:50,margin:3}),e.barcode64base=e.barcode.nativeElement.toDataURL("image/png")},1e3),e.pictures=d&&d.imageUrlsJson?JSON.parse(d.imageUrlsJson):[],e.product.items=d&&d.itemsJson?JSON.parse(d.itemsJson):[],e.product.units=d&&d.unitsJson?JSON.parse(d.unitsJson):[],e.product.materials=d&&d.materialsJson?JSON.parse(d.materialsJson):[];const u=[];let p=[];for(const _ of e.pictures)p.push(_),3===p.length&&(u.push(p),p=[]);p.length>0&&u.push(p),e.arr=u,e.dateFrom=e.dateFrom?e.dateFrom:C.C.GetFirstDateOfMonth(),e.dateTo=e.dateTo?e.dateTo:C.C.GetEndDateOfMonth(),e.tradeService.getTradesByProduct(d.id,e.dateFrom,e.dateTo).then(_=>{_&&_.length>0&&(_=q.orderBy(_,["modifiedAt"],["desc"])),e.trades=_,e.total=q.sumBy(e.trades,g=>g.value*(g.isReceived?1:-1)),e.totalProduct=q.sumBy(e.trades,g=>g.productCount)}),e.dateDebtFrom="",e.dateDebtTo="",e.dateDebtFrom=C.C.GetFirstDateOfMonth(),e.dateDebtTo=C.C.GetEndDateOfMonth(),e.debtService.getDebtsByProduct(d.id,e.dateDebtFrom,e.dateDebtTo).then(_=>{_&&_.length>0&&(_=q.orderBy(_,["modifiedAt"],["desc"])),e.debts=_,e.totalDebt=q.sumBy(e.debts,g=>g.value)}),e.dateNoteFrom="",e.dateNoteTo="",e.dateNoteFrom=C.C.GetFirstDateOfMonth(),e.dateNoteTo=C.C.GetEndDateOfMonth(),e.productService.getNotesByProduct(d.id,e.filteredStaff?e.filteredStaff.id:0,e.dateNoteFrom,e.dateNoteTo,e.store?e.store.id:0).then(_=>{if(_&&_.length>0){if(e.filteredStaff)for(const m of _)m.staff=e.filteredStaff;_=q.orderBy(_,["createdAt"],["desc"])}const g=[];for(const m of _)m.store=!e.checkStore&&m.storeId&&e.stores&&e.stores.length?e.stores.find(y=>y.id===m.storeId):null,g.push(m);e.productNotes=g,e.totalNoteAmount=q.sumBy(e.productNotes,m=>m.orderId?m.amount:m.receivedNoteId?-m.amount:0)}),e.contactService.getCustomerPricesByProduct(d.id).then(_=>{_&&_.length>0&&(_=q.orderBy(_,["createdAt"],["desc"])),e.customerPrices=_}),e.contactService.getCustomerDiscountsByProduct(d.id).then(_=>{_&&_.length>0&&(_=q.orderBy(_,["createdAt"],["desc"])),e.customerDiscounts=_}),e.categories=yield e.tradeService.getCategoriesToTrade(e.product.id)});return function(d){return a.apply(this,arguments)}}())})()}dateFormat(e){return C.C.toUiDateString(e)}dateTimeFormat(e){return C.C.toUiString(e)}edit(){this.staffService.canAddUpdateProduct()?this.navCtrl.push("/product/edit",{id:this.product.id}):alert(this.translateService.instant("product.no-permission"))}showImage(e){var o=this;return(0,l.Z)(function*(){const n=JSON.parse(JSON.stringify(o.pictures));yield(yield o.modalCtrl.create({component:ct.v,componentProps:{images:n,id:e}})).present()})()}presentActionSheet(){var e=this;return(0,l.Z)(function*(){yield(yield e.actionSheetCtrl.create({header:e.translateService.instant("action.action"),buttons:[{text:e.translateService.instant("product-detail.copy"),handler:()=>{e.copyProduct()}},{text:e.translateService.instant("product-detail.generate-barcode"),handler:()=>{e.generateBarcode()}},{text:e.translateService.instant("product-detail.delete"),role:"destructive",handler:()=>{e.deleteProduct()}},{text:e.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}copyProduct(){var e=this;return(0,l.Z)(function*(){const o=JSON.parse(JSON.stringify(e.product));yield e.navCtrl.popOnly(),e.navCtrl.push("/product/quick-add",{copy:o})})()}generateBarcode(){var e=this;if(!this.product||this.product.barcode||(this.barcode64base=1,setTimeout(()=>{gt(this.barcode.nativeElement,this.product.id.toString(),{displayValue:!1}),this.barcode64base=this.barcode.nativeElement.toDataURL("image/png")},1e3),!this.platform.is("capacitor")&&!this.platform.is("cordova")))return;const o=this.barcode64base.split(","),n=o[1].trim(),r=o[0].trim().split(";")[0].split(":")[1],a="barcode-"+Z.W.productName(this.product.code,this.product.title)+".png";this.file.resolveLocalFilesystemUrl(this.file.externalDataDirectory).then(function(){var d=(0,l.Z)(function*(u){const p=u.toURL();Z.W.savebase64AsImageFile(p,a,n,r),yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-detail.barcode-saved-alert")+e.file.externalDataDirectory+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present()});return function(u){return d.apply(this,arguments)}}())}printBarcode(){const e=this.currencyPipe.transform(this.product.price,this.currency,"symbol","1.0-2",this.translateService.currentLang),o=`<div style='text-align: center;'><img src='${this.barcode64base}'/><span>\n        <div>\n        <b>${this.product.title}.&nbsp;<span>${e}</span></b><span>\n        </div></div>`;this.navCtrl.isNotCordova()?Z.W.webPrint(o):this.printer.print(o).then(()=>{})}addTrade(){this.navCtrl.push("/trade/add",{product:this.product.id})}addDebt(){this.navCtrl.push("/debt/add",{product:this.product.id})}exportTradeToExcel(){var e=this;const o=[];if(o.push([this.translateService.instant("export.product-transaction-report")]),o.push([this.translateService.instant("export.product")+": "+Z.W.productName(this.product.code,this.product.title)]),this.dateFrom&&this.dateTo){const a=this.translateService.instant("common.from"),d=this.translateService.instant("common.to"),u=a+" "+this.dateFormat(this.dateFrom)+" "+d+" "+this.dateFormat(this.dateTo);o.push([u])}o.push([this.translateService.instant("common.total")+": "+this.total+" "+this.currency]),o.push([this.translateService.instant("export.contact"),this.translateService.instant("export.product"),this.translateService.instant("export.product-count"),this.translateService.instant("export.money"),this.translateService.instant("export.unit"),this.translateService.instant("export.date")]);for(const a of this.trades)o.push([0!==a.contactId&&a.contact?a.contact.fullName:"",0!==a.productId&&a.product?Z.W.productName(a.product.code,a.product.title):"",0!==a.productId&&a.product&&a.isPurchase?a.productCount?a.productCount:0:" ",a.isReceived?a.value:-1*a.value,this.currency,this.dateFormat(a.createdAt)]);const n=this.excelService.createSheetData(o),r="product-transactions-report-"+this.product.id+"-"+Z.W.getCurrentDate()+".xlsx";this.excelService.exportExcel(n,r).then((0,l.Z)(function*(){e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+e.file.externalDataDirectory+r,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFile())}))}deleteProduct(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-detail.delete-alert"),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.deleteRelated(),e.productService.deleteProduct(e.product).then((0,l.Z)(function*(){e.analyticsService.logEvent("product-detail-delete-success"),e.navCtrl.publish("reloadProductList"),e.navCtrl.pop()}))}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}deleteRelated(){var e=this;return(0,l.Z)(function*(){const o=[],n=yield e.productService.getNotesByProduct(e.product.id,0);for(const r of n)o.push(e.productService.deleteProductNote(r));yield Promise.all(o)})()}selectNote(e){e.tradeId?this.navCtrl.push("/trade/detail",{id:e.tradeId}):e.orderId?this.navCtrl.push("/order/detail",{id:e.orderId}):e.receivedNoteId&&this.navCtrl.push("/received-note/detail",{id:e.receivedNoteId})}selectTrade(e){this.navCtrl.push("/trade/detail",{id:e})}selectDebt(e){this.navCtrl.push("/debt/detail",{id:e})}selectDateRangeForTrade(){var e=this;return(0,l.Z)(function*(){const o=yield e.modalCtrl.create({component:rt.S,componentProps:{dateFromInput:e.dateFrom,dateToInput:e.dateTo,page:"product",selectedStaff:e.filteredStaff}});yield o.present();const{data:n}=yield o.onDidDismiss();n&&(e.dateFrom=""!==n.dateFrom?C.C.toDbString(n.dateFrom,C.C.getDbFormat()):"",e.dateTo=""!==n.dateTo?C.C.toDbString(n.dateTo,C.C.getDbFormat()):"",e.filteredStaff=n.selectedStaff,e.tradeService.getTradesByProduct(e.product.id,e.dateFrom,e.dateTo).then(r=>{r&&r.length>0&&(r=q.orderBy(r,["modifiedAt"],["desc"])),e.trades=r,e.total=q.sumBy(e.trades,a=>a.value*(a.isReceived?1:-1))}))})()}selectDateRangeForNote(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/order/select-filter",{callback:n=>{!n||(e.dateNoteFrom=""!==n.dateFrom?C.C.toDbString(n.dateFrom,C.C.getDbFormat()):"",e.dateNoteTo=""!==n.dateTo?C.C.toDbString(n.dateTo,C.C.getDbFormat()):"",e.filteredStaff=n.selectedStaff,e.productService.getNotesByProduct(e.product.id,e.filteredStaff?e.filteredStaff.id:0,e.dateNoteFrom,e.dateNoteTo,e.store?e.store.id:0).then(r=>{if(r&&r.length>0){if(e.filteredStaff)for(const d of r)d.staff=e.filteredStaff;r=q.orderBy(r,["createdAt"],["desc"])}const a=[];for(const d of r)d.store=!e.checkStore&&d.storeId&&e.stores&&e.stores.length?e.stores.find(u=>u.id===d.storeId):null,a.push(d);e.productNotes=a,e.totalNoteAmount=q.sumBy(e.productNotes,d=>d.orderId?d.amount:d.receivedNoteId?-d.amount:0)}))},dateFromInput:e.dateFrom,dateToInput:e.dateTo,page:"product",selectedStaff:e.filteredStaff})})()}selectDateRangeForDebt(){var e=this;return(0,l.Z)(function*(){const o=yield e.modalCtrl.create({component:rt.S,componentProps:{dateFromInput:e.dateFrom,dateToInput:e.dateTo,page:"product",selectedStaff:e.filteredStaff}});yield o.present();const{data:n}=yield o.onDidDismiss();n&&(e.dateDebtFrom=""!==n.dateFrom?C.C.toDbString(n.dateFrom,C.C.getDbFormat()):"",e.dateDebtTo=""!==n.dateTo?C.C.toDbString(n.dateTo,C.C.getDbFormat()):"",e.filteredStaff=n.selectedStaff,e.debtService.getDebtsByProduct(e.product.id,e.dateDebtFrom,e.dateDebtTo).then(r=>{r&&r.length>0&&(r=q.orderBy(r,["modifiedAt"],["desc"])),e.debts=r,e.totalDebt=q.sumBy(e.debts,a=>a.value)}))})()}productName(e,o){return e||o?Z.W.productName(e,o):Z.W.productName(this.product.code,this.product.title)}getAttributesString(e){return Z.W.getAttributesString(e)}hasOptionsOrAttributes(e){return Z.W.hasOptionsOrAttributes(e)}addPrice(){this.navCtrl.push("/contact/add-price",{product:this.product.id})}selectCustomerPrice(e){this.navCtrl.push("/contact/add-price",{id:e})}addDiscount(){this.navCtrl.push("/contact/add-discount",{product:this.product.id})}selectCustomerDiscount(e){this.navCtrl.push("/contact/add-discount",{id:e})}viewTypes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/type",{callback:()=>{},productId:e.product.id,product:e.product})})()}addOtherBarcode(){this.navCtrl.push("/product/barcode",{productId:this.product.id,units:this.product.units,callback:()=>{}})}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),e.navCtrl.publish("reloadProductList"),e.navCtrl.publish("reloadProductSelector"),e.navCtrl.publish("reloadProduct",e.product),yield e.reload()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(at.$),t.Y36(tt.F),t.Y36(b.sK),t.Y36(E.K),t.Y36(s.IN),t.Y36(N.M),t.Y36(st.X),t.Y36(L.E),t.Y36(co.y),t.Y36(s.t4),t.Y36($.x),t.Y36(D.d),t.Y36(A.x),t.Y36(s.BX),t.Y36(s.Br),t.Y36(T.H9),t.Y36(Q.y))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-detail"]],viewQuery:function(e,o){if(1&e&&t.Gf(Vo,5),2&e){let n;t.iGM(n=t.CRH())&&(o.barcode=n.first)}},decls:66,vars:48,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],["color","primary",3,"click"],["name","create"],["name","ellipsis-vertical"],["lines","none","color","success",4,"ngIf"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap","font-weight","bold"],[4,"ngIf"],["size","small","color","primary",3,"click"],["name","options"],["color","success",3,"click"],["name","add-outline"],["color","light",3,"hidden"],["fill","clear","color","primary","slot","end",3,"click"],["slot","icon-only","name","print"],["lines","none",2,"text-align","center",3,"hidden"],["id","barcode"],["barcode",""],["lines","none","style","--min-height: 0; --padding-bottom: 0; --padding-top: 0; --padding-start: 10px;",4,"ngIf"],[1,"ion-text-wrap",3,"value","ngModel","scrollable","ngModelChange"],["value","product-note",1,"ion-text-wrap"],["value","attributes","class","ion-text-wrap",4,"ngIf"],["value","photo",1,"ion-text-wrap"],["value","combo","class","ion-text-wrap",4,"ngIf"],["value","materials","class","ion-text-wrap",4,"ngIf"],["value","prices","class","ion-text-wrap",4,"ngIf"],["value","discounts","class","ion-text-wrap",4,"ngIf"],[3,"hidden"],[4,"ngFor","ngForOf"],["lines","none","color","success"],["size","small",3,"click"],["name","exit","slot","start","size","small"],["name","calendar"],["lines","none","style","--min-height: 0",4,"ngFor","ngForOf"],["lines","none",2,"--min-height","0"],[1,"ion-text-wrap",2,"margin","5px 0 0 0"],["lines","none",2,"--min-height","0","--padding-bottom","0","--padding-top","0","--padding-start","10px"],["position","stacked"],["size-xs","6","size-sm","6","size-md","3","size-lg","2",4,"ngFor","ngForOf"],["size-xs","6","size-sm","6","size-md","3","size-lg","2"],["color","primary",1,"ion-text-wrap",3,"click"],["value","attributes",1,"ion-text-wrap"],["value","combo",1,"ion-text-wrap"],["value","materials",1,"ion-text-wrap"],["value","prices",1,"ion-text-wrap"],["value","discounts",1,"ion-text-wrap"],["style","max-width: 150px;",4,"ngFor","ngForOf"],[2,"max-width","150px"],[2,"max-width","120px",3,"src","click"],["class","ion-text-wrap",4,"ngIf"],["name","funnel"],["lines","none",4,"ngIf"],[3,"showProduct","note","currency","onClick",4,"ngFor","ngForOf"],[3,"color"],["lines","none"],["color","primary"],["color","dark"],[3,"showProduct","note","currency","onClick"],[3,"showProduct","trade","currency","onClick",4,"ngFor","ngForOf"],[3,"showProduct","trade","currency","onClick"],["color","danger"],[3,"showProduct","debt","currency","onClick",4,"ngFor","ngForOf"],[3,"showProduct","debt","currency","onClick"],["lines","inset"],[2,"padding-top","8px","padding-bottom","8px"],[1,"ion-text-wrap",2,"font-size","0.8em","padding-bottom","5px"],["slot","icon-only","name","add"],[3,"showContact","showProduct","customerPrice","currency","onClick",4,"ngFor","ngForOf"],["class","ion-padding",4,"ngIf"],[3,"showContact","showProduct","customerPrice","currency","onClick"],[1,"ion-padding"],[3,"showContact","showProduct","customerDiscount","currency","onClick",4,"ngFor","ngForOf"],[3,"showContact","showProduct","customerDiscount","currency","onClick"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return o.edit()}),t._UZ(9,"ion-icon",4),t.qZA(),t.TgZ(10,"ion-button",3),t.NdJ("click",function(){return o.presentActionSheet()}),t._UZ(11,"ion-icon",5),t.qZA()()(),t.YNc(12,zo,8,4,"ion-item",6),t.qZA(),t.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item")(16,"ion-label",7)(17,"span",8),t._uU(18),t.qZA(),t._UZ(19,"br"),t.YNc(20,on,11,22,"ng-container",9),t.YNc(21,dn,15,25,"ng-container",9),t.YNc(22,ln,6,4,"span",9),t.qZA()(),t.YNc(23,pn,2,1,"ng-container",9),t.TgZ(24,"ion-item")(25,"ion-button",10),t.NdJ("click",function(){return o.viewTypes()}),t._UZ(26,"ion-icon",11),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"ion-button",12),t.NdJ("click",function(){return o.addOtherBarcode()}),t._UZ(30,"ion-icon",13),t._uU(31),t.ALo(32,"translate"),t.qZA()(),t.TgZ(33,"ion-item-divider",14),t._uU(34),t.ALo(35,"translate"),t.TgZ(36,"ion-button",15),t.NdJ("click",function(){return o.printBarcode()}),t._UZ(37,"ion-icon",16),t.qZA()(),t.TgZ(38,"ion-item",17)(39,"ion-label"),t._UZ(40,"canvas",18,19),t.qZA()(),t.YNc(42,mn,4,3,"ion-item",20),t.YNc(43,fn,3,1,"ion-grid",9),t.qZA(),t.TgZ(44,"ion-segment",21),t.NdJ("ngModelChange",function(r){return o.tab=r}),t.TgZ(45,"ion-segment-button",22),t._uU(46),t.ALo(47,"translate"),t.qZA(),t.YNc(48,xn,3,3,"ion-segment-button",23),t.TgZ(49,"ion-segment-button",24),t._uU(50),t.ALo(51,"translate"),t.qZA(),t.YNc(52,hn,3,3,"ion-segment-button",25),t.YNc(53,Zn,3,3,"ion-segment-button",26),t.YNc(54,Tn,3,3,"ion-segment-button",27),t.YNc(55,An,3,3,"ion-segment-button",28),t.qZA(),t.TgZ(56,"ion-grid",29),t.YNc(57,yn,2,1,"ion-row",30),t.qZA(),t.YNc(58,Sn,7,3,"ion-list",9),t.YNc(59,kn,2,1,"ion-list",9),t.YNc(60,Un,12,20,"ion-list",9),t.YNc(61,Mn,12,16,"ion-list",9),t.YNc(62,On,2,1,"ng-container",9),t.YNc(63,Gn,2,1,"ng-container",9),t.YNc(64,Dn,11,6,"ion-list",9),t.YNc(65,$n,11,6,"ion-list",9),t.qZA()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,36,"product-detail.title")),t.xp6(7),t.Q6J("ngIf",o.checkStore&&(null==o.staff||o.staff.hasFullAccess&&!o.staff.storeId)),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(5),t.Oqu(o.productName(o.product.code,o.product.title)),t.xp6(2),t.Q6J("ngIf",!o.product.units||!o.product.units.length),t.xp6(1),t.Q6J("ngIf",o.product.units&&o.product.units.length),t.xp6(1),t.Q6J("ngIf",o.product.expiredAt),t.xp6(1),t.Q6J("ngIf",o.product&&o.product.units&&o.product.units.length),t.xp6(4),t.hij("\xa0 ",t.lcZ(28,38,"product-add.types")," "),t.xp6(4),t.hij(" ",t.lcZ(32,40,"product.add-other-barcode")," "),t.xp6(2),t.Q6J("hidden",!o.barcode64base),t.xp6(1),t.hij(" ",t.lcZ(35,42,"product-detail.barcode")," "),t.xp6(4),t.Q6J("hidden",!o.product.barcode&&!o.barcode64base),t.xp6(4),t.Q6J("ngIf",o.categories&&o.categories.length),t.xp6(1),t.Q6J("ngIf",o.categories&&o.categories.length),t.xp6(1),t.Q6J("value","product-note")("ngModel",o.tab)("scrollable",!0),t.xp6(2),t.hij(" ",t.lcZ(47,44,"product-detail.product-note")," "),t.xp6(2),t.Q6J("ngIf",o.productAttributes&&o.productAttributes.length),t.xp6(2),t.hij(" ",t.lcZ(51,46,"product-detail.photo")," "),t.xp6(2),t.Q6J("ngIf",o.product.items&&o.product.items.length),t.xp6(1),t.Q6J("ngIf",o.product.materials&&o.product.materials.length),t.xp6(1),t.Q6J("ngIf",null==o.staff||o.staff.hasFullAccess),t.xp6(1),t.Q6J("ngIf",null==o.staff||o.staff.hasFullAccess),t.xp6(1),t.Q6J("hidden","photo"!=o.tab),t.xp6(1),t.Q6J("ngForOf",o.arr),t.xp6(1),t.Q6J("ngIf","product-note"===o.tab),t.xp6(1),t.Q6J("ngIf","attributes"===o.tab&&o.productAttributes&&o.productAttributes.length),t.xp6(1),t.Q6J("ngIf","trade"===o.tab),t.xp6(1),t.Q6J("ngIf","debt"===o.tab),t.xp6(1),t.Q6J("ngIf","combo"===o.tab),t.xp6(1),t.Q6J("ngIf","materials"===o.tab),t.xp6(1),t.Q6J("ngIf","prices"===o.tab),t.xp6(1),t.Q6J("ngIf","discounts"===o.tab))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.oU,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.rH,s.Q$,s.q_,s.Nd,s.cJ,s.GO,s.yW,s.wd,s.sr,s.QI,s.cs,ao.A,so._,lo.X,uo.v,$o,T.H9,b.X$],encapsulation:2}),i})();var ft=x(2694),xt=x(5439),ht=x(5129),Zt=x(1582),Tt=x(8851);const zn=["barcodeInput"],Wn=["barcodeInputCombo"],Rn=["barcodeInputMaterial"],Xn=["fileUploadInput"];function ti(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",51)(1,"ion-label",52),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",53),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",54),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function ei(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",55)(1,"ion-item",56)(2,"ion-button",57),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.removeCategory(r))}),t._UZ(3,"ion-icon",2),t.qZA(),t.TgZ(4,"ion-text",58),t._uU(5),t.qZA()()()}if(2&i){const e=c.$implicit;t.xp6(5),t.hij(" ",e.tradeCategory.title," ")}}function oi(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("(",e.currency.symbol_native," - ",e.currency.code,")")}}function ni(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",8),t._uU(2),t.ALo(3,"translate"),t.YNc(4,oi,2,2,"span",21),t.qZA(),t.TgZ(5,"money-input",59),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.costPrice=n)}),t.ALo(6,"translate"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,6,"product-add.cost-price")," "),t.xp6(2),t.Q6J("ngIf",e.currency),t.xp6(1),t.s9C("placeholder",t.lcZ(6,8,"product-add.cost-price")),t.Q6J("clear",!0)("moneyValue",e.product.costPrice)("disabled",e.canViewProductCostPrice&&!e.canUpdateProductCostPrice)}}function ii(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col",60)(2,"ion-label",8),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-input",61),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.unit=n)})("focus",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.selectAll(n))}),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons")(8,"ion-checkbox",62),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.isDefault=n)})("ngModelChange",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.changeUnitDefault(r))}),t.qZA(),t.TgZ(9,"span",63),t._uU(10),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"ion-col",60)(13,"ion-label",8),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"money-input",26),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.price=n)}),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"ion-buttons")(19,"ion-button",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.addZerosToNumberToUnit(2,r))}),t._uU(20," .00 "),t.qZA(),t.TgZ(21,"ion-button",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.addZerosToNumberToUnit(3,r))}),t._uU(22," .000 "),t.qZA()()(),t.TgZ(23,"ion-col",60)(24,"ion-label",64),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"money-input",65),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.costPrice=n)}),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"ion-buttons")(30,"ion-button",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.addZerosToNumberToUnitCostPrice(2,r))}),t._uU(31," .00 "),t.qZA(),t.TgZ(32,"ion-button",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.addZerosToNumberToUnitCostPrice(3,r))}),t._uU(33," .000 "),t.qZA()()(),t.TgZ(34,"ion-col",60)(35,"ion-label",8),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"ion-input",28),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.exchange=n)})("focus",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.selectAll(n))})("ngModelChange",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.changeUnit(r))}),t.ALo(39,"translate"),t.qZA(),t.TgZ(40,"ion-buttons",66)(41,"ion-button",67),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw(2);return t.KtG(d.removeUnit(r,a))}),t._UZ(42,"ion-icon",68),t.qZA()()()()}if(2&i){const e=c.$implicit;t.xp6(3),t.hij("",t.lcZ(4,14,"product-add.unit")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(6,16,"product-add.enter-unit")),t.Q6J("ngModel",e.unit),t.xp6(3),t.Q6J("ngModel",e.isDefault),t.xp6(2),t.hij("\xa0",t.lcZ(11,18,"product-add.default-unit"),""),t.xp6(4),t.hij("",t.lcZ(15,20,"product-add.price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(17,22,"product-add.enter-price")),t.Q6J("moneyValue",e.price),t.xp6(9),t.hij("",t.lcZ(26,24,"product-add.cost-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(28,26,"product-add.enter-price")),t.Q6J("moneyValue",e.costPrice),t.xp6(9),t.hij("",t.lcZ(37,28,"product-add.unit-exchange")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(39,30,"product-add.enter-unit-exchange")),t.Q6J("ngModel",e.exchange)}}function ri(i,c){if(1&i&&(t.ynx(0),t.YNc(1,ii,43,32,"ion-row",50),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.units)}}function ci(i,c){if(1&i&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.hij(" ",o.getAttributesString(e)," ")}}function ai(i,c){if(1&i&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&i){const e=c.$implicit,o=t.oxw(5);t.xp6(1),t.lnq(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," ")}}function si(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-item",84)(2,"ion-text",85),t.YNc(3,ci,3,1,"ng-container",21),t.YNc(4,ai,3,3,"ng-container",50),t.qZA()(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.options)}}function di(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",75)(2,"ion-text",76),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",77)(5,"ion-button",78),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.decreaseItem(r))}),t._UZ(6,"ion-icon",79),t.qZA(),t.TgZ(7,"ion-button",78),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.increaseItem(r))}),t._UZ(8,"ion-icon",80),t.qZA(),t.TgZ(9,"ion-button",81),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.showOptions(r))}),t._UZ(10,"ion-icon",82),t.qZA()(),t.TgZ(11,"ion-buttons",77)(12,"ion-button",57),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.removeProduct(r))}),t._UZ(13,"ion-icon",83),t.qZA()()(),t.YNc(14,si,5,4,"ng-container",21),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("lines",o.hasOptionsOrAttributes(e)?"none":"inset"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.HOy(" ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(11),t.Q6J("ngIf",o.hasOptionsOrAttributes(e))}}function li(i,c){if(1&i&&(t.ynx(0),t.YNc(1,di,15,8,"ng-container",50),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.product.items)}}function ui(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-list")(2,"ion-item-divider",69),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-item",69)(6,"ion-text",70),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ion-buttons")(11,"ion-button",71),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showProductSelector())}),t._UZ(12,"ion-icon",19),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"ion-button",71),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.scanItem())}),t._UZ(16,"ion-icon",12),t._uU(17),t.ALo(18,"translate"),t.qZA()()(),t.TgZ(19,"ion-item",69)(20,"ion-input",72,10),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.barcode=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.barcodeChanged())}),t.ALo(22,"translate"),t.qZA()(),t.TgZ(23,"ion-item",73),t._UZ(24,"div",74),t.ALo(25,"translate"),t.qZA(),t.YNc(26,li,2,1,"ng-container",21),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,10,"product-add.select-products")," "),t.xp6(4),t.AsE("",t.lcZ(8,12,"product-add.enter-barcode")," ",t.lcZ(9,14,"product-add.or"),"..."),t.xp6(6),t.hij(" \xa0",t.lcZ(14,16,"product-add.add-manual")," "),t.xp6(4),t.hij(" \xa0",t.lcZ(18,18,"product-add.mobile-scan")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(22,20,"product-add.enter-barcode-placeholder")),t.Q6J("ngModel",e.barcode),t.xp6(3),t.Q6J("hidden",e.product.items&&e.product.items.length>0),t.xp6(1),t.Q6J("innerHTML",t.lcZ(25,22,"product-add.no-product"),t.oJD),t.xp6(2),t.Q6J("ngIf",e.product.items&&e.product.items.length)}}function _i(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("(",e.unit,")")}}function pi(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",88)(2,"ion-buttons")(3,"ion-button",57),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.expandMaterial(r))}),t._UZ(4,"ion-icon",89),t.qZA()(),t.TgZ(5,"ion-text",90),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.expandMaterial(r))}),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",77)(8,"ion-button",78),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.decreaseItem(r))}),t._UZ(9,"ion-icon",79),t.qZA(),t.TgZ(10,"ion-button",78),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.increaseItem(r))}),t._UZ(11,"ion-icon",80),t.qZA()(),t.TgZ(12,"ion-buttons",77)(13,"ion-button",57),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.removeMaterial(r))}),t._UZ(14,"ion-icon",83),t.qZA()()(),t.TgZ(15,"ion-grid",91)(16,"ion-row")(17,"ion-col")(18,"ion-label",8),t._uU(19),t.ALo(20,"translate"),t.YNc(21,_i,2,1,"span",21),t.qZA(),t.TgZ(22,"ion-input",92),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.count=n)})("focus",function(n){t.CHM(e);const r=t.oxw(3);return t.KtG(r.selectAll(n))}),t.ALo(23,"translate"),t.qZA()()()(),t.BQk()}if(2&i){const e=c.$implicit;t.xp6(4),t.s9C("name",e.isExpand?"chevron-up-circle":"create"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.HOy(" ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(9),t.Q6J("hidden",!e.isExpand),t.xp6(4),t.hij(" ",t.lcZ(20,12,"order-add.product-count")," "),t.xp6(2),t.Q6J("ngIf",e.unit),t.xp6(1),t.s9C("placeholder",t.lcZ(23,14,"order-add.enter-product-count")),t.Q6J("ngModel",e.count)}}function mi(i,c){if(1&i&&(t.ynx(0),t.YNc(1,pi,24,16,"ng-container",50),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.product.materials)}}function gi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-list")(2,"ion-item-divider",69),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-item",69)(6,"ion-text",70),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ion-buttons")(11,"ion-button",71),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showMaterialSelector())}),t._UZ(12,"ion-icon",19),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"ion-button",71),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.scanMaterialItem())}),t._UZ(16,"ion-icon",12),t._uU(17),t.ALo(18,"translate"),t.qZA()()(),t.TgZ(19,"ion-item",69)(20,"ion-input",86,87),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.barcodeMaterial=n)}),t.ALo(22,"translate"),t.qZA()(),t.YNc(23,mi,2,1,"ng-container",21),t.TgZ(24,"ion-item",73),t._UZ(25,"div",74),t.ALo(26,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,10,"product-add.select-materials")," "),t.xp6(4),t.AsE("",t.lcZ(8,12,"product-add.enter-barcode")," ",t.lcZ(9,14,"product-add.or"),"..."),t.xp6(6),t.hij(" \xa0",t.lcZ(14,16,"product-add.add-manual")," "),t.xp6(4),t.hij(" \xa0",t.lcZ(18,18,"product-add.mobile-scan")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(22,20,"product-add.enter-barcode-placeholder")),t.Q6J("ngModel",e.barcodeMaterial),t.xp6(3),t.Q6J("ngIf",e.product.materials&&e.product.materials.length),t.xp6(1),t.Q6J("hidden",e.product.materials&&e.product.materials.length>0),t.xp6(1),t.Q6J("innerHTML",t.lcZ(26,22,"product-add.no-product"),t.oJD)}}function fi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"date-picker",93),t.NdJ("dateChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.expiredAt=n)}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("date",e.product.expiredAt)}}function xi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-text",94),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showDatePopup())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"common.select-date")," "))}function hi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",95),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeDate())}),t._UZ(1,"ion-icon",83),t.qZA()}}function Zi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",43)(1,"ion-label",8),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"money-input",96),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.originalPrice=n)}),t.ALo(5,"translate"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"product-add.original-price")),t.xp6(2),t.s9C("placeholder",t.lcZ(5,6,"product-add.enter-original-price")),t.Q6J("clear",!0)("moneyValue",e.product.originalPrice)}}function Ti(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",97),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.upload())}),t._UZ(1,"ion-icon",98),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij("\xa0",t.lcZ(3,1,"note-add.select-photo")," "))}function Ai(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",100)(1,"img",101),t.NdJ("click",function(){const r=t.CHM(e).index,a=t.oxw().index,d=t.oxw();return t.KtG(d.showImage(3*a+r))}),t.qZA()()}if(2&i){const e=c.$implicit;t.xp6(1),t.Q6J("src",e,t.LSH)}}function Ci(i,c){if(1&i&&(t.TgZ(0,"ion-row"),t.YNc(1,Ai,2,1,"ion-col",99),t.qZA()),2&i){const e=c.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}let yi=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U,v,f,w){this.navCtrl=e,this.camera=o,this.transfer=n,this.userService=r,this.dataService=a,this.staffService=d,this.modalCtrl=u,this.productService=p,this.barcodeScanner=_,this.platform=g,this.translateService=m,this.actionSheetController=y,this.file=k,this.analyticsService=J,this.toastCtrl=U,this.alertCtrl=v,this.storeService=f,this.tradeService=w,this.params=null,this.product=new K.x,this.lastQuantity=0,this.pictures=[],this.storageDirectory="",this.arr=[],this.lastSamplePictureId=0,this.isNew=!0,this.fromSearch=!1,this.saveDisabled=!1,this.uploadDisabled=!1,this.categories=[],this.categoriesToRemove=[],this.onKeyPress=S=>{!S.target||"body"!==S.target.localName||("s"===S.key||"S"===S.key)&&this.save()},this.platform.ready().then(()=>{if(!this.platform.is("capacitor")&&!this.platform.is("cordova"))return!1;if(this.platform.is("ios"))this.storageDirectory=this.file.documentsDirectory;else{if(!this.platform.is("android"))return!1;this.storageDirectory=this.file.dataDirectory}})}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(!e.staffService.canAddUpdateProduct())return void e.navCtrl.pop();e.currency=yield e.userService.getAttr("current-currency"),e.selectedStaff=e.staffService.selectedStaff,e.canViewProductCostPrice=!e.staffService.isStaff()||e.staffService.selectedStaff.hasFullAccess||e.staffService.selectedStaff.canViewProductCostPrice,e.canUpdateProductCostPrice=!e.staffService.isStaff()||e.staffService.selectedStaff.hasFullAccess||e.staffService.selectedStaff.canUpdateProductCostPrice,e.store=yield e.storeService.getCurrentStore(),e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null,e.params=e.navCtrl.getParams(e.params),e.fromSearch=e.params&&e.params.fromSearch,e.product=new K.x;let o=0,n="";if(e.params&&e.params.id?(o=e.params.id,e.isNew=!1):e.params&&e.params.barcode&&(n=e.params.barcode,e.isNew=!0),o&&o>0){const r=yield e.navCtrl.loading();e.productService.get(o,0).then(function(){var a=(0,l.Z)(function*(d){e.product=d;const u=d.imageUrlsJson?JSON.parse(d.imageUrlsJson):[];e.pictures=u,e.product.items=d.itemsJson?JSON.parse(d.itemsJson):[],e.product.materials=d.materialsJson?JSON.parse(d.materialsJson):[],e.product.autoMaterials=e.product.materials&&e.product.materials.length&&!0,e.product.units=JSON.parse(e.product.unitsJson),e.lastQuantity=e.product.count,e.categories=yield e.tradeService.getCategoriesToTrade(o),e.buildPictureGrid(),yield r.dismiss()});return function(d){return a.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield r.dismiss()}))}else{if(n){const d=new K.x;d.barcode=n,e.product=d}const r=[];let a=[];for(const d of e.pictures)a.push(d),3===a.length&&(r.push(a),a=[]);a.length>0&&r.push(a),e.arr=r}e.barcodeFocus()})()}validate(){if(!this.product.title)return alert(this.translateService.instant("product-add.no-title-alert")),!1;if(!this.product.price)return alert(this.translateService.instant("product-add.no-price-alert")),!1;if(this.product.units&&this.product.units.length)for(const e of this.product.units){if(!e.unit)return alert(this.translateService.instant("product-add.no-unit-unit-alert")),!1;if(!e.price)return alert(this.translateService.instant("product-add.no-unit-price-alert")),!1}return!0}save(){var e=this;if(!this.staffService.canAddUpdateProduct())return void alert(this.translateService.instant("product.no-permission"));if(!this.validate())return;if(this.saveDisabled=!0,this.staffService.isStaff()&&(this.product.staffId=this.staffService.selectedStaff.id),this.product.imageUrlsJson=JSON.stringify(this.pictures),this.product.materialsJson=JSON.stringify(this.product.materials),this.product.isCombo){if(!this.product.items||!this.product.items.length){const r=this.translateService.instant("product-add.no-combo-products",{title:this.product.title});return void alert(r)}this.product.itemsJson=JSON.stringify(this.product.items)}const n=this.product.count;this.product.count=this.lastQuantity,this.product.unitsJson=this.product.units?JSON.stringify(this.product.units):null,this.productService.saveProduct(this.product).then((0,l.Z)(function*(){if(e.lastQuantity!==n){const a=new V.d;a.amount=0,a.unitPrice=e.product.price,a.unit=e.product.unit,a.quantity=n-e.lastQuantity,a.productId=e.product.id,a.productCode=e.product.code,a.productName=e.product.title,a.discount=0,a.discountType=0,a.storeId=e.store?e.store.id:a.storeId,a.note=e.translateService.instant("product-add.update-quantity-manually"),a.staffId=e.staffService.isStaff()?e.staffService.selectedStaff.id:0,yield e.productService.saveProductNote(a)}const r=[];if(e.categories&&e.categories.length>0){const a=e.tradeService.saveCategoriesToTrade(e.categories,e.product.id);r.push(a)}if(e.categoriesToRemove&&e.categoriesToRemove.length>0){const a=e.tradeService.deleteCategoriesToTrade(e.categoriesToRemove);r.push(a)}r.length&&(yield Promise.all(r)),e.analyticsService.logEvent("product-add-save-success"),e.exitPage()}))}exitPage(){var e=this;return(0,l.Z)(function*(){e.fromSearch?yield e.navCtrl.pop():yield e.navCtrl.popOnly(),e.navCtrl.publish("reloadProductList"),e.navCtrl.publish("reloadProductSelector"),e.navCtrl.publish("reloadProduct",e.product),e.isNew&&!e.fromSearch&&(yield e.navCtrl.navigateForward("/product/detail",{id:e.product.id}))})()}addImage(e){var o=this;return(0,l.Z)(function*(){if(!o.fileToUploads||!o.fileToUploads.length)return void alert(o.translateService.instant("note-add.no-picture-selected"));o.uploadDisabled=!0;let n=e;for(const r of o.fileToUploads)yield o.dataService.uploadPicture(r).then(a=>{a&&a.url?o.doAdd(a.url,n):a&&a.error&&(alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1)}).catch(()=>{alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1}),n++;o.afterAdd()})()}rememberFile(e){this.fileToUploads=e.target.files,this.browsePicture()}takePicture(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-take-picture"),yield e.addImage(-1)})()}browsePicture(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-browse-picture"),yield e.addImage(-1)})()}downloadImage(e,o,n){var r=this;this.platform.ready().then((0,l.Z)(function*(){const a=r.transfer.create(),d=yield r.navCtrl.loading();a.download(o,r.storageDirectory+e).then(function(){var u=(0,l.Z)(function*(p){r.doAdd(p.toURL(),n),r.afterAdd(),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}(),(0,l.Z)(function*(){yield d.dismiss()}))}))}doAdd(e,o){this.pictures.push(e),this.buildPictureGrid(),this.refreshAvatar()}afterAdd(){this.uploadDisabled=!1,this.fileToUploads=null,this.fileUploadInput.nativeElement.value=null}refreshAvatar(){this.product.avatarUrl=this.pictures&&this.pictures.length>0?this.pictures[0]:null}showImage(e){var o=this;return(0,l.Z)(function*(){const n=JSON.parse(JSON.stringify(o.pictures)),r=yield o.modalCtrl.create({component:ct.v,componentProps:{images:n,id:e,canDelete:!0}});yield r.present();const{data:a}=yield r.onWillDismiss();if(a&&a.idsToDelete){const d=a.idsToDelete;for(const u of d)o.removePicture(u)}})()}buildPictureGrid(){const e=[];let o=[];for(const n of this.pictures)o.push(n),3===o.length&&(e.push(o),o=[]);o.length>0&&e.push(o),this.arr=e}removePicture(e){this.pictures.splice(e,1),this.buildPictureGrid(),this.refreshAvatar()}changePicture(e){var o=this;return(0,l.Z)(function*(){yield o.addImage(e)})()}selectAll(e){Z.W.selectAll(e)}scan(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-add-scanbarcode"),e.navCtrl.isNotCordova()){const o=Math.random().toString(36).substring(7);e.product.barcode=o}else e.barcodeScanner.scan().then(o=>{!o||!o.text||(e.product.barcode=o.text)})})()}autoGenBarcode(){const e=Math.random().toString(36).substring(7);this.product.barcode=e}barcodeFocus(){setTimeout(()=>{this.barcodeInput.setFocus()},500)}isNotCordova(){return this.navCtrl.isNotCordova()}upload(){var e=this;return(0,l.Z)(function*(){yield(yield e.actionSheetController.create({header:e.translateService.instant("common.select-image-source"),buttons:[{text:e.translateService.instant("common.load-from-gallery"),handler:()=>{e.doUpload(e.camera.PictureSourceType.PHOTOLIBRARY)}},{text:e.translateService.instant("common.use-camera"),handler:()=>{e.doUpload(e.camera.PictureSourceType.CAMERA)}},{text:e.translateService.instant("common.cancel"),role:"cancel"}]})).present()})()}doUpload(e){var o=this;return(0,l.Z)(function*(){o.uploadDisabled=!0,o.camera.getPicture({quality:100,sourceType:e,destinationType:o.camera.DestinationType.DATA_URL,encodingType:o.camera.EncodingType.JPEG,mediaType:o.camera.MediaType.PICTURE}).then(function(){var a=(0,l.Z)(function*(d){const u=d,p=yield o.navCtrl.loading();o.dataService.uploadPictureBase64(u).then(function(){var _=(0,l.Z)(function*(g){yield p.dismiss(),g&&g.url?(o.doAdd(g.url,-1),o.afterAdd()):g&&g.error&&(alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1)});return function(g){return _.apply(this,arguments)}}()).catch(function(){var _=(0,l.Z)(function*(g){yield p.dismiss(),console.error(g)});return function(g){return _.apply(this,arguments)}}())});return function(d){return a.apply(this,arguments)}}())})()}changeIsOption(){var e=this;return(0,l.Z)(function*(){e.product.isOption&&e.analyticsService.logEvent("product-add-set-is-option")})()}viewAttributes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/attribute",{callback:()=>{},productId:e.product.id})})()}viewTypes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/type",{callback:()=>{},productId:e.product.id,product:e.product})})()}getAttributesString(e){return Z.W.getAttributesString(e)}hasOptionsOrAttributes(e){return Z.W.hasOptionsOrAttributes(e)}showOptions(e){var o=this;return(0,l.Z)(function*(){const n={};n.price=e.price,n.id=e.productId,n.code=e.productCode,n.title=e.productName,n.avatarUrl=e.productAvatar,n.unit=e.unit,n.count=e.count,n.options=e.options,n.total=e.total,n.attributes=e.attributes,o.analyticsService.logEvent("product-add-show-combo-options"),yield o.navCtrl.push("/order/option-selector",{callback:a=>{a&&(e.options=a.options,e.attributes=a.attributes)},mainProduct:JSON.parse(JSON.stringify(n))})})()}increaseItem(e){var o=this;return(0,l.Z)(function*(){o.analyticsService.logEvent("product-add-increase-combo-item"),e.count++})()}decreaseItem(e){var o=this;return(0,l.Z)(function*(){e&&0===e.count||(o.analyticsService.logEvent("product-add-decrease-combo-item"),e.count--)})()}removeProduct(e){var o=this;return(0,l.Z)(function*(){const n=o.product.items.findIndex(r=>r.productId===e.productId);n>=0&&o.product.items.splice(n,1),o.analyticsService.logEvent("product-add-remove-combo-item")})()}showProductSelector(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-search-combo-product"),yield e.navCtrl.push("/order/product-selector",{callback:n=>{if(n&&n.length){for(const r of e.product.items)r.isExpand=!1;for(const r of n)e.addProductFromArr(r)}}})})()}addProductFromArr(e){var o=this;return(0,l.Z)(function*(){if(!e||o.product.items.findIndex(u=>!(u.productId!==e.id||u.attributes&&u.attributes.length||u.options&&u.options.length))>=0)return;const r=e.materialsJson?JSON.parse(e.materialsJson):null,a={};a.price=e.price,a.productId=e.id,a.productCode=e.code,a.productName=e.title,a.productAvatar=e.avatarUrl,a.unit=e.unit,a.count=e.count,a.isExpand=!1,a.options=e.options,a.attributes=e.attributes,a.materials=r,o.product.items.unshift(a);const d=o.translateService.instant("product-add.added-combo-product",{product:Z.W.productName(e.code,e.title)});o.presentToast(d)})()}scanItem(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-add-scan-barcode-for-combo-product"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&(e.analyticsService.logEvent("home-scan-for-order-scanned-web"),e.productService.searchByBarcode(n.barcode).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-add-scan-barcode-for-combo-ok"),e.addProduct(a)});return function(a){return r.apply(this,arguments)}}()))}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.productService.searchByBarcode(o.text).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-add-scan-barcode-for-combo-ok"),e.addProduct(r)});return function(r){return n.apply(this,arguments)}}())})})()}addProduct(e){var o=this;return(0,l.Z)(function*(){if(e){for(const u of o.product.items)u.isExpand=!1;const n=o.product.items.findIndex(u=>!(u.productId!==e.id||u.attributes&&u.attributes.length||u.options&&u.options.length));if(n>=0){const u=o.product.items[n];u.isExpand=!0,u.count=1*u.count+1;const p=o.translateService.instant("product-add.qty-combo-product",{product:u.productName,count:u.count+""});return void o.presentToast(p)}const r=e.materialsJson?JSON.parse(e.materialsJson):null,a={};a.price=e.price,a.productId=e.id,a.productCode=e.code,a.productName=e.title,a.productAvatar=e.avatarUrl,a.unit=e.unit,a.count=e.count,a.isExpand=!1,a.options=e.options,a.attributes=e.attributes,a.materials=r,o.product.items.unshift(a);const d=o.translateService.instant("product-add.added-combo-product",{product:Z.W.productName(e.code,e.title)});o.presentToast(d)}})()}presentToast(e,o=1686){var n=this;return(0,l.Z)(function*(){yield(yield n.toastCtrl.create({message:e,duration:o,position:"bottom",color:"danger"})).present()})()}productName(e,o){return Z.W.productName(e,o)}barcodeChanged(){var e=this;return(0,l.Z)(function*(){!e.product||!e.product.barcode||e.product.barcode.length<5||e.analyticsService.logEvent("product-add-barcode-entered-for-combo")})()}showSearchCategory(){var e=this;return(0,l.Z)(function*(){const o=function(){var n=(0,l.Z)(function*(r){const a=r;if(a)if(e.categories.findIndex(d=>d.categoryId===a.id)>=0)yield(yield e.alertCtrl.create({header:"Ch\xfa \xfd",subHeader:"B\u1ea1n \u0111\xe3 th\xeam Danh m\u1ee5c n\xe0y r\u1ed3i.",buttons:["OK"]})).present();else{const d=new ft.p;d.tradeCategory=a,d.categoryId=a.id,e.categories.push(d)}});return function(a){return n.apply(this,arguments)}}();e.navCtrl.push("/trade-category",{callback:o,searchMode:!0})})()}removeCategory(e){0!==e.id&&this.categoriesToRemove.push(e),q.remove(this.categories,o=>o.categoryId===e.categoryId)}dateFormat(e){return C.C.toUiLocalDateString(e)}showDatePopup(){this.product.expiredAt=xt().startOf("day").format("YYYY-MM-DD")}addOtherBarcode(){this.navCtrl.push("/product/barcode",{productId:this.product.id,callback:()=>{}})}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),yield e.exitPage()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}addUnit(){this.product.units||(this.product.units=[]),this.product.units.unshift({})}removeUnit(e,o){e.unit&&!confirm(this.translateService.instant("product-add.remove-unit",{unit:e.unit}))||this.product.units.splice(o,1)}increaseUnit(e){e.count?e.count++:e.count=1}decreaseUnit(e){e.count--,e.count<0&&(e.count=0)}increase(){!this.product||this.product.count++}decrease(){!this.product||(this.product.count--,this.product.count<0&&(this.product.count=0))}addZerosToNumber(e){let o="";for(let n=0;n<e;n++)o+="0";if(this.product&&this.product.price){let n=this.product.price.toString();n+=o,this.product.price=Number(n)}}addZerosToNumberToUnit(e,o){let n="";for(let r=0;r<e;r++)n+="0";if(o&&o.price){let r=o.price.toString();r+=n,o.price=Number(r)}}changeUnit(e){e.exchange&&e.unit&&this.presentToast("1 "+e.unit+" = "+e.exchange+" "+this.product.unit)}changeUnitDefault(e){if(e.isDefault){this.presentToast(this.translateService.instant("product-add.unit-default-alert",{unit:e.unit}),3e3);for(const o of this.product.units)o.unit!==e.unit&&(o.isDefault=!1)}}expandCombo(e){var o=this;return(0,l.Z)(function*(){const n=!e.isExpand;for(const r of o.product.items)r.isExpand=!1;e.isExpand=n,n&&o.analyticsService.logEvent("product-selector-expand")})()}expandMaterial(e){var o=this;return(0,l.Z)(function*(){const n=!e.isExpand;for(const r of o.product.materials)r.isExpand=!1;e.isExpand=n,n&&o.analyticsService.logEvent("product-selector-expand")})()}addMaterial(e){var o=this;return(0,l.Z)(function*(){if(e){for(const d of o.product.materials)d.isExpand=!1;const n=o.product.materials.findIndex(d=>d.productId===e.id);if(n>=0){const d=o.product.materials[n];d.isExpand=!0,d.count=1*d.count+1;const u=o.translateService.instant("product-add.qty-material",{product:d.productName,count:d.count+""});return void o.presentToast(u)}const r={};r.price=e.price,r.productId=e.id,r.productCode=e.code,r.productName=e.title,r.productAvatar=e.avatarUrl,r.unit=e.unit,r.count=1,r.isExpand=!1,o.product.materials.unshift(r);const a=o.translateService.instant("product-add.added-material",{product:Z.W.productName(e.code,e.title)});o.presentToast(a)}})()}showMaterialSelector(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-search-material"),yield e.navCtrl.push("/order/product-selector",{callback:n=>{if(n&&n.length){for(const r of e.product.items)r.isExpand=!1;for(const r of n)e.addMaterialFromArr(r)}},isMaterial:!0})})()}addMaterialFromArr(e){var o=this;return(0,l.Z)(function*(){if(!e||o.product.materials.findIndex(d=>d.productId===e.id)>=0)return;const r={};r.price=e.price,r.productId=e.id,r.productCode=e.code,r.productName=e.title,r.productAvatar=e.avatarUrl,r.unit=e.unit,r.count=e.count,r.isExpand=!1,o.product.materials.unshift(r);const a=o.translateService.instant("product-add.added-material",{product:Z.W.productName(e.code,e.title)});o.presentToast(a)})()}scanMaterialItem(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-quick-add-scan-barcode-for-material"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.productService.searchByBarcode(n.barcode).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-quick-add-scan-barcode-for-material-ok"),e.addMaterial(a)});return function(a){return r.apply(this,arguments)}}())}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.productService.searchByBarcode(o.text).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-quick-scan-barcode-for-combo-ok"),e.addMaterial(r)});return function(r){return n.apply(this,arguments)}}())})})()}removeMaterial(e){var o=this;return(0,l.Z)(function*(){const n=o.product.materials.findIndex(r=>r.productId===e.productId);n>=0&&o.product.materials.splice(n,1),o.analyticsService.logEvent("product-add-remove-material")})()}addZerosToNumberToUnitCostPrice(e,o){let n="";for(let r=0;r<e;r++)n+="0";if(o&&o.costPrice){let r=o.costPrice.toString();r+=n,o.costPrice=Number(r)}}removeDate(){this.product.expiredAt=""}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(ht.V1),t.Y36(Zt.K),t.Y36(E.K),t.Y36(et.D),t.Y36(A.x),t.Y36(s.IN),t.Y36(N.M),t.Y36(I.m),t.Y36(s.t4),t.Y36(b.sK),t.Y36(s.BX),t.Y36(at.$),t.Y36(Q.y),t.Y36(s.yF),t.Y36(s.Br),t.Y36(D.d),t.Y36(st.X))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-add"]],viewQuery:function(e,o){if(1&e&&(t.Gf(zn,7),t.Gf(Wn,7),t.Gf(Rn,7),t.Gf(Xn,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.barcodeInput=n.first),t.iGM(n=t.CRH())&&(o.barcodeInputCombo=n.first),t.iGM(n=t.CRH())&&(o.barcodeInputMaterial=n.first),t.iGM(n=t.CRH())&&(o.fileUploadInput=n.first)}},decls:219,vars:178,consts:[["slot","start"],["color","primary",3,"disabled","click"],["name","close"],["slot","end"],["name","options"],["size","large","color","success",3,"disabled","click"],["name","checkmark"],["lines","none","color","success",4,"ngIf"],["position","stacked","color","primary"],["clearInput","","autofocus","","type","text",3,"placeholder","ngModel","ngModelChange","focus"],["barcodeInput",""],[3,"click"],["name","barcode"],["color","secondary",3,"click"],["color","success",3,"click"],["name","add-outline"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["color","primary"],["fill","outline",3,"click"],["name","add"],["size-xs","6","size-sm","6","size-md","3","size-lg","2",4,"ngFor","ngForOf"],[4,"ngIf"],["size","4","size-md",""],["clearInput","","type","text",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange","focus"],[2,"font-size","0.65em"],["color","danger"],[3,"placeholder","moneyValue","moneyValueChange"],["expand","block","fill","solid",3,"click"],["clearInput","","type","number","tabindex","3",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange","focus"],["slot","icon-only","name","remove-outline"],["slot","icon-only","name","add-outline"],["size","small","fill","outline",3,"click"],["position","stacked","color","primary",1,"ion-text-wrap"],[3,"ngModel","ngModelChange","ionChange"],["color","dark",2,"font-size","0.85em"],["fill","solid","expand","full","color","primary","tabindex","5",3,"disabled","click"],["fill","solid","expand","full","color","medium","tabindex","5",3,"disabled","click"],["name","cog"],[3,"ngModel","ngModelChange"],["slot","end","pickerId","productAddPicker",3,"date","dateChange",4,"ngIf"],["slot","end",3,"click",4,"ngIf"],["fill","outline","slot","end",3,"click",4,"ngIf"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange","focus"],[2,"background-color","#efefef"],["style","background-color: #efefef;",4,"ngIf"],["type","text","rows","5",2,"background-color","#efefef","border-radius","5px","color","#000","font-size","0.8em",3,"placeholder","ngModel","ngModelChange"],["ion-button","","color","secondary",3,"click",4,"ngIf"],["color","primary","for","files"],["type","file","multiple","","accept","image/*","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],[4,"ngFor","ngForOf"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],["size-xs","6","size-sm","6","size-md","3","size-lg","2"],["lines","none"],["fill","clear",3,"click"],["color","dark",1,"ion-text-wrap"],[3,"clear","placeholder","moneyValue","disabled","moneyValueChange"],["size","3","size-md",""],["clearInput","","type","text",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange","focus"],["color","primary",2,"--size","20px",3,"ngModel","ngModelChange"],[2,"font-size","0.8em"],["position","stacked","color","secondary"],[3,"moneyValue","placeholder","moneyValueChange"],[2,"float","right"],["size","small","expand","block","fill","clear","color","danger",3,"click"],["name","close-outline","slot","icon-only"],["color","light",1,"ion-no-padding"],["color","primary",1,"ion-text-wrap"],["fill","clear","color","primary",3,"click"],["clearInput","","autofocus","true","type","text",3,"placeholder","ngModel","ngModelChange"],["color","light",1,"ion-text-wrap","ion-no-padding",3,"hidden"],[2,"padding-top","5px","padding-bottom","5px",3,"innerHTML"],["color","light",1,"ion-no-padding",3,"lines"],[2,"padding-top","8px","padding-bottom","8px"],["slot","end",2,"padding-left","0","margin-left","0","padding-right","0","margin-right","0"],["fill","clear","size","large",3,"click"],["slot","icon-only","name","remove"],["slot","icon-only","name","add"],["fill","clear","size","small","color","medium",3,"click"],["slot","icon-only","size","small","name","ellipsis-vertical"],["slot","icon-only","name","close"],["lines","inset","color","light","size","12",1,"ion-no-padding"],[1,"ion-text-wrap",2,"font-size","0.8em"],["clearInput","","autofocus","true","type","text",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange"],["barcodeInputMaterial",""],["lines","inset","color","light",1,"ion-no-padding"],["slot","icon-only",3,"name"],[2,"padding-top","8px","padding-bottom","8px",3,"click"],["color","light",2,"padding-left","15px","padding-right","15px","margin","0",3,"hidden"],["clearInput","","type","number",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange","focus"],["slot","end","pickerId","productAddPicker",3,"date","dateChange"],["slot","end",3,"click"],["fill","outline","slot","end",3,"click"],[3,"clear","placeholder","moneyValue","moneyValueChange"],["ion-button","","color","secondary",3,"click"],["name","camera"],["style","max-width: 150px;",4,"ngFor","ngForOf"],[2,"max-width","150px"],[2,"max-width","120px",3,"src","click"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.navCtrl.back()}),t._UZ(4,"ion-icon",2),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-title"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ion-buttons",3)(11,"ion-button",1),t.NdJ("click",function(){return o.viewTypes()}),t._UZ(12,"ion-icon",4),t.qZA(),t.TgZ(13,"ion-button",5),t.NdJ("click",function(){return o.save()}),t._UZ(14,"ion-icon",6),t._uU(15),t.ALo(16,"translate"),t.qZA()()(),t.YNc(17,ti,8,4,"ion-item",7),t.qZA(),t.TgZ(18,"ion-content")(19,"ion-list")(20,"ion-item")(21,"ion-label",8),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"ion-input",9,10),t.NdJ("ngModelChange",function(r){return o.product.barcode=r})("focus",function(r){return o.selectAll(r)}),t.ALo(26,"translate"),t.qZA()(),t.TgZ(27,"ion-item")(28,"ion-button",11),t.NdJ("click",function(){return o.scan()}),t._UZ(29,"ion-icon",12),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"ion-button",13),t.NdJ("click",function(){return o.autoGenBarcode()}),t._UZ(33,"ion-icon",12),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.TgZ(36,"ion-button",14),t.NdJ("click",function(){return o.addOtherBarcode()}),t._UZ(37,"ion-icon",15),t._uU(38),t.ALo(39,"translate"),t.qZA()(),t.TgZ(40,"ion-item")(41,"ion-label",8),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"ion-input",16),t.NdJ("ngModelChange",function(r){return o.product.code=r}),t.ALo(45,"translate"),t.qZA()(),t.TgZ(46,"ion-item")(47,"ion-label",17),t._uU(48),t.ALo(49,"translate"),t.qZA(),t.TgZ(50,"ion-button",18),t.NdJ("click",function(){return o.showSearchCategory()}),t._UZ(51,"ion-icon",19),t._uU(52),t.ALo(53,"translate"),t.qZA()(),t.TgZ(54,"ion-grid")(55,"ion-row"),t.YNc(56,ei,6,1,"ion-col",20),t.qZA()(),t.TgZ(57,"ion-item")(58,"ion-label",8),t._uU(59),t.ALo(60,"translate"),t.qZA(),t.TgZ(61,"ion-input",16),t.NdJ("ngModelChange",function(r){return o.product.title=r}),t.ALo(62,"translate"),t.qZA()(),t.YNc(63,ni,7,10,"ion-item",21),t.TgZ(64,"ion-grid")(65,"ion-row")(66,"ion-col",22)(67,"ion-label",8),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"ion-input",23),t.NdJ("ngModelChange",function(r){return o.product.unit=r})("focus",function(r){return o.selectAll(r)}),t.ALo(71,"translate"),t.qZA(),t.TgZ(72,"p",24)(73,"ion-text",25),t._uU(74),t.ALo(75,"translate"),t.qZA()()(),t.TgZ(76,"ion-col",22)(77,"ion-label",8),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.TgZ(80,"money-input",26),t.NdJ("moneyValueChange",function(r){return o.product.price=r}),t.ALo(81,"translate"),t.qZA(),t.TgZ(82,"ion-buttons")(83,"ion-button",27),t.NdJ("click",function(){return o.addZerosToNumber(2)}),t._uU(84,".00"),t.qZA(),t.TgZ(85,"ion-button",27),t.NdJ("click",function(){return o.addZerosToNumber(3)}),t._uU(86,".000"),t.qZA()()(),t.TgZ(87,"ion-col",22)(88,"ion-label",8),t._uU(89),t.ALo(90,"translate"),t.qZA(),t.TgZ(91,"ion-input",28),t.NdJ("ngModelChange",function(r){return o.product.count=r})("focus",function(r){return o.selectAll(r)}),t.ALo(92,"translate"),t.qZA(),t.TgZ(93,"ion-buttons")(94,"ion-button",27),t.NdJ("click",function(){return o.decrease()}),t._UZ(95,"ion-icon",29),t.qZA(),t.TgZ(96,"ion-button",27),t.NdJ("click",function(){return o.increase()}),t._UZ(97,"ion-icon",30),t.qZA()()()(),t.TgZ(98,"ion-row")(99,"ion-col")(100,"ion-button",31),t.NdJ("click",function(){return o.addUnit()}),t._uU(101),t.ALo(102,"translate"),t.qZA()()(),t.YNc(103,ri,2,1,"ng-container",21),t.qZA(),t.TgZ(104,"ion-item")(105,"ion-label",32)(106,"h3"),t._uU(107),t.ALo(108,"translate"),t.qZA()(),t.TgZ(109,"ion-toggle",33),t.NdJ("ngModelChange",function(r){return o.product.isOption=r})("ionChange",function(){return o.changeIsOption()}),t.qZA(),t.TgZ(110,"ion-text",34),t._uU(111),t.ALo(112,"translate"),t.qZA()(),t.TgZ(113,"ion-item")(114,"ion-button",35),t.NdJ("click",function(){return o.viewTypes()}),t._UZ(115,"ion-icon",4),t._uU(116),t.ALo(117,"translate"),t.qZA(),t.TgZ(118,"ion-button",36),t.NdJ("click",function(){return o.viewAttributes()}),t._UZ(119,"ion-icon",37),t._uU(120),t.ALo(121,"translate"),t.qZA()(),t.TgZ(122,"ion-item")(123,"ion-label",32)(124,"h3"),t._uU(125),t.ALo(126,"translate"),t.qZA()(),t.TgZ(127,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.isCombo=r}),t.qZA(),t.TgZ(128,"ion-text",34),t._uU(129),t.ALo(130,"translate"),t.qZA()(),t.YNc(131,ui,27,24,"ion-item",21),t.TgZ(132,"ion-item")(133,"ion-label",32)(134,"h3"),t._uU(135),t.ALo(136,"translate"),t.qZA()(),t.TgZ(137,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.autoMaterials=r}),t.qZA(),t.TgZ(138,"ion-text",34),t._uU(139),t.ALo(140,"translate"),t.qZA()(),t.YNc(141,gi,27,24,"ion-item",21),t.TgZ(142,"ion-item")(143,"ion-label",32)(144,"h3"),t._uU(145),t.ALo(146,"translate"),t.qZA()(),t.TgZ(147,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.isService=r}),t.qZA(),t.TgZ(148,"ion-text",34),t._uU(149),t.ALo(150,"translate"),t.qZA()(),t.TgZ(151,"ion-item")(152,"ion-label",8),t._uU(153),t.ALo(154,"translate"),t.qZA(),t.YNc(155,fi,1,1,"date-picker",39),t.YNc(156,xi,3,3,"ion-text",40),t.YNc(157,hi,2,0,"ion-button",41),t.qZA(),t.TgZ(158,"ion-item")(159,"ion-label",8),t._uU(160),t.ALo(161,"translate"),t.qZA(),t.TgZ(162,"ion-input",42),t.NdJ("ngModelChange",function(r){return o.product.foreignCurrency=r})("focus",function(r){return o.selectAll(r)}),t.ALo(163,"translate"),t.qZA()(),t.TgZ(164,"ion-item")(165,"ion-label",8),t._uU(166),t.ALo(167,"translate"),t.qZA(),t.TgZ(168,"money-input",26),t.NdJ("moneyValueChange",function(r){return o.product.costPriceForeign=r}),t.ALo(169,"translate"),t.qZA()(),t.TgZ(170,"ion-item",43)(171,"ion-label",17),t._uU(172),t.ALo(173,"translate"),t.qZA()(),t.TgZ(174,"ion-item",43)(175,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.showOnWeb=r}),t.qZA(),t.TgZ(176,"ion-label",17),t._uU(177),t.ALo(178,"translate"),t.qZA()(),t.TgZ(179,"ion-item",43)(180,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.isHotProduct=r}),t.qZA(),t.TgZ(181,"ion-label",17),t._uU(182),t.ALo(183,"translate"),t.qZA()(),t.TgZ(184,"ion-item",43)(185,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.isNewProduct=r}),t.qZA(),t.TgZ(186,"ion-label",17),t._uU(187),t.ALo(188,"translate"),t.qZA()(),t.TgZ(189,"ion-item",43)(190,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.showPriceOnWeb=r}),t.qZA(),t.TgZ(191,"ion-label",17),t._uU(192),t.ALo(193,"translate"),t.qZA()(),t.TgZ(194,"ion-item",43)(195,"ion-toggle",38),t.NdJ("ngModelChange",function(r){return o.product.isSale=r}),t.qZA(),t.TgZ(196,"ion-label",17),t._uU(197),t.ALo(198,"translate"),t.qZA()(),t.YNc(199,Zi,6,8,"ion-item",44),t.TgZ(200,"ion-item")(201,"ion-label",8),t._uU(202),t.ALo(203,"translate"),t.qZA(),t.TgZ(204,"ion-textarea",45),t.NdJ("ngModelChange",function(r){return o.product.description=r}),t.ALo(205,"translate"),t.qZA()()(),t.TgZ(206,"ion-list")(207,"ion-item")(208,"ion-label",17),t._uU(209),t.ALo(210,"translate"),t.qZA(),t.YNc(211,Ti,4,3,"ion-button",46),t.TgZ(212,"label",47),t._uU(213),t.ALo(214,"translate"),t.qZA(),t.TgZ(215,"input",48,49),t.NdJ("change",function(r){return o.rememberFile(r)}),t.qZA()()(),t.TgZ(217,"ion-grid"),t.YNc(218,Ci,2,1,"ion-row",50),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(6,84,"product-add.close")," "),t.xp6(3),t.Oqu(t.lcZ(9,86,"product-add.title")),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(16,88,"action.save")," "),t.xp6(2),t.Q6J("ngIf",o.checkStore&&(!o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(4),t.Oqu(t.lcZ(23,90,"order-add.enter-barcode")),t.xp6(2),t.s9C("placeholder",t.lcZ(26,92,"order-add.enter-barcode-placeholder")),t.Q6J("ngModel",o.product.barcode),t.xp6(6),t.hij(" ",t.lcZ(31,94,"product.scan-barcode")," "),t.xp6(4),t.hij(" ",t.lcZ(35,96,"product.auto-gen-barcode")," "),t.xp6(4),t.hij(" ",t.lcZ(39,98,"product.add-other-barcode")," "),t.xp6(4),t.Oqu(t.lcZ(43,100,"product-add.code")),t.xp6(2),t.s9C("placeholder",t.lcZ(45,102,"product-add.enter-code")),t.Q6J("ngModel",o.product.code),t.xp6(4),t.Oqu(t.lcZ(49,104,"trade-add.categories")),t.xp6(4),t.hij(" ",t.lcZ(53,106,"trade-add.add")," "),t.xp6(4),t.Q6J("ngForOf",o.categories),t.xp6(3),t.Oqu(t.lcZ(60,108,"product-add.product-title")),t.xp6(2),t.s9C("placeholder",t.lcZ(62,110,"product-add.enter-title")),t.Q6J("ngModel",o.product.title),t.xp6(2),t.Q6J("ngIf",o.canViewProductCostPrice&&o.canUpdateProductCostPrice),t.xp6(5),t.Oqu(t.lcZ(69,112,"product-add.basic-unit")),t.xp6(2),t.s9C("placeholder",t.lcZ(71,114,"product-add.enter-unit")),t.Q6J("ngModel",o.product.unit),t.xp6(4),t.Oqu(t.lcZ(75,116,"product-add.basic-unit-description")),t.xp6(4),t.Oqu(t.lcZ(79,118,"product-add.price")),t.xp6(2),t.s9C("placeholder",t.lcZ(81,120,"product-add.enter-price")),t.Q6J("moneyValue",o.product.price),t.xp6(9),t.hij("",t.lcZ(90,122,"product-add.count")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(92,124,"product-add.enter-count")),t.Q6J("ngModel",o.product.count),t.xp6(10),t.hij("+ ",t.lcZ(102,126,"product-add.add-unit")," "),t.xp6(2),t.Q6J("ngIf",o.product&&o.product.units&&o.product.units.length),t.xp6(4),t.Oqu(t.lcZ(108,128,"product-add.is-added-option")),t.xp6(2),t.Q6J("ngModel",o.product.isOption),t.xp6(2),t.hij("",t.lcZ(112,130,"product-add.added-option-explain")," "),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij("\xa0 ",t.lcZ(117,132,"product-add.types")," "),t.xp6(2),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij("\xa0 ",t.lcZ(121,134,"product-add.attributes")," "),t.xp6(5),t.Oqu(t.lcZ(126,136,"product-add.is-combo")),t.xp6(2),t.Q6J("ngModel",o.product.isCombo),t.xp6(2),t.hij("",t.lcZ(130,138,"product-add.combo-description")," "),t.xp6(2),t.Q6J("ngIf",o.product.isCombo),t.xp6(4),t.Oqu(t.lcZ(136,140,"product-add.auto-materials")),t.xp6(2),t.Q6J("ngModel",o.product.autoMaterials),t.xp6(2),t.hij("",t.lcZ(140,142,"product-add.auto-materials-explain")," "),t.xp6(2),t.Q6J("ngIf",o.product.autoMaterials),t.xp6(4),t.Oqu(t.lcZ(146,144,"product-add.is-service")),t.xp6(2),t.Q6J("ngModel",o.product.isService),t.xp6(2),t.hij("",t.lcZ(150,146,"product-add.service-description")," "),t.xp6(4),t.hij("",t.lcZ(154,148,"product-add.expired-date")," "),t.xp6(2),t.Q6J("ngIf",o.product.expiredAt),t.xp6(1),t.Q6J("ngIf",!o.product.expiredAt),t.xp6(1),t.Q6J("ngIf",o.product.expiredAt),t.xp6(3),t.Oqu(t.lcZ(161,150,"product-add.unit-foreign")),t.xp6(2),t.s9C("placeholder",t.lcZ(163,152,"product-add.unit-foreign")),t.Q6J("ngModel",o.product.foreignCurrency),t.xp6(4),t.hij("",t.lcZ(167,154,"product-add.cost-price-foreign")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(169,156,"product-add.cost-price-foreign")),t.Q6J("moneyValue",o.product.costPriceForeign),t.xp6(4),t.Oqu(t.lcZ(173,158,"config.web")),t.xp6(3),t.Q6J("ngModel",o.product.showOnWeb),t.xp6(2),t.hij("\xa0",t.lcZ(178,160,"product-add.show-on-web"),""),t.xp6(3),t.Q6J("ngModel",o.product.isHotProduct),t.xp6(2),t.hij("\xa0",t.lcZ(183,162,"product-add.is-hot-product"),""),t.xp6(3),t.Q6J("ngModel",o.product.isNewProduct),t.xp6(2),t.hij("\xa0",t.lcZ(188,164,"product-add.is-new-product"),""),t.xp6(3),t.Q6J("ngModel",o.product.showPriceOnWeb),t.xp6(2),t.hij("\xa0",t.lcZ(193,166,"product-add.show-price-on-web"),""),t.xp6(3),t.Q6J("ngModel",o.product.isSale),t.xp6(2),t.hij("\xa0",t.lcZ(198,168,"product-add.is-sale"),""),t.xp6(2),t.Q6J("ngIf",o.product.isSale),t.xp6(3),t.Oqu(t.lcZ(203,170,"product-add.description")),t.xp6(2),t.s9C("placeholder",t.lcZ(205,172,"product-add.enter-description")),t.Q6J("ngModel",o.product.description),t.xp6(5),t.Oqu(t.lcZ(210,174,"product-detail.photo")),t.xp6(2),t.Q6J("ngIf",!o.isNotCordova()),t.xp6(2),t.hij("\xa0[",t.lcZ(214,176,"note-add.select-photos"),"]"),t.xp6(5),t.Q6J("ngForOf",o.arr))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.nz,s.wI,s.W2,s.jY,s.Gu,s.gu,s.pK,s.Ie,s.rH,s.Q$,s.q_,s.Nd,s.yW,s.g2,s.wd,s.ho,s.sr,s.w,s.as,s.j9,ot.F,Tt.L,b.X$],encapsulation:2}),i})();const bi=["fileUploadInput"];function vi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",14)(1,"ion-label",15),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",17),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function Pi(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-import.upload-file")))}function Si(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.fileToUpload.name)}}const At=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function wi(i,c){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-label",15)(2,"span",19),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"span",20),t._UZ(6,"ion-icon",21),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(3),t.hij(" ",o.limitText(o.productName(e.code,e.title))," "),t.xp6(4),t.AsE("\xa0",t.lcZ(8,6,"product-detail.product-unit-price"),": ",t.G7q(9,8,t.kEZ(16,At,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(4),t.lnq(" - ",t.lcZ(12,14,"product-detail.product-quantity"),": ",e.count," ",e.unit,"")}}function ki(i,c){if(1&i&&(t.ynx(0),t.YNc(1,wi,13,20,"ion-item",18),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.productsImported)}}function qi(i,c){if(1&i&&(t.TgZ(0,"ion-row",23)(1,"ion-col"),t._uU(2),t.qZA(),t.TgZ(3,"ion-col"),t._uU(4),t.ALo(5,"currency"),t.qZA(),t.TgZ(6,"ion-col"),t._uU(7),t.qZA(),t.TgZ(8,"ion-col"),t._uU(9),t.qZA()()),2&i){const e=c.$implicit,o=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(2),t.Oqu(o.limitText(o.productName(e.code,e.title))),t.xp6(2),t.Oqu(t.G7q(5,6,t.kEZ(12,At,e.price,o.currency,o.translateService.currentLang))),t.xp6(3),t.Oqu(e.count),t.xp6(2),t.Oqu(e.unit)}}function Ni(i,c){if(1&i&&(t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"ion-col")(7,"strong"),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"ion-col")(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col")(15,"strong"),t._uU(16),t.ALo(17,"translate"),t.qZA()()(),t.YNc(18,qi,10,16,"ion-row",22),t.qZA()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,5,"product-add.product-title")),t.xp6(4),t.Oqu(t.lcZ(9,7,"product-add.price")),t.xp6(4),t.Oqu(t.lcZ(13,9,"product-add.count")),t.xp6(4),t.Oqu(t.lcZ(17,11,"product-add.unit")),t.xp6(2),t.Q6J("ngForOf",e.productsImported)}}function Ui(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.navCtrl.back())}),t._UZ(2,"ion-icon",25),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.hij("\xa0 ",t.lcZ(4,1,"product-add.close")," "))}let Ii=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_){this.userService=e,this.excelService=o,this.navCtrl=n,this.platform=r,this.alertCtrl=a,this.translateService=d,this.storeService=u,this.staffService=p,this.analyticsService=_,this.uploadDisabled=!1,this.productsImported=[],this.isMobile=!0,this.isMaterial=!1}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-import")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){e.userService.getAttr("current-currency").then(n=>{e.currency=n}),e.isMobile=e.platform.width()<720,e.platform.resize.subscribe(()=>{e.isMobile=e.platform.width()<720}),e.store=yield e.storeService.getCurrentStore(),e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null,e.selectedStaff=e.staffService.selectedStaff;const o=e.navCtrl.getParams();e.isMaterial=o&&o.isMaterial})()}downloadTemplate(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-import-download");const o="product-template.xlsx",n=yield e.navCtrl.loading();e.excelService.downloadProductsTemplate(o).then(function(){var r=(0,l.Z)(function*(a){yield n.dismiss(),(e.platform.is("capacitor")||e.platform.is("cordova"))&&-1===document.URL.indexOf("isale.online/app")&&(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(o,o,a))});return function(a){return r.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield n.dismiss()}))})()}rememberFile(e){this.fileToUpload=e.target.files[0],this.uploadProducts()}uploadProducts(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-import-upload"),e.uploadDisabled=!0;const o=yield e.navCtrl.loading();e.excelService.uploadProductsFile(e.fileToUpload,e.store?e.store.id:0,e.isMaterial).then(function(){var n=(0,l.Z)(function*(r){if(yield o.dismiss(),r&&r.id)e.analyticsService.logEvent("product-import-uploaded-success"),alert(e.translateService.instant("product-import.done")),e.navCtrl.publish("reloadProductList"),e.productsImported=r.products;else if(r&&r.error){e.analyticsService.logEvent("product-import-error");let a=r.error+"";a=a.replace("{","").replace("}","");const d=a.split(":");a="",a=d.length>=2?e.translateService.instant("product-import."+d[0])+d[1]:e.translateService.instant("product-import."+d[0]),alert(a)}else alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later).");e.uploadDisabled=!1,e.fileToUpload=null,e.fileUploadInput.nativeElement.value=null});return function(r){return n.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield o.dismiss(),alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),e.uploadDisabled=!1,e.fileToUpload=null,e.fileUploadInput.nativeElement.value=null}))})()}productName(e,o){return Z.W.productName(e,o)}limitText(e,o=200){return Z.W.limitText(e,o)}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),e.store=null,e.checkStore=null}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(E.K),t.Y36($.x),t.Y36(M.G),t.Y36(s.t4),t.Y36(s.Br),t.Y36(b.sK),t.Y36(D.d),t.Y36(A.x),t.Y36(Q.y))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-import"]],viewQuery:function(e,o){if(1&e&&t.Gf(bi,5),2&e){let n;t.iGM(n=t.CRH())&&(o.fileUploadInput=n.first)}},decls:31,vars:20,consts:[["slot","start"],["defaultHref","/home"],["lines","none","color","success",4,"ngIf"],[1,"ion-padding"],["expand","block","fill","outline","color","secondary",3,"click"],["name","download"],[3,"innerHTML"],["color","primary","for","files",2,"border-radius","10px","display","block","border","1px solid #387ef5","text-transform","uppercase","text-align","center"],[2,"color","#387ef5","height","45px","display","flex","align-items","center","justify-content","center"],["name","cloud-upload","color","primary",2,"zoom","1.5"],[4,"ngIf"],["type","file","accept",".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],["class","ion-padding",4,"ngIf"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],[4,"ngFor","ngForOf"],[2,"white-space","pre-wrap","font-weight","bold"],["color","secondary"],["name","pricetag"],["style","border-bottom: 1px solid #ccc;",3,"cursor",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #ccc"],[3,"click"],["name","close"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,vi,8,4,"ion-item",2),t.qZA(),t.TgZ(8,"ion-content")(9,"div",3)(10,"p"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"ion-button",4),t.NdJ("click",function(){return o.downloadTemplate()}),t._UZ(14,"ion-icon",5),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"p",6),t.ALo(18,"translate"),t.TgZ(19,"label",7)(20,"div",8),t._UZ(21,"ion-icon",9),t._uU(22," \xa0 "),t.YNc(23,Pi,3,3,"span",10),t.YNc(24,Si,2,1,"span",10),t.qZA()(),t.TgZ(25,"input",11,12),t.NdJ("change",function(r){return o.rememberFile(r)}),t.qZA()(),t.TgZ(27,"ion-list"),t.YNc(28,ki,2,1,"ng-container",10),t.YNc(29,Ni,19,13,"ion-grid",10),t.qZA(),t.YNc(30,Ui,5,3,"div",13),t.qZA()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,12,"product-import.title")),t.xp6(2),t.Q6J("ngIf",o.checkStore&&(null==o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(3),t.Oqu(t.lcZ(12,14,"product-import.template-note")),t.xp6(4),t.hij("\xa0 ",t.lcZ(16,16,"product-import.download-template")," "),t.xp6(2),t.Q6J("innerHTML",t.lcZ(18,18,"product-import.note"),t.oJD),t.xp6(6),t.Q6J("ngIf",!o.fileToUpload),t.xp6(1),t.Q6J("ngIf",o.fileToUpload),t.xp6(4),t.Q6J("ngIf",o.isMobile),t.xp6(1),t.Q6J("ngIf",!o.isMobile&&o.productsImported&&o.productsImported.length),t.xp6(1),t.Q6J("ngIf",o.productsImported&&o.productsImported.length))},dependencies:[T.sg,T.O5,s.oU,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.Nd,s.wd,s.sr,s.cs,T.H9,b.X$],encapsulation:2}),i})();var Ct=x(2216);function Ji(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",7)(1,"ion-label",8),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",10),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function Mi(i,c){if(1&i&&(t.TgZ(0,"ion-label",8),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.HOy(" ",t.lcZ(2,4,"common.from")," ",e.dateFormat(e.dateFrom)," ",t.lcZ(3,6,"common.to")," ",e.dateFormat(e.dateTo),"")}}function Qi(i,c){1&i&&(t.TgZ(0,"ion-item",11)(1,"ion-label",16),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.hij("",t.lcZ(3,1,"product-note-export.select-product"),":"))}function Li(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",0)(1,"ion-button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.removeProduct())}),t._UZ(2,"ion-icon",27),t.qZA()()}}function Ei(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-text",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.showSearchProduct())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.productName(e.productSelected.code,e.productSelected.title)," ")}}function Oi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-text",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.showSearchProduct())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"product-note-export.all-product")," "))}function Yi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",11),t.YNc(1,Li,3,0,"ion-buttons",20),t.YNc(2,Ei,2,1,"ion-text",21),t.YNc(3,Oi,3,3,"ion-text",22),t.TgZ(4,"ion-buttons",23)(5,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.scan())}),t._UZ(6,"ion-icon",25),t._uU(7),t.ALo(8,"translate"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.productSelected&&e.productSelected.id>0),t.xp6(1),t.Q6J("ngIf",e.productSelected&&e.productSelected.id>0),t.xp6(1),t.Q6J("ngIf",!e.productSelected||0==e.productSelected.id),t.xp6(4),t.hij(" ",t.lcZ(8,4,"product.scan-barcode")," ")}}function Fi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-list")(1,"ion-item",11)(2,"ion-label",12),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"ion-item",13),t.YNc(6,Mi,4,8,"ion-label",5),t.TgZ(7,"ion-button",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.selectDateRange())}),t._UZ(8,"ion-icon",15),t.qZA()(),t.TgZ(9,"ion-item",11)(10,"ion-label",16),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"ion-item")(14,"ion-select",17),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.reportType=n)}),t.TgZ(15,"ion-select-option",18),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"ion-select-option",18),t._uU(19),t.ALo(20,"translate"),t.qZA()()(),t.YNc(21,Qi,4,3,"ion-item",19),t.YNc(22,Yi,9,6,"ion-item",19),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij("",t.lcZ(4,10,"product-note-export.select-date-range"),":"),t.xp6(3),t.Q6J("ngIf",""!=e.dateFrom||""!=e.dateTo),t.xp6(5),t.hij("",t.lcZ(12,12,"product-note-export.select-report-type"),":"),t.xp6(3),t.Q6J("ngModel",e.reportType),t.xp6(1),t.Q6J("value",0),t.xp6(1),t.hij("",t.lcZ(17,14,"product-note-export.report-type-summary")," "),t.xp6(2),t.Q6J("value",1),t.xp6(1),t.hij("",t.lcZ(20,16,"product-note-export.report-type-detail")," "),t.xp6(2),t.Q6J("ngIf",1===e.reportType),t.xp6(1),t.Q6J("ngIf",1===e.reportType)}}function Gi(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.generate())}),t._UZ(4,"ion-icon",31),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.export())}),t._UZ(9,"fa-icon",33),t._uU(10),t.ALo(11,"translate"),t.qZA()()()()}2&i&&(t.xp6(5),t.hij(" \xa0",t.lcZ(6,2,"product-note-export.generate")," "),t.xp6(5),t.hij(" \xa0",t.lcZ(11,4,"product-note-export.export")," "))}function Ki(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.resetReport())}),t._UZ(4,"ion-icon",34),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.export())}),t._UZ(9,"fa-icon",33),t._uU(10),t.ALo(11,"translate"),t.qZA()()()()}2&i&&(t.xp6(5),t.hij(" \xa0",t.lcZ(6,2,"product-note-export.change")," "),t.xp6(5),t.hij(" \xa0",t.lcZ(11,4,"product-note-export.export")," "))}const O=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function Hi(i,c){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col",35)(2,"ion-text",36),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._uU(5,":"),t._UZ(6,"br"),t.TgZ(7,"ion-text",37),t._uU(8),t.ALo(9,"currency"),t.qZA()(),t.TgZ(10,"ion-col",35),t._uU(11),t.ALo(12,"translate"),t._UZ(13,"br"),t.TgZ(14,"ion-text",36),t._uU(15),t.ALo(16,"currency"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,4,"common.total")),t.xp6(5),t.hij(" ",t.G7q(9,6,t.kEZ(20,O,e.report.totalSale,e.currency,e.translateService.currentLang)),"."),t.xp6(3),t.hij(" ",t.lcZ(12,12,"product-note-export.total-cost"),":"),t.xp6(4),t.hij(" ",t.G7q(16,14,t.kEZ(24,O,e.report.totalCost,e.currency,e.translateService.currentLang)),".")}}function Di(i,c){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col",35)(2,"ion-text",36),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._uU(5,":"),t._UZ(6,"br"),t.TgZ(7,"ion-text",37),t._uU(8),t.ALo(9,"currency"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,2,"common.total")),t.xp6(5),t.hij(" ",t.G7q(9,4,t.kEZ(10,O,e.report.total,e.currency,e.translateService.currentLang)),".")}}function Bi(i,c){if(1&i&&(t.TgZ(0,"ion-item",8)(1,"ion-grid")(2,"ion-row")(3,"ion-col",35)(4,"ion-text"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t._uU(7,":"),t._UZ(8,"br"),t.TgZ(9,"ion-text",16),t._uU(10),t.qZA()(),t.TgZ(11,"ion-col",35)(12,"ion-text"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._uU(15,":"),t._UZ(16,"br"),t.TgZ(17,"ion-text",16),t._uU(18),t.qZA()(),t.TgZ(19,"ion-col")(20,"ion-text"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._uU(23,":"),t._UZ(24,"br"),t.TgZ(25,"ion-text",16),t._uU(26),t.qZA()()(),t.YNc(27,Hi,17,28,"ion-row",3),t.YNc(28,Di,10,14,"ion-row",3),t.qZA()()),2&i){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,8,"common.from")),t.xp6(5),t.hij(" ",e.dateFormat(e.dateFrom)," "),t.xp6(3),t.Oqu(t.lcZ(14,10,"common.to")),t.xp6(5),t.hij(" ",e.dateFormat(e.dateTo)," "),t.xp6(3),t.Oqu(t.lcZ(22,12,"product-note-export.report-type")),t.xp6(5),t.hij(" ",e.reportName(),""),t.xp6(1),t.Q6J("ngIf",0===e.reportType),t.xp6(1),t.Q6J("ngIf",1===e.reportType)}}function ji(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function $i(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.selectProduct(r.id))}),t.TgZ(1,"ion-label",8)(2,"strong"),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"ion-text",16),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"currency"),t.qZA(),t._uU(9),t.ALo(10,"translate"),t.ALo(11,"currency"),t.qZA(),t.TgZ(12,"div"),t._uU(13),t.ALo(14,"translate"),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"div"),t._uU(17),t.ALo(18,"translate"),t.YNc(19,ji,2,0,"span",3),t._uU(20),t.ALo(21,"translate"),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(3),t.Oqu(o.productName(e.code,e.name)),t.xp6(3),t.AsE("",t.lcZ(7,14,"product-note-export.total-sale"),": ",t.G7q(8,16,t.kEZ(38,O,e.totalSale,o.currency,o.translateService.currentLang)),""),t.xp6(3),t.AsE(" - ",t.lcZ(10,22,"product-note-export.total-cost"),": ",t.G7q(11,24,t.kEZ(42,O,e.totalCost,o.currency,o.translateService.currentLang))," "),t.xp6(4),t.HOy(" ",t.lcZ(14,30,"product-note-export.opening"),": ",e.opening?e.opening:0," - ",t.lcZ(15,32,"product-note-export.closing"),": ",e.closing?e.closing:0," "),t.xp6(4),t.hij(" ",t.lcZ(18,34,"product-note-export.received"),": "),t.xp6(2),t.Q6J("ngIf",e.received>0),t.xp6(1),t.lnq("",e.received?e.received:0," - ",t.lcZ(21,36,"product-note-export.issued"),": ",e.issued?e.issued:0," ")}}function Vi(i,c){if(1&i&&(t.ynx(0),t.YNc(1,$i,22,46,"ion-item",38),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.report.items)}}function zi(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("/",e.unit,"")}}function Wi(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Ri(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.AsE("- ",t.lcZ(2,2,"product-note-export.discount"),": ",e.discount,"")}}function Xi(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE("- ",t.lcZ(2,2,"product-note-export.staff-price"),": ",t.G7q(3,4,t.kEZ(10,O,e.staffUnitPrice,o.currency,o.translateService.currentLang)),"")}}function tr(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"currency"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE("- ",t.lcZ(2,2,"product-note-export.staff-profit"),": ",t.G7q(3,4,t.kEZ(10,O,e.staffProfit,o.currency,o.translateService.currentLang)),"")}}function er(i,c){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Xi,4,14,"span",3),t.YNc(4,tr,4,14,"span",3),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,4,"product-note-export.staff"),": ",e.staff," "),t.xp6(2),t.Q6J("ngIf",e.staffUnitPrice),t.xp6(1),t.Q6J("ngIf",e.staffProfit)}}function or(i,c){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,"product-note-export.contact"),": ",e.contact," ")}}function nr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.selectProduct(r.id))}),t.TgZ(1,"ion-label",8)(2,"strong"),t._uU(3),t.qZA(),t._uU(4," - "),t.TgZ(5,"ion-text",39),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"div")(9,"strong"),t._uU(10),t.qZA(),t._uU(11," - "),t.TgZ(12,"ion-text"),t._uU(13),t.ALo(14,"translate"),t.ALo(15,"currency"),t.qZA(),t.YNc(16,zi,2,1,"span",3),t.qZA(),t.TgZ(17,"div"),t._uU(18),t.ALo(19,"translate"),t.YNc(20,Wi,2,0,"span",3),t._uU(21),t.YNc(22,Ri,3,4,"span",3),t.qZA(),t.YNc(23,er,5,6,"div",3),t.YNc(24,or,3,4,"div",3),t.TgZ(25,"p"),t._uU(26),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(3),t.Oqu(e.description),t.xp6(2),t.s9C("color",e.amount>=0?"secondary":"danger"),t.xp6(1),t.Oqu(t.G7q(7,14,t.kEZ(30,O,e.amount,o.currency,o.translateService.currentLang))),t.xp6(4),t.Oqu(o.productName(e.code,e.name)),t.xp6(3),t.AsE(" ",t.lcZ(14,20,"product-note-export.unit-price"),": ",t.G7q(15,22,t.kEZ(34,O,e.unitPrice,o.currency,o.translateService.currentLang)),""),t.xp6(3),t.Q6J("ngIf",e.unit),t.xp6(2),t.hij(" ",t.lcZ(19,28,"product-note-export.quantity"),": "),t.xp6(2),t.Q6J("ngIf",e.quantity>0),t.xp6(1),t.hij("",e.quantity," "),t.xp6(1),t.Q6J("ngIf",e.discount),t.xp6(1),t.Q6J("ngIf",e.staff),t.xp6(1),t.Q6J("ngIf",e.contact),t.xp6(2),t.hij(" ",o.dateFormat(e.createdAt)," ")}}function ir(i,c){if(1&i&&(t.ynx(0),t.YNc(1,nr,27,38,"ion-item",38),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.report.items)}}function rr(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-list-header")(2,"ion-label"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,Vi,2,1,"ng-container",3),t.YNc(6,ir,2,1,"ng-container",3),t.BQk()),2&i){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,3,"product-note-export.list")),t.xp6(2),t.Q6J("ngIf",0===e.reportType),t.xp6(1),t.Q6J("ngIf",1===e.reportType)}}function cr(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function ar(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",44),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.selectProduct(r.id))}),t.TgZ(1,"ion-col",41),t._uU(2),t.qZA(),t.TgZ(3,"ion-col",45),t._uU(4),t.qZA(),t.TgZ(5,"ion-col",41),t._uU(6),t.qZA(),t.TgZ(7,"ion-col",41),t._uU(8),t.qZA(),t.TgZ(9,"ion-col",41),t.YNc(10,cr,2,0,"span",3),t._uU(11),t.qZA(),t.TgZ(12,"ion-col",41),t._uU(13),t.qZA(),t.TgZ(14,"ion-col",41),t._uU(15),t.qZA(),t.TgZ(16,"ion-col",41),t._uU(17),t.ALo(18,"currency"),t.qZA(),t.TgZ(19,"ion-col",41),t._uU(20),t.ALo(21,"currency"),t.qZA()()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.Udp("cursor","pointer"),t.xp6(2),t.Oqu(e.code),t.xp6(2),t.hij(" ",e.name," "),t.xp6(2),t.hij(" ",e.unit," "),t.xp6(2),t.hij(" ",e.opening," "),t.xp6(2),t.Q6J("ngIf",e.received>0),t.xp6(1),t.hij("",e.received," "),t.xp6(2),t.hij(" ",e.issued," "),t.xp6(2),t.hij(" ",e.closing," "),t.xp6(2),t.Oqu(t.G7q(18,12,t.kEZ(24,O,e.totalSale,o.currency,o.translateService.currentLang))),t.xp6(3),t.Oqu(t.G7q(21,18,t.kEZ(28,O,e.totalCost,o.currency,o.translateService.currentLang)))}}function sr(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-row")(2,"ion-col",41)(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"ion-col",42)(7,"strong"),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"ion-col",41)(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col",41)(15,"strong"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t.TgZ(18,"ion-col",41)(19,"strong"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"ion-col",41)(23,"strong"),t._uU(24),t.ALo(25,"translate"),t.qZA()(),t.TgZ(26,"ion-col",41)(27,"strong"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t.TgZ(30,"ion-col",41)(31,"strong"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t.TgZ(34,"ion-col",41)(35,"strong"),t._uU(36),t.ALo(37,"translate"),t.qZA()()(),t.YNc(38,ar,22,32,"ion-row",43),t.BQk()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(t.lcZ(5,10,"product-note-export.product-code")),t.xp6(4),t.Oqu(t.lcZ(9,12,"product-note-export.product-name")),t.xp6(4),t.Oqu(t.lcZ(13,14,"product-note-export.product-unit")),t.xp6(4),t.Oqu(t.lcZ(17,16,"product-note-export.opening")),t.xp6(4),t.Oqu(t.lcZ(21,18,"product-note-export.received")),t.xp6(4),t.Oqu(t.lcZ(25,20,"product-note-export.issued")),t.xp6(4),t.Oqu(t.lcZ(29,22,"product-note-export.closing")),t.xp6(4),t.Oqu(t.lcZ(33,24,"product-note-export.total-sale")),t.xp6(4),t.Oqu(t.lcZ(37,26,"product-note-export.total-cost")),t.xp6(2),t.Q6J("ngForOf",e.report.items)}}function dr(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("/",e.unit,"")}}function lr(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function ur(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",44),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.selectProduct(r.id))}),t.TgZ(1,"ion-col",41),t._uU(2),t.qZA(),t.TgZ(3,"ion-col",41),t._uU(4),t.qZA(),t.TgZ(5,"ion-col",42),t._uU(6),t.qZA(),t.TgZ(7,"ion-col",41)(8,"ion-text"),t._uU(9),t.ALo(10,"currency"),t.qZA(),t.YNc(11,dr,2,1,"span",3),t.qZA(),t.TgZ(12,"ion-col",41),t.YNc(13,lr,2,0,"span",3),t._uU(14),t.qZA(),t.TgZ(15,"ion-col",41),t._uU(16),t.qZA(),t.TgZ(17,"ion-col",41),t._uU(18),t.qZA(),t.TgZ(19,"ion-col",41),t._uU(20),t.qZA(),t.TgZ(21,"ion-col",41)(22,"ion-text",39),t._uU(23),t.ALo(24,"currency"),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.Udp("cursor","pointer"),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(e.code),t.xp6(2),t.hij(" ",e.name," "),t.xp6(3),t.hij(" ",t.G7q(10,14,t.kEZ(26,O,e.unitPrice,o.currency,o.translateService.currentLang)),""),t.xp6(2),t.Q6J("ngIf",e.unit),t.xp6(2),t.Q6J("ngIf",e.quantity>0),t.xp6(1),t.hij("",e.quantity," "),t.xp6(2),t.hij(" ",e.discount," "),t.xp6(2),t.hij(" ",e.contact," "),t.xp6(2),t.hij(" ",o.dateFormat(e.createdAt)," "),t.xp6(2),t.s9C("color",e.amount>=0?"secondary":"danger"),t.xp6(1),t.Oqu(t.G7q(24,20,t.kEZ(30,O,e.amount,o.currency,o.translateService.currentLang)))}}function _r(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-row")(2,"ion-col",41)(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"ion-col",41)(7,"strong"),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"ion-col",42)(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col",41)(15,"strong"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t.TgZ(18,"ion-col",41)(19,"strong"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"ion-col",41)(23,"strong"),t._uU(24),t.ALo(25,"translate"),t.qZA()(),t.TgZ(26,"ion-col",41)(27,"strong"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t.TgZ(30,"ion-col",41)(31,"strong"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t.TgZ(34,"ion-col",41)(35,"strong"),t._uU(36),t.ALo(37,"translate"),t.qZA()()(),t.YNc(38,ur,25,34,"ion-row",43),t.BQk()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(t.lcZ(5,10,"product-note-export.description")),t.xp6(4),t.Oqu(t.lcZ(9,12,"product-note-export.product-code")),t.xp6(4),t.Oqu(t.lcZ(13,14,"product-note-export.product-name")),t.xp6(4),t.Oqu(t.lcZ(17,16,"product-note-export.product-unit")),t.xp6(4),t.Oqu(t.lcZ(21,18,"product-note-export.quantity")),t.xp6(4),t.Oqu(t.lcZ(25,20,"product-note-export.discount")),t.xp6(4),t.Oqu(t.lcZ(29,22,"product-note-export.contact")),t.xp6(4),t.Oqu(t.lcZ(33,24,"product-note-export.date")),t.xp6(4),t.Oqu(t.lcZ(37,26,"product-note-export.amount")),t.xp6(2),t.Q6J("ngForOf",e.report.items)}}function pr(i,c){if(1&i&&(t.TgZ(0,"ion-grid",40),t.YNc(1,sr,39,28,"ng-container",3),t.YNc(2,_r,39,28,"ng-container",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",0===e.reportType),t.xp6(1),t.Q6J("ngIf",1===e.reportType)}}let mr=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y){this.modalCtrl=e,this.translateService=o,this.userService=n,this.excelService=r,this.navCtrl=a,this.alertCtrl=d,this.analyticsService=u,this.platform=p,this.storeService=_,this.barcodeScanner=g,this.staffService=m,this.productService=y,this.params=null,this.dateFrom="",this.dateTo="",this.reportType=0}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-note-export")})()}ngOnInit(){this.platform.resize.subscribe(()=>{this.isMobile=this.platform.width()<720}),this.reload()}export(){var e=this;return(0,l.Z)(function*(){const o=0===e.reportType?"products-report-summary-"+e.dateFormatInFile(e.dateFrom)+"-to-"+e.dateFormatInFile(e.dateTo)+".xlsx":"products-report-detail-"+e.dateFormatInFile(e.dateFrom)+"-to-"+e.dateFormatInFile(e.dateTo)+".xlsx";e.excelService.downloadExcelInventoryReport(o,e.productSelected&&1===e.reportType?e.productSelected.id:0,e.reportType,e.dateFrom,e.dateTo,e.store?e.store.id:0).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-note-export-downloaded"),e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+r,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(o,o,r))});return function(r){return n.apply(this,arguments)}}())})()}selectDateRange(){var e=this;return(0,l.Z)(function*(){const o=yield e.modalCtrl.create({component:rt.S,componentProps:{dateFromInput:e.dateFrom,dateToInput:e.dateTo}});yield o.present();const{data:n}=yield o.onDidDismiss();n&&(e.dateFrom=""!=n.dateFrom?C.C.toDbString(n.dateFrom,C.C.getDbFormat()):"",e.dateTo=""!=n.dateTo?C.C.toDbString(n.dateTo,C.C.getDbFormat()):"")})()}reload(){var e=this;return(0,l.Z)(function*(){e.isMobile=e.platform.width()<720,e.userService.getAttr("current-currency").then(n=>{e.currency=n}),e.store=yield e.storeService.getCurrentStore(),e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null,e.selectedStaff=e.staffService.selectedStaff,e.dateTo="";const o=e.params?e.params:e.navCtrl.getParams();e.params=o,e.dateFrom=o.dateFrom?o.dateFrom:e.dateFrom?e.dateFrom:C.C.GetFirstDateOfMonth(),e.dateTo=o.dateTo?o.dateTo:e.dateTo?e.dateTo:C.C.GetEndDateOfMonth(),e.reportType=o.reportType?o.reportType:0})()}dateOnlyFormat(e){return C.C.toUiDateString(e)}dateFormat(e){return C.C.toUiDateString(e)}dateFormatInFile(e){return this.dateFormat(e).split("/").join("-")}generate(){var e=this;return(0,l.Z)(function*(){const o=yield e.navCtrl.loading();e.excelService.getProductReport(e.reportType,e.productSelected?e.productSelected.id:0,e.dateFrom,e.dateTo,e.store?e.store.id:0).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-note-export-generated"),e.report=r,yield o.dismiss()});return function(r){return n.apply(this,arguments)}}())})()}resetReport(){this.report=null}reportName(){return 0===this.reportType?this.translateService.instant("product-note-export.report-type-by-summary"):1===this.reportType?this.translateService.instant("product-note-export.report-type-by-detail"):""}productName(e,o){return Z.W.productName(e,o)}showSearchProduct(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product",{callback:n=>{n&&(e.productSelected=n)},searchMode:!0})})()}removeProduct(){this.productSelected=null}scan(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-note-export-scan-barcode"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.checkBarcodeScaned(n.barcode)}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.checkBarcodeScaned(o.text)})})()}checkBarcodeScaned(e){var o=this;this.productService.searchByBarcode(e).then(function(){var n=(0,l.Z)(function*(r){!r||(o.analyticsService.logEvent("product-note-export-searched-barcode"),o.productSelected=r)});return function(r){return n.apply(this,arguments)}}())}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),e.resetReport(),yield e.reload()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}selectProduct(e){this.navCtrl.navigateForward("/product/detail",{id:e,selectedStaff:this.selectedStaff})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.IN),t.Y36(b.sK),t.Y36(E.K),t.Y36($.x),t.Y36(M.G),t.Y36(s.Br),t.Y36(Q.y),t.Y36(s.t4),t.Y36(D.d),t.Y36(I.m),t.Y36(A.x),t.Y36(N.M))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-note-export"]],decls:17,vars:12,consts:[["slot","start"],["defaultHref","/home"],["lines","none","color","success",4,"ngIf"],[4,"ngIf"],[1,"ion-padding",2,"padding-top","0","padding-bottom","0"],["class","ion-text-wrap",4,"ngIf"],["class","ion-padding",4,"ngIf"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],["lines","none"],["ion-text","","color","primary"],["text-wrap",""],["fill","clear","slot","end",3,"click"],["slot","icon-only","name","funnel"],["color","primary"],[2,"width","100% !important","max-width","100% !important","padding-left","0px !important","background-color","#cccccc",3,"ngModel","ngModelChange"],[3,"value"],["lines","none",4,"ngIf"],["slot","start",4,"ngIf"],["color","dark",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end"],["fill","outline",3,"click"],["name","barcode"],["fill","clear",3,"click"],["name","close"],["color","dark",3,"click"],[3,"click"],["color","primary","expand","block",3,"click"],["name","funnel"],["color","secondary","expand","block",3,"click"],["icon","file-excel","size","lg"],["name","create"],["size-sm","4","size-xs","4"],["color","danger"],["color","secondary"],[3,"click",4,"ngFor","ngForOf"],[3,"color"],[1,"ion-padding"],["size","1"],["size","4"],["style","border-bottom: 1px solid #ccc;",3,"cursor","click",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #ccc",3,"click"],["size","4",1,"ion-text-wrap"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,Ji,8,4,"ion-item",2),t.qZA(),t.TgZ(8,"ion-content"),t.YNc(9,Fi,23,18,"ion-list",3),t.TgZ(10,"div",4),t.YNc(11,Gi,12,6,"ion-grid",3),t.YNc(12,Ki,12,6,"ion-grid",3),t.qZA(),t.TgZ(13,"ion-list"),t.YNc(14,Bi,29,14,"ion-item",5),t.YNc(15,rr,7,5,"ng-container",3),t.YNc(16,pr,3,2,"ion-grid",6),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,10,"product-note-export.title")),t.xp6(2),t.Q6J("ngIf",o.checkStore&&(null==o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.Q6J("ngIf",!o.report),t.xp6(2),t.Q6J("ngIf",!o.report),t.xp6(1),t.Q6J("ngIf",o.report),t.xp6(2),t.Q6J("ngIf",o.report),t.xp6(1),t.Q6J("ngIf",o.isMobile&&o.report),t.xp6(1),t.Q6J("ngIf",!o.isMobile&&o.report&&o.report.items&&o.report.items.length))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.oU,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.yh,s.Nd,s.t9,s.n0,s.yW,s.wd,s.sr,s.QI,s.cs,Ct.BN,T.H9,b.X$],encapsulation:2}),i})();var gr=x(360);const fr=["barcodeInput"],xr=["barcodeInputCombo"],hr=["barcodeInputMaterial"],Zr=["fileUploadInput"];function Tr(i,c){1&i&&(t.TgZ(0,"ion-title"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"product-add.title-add")))}function Ar(i,c){1&i&&(t.TgZ(0,"ion-title"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"material.title-add")))}function Cr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",16)(1,"ion-label",17),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",19),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function yr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.scan())}),t._UZ(1,"ion-icon",45),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product.scan-barcode")," "))}function br(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.autoGenBarcode())}),t._UZ(1,"ion-icon",45),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product.auto-gen-barcode")," "))}function vr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",47),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addOtherBarcode())}),t._UZ(1,"ion-icon",48),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"product.add-other-barcode")," "))}function Pr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons")(1,"ion-button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.scan())}),t._UZ(2,"ion-icon",50),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-button",51),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.autoGenBarcode())}),t._UZ(6,"ion-icon",50),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"ion-button",52),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addOtherBarcode())}),t._UZ(10,"ion-icon",53),t._uU(11),t.ALo(12,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,3,"product.scan-barcode")," "),t.xp6(4),t.hij(" ",t.lcZ(8,5,"product.auto-gen-barcode")," "),t.xp6(4),t.hij(" ",t.lcZ(12,7,"product.add-other-barcode")," "))}function Sr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",31)(1,"ion-label",21),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"money-input",54),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.product.costPrice=n)}),t.ALo(5,"translate"),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij("",t.lcZ(3,3,"product-add.cost-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(5,5,"product-add.cost-price")),t.Q6J("moneyValue",e.product.costPrice)}}function wr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",31)(1,"ion-label",21),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"money-input",54),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.product.price=n)}),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-buttons")(7,"ion-button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addZerosToNumber(2))}),t._uU(8,".00"),t.qZA(),t.TgZ(9,"ion-button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addZerosToNumber(3))}),t._uU(10,".000"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij("",t.lcZ(3,3,"product-add.price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(5,5,"product-add.enter-price")),t.Q6J("moneyValue",e.product.price)}}function kr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col",56)(2,"ion-label",21),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-input",57),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.unit=n)})("focus",function(n){t.CHM(e);const r=t.oxw(3);return t.KtG(r.selectAll(n))}),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"ion-buttons")(8,"ion-checkbox",58),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.isDefault=n)})("ngModelChange",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.changeUnitDefault(r))}),t.qZA(),t.TgZ(9,"span",43),t._uU(10),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"ion-col",56)(13,"ion-label",21),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"money-input",54),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.price=n)}),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"ion-buttons")(19,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.addZerosToNumberToUnit(2,r))}),t._uU(20," .00 "),t.qZA(),t.TgZ(21,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.addZerosToNumberToUnit(3,r))}),t._uU(22," .000 "),t.qZA()()(),t.TgZ(23,"ion-col",56)(24,"ion-label",59),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"money-input",60),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.costPrice=n)}),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"ion-buttons")(30,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.addZerosToNumberToUnitCostPrice(2,r))}),t._uU(31," .00 "),t.qZA(),t.TgZ(32,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.addZerosToNumberToUnitCostPrice(3,r))}),t._uU(33," .000 "),t.qZA()()(),t.TgZ(34,"ion-col",56)(35,"ion-label",21),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"ion-input",36),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.exchange=n)})("focus",function(n){t.CHM(e);const r=t.oxw(3);return t.KtG(r.selectAll(n))})("ngModelChange",function(){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.changeUnit(r))}),t.ALo(39,"translate"),t.qZA(),t.TgZ(40,"ion-buttons",61)(41,"ion-button",62),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw(3);return t.KtG(d.removeUnit(r,a))}),t._UZ(42,"ion-icon",63),t.qZA()()()()}if(2&i){const e=c.$implicit;t.xp6(3),t.hij("",t.lcZ(4,14,"product-add.unit")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(6,16,"product-add.enter-unit")),t.Q6J("ngModel",e.unit),t.xp6(3),t.Q6J("ngModel",e.isDefault),t.xp6(2),t.hij("\xa0",t.lcZ(11,18,"product-add.default-unit"),""),t.xp6(4),t.hij("",t.lcZ(15,20,"product-add.price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(17,22,"product-add.enter-price")),t.Q6J("moneyValue",e.price),t.xp6(9),t.hij("",t.lcZ(26,24,"product-add.cost-price")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(28,26,"product-add.enter-price")),t.Q6J("moneyValue",e.costPrice),t.xp6(9),t.hij("",t.lcZ(37,28,"product-add.unit-exchange")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(39,30,"product-add.enter-unit-exchange")),t.Q6J("ngModel",e.exchange)}}function qr(i,c){if(1&i&&(t.ynx(0),t.YNc(1,kr,43,32,"ion-row",55),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.product.units)}}function Nr(i,c){if(1&i&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(4);t.xp6(1),t.hij(" ",o.getAttributesString(e)," ")}}function Ur(i,c){if(1&i&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&i){const e=c.$implicit,o=t.oxw(6);t.xp6(1),t.lnq(" ",o.productName(e.code,e.title)," | ",e.count," ",e.unit," ")}}function Ir(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-item",85)(2,"ion-text",86),t.YNc(3,Nr,3,1,"ng-container",3),t.YNc(4,Ur,3,3,"ng-container",55),t.qZA()(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Udp("font-weight","normal"),t.xp6(1),t.Q6J("ngIf",e.attributes&&e.attributes.length),t.xp6(1),t.Q6J("ngForOf",e.options)}}const dt=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function Jr(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(4);t.xp6(1),t.AsE("(",t.G7q(2,2,t.kEZ(8,dt,e.price,o.currency.code,o.translateService.currentLang)),"/",e.unit,")")}}function Mr(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",72)(2,"ion-buttons")(3,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.expandCombo(r))}),t._UZ(4,"ion-icon",74),t.qZA()(),t.TgZ(5,"ion-text",75),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.expandCombo(r))}),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",76)(8,"ion-button",77),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.decreaseItem(r))}),t._UZ(9,"ion-icon",78),t.qZA(),t.TgZ(10,"ion-button",77),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.increaseItem(r))}),t._UZ(11,"ion-icon",79),t.qZA(),t.TgZ(12,"ion-button",80),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.showOptions(r))}),t._UZ(13,"ion-icon",81),t.qZA()(),t.TgZ(14,"ion-buttons",76)(15,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.removeProduct(r))}),t._UZ(16,"ion-icon",82),t.qZA()()(),t.YNc(17,Ir,5,4,"ng-container",3),t.TgZ(18,"ion-grid",83)(19,"ion-row")(20,"ion-col")(21,"ion-label",21),t._uU(22),t.ALo(23,"translate"),t.YNc(24,Jr,3,12,"span",3),t.qZA(),t.TgZ(25,"ion-input",84),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.count=n)})("focus",function(n){t.CHM(e);const r=t.oxw(4);return t.KtG(r.selectAll(n))}),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"ion-buttons")(28,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.decreaseItem(r))}),t._UZ(29,"ion-icon",78),t.qZA(),t.TgZ(30,"ion-button",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.increaseItem(r))}),t._UZ(31,"ion-icon",79),t.qZA()()(),t.TgZ(32,"ion-col")(33,"ion-label",21),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.TgZ(36,"money-input",54),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.discount=n)}),t.ALo(37,"translate"),t.qZA()(),t.TgZ(38,"ion-col")(39,"ion-label",21),t._uU(40),t.ALo(41,"translate"),t.qZA(),t.TgZ(42,"money-input",54),t.NdJ("moneyValueChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.total=n)}),t.ALo(43,"translate"),t.qZA()()()(),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("lines",o.hasOptionsOrAttributes(e)?"none":"inset"),t.xp6(3),t.s9C("name",e.isExpand?"chevron-up-circle":"create"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.HOy(" ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(11),t.Q6J("ngIf",o.hasOptionsOrAttributes(e)),t.xp6(1),t.Q6J("hidden",!e.isExpand),t.xp6(4),t.hij(" ",t.lcZ(23,21,"product-add.product-count")," "),t.xp6(2),t.Q6J("ngIf",e.unit),t.xp6(1),t.s9C("placeholder",t.lcZ(26,23,"product-add.enter-product-count")),t.Q6J("ngModel",e.count),t.xp6(9),t.hij(" ",t.lcZ(35,25,"product-add.product-discount"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(37,27,"product-add.enter-product-discount")),t.Q6J("moneyValue",e.discount),t.xp6(4),t.AsE(" ",t.lcZ(41,29,"product-add.product-total")," (",o.currency.code,") "),t.xp6(2),t.s9C("placeholder",t.lcZ(43,31,"product-add.enter-product-total")),t.Q6J("moneyValue",e.total)}}function Qr(i,c){if(1&i&&(t.ynx(0),t.YNc(1,Mr,44,33,"ng-container",55),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.product.items)}}function Lr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-list")(3,"ion-item-divider",64),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-item",64)(7,"ion-text",65),t._uU(8),t.ALo(9,"translate"),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"ion-buttons")(12,"ion-button",66),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showProductSelector())}),t._UZ(13,"ion-icon",67),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"ion-button",66),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.scanItem())}),t._UZ(17,"ion-icon",50),t._uU(18),t.ALo(19,"translate"),t.qZA()()(),t.TgZ(20,"ion-item",64)(21,"ion-input",68,69),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.barcode=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.barcodeComboChanged())}),t.ALo(23,"translate"),t.qZA()(),t.YNc(24,Qr,2,1,"ng-container",3),t.qZA(),t.TgZ(25,"ion-item",70),t._UZ(26,"div",71),t.ALo(27,"translate"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,10,"product-add.select-products")," "),t.xp6(4),t.AsE("",t.lcZ(9,12,"product-add.enter-barcode")," ",t.lcZ(10,14,"product-add.or"),"..."),t.xp6(6),t.hij(" \xa0",t.lcZ(15,16,"product-add.add-manual")," "),t.xp6(4),t.hij(" \xa0",t.lcZ(19,18,"product-add.mobile-scan")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(23,20,"product-add.enter-barcode-placeholder")),t.Q6J("ngModel",e.barcode),t.xp6(3),t.Q6J("ngIf",e.product.items&&e.product.items.length),t.xp6(1),t.Q6J("hidden",e.product.items&&e.product.items.length>0),t.xp6(1),t.Q6J("innerHTML",t.lcZ(27,22,"product-add.no-product"),t.oJD)}}function Er(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("(",e.unit,")")}}function Or(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",88)(2,"ion-buttons")(3,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.expandMaterial(r))}),t._UZ(4,"ion-icon",74),t.qZA()(),t.TgZ(5,"ion-text",75),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.expandMaterial(r))}),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",76)(8,"ion-button",77),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.decreaseItem(r))}),t._UZ(9,"ion-icon",78),t.qZA(),t.TgZ(10,"ion-button",77),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.increaseItem(r))}),t._UZ(11,"ion-icon",79),t.qZA()(),t.TgZ(12,"ion-buttons",76)(13,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(4);return t.KtG(a.removeMaterial(r))}),t._UZ(14,"ion-icon",82),t.qZA()()(),t.TgZ(15,"ion-grid",83)(16,"ion-row")(17,"ion-col")(18,"ion-label",21),t._uU(19),t.ALo(20,"translate"),t.YNc(21,Er,2,1,"span",3),t.qZA(),t.TgZ(22,"ion-input",84),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.count=n)})("focus",function(n){t.CHM(e);const r=t.oxw(4);return t.KtG(r.selectAll(n))}),t.ALo(23,"translate"),t.qZA()()()(),t.BQk()}if(2&i){const e=c.$implicit;t.xp6(4),t.s9C("name",e.isExpand?"chevron-up-circle":"create"),t.xp6(1),t.Udp("font-weight",e.isExpand?"bold":"normal"),t.xp6(1),t.HOy(" ",e.productCode?e.productCode.toUpperCase()+"-":"","",e.productName," | ",e.count," ",e.unit," "),t.xp6(9),t.Q6J("hidden",!e.isExpand),t.xp6(4),t.hij(" ",t.lcZ(20,12,"order-add.product-count")," "),t.xp6(2),t.Q6J("ngIf",e.unit),t.xp6(1),t.s9C("placeholder",t.lcZ(23,14,"order-add.enter-product-count")),t.Q6J("ngModel",e.count)}}function Yr(i,c){if(1&i&&(t.ynx(0),t.YNc(1,Or,24,16,"ng-container",55),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.product.materials)}}function Fr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-list")(3,"ion-item-divider",64),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-item",64)(7,"ion-text",65),t._uU(8),t.ALo(9,"translate"),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"ion-buttons")(12,"ion-button",66),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showMaterialSelector())}),t._UZ(13,"ion-icon",67),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"ion-button",66),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.scanMaterialItem())}),t._UZ(17,"ion-icon",50),t._uU(18),t.ALo(19,"translate"),t.qZA()()(),t.TgZ(20,"ion-item",64)(21,"ion-input",68,87),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.barcodeMaterial=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.barcodeMaterialChanged())}),t.ALo(23,"translate"),t.qZA()(),t.YNc(24,Yr,2,1,"ng-container",3),t.qZA(),t.TgZ(25,"ion-item",70),t._UZ(26,"div",71),t.ALo(27,"translate"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,10,"product-add.select-materials")," "),t.xp6(4),t.AsE("",t.lcZ(9,12,"product-add.enter-barcode")," ",t.lcZ(10,14,"product-add.or"),"..."),t.xp6(6),t.hij(" \xa0",t.lcZ(15,16,"product-add.add-manual")," "),t.xp6(4),t.hij(" \xa0",t.lcZ(19,18,"product-add.mobile-scan")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(23,20,"product-add.enter-barcode-placeholder")),t.Q6J("ngModel",e.barcodeMaterial),t.xp6(3),t.Q6J("ngIf",e.product.materials&&e.product.materials.length),t.xp6(1),t.Q6J("hidden",e.product.materials&&e.product.materials.length>0),t.xp6(1),t.Q6J("innerHTML",t.lcZ(27,22,"product-add.no-product"),t.oJD)}}function Gr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",20)(3,"ion-label",21),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-input",22,23),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.barcode=n)})("focus",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.selectAll(n))}),t.ALo(8,"translate"),t.qZA(),t.YNc(9,yr,4,3,"ion-button",24),t.YNc(10,br,4,3,"ion-button",25),t.YNc(11,vr,4,3,"ion-button",26),t.YNc(12,Pr,13,9,"ion-buttons",3),t.qZA(),t.TgZ(13,"ion-col",20)(14,"ion-label",21),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ion-input",27),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.code=n)}),t.ALo(18,"translate"),t.qZA()(),t.TgZ(19,"ion-col",20)(20,"ion-label",21),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"ion-input",28),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.title=n)}),t.ALo(24,"translate"),t.qZA()(),t.TgZ(25,"ion-col",29)(26,"ion-grid",30)(27,"ion-row")(28,"ion-col",31)(29,"ion-label",21),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"ion-input",32),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.unit=n)})("focus",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.selectAll(n))}),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"p",33)(35,"ion-text",34),t._uU(36),t.ALo(37,"translate"),t.qZA()()(),t.YNc(38,Sr,6,7,"ion-col",35),t.YNc(39,wr,11,7,"ion-col",35),t.TgZ(40,"ion-col",31)(41,"ion-label",21),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"ion-input",36),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.count=n)})("focus",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.selectAll(n))}),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"ion-buttons")(47,"ion-button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.decrease())}),t._UZ(48,"ion-icon",38),t.qZA(),t.TgZ(49,"ion-button",37),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.increase())}),t._UZ(50,"ion-icon",39),t.qZA()()()(),t.TgZ(51,"ion-row")(52,"ion-col")(53,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addUnit())}),t._uU(54),t.ALo(55,"translate"),t.qZA()()(),t.YNc(56,qr,2,1,"ng-container",3),t.qZA()()(),t.TgZ(57,"ion-row",41)(58,"ion-col")(59,"ion-label",14),t._uU(60),t.ALo(61,"translate"),t.qZA(),t._UZ(62,"br"),t.TgZ(63,"ion-toggle",42),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isOption=n)})("ionChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeIsOption(n.product))}),t.qZA(),t._UZ(64,"br"),t.TgZ(65,"ion-text",43),t._uU(66),t.ALo(67,"translate"),t.qZA()(),t.TgZ(68,"ion-col")(69,"ion-label",14),t._uU(70),t.ALo(71,"translate"),t.qZA(),t._UZ(72,"br"),t.TgZ(73,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isCombo=n)}),t.qZA(),t._UZ(74,"br"),t.TgZ(75,"ion-text",43),t._uU(76),t.ALo(77,"translate"),t.qZA()()(),t.YNc(78,Lr,28,24,"ion-row",3),t.TgZ(79,"ion-row",41)(80,"ion-col")(81,"ion-label",14),t._uU(82),t.ALo(83,"translate"),t.qZA(),t._UZ(84,"br"),t.TgZ(85,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.autoMaterials=n)}),t.qZA(),t._UZ(86,"br"),t.TgZ(87,"ion-text",43),t._uU(88),t.ALo(89,"translate"),t.qZA()()(),t.YNc(90,Fr,28,24,"ion-row",3),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,35,"product-add.enter-barcode")),t.xp6(2),t.s9C("placeholder",t.lcZ(8,37,"product-add.enter-barcode-placeholder")),t.Q6J("ngModel",e.product.barcode),t.xp6(3),t.Q6J("ngIf",e.isMobile),t.xp6(1),t.Q6J("ngIf",e.isMobile),t.xp6(1),t.Q6J("ngIf",e.isMobile),t.xp6(1),t.Q6J("ngIf",!e.isMobile),t.xp6(3),t.Oqu(t.lcZ(16,39,"product-add.code")),t.xp6(2),t.s9C("placeholder",t.lcZ(18,41,"product-add.enter-code")),t.Q6J("ngModel",e.product.code),t.xp6(4),t.Oqu(t.lcZ(22,43,"product-add.product-title")),t.xp6(2),t.s9C("placeholder",t.lcZ(24,45,"product-add.enter-title")),t.Q6J("ngModel",e.product.title),t.xp6(7),t.hij("",t.lcZ(31,47,"product-add.basic-unit")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(33,49,"product-add.enter-unit")),t.Q6J("ngModel",e.product.unit),t.xp6(4),t.Oqu(t.lcZ(37,51,"product-add.basic-unit-description")),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice&&e.canUpdateProductCostPrice&&e.isMaterial),t.xp6(1),t.Q6J("ngIf",!e.isMaterial),t.xp6(3),t.hij("",t.lcZ(43,53,"product-add.count")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(45,55,"product-add.enter-count")),t.Q6J("ngModel",e.product.count),t.xp6(10),t.hij("+ ",t.lcZ(55,57,"product-add.add-unit")," "),t.xp6(2),t.Q6J("ngIf",e.product&&e.product.units&&e.product.units.length),t.xp6(4),t.Oqu(t.lcZ(61,59,"product-add.is-added-option")),t.xp6(3),t.Q6J("ngModel",e.product.isOption),t.xp6(3),t.Oqu(t.lcZ(67,61,"product-add.added-option-explain")),t.xp6(4),t.Oqu(t.lcZ(71,63,"product-add.is-combo")),t.xp6(3),t.Q6J("ngModel",e.product.isCombo),t.xp6(3),t.Oqu(t.lcZ(77,65,"product-add.combo-description")),t.xp6(2),t.Q6J("ngIf",e.product.isCombo),t.xp6(4),t.Oqu(t.lcZ(83,67,"product-add.auto-materials")),t.xp6(3),t.Q6J("ngModel",e.product.autoMaterials),t.xp6(3),t.Oqu(t.lcZ(89,69,"product-add.auto-materials-explain")),t.xp6(2),t.Q6J("ngIf",e.product.autoMaterials)}}function Kr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"date-picker",105),t.NdJ("dateChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.product.expiredAt=n)}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("date",e.product.expiredAt)}}function Hr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-text",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showDatePopup())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"common.select-date")," "))}function Dr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.removeDate())}),t._UZ(1,"ion-icon",82),t.qZA()}}function Br(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col")(1,"ion-label",21),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"money-input",106),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.product.costPrice=n)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"product-add.cost-price")),t.xp6(2),t.Q6J("moneyValue",e.product.costPrice)}}function jr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",107)(1,"ion-item",108)(2,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.removeCategory(r))}),t._UZ(3,"ion-icon",2),t.qZA(),t.TgZ(4,"ion-text",109),t._uU(5),t.qZA()()()}if(2&i){const e=c.$implicit;t.xp6(5),t.hij(" ",e.tradeCategory.title," ")}}function $r(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",110),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.upload())}),t._UZ(1,"ion-icon",111),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij("\xa0",t.lcZ(3,1,"note-add.select-photo")," "))}function Vr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col",113)(1,"img",114),t.NdJ("click",function(){const r=t.CHM(e).index,a=t.oxw().index,d=t.oxw(3);return t.KtG(d.showImage(3*a+r))}),t.qZA()()}if(2&i){const e=c.$implicit;t.xp6(1),t.Q6J("src",e,t.LSH)}}function zr(i,c){if(1&i&&(t.TgZ(0,"ion-row"),t.YNc(1,Vr,2,1,"ion-col",112),t.qZA()),2&i){const e=c.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function Wr(i,c){if(1&i&&(t.TgZ(0,"ion-grid"),t.YNc(1,zr,2,1,"ion-row",55),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.arr)}}function Rr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-col")(1,"ion-label",115),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"money-input",54),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.product.originalPrice=n)}),t.ALo(5,"translate"),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"product-add.original-price")),t.xp6(2),t.s9C("placeholder",t.lcZ(5,5,"product-add.enter-original-price")),t.Q6J("moneyValue",e.product.originalPrice)}}function Xr(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row",41)(2,"ion-col")(3,"ion-label",14),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isService=n)}),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"ion-text",43),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"ion-col")(13,"ion-label",14),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"br"),t.YNc(17,Kr,1,1,"date-picker",89),t.YNc(18,Hr,3,3,"ion-text",90),t.YNc(19,Dr,2,0,"ion-button",91),t.qZA()(),t.TgZ(20,"ion-row"),t.YNc(21,Br,5,4,"ion-col",3),t.TgZ(22,"ion-col")(23,"ion-label",21),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"ion-input",32),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.foreignCurrency=n)})("focus",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.selectAll(n))}),t.ALo(27,"translate"),t.qZA()(),t.TgZ(28,"ion-col")(29,"ion-label",21),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"money-input",54),t.NdJ("moneyValueChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.costPriceForeign=n)}),t.ALo(33,"translate"),t.qZA()()(),t.TgZ(34,"ion-row")(35,"ion-col",92)(36,"ion-item",93)(37,"ion-label",14),t._uU(38),t.ALo(39,"translate"),t.qZA(),t.TgZ(40,"ion-buttons")(41,"ion-button",73),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showSearchCategory())}),t._UZ(42,"ion-icon",67),t._uU(43),t.ALo(44,"translate"),t.qZA()()()()(),t.TgZ(45,"ion-row")(46,"ion-col",93)(47,"ion-grid",93)(48,"ion-row",93),t.YNc(49,jr,6,1,"ion-col",94),t.qZA()()()(),t.TgZ(50,"ion-row")(51,"ion-col",95)(52,"ion-list")(53,"ion-item",96)(54,"ion-label",14),t._uU(55),t.ALo(56,"translate"),t.qZA(),t.YNc(57,$r,4,3,"ion-button",97),t.TgZ(58,"label",98),t._uU(59),t.ALo(60,"translate"),t.qZA(),t.TgZ(61,"input",99,100),t.NdJ("change",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.rememberFile(n))}),t.qZA()()(),t.YNc(63,Wr,2,1,"ion-grid",3),t.qZA()(),t.TgZ(64,"ion-row",101)(65,"ion-col",102)(66,"ion-label",103),t._uU(67),t.ALo(68,"translate"),t.qZA()(),t.TgZ(69,"ion-col")(70,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.showOnWeb=n)}),t.qZA(),t._UZ(71,"br"),t.TgZ(72,"ion-label",64),t._uU(73),t.ALo(74,"translate"),t.qZA()(),t.TgZ(75,"ion-col")(76,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isHotProduct=n)}),t.qZA(),t._UZ(77,"br"),t.TgZ(78,"ion-label",64),t._uU(79),t.ALo(80,"translate"),t.qZA()(),t.TgZ(81,"ion-col")(82,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isNewProduct=n)}),t.qZA(),t._UZ(83,"br"),t.TgZ(84,"ion-label",64),t._uU(85),t.ALo(86,"translate"),t.qZA()(),t.TgZ(87,"ion-col")(88,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.showPriceOnWeb=n)}),t.qZA(),t._UZ(89,"br"),t.TgZ(90,"ion-label",64),t._uU(91),t.ALo(92,"translate"),t.qZA()()(),t.TgZ(93,"ion-row",101)(94,"ion-col")(95,"ion-toggle",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.isSale=n)}),t.qZA(),t._UZ(96,"br"),t.TgZ(97,"ion-label",64),t._uU(98),t.ALo(99,"translate"),t.qZA()(),t.YNc(100,Rr,6,7,"ion-col",3),t.qZA(),t.TgZ(101,"ion-row",101)(102,"ion-col")(103,"ion-label",64),t._uU(104),t.ALo(105,"translate"),t.qZA(),t._UZ(106,"br"),t.TgZ(107,"ion-textarea",104),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.product.description=n)}),t.ALo(108,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,36,"product-add.is-service")),t.xp6(3),t.Q6J("ngModel",e.product.isService),t.xp6(3),t.Oqu(t.lcZ(11,38,"product-add.service-description")),t.xp6(4),t.hij("",t.lcZ(15,40,"product-add.expired-date")," "),t.xp6(3),t.Q6J("ngIf",e.product.expiredAt),t.xp6(1),t.Q6J("ngIf",!e.product.expiredAt),t.xp6(1),t.Q6J("ngIf",e.product.expiredAt),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice&&e.canUpdateProductCostPrice&&!e.isMaterial),t.xp6(3),t.Oqu(t.lcZ(25,42,"product-add.unit-foreign")),t.xp6(2),t.s9C("placeholder",t.lcZ(27,44,"product-add.unit-foreign")),t.Q6J("ngModel",e.product.foreignCurrency),t.xp6(4),t.hij("",t.lcZ(31,46,"product-add.cost-price-foreign")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(33,48,"product-add.cost-price-foreign")),t.Q6J("moneyValue",e.product.costPriceForeign),t.xp6(6),t.Oqu(t.lcZ(39,50,"trade-add.categories")),t.xp6(5),t.hij(" ",t.lcZ(44,52,"trade-add.add")," "),t.xp6(6),t.Q6J("ngForOf",e.categories),t.xp6(6),t.Oqu(t.lcZ(56,54,"product-detail.photo")),t.xp6(2),t.Q6J("ngIf",!e.isNotCordova()),t.xp6(2),t.hij("\xa0[",t.lcZ(60,56,"note-add.select-photos"),"]"),t.xp6(4),t.Q6J("ngIf",e.isExtend&&"inprogress"===e.tab),t.xp6(4),t.hij(" ",t.lcZ(68,58,"config.web"),""),t.xp6(3),t.Q6J("ngModel",e.product.showOnWeb),t.xp6(3),t.Oqu(t.lcZ(74,60,"product-add.show-on-web")),t.xp6(3),t.Q6J("ngModel",e.product.isHotProduct),t.xp6(3),t.Oqu(t.lcZ(80,62,"product-add.is-hot-product")),t.xp6(3),t.Q6J("ngModel",e.product.isNewProduct),t.xp6(3),t.Oqu(t.lcZ(86,64,"product-add.is-new-product")),t.xp6(3),t.Q6J("ngModel",e.product.showPriceOnWeb),t.xp6(3),t.Oqu(t.lcZ(92,66,"product-add.show-price-on-web")),t.xp6(4),t.Q6J("ngModel",e.product.isSale),t.xp6(3),t.Oqu(t.lcZ(99,68,"product-add.is-sale")),t.xp6(2),t.Q6J("ngIf",e.product.isSale),t.xp6(4),t.Oqu(t.lcZ(105,70,"product-add.description")),t.xp6(3),t.s9C("placeholder",t.lcZ(108,72,"product-add.enter-description")),t.Q6J("ngModel",e.product.description)}}function tc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"ion-button",116),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.isExtend=!n.isExtend)}),t._UZ(4,"ion-icon",117),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-button",118),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.viewTypes())}),t._UZ(9,"ion-icon",119),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"ion-col")(13,"ion-button",118),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.viewAttributes())}),t._UZ(14,"ion-icon",119),t._uU(15),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"ion-col")(18,"ion-button",118),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save(!1,!0))}),t._UZ(19,"ion-icon",5),t._uU(20),t.ALo(21,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(5),t.hij("\xa0 ",t.lcZ(6,7,"product-add.extend")," "),t.xp6(3),t.Q6J("disabled",e.saveDisabled),t.xp6(2),t.hij("\xa0 ",t.lcZ(11,9,"product-add.types")," "),t.xp6(3),t.Q6J("disabled",e.saveDisabled),t.xp6(2),t.hij("\xa0 ",t.lcZ(16,11,"product-add.attributes")," "),t.xp6(3),t.Q6J("disabled",e.saveDisabled),t.xp6(2),t.hij("\xa0 ",t.lcZ(21,13,"product-add.save-continue")," ")}}function ec(i,c){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-label",17)(2,"span",120),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"span",121),t._UZ(6,"ion-icon",122),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(3),t.hij(" ",o.limitText(o.productName(e.code,e.title))," "),t.xp6(4),t.AsE("\xa0",t.lcZ(8,6,"product-detail.product-unit-price"),": ",t.G7q(9,8,t.kEZ(16,dt,e.price,o.currency.code,o.translateService.currentLang))," "),t.xp6(4),t.lnq(" - ",t.lcZ(12,14,"product-detail.product-quantity"),": ",e.count," ",e.unit,"")}}function oc(i,c){if(1&i&&(t.ynx(0),t.YNc(1,ec,13,20,"ion-item",55),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.productsAdded)}}function nc(i,c){if(1&i&&(t.TgZ(0,"ion-row",124)(1,"ion-col"),t._uU(2),t.qZA(),t.TgZ(3,"ion-col"),t._uU(4),t.ALo(5,"currency"),t.qZA(),t.TgZ(6,"ion-col"),t._uU(7),t.qZA(),t.TgZ(8,"ion-col"),t._uU(9),t.qZA()()),2&i){const e=c.$implicit,o=t.oxw(3);t.Udp("cursor","pointer"),t.xp6(2),t.Oqu(o.limitText(o.productName(e.code,e.title))),t.xp6(2),t.hij("",t.G7q(5,6,t.kEZ(12,dt,e.price,o.currency.code,o.translateService.currentLang))," "),t.xp6(3),t.Oqu(e.count),t.xp6(2),t.Oqu(e.unit)}}function ic(i,c){if(1&i&&(t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"ion-col")(7,"strong"),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"ion-col")(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col")(15,"strong"),t._uU(16),t.ALo(17,"translate"),t.qZA()()(),t.YNc(18,nc,10,16,"ion-row",123),t.qZA()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(t.lcZ(5,5,"product-add.product-title")),t.xp6(4),t.Oqu(t.lcZ(9,7,"product-add.price")),t.xp6(4),t.Oqu(t.lcZ(13,9,"product-add.count")),t.xp6(4),t.Oqu(t.lcZ(17,11,"product-add.basic-unit")),t.xp6(2),t.Q6J("ngForOf",e.productsAdded)}}function rc(i,c){if(1&i&&(t.TgZ(0,"ion-list"),t.YNc(1,oc,2,1,"ng-container",3),t.YNc(2,ic,19,13,"ion-grid",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isMobile),t.xp6(1),t.Q6J("ngIf",!e.isMobile&&e.productsAdded&&e.productsAdded.length)}}let cc=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U,v,f,w){this.navCtrl=e,this.camera=o,this.transfer=n,this.userService=r,this.dataService=a,this.staffService=d,this.modalCtrl=u,this.productService=p,this.barcodeScanner=_,this.platform=g,this.translateService=m,this.actionSheetController=y,this.file=k,this.analyticsService=J,this.toastCtrl=U,this.alertCtrl=v,this.storeService=f,this.tradeService=w,this.params=null,this.product=new K.x,this.pictures=[],this.storageDirectory="",this.arr=[],this.lastSamplePictureId=0,this.isNew=!0,this.saveDisabled=!1,this.uploadDisabled=!1,this.isExtend=!1,this.productsAdded=[],this.fromSearch=!1,this.isMobile=!1,this.tab="inprogress",this.categories=[],this.categoriesToRemove=[],this.addCount=0,this.isMaterial=!1,this.onKeyPress=S=>{!S.target||"body"!==S.target.localName||("s"===S.key||"S"===S.key)&&this.save(!0,!1)},this.platform.ready().then(()=>{if(!this.platform.is("capacitor")&&!this.platform.is("cordova"))return!1;if(this.platform.is("ios"))this.storageDirectory=this.file.documentsDirectory;else{if(!this.platform.is("android"))return!1;this.storageDirectory=this.file.dataDirectory}})}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-quick-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(e.isMobile=e.platform.width()<720,e.platform.resize.subscribe(()=>{e.isMobile=e.platform.width()<720}),!e.staffService.canAddUpdateProduct())return void e.navCtrl.pop();e.userService.getAttr("current-currency").then(r=>{e.currency=Z.W.getCurrencyByCode(r)}),e.selectedStaff=e.staffService.selectedStaff,e.store=yield e.storeService.getCurrentStore(),e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null,e.params=e.navCtrl.getParams(e.params),e.fromSearch=e.params&&e.params.fromSearch,e.product=new K.x,e.product.count=1,e.product.price=null;let o=0,n="";if(e.canViewProductCostPrice=!e.staffService.isStaff()||e.staffService.selectedStaff.hasFullAccess||e.staffService.selectedStaff.canViewProductCostPrice,e.canUpdateProductCostPrice=!e.staffService.isStaff()||e.staffService.selectedStaff.hasFullAccess||e.staffService.selectedStaff.canUpdateProductCostPrice,e.params&&e.params.id?(o=e.params.id,e.isNew=!1):e.params&&e.params.barcode?(n=e.params.barcode,e.isNew=!0):e.params&&e.params.copy&&(e.product=e.params.copy,e.product.id=0,e.isNew=!0),e.isMaterial=e.params&&e.params.isMaterial,o&&o>0)e.productService.get(o,0).then(r=>{e.product=r;const a=r.imageUrlsJson?JSON.parse(r.imageUrlsJson):[];e.pictures=a,e.product.units=JSON.parse(e.product.unitsJson),e.buildPictureGrid()});else{if(n){const d=new K.x;d.barcode=n,e.product=d}const r=[];let a=[];for(const d of e.pictures)a.push(d),3===a.length&&(r.push(a),a=[]);a.length>0&&r.push(a),e.arr=r}e.barcodeFocus()})()}validate(){if(!this.product.title)return alert(this.translateService.instant("product-add.no-title-alert")),!1;if(this.isMaterial&&this.product.costPrice&&!this.product.price&&(this.product.price=this.product.costPrice),!this.product.price)return alert(this.translateService.instant("product-add.no-price-alert")),!1;if(this.product.units&&this.product.units.length)for(const e of this.product.units){if(!e.unit)return alert(this.translateService.instant("product-add.no-unit-unit-alert")),!1;if(!e.price)return alert(this.translateService.instant("product-add.no-unit-price-alert")),!1;if(!e.exchange)return alert(this.translateService.instant("product-add.no-unit-exchange-alert")),!1}return!0}save(e,o){var n=this;return(0,l.Z)(function*(){if(!n.validate()||n.saveDisabled)return;n.analyticsService.logEvent("product-quick-add-save-"+(e?"on-toolbar":"on-page")),n.saveDisabled=!0,n.staffService.isStaff()&&(n.product.staffId=n.staffService.selectedStaff.id),n.product.isMaterial=n.isMaterial,n.product.imageUrlsJson=JSON.stringify(n.pictures);const r=yield n.navCtrl.loading();if(n.product.barcode&&(yield n.productService.searchByBarcode(n.product.barcode))){n.analyticsService.logEvent("product-quick-add-duplicated-barcode");const p=n.translateService.instant("product-add.duplicate-barcode-alert",{barcode:n.product.barcode});return alert(p),n.saveDisabled=!1,void(yield r.dismiss())}if(n.product.code){const u=yield n.productService.getProductsByCode(n.product.code);if(u&&u.length){n.analyticsService.logEvent("product-quick-add-duplicated-code");const p=n.translateService.instant("product-add.duplicate-code-alert",{code:n.product.code});return alert(p),n.saveDisabled=!1,void(yield r.dismiss())}}const a=yield n.productService.getProductsByTitle(n.product.title);if(a&&a.length){n.analyticsService.logEvent("product-quick-add-duplicated-title");const u=n.translateService.instant("product-add.duplicate-title-alert",{title:n.product.title});return alert(u),n.saveDisabled=!1,void(yield r.dismiss())}if(n.product.isCombo){if(!n.product.items||!n.product.items.length){const u=n.translateService.instant("product-add.no-combo-products",{title:n.product.title});return void alert(u)}n.product.itemsJson=JSON.stringify(n.product.items)}const d=n.product.count;n.product.count=0,n.product.unitsJson=n.product.units?JSON.stringify(n.product.units):null,n.product.materialsJson=n.product.materials&&n.product.materials.length?JSON.stringify(n.product.materials):null,n.productService.saveProduct(n.product).then((0,l.Z)(function*(){if(d>0){const m=new V.d;m.amount=0,m.unitPrice=n.product.price,m.unit=n.product.unit,m.quantity=d,m.productId=n.product.id,m.productCode=n.product.code,m.productName=n.product.title,m.discount=0,m.discountType=0,m.storeId=n.store?n.store.id:m.storeId,m.note=n.translateService.instant("product-add.update-quantity-manually"),m.staffId=n.staffService.isStaff()?n.staffService.selectedStaff.id:0,yield n.productService.saveProductNote(m)}const u=[];if(n.categories&&n.categories.length>0){const m=n.tradeService.saveCategoriesToTrade(n.categories,n.product.id);u.push(m)}if(n.categoriesToRemove&&n.categoriesToRemove.length>0){const m=n.tradeService.deleteCategoriesToTrade(n.categoriesToRemove);u.push(m)}if(u.length&&(yield Promise.all(u),n.categories=[],n.categoriesToRemove=[]),n.analyticsService.logEvent("product-quick-add-save-success"),n.productBarcodesSaved&&n.productBarcodesSaved.length){const m=[];for(const y of n.productBarcodesSaved)y.productId=n.product.id,m.push(n.productService.saveProductBarcode(y));m.length&&(yield Promise.all(m))}if(n.productAttributesSaved&&n.productAttributesSaved.length){const m=[];for(const y of n.productAttributesSaved)y.productId=n.product.id,m.push(n.productService.saveProductAttribute(y));m.length&&(yield Promise.all(m))}if(n.productTypesSaved&&n.productTypesSaved.length){const m=[];for(const y of n.productTypesSaved)y.productId=n.product.id,m.push(n.productService.saveProductType(y));m.length&&(yield Promise.all(m))}if(n.productTypesSaved&&n.productTypesSaved.length){const m=[];for(const y of n.productTypesSaved)if(y.values)for(const k of y.values)k.productTypeId=y.id,k.productId=y.productId,m.push(n.productService.saveProductTypeValue(k));m.length&&(yield Promise.all(m))}yield r.dismiss();const p=JSON.parse(JSON.stringify(n.product)),_=n.translateService.instant("product-add.added-product",{product:Z.W.productName(p.code,p.title)});var m;yield n.presentToast(_),n.productsAdded.unshift(p),n.arr=[],n.product=new K.x,n.pictures=[],n.product.imageUrlsJson=JSON.stringify(n.pictures),n.product.count=1,n.navCtrl.publish("reloadProductList"),n.saveDisabled=!1,n.barcodeFocus(),n.addCount>0&&n.analyticsService.logEvent("product-quick-add-save-multi"),o&&n.addCount>0||(n.addCount++,yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("product-add.continue-or-close",{product:Z.W.productName(p.code,p.title)}),buttons:[{text:n.translateService.instant("product-add.finish-adding"),handler:(m=(0,l.Z)(function*(){n.fromSearch?yield n.navCtrl.pop():yield n.navCtrl.popOnly(),n.navCtrl.publish("reloadProductList"),n.navCtrl.publish("reloadProductSelector")}),function(){return m.apply(this,arguments)})},{text:n.translateService.instant("product-add.continue-to-add"),handler:()=>{}}]})).present())})).catch(()=>{n.saveDisabled=!1})})()}presentToast(e,o=1686){var n=this;return(0,l.Z)(function*(){yield(yield n.toastCtrl.create({message:e,duration:o,position:"bottom",color:"danger"})).present()})()}increase(){!this.product||this.product.count++}decrease(){!this.product||(this.product.count--,this.product.count<0&&(this.product.count=0))}addImage(e){var o=this;return(0,l.Z)(function*(){if(!o.fileToUploads||!o.fileToUploads.length)return void alert(o.translateService.instant("note-add.no-picture-selected"));const n=o.fileToUploads.length;o.uploadDisabled=!0;let r=e;for(let a=0;a<n;a++){const d=o.fileToUploads.item(a);yield o.dataService.uploadPicture(d).then(u=>{u&&u.url?o.doAdd(u.url,r):u&&u.error&&(alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1)}).catch(()=>{alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1}),r++}o.afterAdd()})()}rememberFile(e){this.fileToUploads=e.target.files,this.browsePicture()}takePicture(){this.addImage(-1)}browsePicture(){this.addImage(-1)}downloadImage(e,o,n){var r=this;this.platform.ready().then((0,l.Z)(function*(){const a=r.transfer.create(),d=yield r.navCtrl.loading();a.download(o,r.storageDirectory+e).then(function(){var u=(0,l.Z)(function*(p){r.doAdd(p.toURL(),n),r.afterAdd(),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}(),(0,l.Z)(function*(){yield d.dismiss()}))}))}doAdd(e,o){this.pictures.push(e),this.buildPictureGrid(),this.refreshAvatar()}afterAdd(){this.uploadDisabled=!1,this.fileToUploads=null,this.fileUploadInput.nativeElement.value=null}refreshAvatar(){this.product.avatarUrl=this.pictures&&this.pictures.length>0?this.pictures[0]:null}addZerosToNumber(e){let o="";for(let n=0;n<e;n++)o+="0";if(this.product&&this.product.price){let n=this.product.price.toString();n+=o,this.product.price=Number(n)}}addZerosToNumberToUnit(e,o){let n="";for(let r=0;r<e;r++)n+="0";if(o&&o.price){let r=o.price.toString();r+=n,o.price=Number(r)}}addZerosToNumberToUnitCostPrice(e,o){let n="";for(let r=0;r<e;r++)n+="0";if(o&&o.costPrice){let r=o.costPrice.toString();r+=n,o.costPrice=Number(r)}}showImage(e){var o=this;return(0,l.Z)(function*(){const n=JSON.parse(JSON.stringify(o.pictures)),r=yield o.modalCtrl.create({component:ct.v,componentProps:{images:n,id:e,canDelete:!0}});yield r.present();const{data:a}=yield r.onWillDismiss();if(a&&a.idsToDelete){const d=a.idsToDelete;for(const u of d)o.removePicture(u)}})()}buildPictureGrid(){const e=[];let o=[];for(const n of this.pictures)o.push(n),3===o.length&&(e.push(o),o=[]);o.length>0&&e.push(o),this.arr=e}removePicture(e){this.pictures.splice(e,1),this.buildPictureGrid(),this.refreshAvatar()}changePicture(e){this.addImage(e)}selectAll(e){Z.W.selectAll(e)}scan(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-quick-add-scan-barcode"),e.navCtrl.isNotCordova()){const o=Math.random().toString(36).substring(7);e.product.barcode=o}else e.barcodeScanner.scan().then(function(){var o=(0,l.Z)(function*(n){if(!n||!n.text)return;const r=yield e.productService.searchByBarcode(n.text);r&&r.barcode!==e.product.barcode?alert(e.translateService.instant("product-add.barcode-exist-alert")):e.product.barcode=n.text});return function(n){return o.apply(this,arguments)}}())})()}barcodeMaterialChanged(){var e=this;return(0,l.Z)(function*(){!e.barcodeMaterial||(e.productService.searchByBarcode(e.barcodeMaterial).then(o=>{!o||!o.isMaterial||e.addMaterial(o)}),e.analyticsService.logEvent("product-quick-add-barcode-entered-for-material"))})()}barcodeComboChanged(){var e=this;return(0,l.Z)(function*(){!e.barcode||(e.productService.searchByBarcode(e.barcode).then(o=>{!o||o.isMaterial||e.addProduct(o)}),e.analyticsService.logEvent("product-quick-add-barcode-entered-for-combo"))})()}autoGenBarcode(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-quick-add-auto-gen-barcode");const o=Math.random().toString(36).substring(7);e.product.barcode=o})()}barcodeFocus(){this.doFocus(this.barcodeInput)}barcodeFocusCombo(){this.doFocus(this.barcodeInputCombo)}barcodeFocusMaterial(){this.doFocus(this.barcodeInputMaterial)}doFocus(e){setTimeout(()=>{typeof e>"u"||!e||e.setFocus()},500)}isNotCordova(){return this.navCtrl.isNotCordova()}upload(){var e=this;return(0,l.Z)(function*(){yield(yield e.actionSheetController.create({header:e.translateService.instant("common.select-image-source"),buttons:[{text:e.translateService.instant("common.load-from-gallery"),handler:()=>{e.doUpload(e.camera.PictureSourceType.PHOTOLIBRARY)}},{text:e.translateService.instant("common.use-camera"),handler:()=>{e.doUpload(e.camera.PictureSourceType.CAMERA)}},{text:e.translateService.instant("common.cancel"),role:"cancel"}]})).present()})()}doUpload(e){var o=this;return(0,l.Z)(function*(){o.uploadDisabled=!0,o.camera.getPicture({quality:100,sourceType:e,destinationType:o.camera.DestinationType.DATA_URL,encodingType:o.camera.EncodingType.JPEG,mediaType:o.camera.MediaType.PICTURE}).then(function(){var a=(0,l.Z)(function*(d){const u=d,p=yield o.navCtrl.loading();o.dataService.uploadPictureBase64(u).then(function(){var _=(0,l.Z)(function*(g){yield p.dismiss(),g&&g.url?(o.doAdd(g.url,-1),o.afterAdd()):g&&g.error&&(alert("C\xf3 v\u1ea5n \u0111\u1ec1 x\u1ea3y ra, h\xe3y th\u1eed l\u1ea1i sau. (English: Something wrong, please try again later)."),o.uploadDisabled=!1)});return function(g){return _.apply(this,arguments)}}()).catch(function(){var _=(0,l.Z)(function*(g){yield p.dismiss(),console.error(g)});return function(g){return _.apply(this,arguments)}}())});return function(d){return a.apply(this,arguments)}}())})()}productName(e,o){return Z.W.productName(e,o)}limitText(e,o=200){return Z.W.limitText(e,o)}changeIsOption(e){var o=this;return(0,l.Z)(function*(){e.isOption&&o.analyticsService.logEvent("product-quick-add-set-is-option")})()}viewTypes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/type",{callback:n=>{0===e.product.id&&(e.productTypesSaved=n)},productId:e.product.id,productTypesSaved:e.productTypesSaved})})()}viewAttributes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/attribute",{callback:n=>{0===e.product.id&&(e.productAttributesSaved=n)},productId:e.product.id,productAttributesSaved:e.productAttributesSaved})})()}goHelpPage(e){this.navCtrl.push("/help/"+e)}getAttributesString(e){return Z.W.getAttributesString(e)}hasOptionsOrAttributes(e){return Z.W.hasOptionsOrAttributes(e)}showOptions(e){var o=this;return(0,l.Z)(function*(){const n={};n.price=e.price,n.id=e.productId,n.code=e.productCode,n.title=e.productName,n.avatarUrl=e.productAvatar,n.unit=e.unit,n.count=e.count,n.options=e.options,n.total=e.total,n.attributes=e.attributes,o.analyticsService.logEvent("product-add-show-combo-options"),yield o.navCtrl.push("/order/option-selector",{callback:a=>{a&&(e.options=a.options,e.attributes=a.attributes)},mainProduct:JSON.parse(JSON.stringify(n))})})()}increaseItem(e){var o=this;return(0,l.Z)(function*(){o.analyticsService.logEvent("product-add-increase-combo-item"),e.count++})()}decreaseItem(e){var o=this;return(0,l.Z)(function*(){e&&0===e.count||(o.analyticsService.logEvent("product-add-decrease-combo-item"),e.count--)})()}removeProduct(e){var o=this;return(0,l.Z)(function*(){const n=o.product.items.findIndex(r=>r.productId===e.productId);n>=0&&o.product.items.splice(n,1),o.analyticsService.logEvent("product-add-remove-combo-item")})()}removeMaterial(e){var o=this;return(0,l.Z)(function*(){const n=o.product.materials.findIndex(r=>r.productId===e.productId);n>=0&&o.product.materials.splice(n,1),o.analyticsService.logEvent("product-add-remove-material")})()}showProductSelector(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-search-combo-product"),yield e.navCtrl.push("/order/product-selector",{callback:n=>{if(n&&n.length){for(const r of e.product.items)r.isExpand=!1;for(const r of n)e.addProductFromArr(r)}}})})()}showMaterialSelector(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-add-search-material"),yield e.navCtrl.push("/order/product-selector",{callback:n=>{if(n&&n.length){for(const r of e.product.items)r.isExpand=!1;for(const r of n)e.addMaterialFromArr(r)}},isMaterial:!0})})()}addProductFromArr(e){var o=this;return(0,l.Z)(function*(){if(!e||o.product.items.findIndex(d=>!(d.productId!==e.id||d.attributes&&d.attributes.length||d.options&&d.options.length))>=0)return;const r=o.newProductItem(e,e.count);r.options=e.options,r.attributes=e.attributes,o.product.items.unshift(r);const a=o.translateService.instant("product-add.added-combo-product",{product:Z.W.productName(e.code,e.title)});o.presentToast(a)})()}addMaterialFromArr(e){var o=this;return(0,l.Z)(function*(){if(!e||o.product.materials.findIndex(u=>u.productId===e.id)>=0)return;const r=e.materialsJson?JSON.parse(e.materialsJson):null,a=o.newProductItem(e,e.count);a.materials=r,o.product.materials.unshift(a);const d=o.translateService.instant("product-add.added-material",{product:Z.W.productName(e.code,e.title)});o.presentToast(d)})()}scanItem(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-quick-add-scan-barcode-for-combo-product"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.productService.searchByBarcode(n.barcode).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-quick-add-scan-barcode-for-combo-ok"),e.addProduct(a)});return function(a){return r.apply(this,arguments)}}())}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.productService.searchByBarcode(o.text).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-quick-scan-barcode-for-combo-ok"),e.addProduct(r)});return function(r){return n.apply(this,arguments)}}())})})()}scanMaterialItem(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-quick-add-scan-barcode-for-material"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.productService.searchByBarcode(n.barcode).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-quick-add-scan-barcode-for-material-ok"),e.addMaterial(a)});return function(a){return r.apply(this,arguments)}}())}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.productService.searchByBarcode(o.text).then(function(){var n=(0,l.Z)(function*(r){e.analyticsService.logEvent("product-quick-scan-barcode-for-combo-ok"),e.addMaterial(r)});return function(r){return n.apply(this,arguments)}}())})})()}addProduct(e){var o=this;return(0,l.Z)(function*(){if(e){for(const d of o.product.items)d.isExpand=!1;const n=o.product.items.findIndex(d=>!(d.productId!==e.id||d.attributes&&d.attributes.length||d.options&&d.options.length));if(n>=0){const d=o.product.items[n];d.isExpand=!0,d.count=1*d.count+1;const u=o.translateService.instant("product-add.qty-combo-product",{product:d.productName,count:d.count+""});return void o.presentToast(u)}const r=o.newProductItem(e,1);o.product.items.unshift(r);const a=o.translateService.instant("product-add.added-combo-product",{product:Z.W.productName(e.code,e.title)});o.presentToast(a)}})()}addMaterial(e){var o=this;return(0,l.Z)(function*(){if(e){for(const u of o.product.materials)u.isExpand=!1;const n=o.product.materials.findIndex(u=>u.productId===e.id);if(n>=0){const u=o.product.materials[n];u.isExpand=!0,u.count=1*u.count+1;const p=o.translateService.instant("product-add.qty-material",{product:u.productName,count:u.count+""});return void o.presentToast(p)}const r=e.materialsJson?JSON.parse(e.materialsJson):null,a=o.newProductItem(e,1);a.materials=r,o.product.materials.unshift(a);const d=o.translateService.instant("product-add.added-material",{product:Z.W.productName(e.code,e.title)});o.presentToast(d)}})()}newProductItem(e,o){const n={};return n.price=e.price,n.productId=e.id,n.productCode=e.code,n.productName=e.title,n.productAvatar=e.avatarUrl,n.unit=e.unit,n.count=o,n.isExpand=!1,n}showSearchCategory(){var e=this;return(0,l.Z)(function*(){const o=function(){var n=(0,l.Z)(function*(r){const a=r;if(a)if(e.categories.findIndex(d=>d.categoryId===a.id)>=0)yield(yield e.alertCtrl.create({header:"Ch\xfa \xfd",subHeader:"B\u1ea1n \u0111\xe3 th\xeam Danh m\u1ee5c n\xe0y r\u1ed3i.",buttons:["OK"]})).present();else{const d=new ft.p;d.tradeCategory=a,d.categoryId=a.id,e.categories.push(d)}});return function(a){return n.apply(this,arguments)}}();e.navCtrl.push("/trade-category",{callback:o,searchMode:!0})})()}removeCategory(e){0!==e.id&&this.categoriesToRemove.push(e),q.remove(this.categories,o=>o.categoryId===e.categoryId)}dateFormat(e){return C.C.toUiLocalDateString(e)}showDatePopup(){this.product.expiredAt=xt().startOf("day").format("YYYY-MM-DD")}addOtherBarcode(){this.navCtrl.push("/product/barcode",{callback:o=>{0===this.product.id&&(this.productBarcodesSaved=o)},productId:this.product.id,productBarcodesSaved:this.productBarcodesSaved})}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),e.selectedStaff=e.staffService.selectedStaff,e.store=yield e.storeService.getCurrentStore(),e.checkStore=e.store?e.translateService.instant("store.check-store",{shop:e.store.name}):null}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}addUnit(){this.product.units||(this.product.units=[]),this.product.units.unshift({})}removeUnit(e,o){e.unit&&!confirm(this.translateService.instant("product-add.remove-unit",{unit:e.unit}))||this.product.units.splice(o,1)}changeUnit(e){e.exchange&&e.unit&&this.presentToast("1 "+e.unit+" = "+e.exchange+" "+this.product.unit)}changeUnitDefault(e){if(e.isDefault){this.presentToast(this.translateService.instant("product-add.unit-default-alert",{unit:e.unit}),3e3);for(const o of this.product.units)o.unit!==e.unit&&(o.isDefault=!1)}}expandCombo(e){var o=this;return(0,l.Z)(function*(){const n=!e.isExpand;for(const r of o.product.items)r.isExpand=!1;e.isExpand=n,n&&o.analyticsService.logEvent("product-selector-expand")})()}expandMaterial(e){var o=this;return(0,l.Z)(function*(){const n=!e.isExpand;for(const r of o.product.materials)r.isExpand=!1;e.isExpand=n,n&&o.analyticsService.logEvent("product-selector-expand")})()}removeDate(){this.product.expiredAt=""}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(ht.V1),t.Y36(Zt.K),t.Y36(E.K),t.Y36(et.D),t.Y36(A.x),t.Y36(s.IN),t.Y36(N.M),t.Y36(I.m),t.Y36(s.t4),t.Y36(b.sK),t.Y36(s.BX),t.Y36(at.$),t.Y36(Q.y),t.Y36(s.yF),t.Y36(s.Br),t.Y36(D.d),t.Y36(st.X))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-quick-add"]],viewQuery:function(e,o){if(1&e&&(t.Gf(fr,7),t.Gf(xr,7),t.Gf(hr,7),t.Gf(Zr,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.barcodeInput=n.first),t.iGM(n=t.CRH())&&(o.barcodeInputCombo=n.first),t.iGM(n=t.CRH())&&(o.barcodeInputMaterial=n.first),t.iGM(n=t.CRH())&&(o.fileUploadInput=n.first)}},decls:36,vars:30,consts:[["slot","start"],["color","primary",3,"disabled","click"],["name","close"],[4,"ngIf"],["slot","end"],["name","checkmark"],["lines","none","color","success",4,"ngIf"],["color","primary",3,"value","ngModel","ngModelChange"],["value","inprogress"],["value","added"],[3,"color"],["lines","none"],["button","","detail","",3,"click"],["name","help","slot","start"],["color","primary"],[1,"ion-padding",2,"padding-top","0 !important"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],["size","12","size-md",""],["position","stacked","color","primary"],["clearInput","","autofocus","","type","text","tabindex","0",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange","focus"],["barcodeInput",""],["size","small",3,"click",4,"ngIf"],["color","secondary","size","small",3,"click",4,"ngIf"],["color","success","size","small",3,"click",4,"ngIf"],["clearInput","","type","text","tabindex","1",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange"],["clearInput","","type","text","tabindex","2",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange"],["size","12",2,"padding","0"],[2,"padding","0"],["size","4","size-md",""],["clearInput","","type","text",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange","focus"],[2,"font-size","0.65em"],["color","danger"],["size","4","size-md","",4,"ngIf"],["clearInput","","type","number","tabindex","3",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange","focus"],["expand","block","fill","solid",3,"click"],["slot","icon-only","name","remove-outline"],["slot","icon-only","name","add-outline"],["size","small","fill","outline",3,"click"],[2,"margin-top","15px !important"],[3,"ngModel","ngModelChange","ionChange"],[2,"font-size","0.8em"],[3,"ngModel","ngModelChange"],["name","barcode","size","small"],["color","secondary","size","small",3,"click"],["color","success","size","small",3,"click"],["name","add-outline","size","small"],[3,"click"],["name","barcode"],["color","secondary",3,"click"],["color","success",3,"click"],["name","add-outline"],[3,"placeholder","moneyValue","moneyValueChange"],[4,"ngFor","ngForOf"],["size","3","size-md",""],["clearInput","","type","text",2,"background-color","#efefef","border-radius","5px","color","#000","margin-bottom","5px",3,"placeholder","ngModel","ngModelChange","focus"],["color","primary",2,"--size","20px",3,"ngModel","ngModelChange"],["position","stacked","color","secondary"],[3,"moneyValue","placeholder","moneyValueChange"],[2,"float","right"],["size","small","expand","block","fill","clear","color","danger",3,"click"],["name","close-outline","slot","icon-only"],["color","light"],["color","primary",1,"ion-text-wrap"],["fill","clear","color","primary",3,"click"],["name","add"],["clearInput","","autofocus","true","type","text",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange"],["barcodeInputCombo",""],["color","light",1,"ion-text-wrap",3,"hidden"],[2,"padding-top","5px","padding-bottom","5px",3,"innerHTML"],["color","light",3,"lines"],["fill","clear",3,"click"],["slot","icon-only",3,"name"],[2,"padding-top","8px","padding-bottom","8px",3,"click"],["slot","end",2,"padding-left","0","margin-left","0","padding-right","0","margin-right","0"],["fill","clear","size","large",3,"click"],["slot","icon-only","name","remove"],["slot","icon-only","name","add"],["fill","clear","size","small","color","medium",3,"click"],["slot","icon-only","size","small","name","ellipsis-vertical"],["slot","icon-only","name","close"],["color","light",2,"padding-left","15px","padding-right","15px","margin","0",3,"hidden"],["clearInput","","type","number",2,"background-color","#efefef","border-radius","5px","color","#000",3,"placeholder","ngModel","ngModelChange","focus"],["lines","inset","color","light","size","12"],[1,"ion-text-wrap",2,"font-size","0.8em"],["barcodeInputMaterial",""],["lines","inset","color","light"],["pickerId","contactBd2Picker",3,"date","dateChange",4,"ngIf"],[3,"click",4,"ngIf"],["size","small","fill","outline",3,"click",4,"ngIf"],["size-lg","4"],[1,"ion-no-padding"],["size-xs","6","size-sm","6","size-md","3","size-lg","2","class","ion-no-padding",4,"ngFor","ngForOf"],["size-lg","4",1,"ion-no-padding"],[1,"ion-no-padding",2,"padding-left","5px"],["ion-button","","color","secondary",3,"click",4,"ngIf"],["color","primary","for","files"],["type","file","multiple","","accept","image/*","id","files",2,"width","0","height","0","font-size","0",3,"change"],["fileUploadInput",""],[2,"background-color","#69bb7b"],["size","12"],["color","light",2,"text-shadow","2px 2px 2px #cccccc","text-transform","uppercase"],["type","text","rows","5",2,"background-color","#efefef",3,"placeholder","ngModel","ngModelChange"],["pickerId","contactBd2Picker",3,"date","dateChange"],[3,"moneyValue","moneyValueChange"],["size-xs","6","size-sm","6","size-md","3","size-lg","2",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],["color","dark",1,"ion-text-wrap"],["ion-button","","color","secondary",3,"click"],["name","camera"],["style","max-width: 150px;",4,"ngFor","ngForOf"],[2,"max-width","150px"],[2,"max-width","120px",3,"src","click"],["position","stacked","color","light"],["fill","outline","expand","block","color","secondary",3,"click"],["name","ellipsis-horizontal"],["fill","outline","expand","block","color","primary","tabindex","5",3,"disabled","click"],["name","options"],[2,"white-space","pre-wrap","font-weight","bold"],["color","secondary"],["name","pricetag"],["style","border-bottom: 1px solid #ccc;",3,"cursor",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #ccc"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.navCtrl.back()}),t._UZ(4,"ion-icon",2),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,Tr,3,3,"ion-title",3),t.YNc(8,Ar,3,3,"ion-title",3),t.TgZ(9,"ion-buttons",4)(10,"ion-button",1),t.NdJ("click",function(){return o.save(!0,!1)}),t._UZ(11,"ion-icon",5),t._uU(12),t.ALo(13,"translate"),t.qZA()()(),t.YNc(14,Cr,8,4,"ion-item",6),t.TgZ(15,"ion-segment",7),t.NdJ("ngModelChange",function(r){return o.tab=r}),t.TgZ(16,"ion-segment-button",8),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-segment-button",9)(20,"ion-text",10),t._uU(21),t.ALo(22,"translate"),t.qZA()()()(),t.TgZ(23,"ion-content"),t.YNc(24,Gr,91,71,"ion-grid",3),t.YNc(25,Xr,109,74,"ion-grid",3),t.YNc(26,tc,22,15,"ion-grid",3),t.YNc(27,rc,3,2,"ion-list",3),t.TgZ(28,"ion-list",11)(29,"ion-item",12),t.NdJ("click",function(){return o.goHelpPage("product")}),t._UZ(30,"ion-icon",13),t.TgZ(31,"ion-label",14),t._uU(32),t.ALo(33,"translate"),t.qZA()()(),t.TgZ(34,"div",15),t._UZ(35,"support"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(6,20,"product-add.close")," "),t.xp6(2),t.Q6J("ngIf",!o.isMaterial),t.xp6(1),t.Q6J("ngIf",o.isMaterial),t.xp6(2),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(13,22,"action.save")," "),t.xp6(2),t.Q6J("ngIf",o.checkStore&&(null==o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.Q6J("value","inprogress")("ngModel",o.tab),t.xp6(2),t.hij(" ",t.lcZ(18,24,"product-add.inprogress")," "),t.xp6(3),t.Q6J("color",o.productsAdded&&o.productsAdded.length?"danger":"default"),t.xp6(1),t.AsE(" ",t.lcZ(22,26,"product-add.added")," (",o.productsAdded&&o.productsAdded.length?o.productsAdded.length:0,") "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.Q6J("ngIf","inprogress"===o.tab),t.xp6(1),t.Q6J("ngIf",o.isExtend&&"inprogress"===o.tab),t.xp6(1),t.Q6J("ngIf","inprogress"===o.tab),t.xp6(1),t.Q6J("ngIf","added"===o.tab),t.xp6(5),t.hij(" ",t.lcZ(33,28,"help-product.title")," "))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.nz,s.wI,s.W2,s.jY,s.Gu,s.gu,s.pK,s.Ie,s.rH,s.Q$,s.q_,s.Nd,s.cJ,s.GO,s.yW,s.g2,s.wd,s.ho,s.sr,s.w,s.as,s.QI,s.j9,gr.Y,ot.F,Tt.L,T.H9,b.X$],encapsulation:2}),i})(),lt=(()=>{class i{constructor(e,o,n,r,a){this.navCtrl=e,this.staffService=o,this.productService=n,this.analyticsService=r,this.modalController=a,this.productId=0,this.productAttributeId=0,this.productAttribute={},this.isNew=!0,this.saveDisabled=!1,this.onKeyPress=d=>{!d.target||"body"!==d.target.localName||("s"===d.key||"S"===d.key)&&this.save()}}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-attribute-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct()){if(e.productAttribute={id:e.productAttributeToEdit?e.productAttributeToEdit.id:0,title:e.productAttributeToEdit?e.productAttributeToEdit.title:null,productId:e.productAttributeToEdit?e.productAttributeToEdit.productId:0},e.productAttributeId&&e.productAttributeId>0&&(e.isNew=!1),e.productAttributeId&&e.productAttributeId>0){const o=yield e.navCtrl.loading();e.productService.getProductAttribute(e.productAttributeId).then(function(){var n=(0,l.Z)(function*(r){yield o.dismiss(),e.productAttribute=r});return function(r){return n.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield o.dismiss()}))}}else e.navCtrl.pop()})()}save(){var e=this;if(this.saveDisabled=!0,0===this.productId)return this.productAttributeToEdit&&(this.productAttributeToEdit.title=this.productAttribute.title),void this.modalController.dismiss(this.productAttribute);this.productAttribute.productId=this.productId,this.productService.saveProductAttribute(this.productAttribute).then((0,l.Z)(function*(){e.analyticsService.logEvent("product-attribute-add-save-success"),e.exitPage()}))}exitPage(){var e=this;return(0,l.Z)(function*(){e.navCtrl.publish("reloadProductAttributes"),e.navCtrl.publish("reloadProductAttribute",e.productAttribute),e.productId>0&&e.navCtrl.publish("reloadProduct",{id:e.productId}),e.modalController.dismiss(e.productAttribute)})()}dismiss(){this.modalController.dismiss()}selectAll(e){Z.W.selectAll(e)}isNotCordova(){return this.navCtrl.isNotCordova()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(s.IN))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-attribute-add"]],inputs:{productId:"productId",productAttributeId:"productAttributeId",productAttributeToEdit:"productAttributeToEdit"},decls:21,vars:16,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["size","large","color","success",3,"disabled","click"],["name","checkmark"],["position","stacked","color","primary"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",3)(9,"ion-button",4),t.NdJ("click",function(){return o.save()}),t._UZ(10,"ion-icon",5),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item")(16,"ion-label",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-input",7),t.NdJ("ngModelChange",function(r){return o.productAttribute.title=r}),t.ALo(20,"translate"),t.qZA()()()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,8,"product-attribute-add.title")),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(12,10,"action.save")," "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(4),t.Oqu(t.lcZ(18,12,"product-attribute-add.product-attribute-title")),t.xp6(2),t.s9C("placeholder",t.lcZ(20,14,"product-attribute-add.enter-title")),t.Q6J("ngModel",o.productAttribute.title))},dependencies:[P.JJ,P.On,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.sr,s.j9,b.X$],encapsulation:2}),i})();function ac(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save())}),t._UZ(1,"ion-icon",17),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij("\xa0",t.lcZ(3,1,"action.save")," "))}function sc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",18)(1,"ion-label",1),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProduct(r))}),t.TgZ(2,"span",19),t._uU(3),t.qZA()(),t.TgZ(4,"ion-buttons",20)(5,"ion-button",7),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw();return t.KtG(d.removeProductAttribute(r,a))}),t._UZ(6,"ion-icon",21),t.qZA(),t.TgZ(7,"ion-button",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProduct(r))}),t._UZ(8,"ion-icon",22),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw();t.xp6(3),t.hij(" ",o.productName(null,e.title)," "),t.xp6(1),t.Q6J("hidden",!o.staffService.canAddUpdateProduct())}}function dc(i,c){1&i&&(t.TgZ(0,"ion-item",18),t._UZ(1,"div",23),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product-attribute.no-product-attribute"),t.oJD))}let lc=(()=>{class i{constructor(e,o,n,r,a,d,u,p){var _=this;this.navCtrl=e,this.modalCtrl=o,this.userService=n,this.staffService=r,this.productService=a,this.analyticsService=d,this.translateService=u,this.alertCtrl=p,this.searchKey="",this.reloadProductAttributes=(0,l.Z)(function*(){_.params=_.navCtrl.getParams(_.params),_.params&&(_.callback=_.params.callback,_.productId=_.params.productId,_.productAttributesSaved=_.params.productAttributesSaved);const g=yield _.navCtrl.loading();if(_.currency=yield _.userService.getAttr("current-currency"),0===_.productId)return _.productAttributesSaved&&_.productAttributesSaved.length&&(_.originalProductAttributes=JSON.parse(JSON.stringify(_.productAttributesSaved)),_.productAttributes=JSON.parse(JSON.stringify(_.productAttributesSaved))),void(yield g.dismiss());_.productService.getProductAttributes(_.productId).then(function(){var m=(0,l.Z)(function*(y){yield g.dismiss(),_.originalProductAttributes=JSON.parse(JSON.stringify(y)),_.productAttributes=y});return function(y){return m.apply(this,arguments)}}())}),this.navCtrl.removeEventListener("reloadProductAttributes",this.reloadProductAttributes),this.navCtrl.addEventListener("reloadProductAttributes",this.reloadProductAttributes)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-attribute")})()}ngOnInit(){this.reloadProductAttributes()}dateFormat(e){return C.C.toUiString(e)}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("search-product-search");let o=e.originalProductAttributes?JSON.parse(JSON.stringify(e.originalProductAttributes)):[];if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.title&&-1!==r.title.toLowerCase().indexOf(n)||r.code&&-1!==r.code.toLowerCase().indexOf(n))}e.productAttributes=o})()}clearSearch(){this.searchKey=null,this.reloadProductAttributes()}dismiss(){var e=this;return(0,l.Z)(function*(){var n;if(0!==e.productId||!e.productAttributes||!e.productAttributes.length)return e.callback?(e.callback(null),void e.navCtrl.back()):void e.modalCtrl.dismiss();yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-attribute.dismiss-with-data-warning"),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){if(e.callback)return e.callback(null),void e.navCtrl.back();e.modalCtrl.dismiss()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}save(){if(this.callback)return this.callback(this.productAttributes),void this.navCtrl.back();this.modalCtrl.dismiss(this.productAttributes)}removeProductAttribute(e,o){var n=this;return(0,l.Z)(function*(){var a;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("product-attribute.delete-warning"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,l.Z)(function*(){if(0===n.productId)return void n.productAttributes.splice(o,1);const d=yield n.navCtrl.loading();n.productService.deleteProductAttribute(e).then((0,l.Z)(function*(){yield d.dismiss(),n.analyticsService.logEvent("product-attribute-delete-success"),n.navCtrl.publish("reloadProductAttributes"),n.navCtrl.publish("reloadProduct",{id:n.productId})})).catch(function(){var u=(0,l.Z)(function*(p){console.error(p),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}())}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}selectProduct(e){var o=this;return(0,l.Z)(function*(){yield(yield o.modalCtrl.create({component:lt,componentProps:{productId:o.productId,productAttributeId:e.id,productAttributeToEdit:e}})).present()})()}productName(e,o){return Z.W.productName(e,o)}openProductAttributeAdd(){var e=this;return(0,l.Z)(function*(){const o=yield e.modalCtrl.create({component:lt,componentProps:{productId:e.productId,productAttributeId:0}});yield o.present();const{data:n}=yield o.onDidDismiss();!n||0===e.productId&&(e.productAttributes||(e.productAttributes=[]),e.productAttributes.push(n),e.originalProductAttributes||(e.originalProductAttributes=[]),e.originalProductAttributes.push(n))})()}copy(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-attribute.copy-alert"),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){e.continueCopy()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}continueCopy(){var e=this;return(0,l.Z)(function*(){const o=function(){var n=(0,l.Z)(function*(r){if(!r)return;const a=yield e.productService.getProductAttributes(r.id);if(a&&a.length)if(e.productId>0){const d=[];for(const u of a)u.id=0,u.productId=e.productId,d.push(e.productService.saveProductAttribute(u));yield Promise.all(d),e.analyticsService.logEvent("product-attribute-copied-attributes-from-edit"),e.navCtrl.publish("reloadProductAttributes"),e.navCtrl.publish("reloadProduct",{id:e.productId})}else for(const d of a)d.id=0,d.productId=0,e.productAttributes||(e.productAttributes=[]),e.originalProductAttributes||(e.originalProductAttributes=[]),e.originalProductAttributes.push(d),e.productAttributes.push(d),e.analyticsService.logEvent("product-attribute-copied-attributes-from-quick-add")});return function(a){return n.apply(this,arguments)}}();e.navCtrl.push("/product",{callback:o,searchMode:!0})})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(s.IN),t.Y36(E.K),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(b.sK),t.Y36(s.Br))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-attribute"]],inputs:{productId:"productId",productAttributesSaved:"productAttributesSaved"},decls:29,vars:19,consts:[["slot","start"],[3,"click"],["name","close"],[1,"ion-text-start",2,"font-weight","bold"],["slot","end"],["size","large","color","primary",3,"hidden","click"],["name","add-circle"],["size","large","color","primary",3,"click"],["name","copy"],["size","large","color","primary",3,"click",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],[1,"ion-padding"],["color","danger"],["text-wrap","",4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",3,"hidden"],["name","add"],["name","checkmark"],["text-wrap",""],[2,"white-space","pre-wrap"],["slot","end",3,"hidden"],["name","close-circle"],["name","create"],[3,"innerHTML"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-label",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",4)(9,"ion-button",5),t.NdJ("click",function(){return o.openProductAttributeAdd()}),t._UZ(10,"ion-icon",6),t.qZA(),t.TgZ(11,"ion-button",7),t.NdJ("click",function(){return o.copy()}),t._UZ(12,"ion-icon",8),t.qZA(),t.YNc(13,ac,4,3,"ion-button",9),t.qZA()()(),t.TgZ(14,"ion-content")(15,"ion-searchbar",10),t.NdJ("ionClear",function(){return o.clearSearch()})("ionChange",function(){return o.search()})("ngModelChange",function(r){return o.searchKey=r}),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",11)(18,"ion-text",12)(19,"strong")(20,"i"),t._uU(21),t.ALo(22,"translate"),t.qZA()()()(),t.TgZ(23,"ion-list"),t.YNc(24,sc,9,2,"ion-item",13),t.YNc(25,dc,3,3,"ion-item",14),t.qZA(),t.TgZ(26,"ion-fab",15)(27,"ion-fab-button",1),t.NdJ("click",function(){return o.openProductAttributeAdd()}),t._UZ(28,"ion-icon",16),t.qZA()()()),2&e&&(t.xp6(6),t.hij(" ",t.lcZ(7,13,"product-attribute.title")," "),t.xp6(3),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()),t.xp6(4),t.Q6J("ngIf",0===o.productId),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.s9C("placeholder",t.lcZ(16,15,"product-attribute.search")),t.Q6J("ngModel",o.searchKey),t.xp6(6),t.hij("* ",t.lcZ(22,17,"product-type.recommend"),""),t.xp6(3),t.Q6J("ngForOf",o.productAttributes),t.xp6(1),t.Q6J("ngIf",!o.originalProductAttributes||0===o.originalProductAttributes.length),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"margin-bottom: 60px":""),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.W2,s.IJ,s.W4,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.VI,s.yW,s.sr,s.j9,b.X$],encapsulation:2}),i})();function uc(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._UZ(3,"ion-icon",14),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(4),t.AsE(" \xa0",t.lcZ(5,2,"product-add.expired-date"),": ",o.dateFormat(e.expiredAt)," ")}}function _c(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",15),t._UZ(1,"img",16),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}const yt=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function pc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item-sliding")(1,"ion-item",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r.id))}),t.TgZ(2,"ion-label",8)(3,"span",9),t._uU(4),t.qZA(),t._UZ(5,"br"),t.TgZ(6,"ion-text"),t._UZ(7,"ion-icon",10),t._uU(8),t.ALo(9,"translate"),t.ALo(10,"currency"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.YNc(14,uc,6,4,"span",3),t.qZA(),t.YNc(15,_c,2,1,"ion-thumbnail",11),t.qZA(),t.TgZ(16,"ion-item-options",12)(17,"ion-item-option",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))}),t._UZ(18,"ion-icon",13),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(4),t.hij(" ",o.limitText(o.productName(e.code,e.title))," "),t.xp6(4),t.AsE(" \xa0",t.lcZ(9,8,"product-detail.product-unit-price"),": ",t.G7q(10,10,t.kEZ(18,yt,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(4),t.lnq(" - ",t.lcZ(13,16,"product-detail.product-quantity"),": ",e.count," ",e.unit,""),t.xp6(2),t.Q6J("ngIf",e.expiredAt),t.xp6(1),t.Q6J("ngIf",e.avatarUrl)}}function mc(i,c){if(1&i&&(t.ynx(0),t.YNc(1,pc,19,22,"ion-item-sliding",6),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.products)}}function gc(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",20),t._UZ(1,"img",16),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function fc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",18),t.NdJ("press",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))})("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r.id))}),t.TgZ(1,"ion-col"),t._uU(2),t.qZA(),t.TgZ(3,"ion-col"),t._uU(4),t.ALo(5,"currency"),t.qZA(),t.TgZ(6,"ion-col"),t._uU(7),t.qZA(),t.TgZ(8,"ion-col"),t._uU(9),t.qZA(),t.TgZ(10,"ion-col"),t.YNc(11,gc,2,1,"ion-thumbnail",19),t.qZA()()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(2),t.hij(" ",o.limitText(o.productName(e.code,e.title))," "),t.xp6(2),t.Oqu(t.G7q(5,7,t.kEZ(13,yt,e.price,o.currency,o.translateService.currentLang))),t.xp6(3),t.Oqu(e.count),t.xp6(2),t.Oqu(e.unit),t.xp6(2),t.Q6J("ngIf",e.avatarUrl)}}function xc(i,c){if(1&i&&(t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col")(3,"strong"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"ion-col")(7,"strong"),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"ion-col")(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"ion-col")(15,"strong"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t.TgZ(18,"ion-col")(19,"strong"),t._uU(20),t.ALo(21,"translate"),t.qZA()()(),t.YNc(22,fc,12,17,"ion-row",17),t.qZA()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,6,"product-add.product-title")),t.xp6(4),t.Oqu(t.lcZ(9,8,"product-add.price")),t.xp6(4),t.Oqu(t.lcZ(13,10,"product-add.count")),t.xp6(4),t.Oqu(t.lcZ(17,12,"product-add.unit")),t.xp6(4),t.Oqu(t.lcZ(21,14,"product-detail.photo")),t.xp6(2),t.Q6J("ngForOf",e.products)}}function hc(i,c){1&i&&(t.TgZ(0,"ion-item",21),t._UZ(1,"div",22),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product.no-product"),t.oJD))}function Zc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.goHelpPage("product"))}),t._UZ(1,"ion-icon",24),t.TgZ(2,"ion-label",25),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"help-product.title")," "))}let Tc=(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U){var v=this;this.platform=e,this.barcodeScanner=o,this.productService=n,this.staffService=r,this.debtService=a,this.translateService=d,this.userService=u,this.actionSheetCtrl=p,this.alertCtrl=_,this.modalCtrl=g,this.navCtrl=m,this.analyticsService=y,this.planService=k,this.storeService=J,this.excelService=U,this.searchKey="",this.isMobile=!0,this.checkProduct=0,this.currentPlan=null,this.reload=(0,l.Z)(function*(){const f=yield v.navCtrl.loading();v.isMobile=v.platform.width()<720,v.currency=yield v.userService.getAttr("current-currency"),v.currentPlan=yield v.planService.getCurrentPlan(),v.currentPlan||(v.checkProduct=yield v.planService.checkProduct(),v.checkProduct>=30&&(v.isOnTrial=yield v.planService.isOnTrial(v.currentPlan)));const w=yield v.storeService.getCurrentStore();v.productService.getProductsExpiry(w?w.id:0,0).then(function(){var S=(0,l.Z)(function*(h){v.originalProducts=JSON.parse(JSON.stringify(h)),v.products=h,yield f.dismiss()});return function(h){return S.apply(this,arguments)}}())}),this.doEnteredBarcode=f=>{!f||this.productService.searchByBarcode(f).then(w=>{if(w)return this.analyticsService.logEvent("product-scan-barcode-ok"),void this.navCtrl.push("/product/detail",{id:w.id});this.navCtrl.push("/product/edit",{barcode:f})})},this.navCtrl.removeEventListener("reloadProductList",this.reload),this.navCtrl.addEventListener("reloadProductList",this.reload)}ngOnInit(){this.platform.resize.subscribe(()=>{this.isMobile=this.platform.width()<720}),this.reload()}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("home")})()}isNotCordova(){return this.navCtrl.isNotCordova()}scanProduct(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-scan-barcode"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.doEnteredBarcode(n.barcode)}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.doEnteredBarcode(o.text)})})()}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-search");let o=JSON.parse(JSON.stringify(e.originalProducts));if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.code&&-1!==r.code.toLowerCase().indexOf(n)||r.title&&-1!==r.title.toLowerCase().indexOf(n))}e.products=o})()}clearSearch(){this.searchKey=null,this.reload()}limitText(e,o=200){return Z.W.limitText(e,o)}selectProduct(e){try{this.navCtrl.navigateForward("/product/detail",{id:e})}catch(o){console.error(o),alert(o)}}deleteProduct(e){var o=this;return(0,l.Z)(function*(){yield(yield o.alertCtrl.create({header:o.translateService.instant("common.confirm"),message:o.translateService.instant("product-detail.delete-alert"),buttons:[{text:o.translateService.instant("common.agree"),handler:()=>{o.productService.deleteProduct(e).then((0,l.Z)(function*(){o.analyticsService.logEvent("product-delete-success");let r=o.products.findIndex(a=>a.id==e.id);r>=0&&o.products.splice(r,1),r=o.originalProducts.findIndex(a=>a.id==e.id),r>=0&&o.originalProducts.splice(r,1)}))}},{text:o.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}importProducts(){if(!this.currentPlan&&this.checkProduct>=30&&!this.isOnTrial)return this.analyticsService.logEvent("check-product-alert"),void alert(this.translateService.instant("product.check-product-alert",{total:this.checkProduct}));this.navCtrl.navigateForward("/product/import")}presentActionSheet(e){var o=this;return(0,l.Z)(function*(){yield(yield o.actionSheetCtrl.create({header:o.translateService.instant("action.action"),buttons:[{text:o.translateService.instant("product-detail.delete"),role:"destructive",handler:()=>{o.deleteProduct(e)}},{text:o.translateService.instant("product-detail.view-detail"),handler:()=>{o.selectProduct(e.id)}},{text:o.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}productName(e,o){return Z.W.productName(e,o)}removeProductDebts(e){return new Promise((o,n)=>{this.debtService.getDebtsByContact(e).then(r=>{const a=[];if(r&&r.length>0)for(const d of r){d.productId=0;const u=this.debtService.saveDebt(d);a.push(u)}a.length>0?Promise.all(a).then(()=>{o(!0)}).catch(()=>{n(null)}):o(!0)}).catch(()=>{n(null)})})}exportProductNotesReport(e){this.navCtrl.navigateForward("/product/export",{reportType:e})}goHelpPage(e){this.navCtrl.push("/help/"+e)}exportProductsReport(){var e=this;return(0,l.Z)(function*(){const o="products-report.xlsx",n=yield e.navCtrl.loading();e.excelService.downloadProductsReport(o).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-export-to-excel-success"),yield n.dismiss(),e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(o,o,a))});return function(a){return r.apply(this,arguments)}}())})()}requestProPlan(){this.navCtrl.push("/request-pro")}dateFormat(e){return C.C.toUiDateString(e)}showExpiries(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.t4),t.Y36(I.m),t.Y36(N.M),t.Y36(A.x),t.Y36(L.E),t.Y36(b.sK),t.Y36(E.K),t.Y36(s.BX),t.Y36(s.Br),t.Y36(s.IN),t.Y36(M.G),t.Y36(Q.y),t.Y36(it.D),t.Y36(D.d),t.Y36($.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["products-expiry"]],decls:15,vars:13,consts:[["slot","start"],["defaultHref","/home"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],[4,"ngIf"],["class","ion-text-wrap","lines","none",4,"ngIf"],["button","","detail","","lines","none",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap","font-weight","bold"],["name","pricetag"],["item-right","",4,"ngIf"],["side","end"],["slot","icon-only","name","ellipsis-vertical"],["name","calendar"],["item-right",""],[3,"src"],["style","border-bottom: 1px solid #ccc;",3,"cursor","press","click",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #ccc",3,"press","click"],["class","ion-item-right","size","small",4,"ngIf"],["size","small",1,"ion-item-right"],["lines","none",1,"ion-text-wrap"],[3,"innerHTML"],["button","","detail","","lines","none",3,"click"],["name","help","slot","start"],["color","primary"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"ion-searchbar",2),t.NdJ("ionClear",function(){return o.clearSearch()})("ionChange",function(){return o.search()})("ngModelChange",function(r){return o.searchKey=r}),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"ion-content")(10,"ion-list"),t.YNc(11,mc,2,1,"ng-container",3),t.YNc(12,xc,23,16,"ion-grid",3),t.YNc(13,hc,3,3,"ion-item",4),t.YNc(14,Zc,5,3,"ion-item",5),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,9,"product.expiry-products")),t.xp6(2),t.s9C("placeholder",t.lcZ(8,11,"product.search")),t.Q6J("ngModel",o.searchKey),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(2),t.Q6J("ngIf",o.isMobile),t.xp6(1),t.Q6J("ngIf",!o.isMobile&&o.products&&o.products.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.oU,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.u8,s.IK,s.td,s.Q$,s.q_,s.Nd,s.VI,s.yW,s.Bs,s.wd,s.sr,s.j9,s.cs,T.H9,b.X$],encapsulation:2}),i})();function Ac(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save())}),t._UZ(1,"ion-icon",15),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij("\xa0",t.lcZ(3,1,"action.save")," "))}function Cc(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._UZ(3,"ion-icon",19),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.AsE(" \xa0",t.lcZ(5,2,"product-add.expired-date"),": ",e.dateFormat(e.product.expiredAt)," ")}}const ut=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function yc(i,c){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-label",16)(2,"span",17),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"ion-text"),t._UZ(6,"ion-icon",18),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.YNc(13,Cc,6,4,"span",10),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.Oqu(e.productName(e.product.code,e.product.title)),t.xp6(4),t.AsE(" \xa0",t.lcZ(8,7,"product-detail.product-unit-price"),": ",t.G7q(9,9,t.kEZ(17,ut,e.product.price,e.currency,e.translateService.currentLang))," "),t.xp6(4),t.lnq(" - ",t.lcZ(12,15,"product-detail.product-quantity"),": ",e.product.count," ",e.product.unit,""),t.xp6(2),t.Q6J("ngIf",e.product.expiredAt)}}function bc(i,c){1&i&&(t.TgZ(0,"p")(1,"ion-text",31),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"product-type.allow-multi-choice")))}function vc(i,c){if(1&i&&(t.TgZ(0,"ion-text",31),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.hij(": +",t.G7q(2,1,t.kEZ(7,ut,e.price,o.currency,o.translateService.currentLang)),"")}}function Pc(i,c){if(1&i&&(t.TgZ(0,"ion-text",31),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.hij(": ",t.G7q(2,1,t.kEZ(7,ut,e.price,o.currency,o.translateService.currentLang)),"")}}function Sc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",32)(1,"ion-button",21),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw().index,u=t.oxw();return t.KtG(u.upValue(r,d,a))}),t._UZ(2,"ion-icon",22),t.qZA(),t.TgZ(3,"ion-button",23),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw().index,u=t.oxw();return t.KtG(u.downValue(r,d,a))}),t._UZ(4,"ion-icon",24),t.qZA(),t.TgZ(5,"ion-label",1),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw().$implicit,d=t.oxw();return t.KtG(d.selectProductTypeValue(r,a.id))}),t.TgZ(6,"span",25),t._uU(7),t.YNc(8,vc,3,11,"ion-text",33),t.YNc(9,Pc,3,11,"ion-text",33),t.qZA()(),t.TgZ(10,"ion-buttons",26)(11,"ion-button",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw().$implicit,d=t.oxw();return t.KtG(d.selectProductTypeValue(r,a.id))}),t._UZ(12,"ion-icon",27),t.qZA(),t.TgZ(13,"ion-button",28),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw().index,d=t.oxw();return t.KtG(d.removeProductTypeValue(r,a))}),t._UZ(14,"ion-icon",34),t.qZA()()()}if(2&i){const e=c.$implicit,o=c.index,n=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===n.values.length-1),t.xp6(4),t.hij("",e.title," "),t.xp6(1),t.Q6J("ngIf",e.price&&e.isAddedToPrice),t.xp6(1),t.Q6J("ngIf",e.price&&!e.isAddedToPrice),t.xp6(1),t.Q6J("hidden",!r.staffService.canAddUpdateProduct())}}function wc(i,c){1&i&&(t.TgZ(0,"ion-item",32),t._UZ(1,"div",35),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product-type.no-product-type-value"),t.oJD))}function kc(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",20)(2,"ion-button",21),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw();return t.KtG(d.up(r,a))}),t._UZ(3,"ion-icon",22),t.qZA(),t.TgZ(4,"ion-button",23),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw();return t.KtG(d.down(r,a))}),t._UZ(5,"ion-icon",24),t.qZA(),t.TgZ(6,"ion-label",1),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProductType(r))}),t.TgZ(7,"span",25)(8,"strong"),t._uU(9),t.qZA()(),t.YNc(10,bc,4,3,"p",10),t.qZA(),t.TgZ(11,"ion-buttons",26)(12,"ion-button",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.addTypeValue(r))}),t._UZ(13,"ion-icon",14),t.qZA(),t.TgZ(14,"ion-button",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProductType(r))}),t._UZ(15,"ion-icon",27),t.qZA(),t.TgZ(16,"ion-button",28),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw();return t.KtG(d.removeProductType(r,a))}),t._UZ(17,"ion-icon",29),t.qZA()()(),t.YNc(18,Sc,15,6,"ion-item",30),t.YNc(19,wc,3,3,"ion-item",12),t.BQk()}if(2&i){const e=c.$implicit,o=c.index,n=t.oxw();t.xp6(2),t.Q6J("disabled",0===o),t.xp6(2),t.Q6J("disabled",o===n.productTypes.length-1),t.xp6(5),t.Oqu(e.title),t.xp6(1),t.Q6J("ngIf",e.multiChoice),t.xp6(1),t.Q6J("hidden",!n.staffService.canAddUpdateProduct()),t.xp6(7),t.Q6J("ngForOf",e.values),t.xp6(1),t.Q6J("ngIf",!e.values||0===e.values.length)}}function qc(i,c){1&i&&(t.TgZ(0,"ion-item",32),t._UZ(1,"div",35),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product-type.no-product-type"),t.oJD))}let Nc=(()=>{class i{constructor(e,o,n,r,a,d,u,p){var _=this;this.navCtrl=e,this.modalCtrl=o,this.userService=n,this.staffService=r,this.productService=a,this.analyticsService=d,this.translateService=u,this.alertCtrl=p,this.searchKey="",this.reloadProductTypes=(0,l.Z)(function*(){_.params=_.navCtrl.getParams(_.params),_.params&&(_.callback=_.params.callback,_.productId=_.params.productId,_.productTypesSaved=_.params.productTypesSaved,_.product=_.params.product);const g=yield _.navCtrl.loading();if(_.currency=yield _.userService.getAttr("current-currency"),0===_.productId)return _.productTypesSaved&&_.productTypesSaved.length&&(_.originalProductTypes=JSON.parse(JSON.stringify(_.productTypesSaved)),_.productTypes=JSON.parse(JSON.stringify(_.productTypesSaved))),void(yield g.dismiss());_.product=_.product?_.product:0===_.productId?null:yield _.productService.get(_.productId,0),_.productService.getProductTypes(_.productId).then(function(){var m=(0,l.Z)(function*(y){const k=_.sortByOrderIndex(y),J=yield _.productService.getProductTypeValues(_.productId);if(J&&J.length){const U=_.sortByOrderIndex(J);for(const v of U){const f=k.find(w=>w.id===v.productTypeId);!f||(f.values||(f.values=[]),f.values.push(v))}}_.originalProductTypes=JSON.parse(JSON.stringify(k)),_.productTypes=k,yield g.dismiss()});return function(y){return m.apply(this,arguments)}}())}),this.navCtrl.removeEventListener("reloadProductTypes",this.reloadProductTypes),this.navCtrl.addEventListener("reloadProductTypes",this.reloadProductTypes)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-type")})()}ngOnInit(){this.reloadProductTypes()}dateFormat(e){return C.C.toUiString(e)}sortByOrderIndex(e){return e?q.orderBy(e,["orderIndex"],["asc"]):null}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("search-product-search");let o=e.originalProductTypes?JSON.parse(JSON.stringify(e.originalProductTypes)):[];if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.title&&-1!==r.title.toLowerCase().indexOf(n)||r.code&&-1!==r.code.toLowerCase().indexOf(n))}e.productTypes=o})()}clearSearch(){this.searchKey=null,this.reloadProductTypes()}dismiss(){var e=this;return(0,l.Z)(function*(){let o=!1;if(0===e.productId){const n=e.productTypesSaved&&e.productTypesSaved.length,r=e.productTypes&&e.productTypes.length;n&&r?o=JSON.stringify(e.productTypesSaved)!==JSON.stringify(e.productTypes):(r&&!n||!r&&n)&&(o=!0)}var r;if(!o)return e.callback?(e.callback(e.productTypesSaved),void e.navCtrl.back()):void e.modalCtrl.dismiss(e.productTypesSaved);yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-type.dismiss-with-data-warning"),buttons:[{text:e.translateService.instant("common.agree"),handler:(r=(0,l.Z)(function*(){if(e.callback)return e.callback(e.productTypesSaved),void e.navCtrl.back();e.modalCtrl.dismiss(e.productTypesSaved)}),function(){return r.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}save(){if(this.callback)return this.callback(this.productTypes),void this.navCtrl.back();this.modalCtrl.dismiss(this.productTypes)}removeProductType(e,o){var n=this;return(0,l.Z)(function*(){var a;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("product-type.delete-warning"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,l.Z)(function*(){if(0===n.productId)return void n.productTypes.splice(o,1);const d=yield n.navCtrl.loading();n.productService.deleteProductType(e).then((0,l.Z)(function*(){yield d.dismiss(),n.analyticsService.logEvent("product-type-delete-success"),n.navCtrl.publish("reloadProductTypes"),n.navCtrl.publish("reloadProduct",{id:n.productId})})).catch(function(){var u=(0,l.Z)(function*(p){console.error(p),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}())}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}removeProductTypeValue(e,o){var n=this;return(0,l.Z)(function*(){var a;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("product-type.delete-value-warning"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,l.Z)(function*(){if(0===n.productId)return void n.productTypes.splice(o,1);const d=yield n.navCtrl.loading();n.productService.deleteProductTypeValue(e).then((0,l.Z)(function*(){yield d.dismiss(),n.analyticsService.logEvent("product-type-delete-value-success"),n.navCtrl.publish("reloadProductTypes"),n.navCtrl.publish("reloadProduct",{id:n.productId})})).catch(function(){var u=(0,l.Z)(function*(p){console.error(p),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}())}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}selectProductType(e){var o=this;return(0,l.Z)(function*(){o.analyticsService.logEvent("product-type-open-update"),yield o.navCtrl.push("/product/add-type",{callback:()=>{},productId:o.productId,productTypeId:e.id,productTypeToEdit:e})})()}selectProductTypeValue(e,o){var n=this;return(0,l.Z)(function*(){n.analyticsService.logEvent("product-type-open-value-update"),yield n.navCtrl.push("/product/add-type-value",{callback:()=>{},productId:n.productId,productTypeId:o,productAttributeId:e.id,productAttributeToEdit:e})})()}productName(e,o){return Z.W.productName(e,o)}openProductTypeAdd(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-type-open-add"),yield e.navCtrl.push("/product/add-type",{callback:n=>{!n||0===e.productId&&(e.productTypes||(e.productTypes=[]),n.orderIndex=e.productTypes.length+1,e.productTypes.push(n),e.originalProductTypes||(e.originalProductTypes=[]),e.originalProductTypes.push(n))},productId:e.productId,productTypeId:0,lastOrderIndex:e.productTypes?e.productTypes.length:0})})()}addTypeValue(e){var o=this;return(0,l.Z)(function*(){o.analyticsService.logEvent("product-type-open-value-add"),yield o.navCtrl.push("/product/add-type-value",{callback:r=>{!r||0===o.productId&&(e.values||(e.values=[]),r.orderIndex=e.values.length+1,e.values.push(r))},productId:o.productId,productTypeId:e.id,lastOrderIndex:e.values?e.values.length:0,productAttributeId:0})})()}copy(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-type.copy-alert"),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){e.continueCopy()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}continueCopy(){var e=this;return(0,l.Z)(function*(){const o=function(){var n=(0,l.Z)(function*(r){if(!r)return;const a=yield e.productService.getProductTypes(r.id),d=yield e.productService.getProductTypeValues(r.id);if(a&&a.length){for(const u of d){let p=a.find(_=>_.id===u.productTypeId);!p||(p.values||(p.values=[]),u.productId=e.productId,u.id=0,p.values.push(u))}if(e.productId>0){const u=[];for(const _ of a)_.id=0,_.productId=e.productId,u.push(e.productService.saveProductType(_));yield Promise.all(u);const p=[];for(const _ of a)if(_&&_.values)for(const g of _.values)g.productId=e.productId,g.productTypeId=_.id,p.push(e.productService.saveProductTypeValue(g));yield Promise.all(p),e.analyticsService.logEvent("product-type-copied-types-from-edit"),e.navCtrl.publish("reloadProductTypes"),e.navCtrl.publish("reloadProduct",{id:e.productId})}else for(const u of a)u.id=0,u.productId=0,e.productTypes||(e.productTypes=[]),e.originalProductTypes||(e.originalProductTypes=[]),e.originalProductTypes.push(u),e.productTypes.push(u),e.analyticsService.logEvent("product-type-copied-types-from-quick-add")}});return function(a){return n.apply(this,arguments)}}();e.navCtrl.push("/product",{callback:o,searchMode:!0})})()}up(e,o){var n=this;return(0,l.Z)(function*(){const r=yield n.navCtrl.loading(),a=[];n.productTypes[o].orderIndex=o-1,n.productTypes[o-1].orderIndex=o,n.productId>0&&(a.push(n.productService.saveProductType(n.productTypes[o])),a.push(n.productService.saveProductType(n.productTypes[o-1])));for(let d=o+1;d<n.productTypes.length;d++)n.productTypes[d].orderIndex=d,n.productId>0&&a.push(n.productService.saveProductType(n.productTypes[d]));0===n.productId?n.productTypes=n.sortByOrderIndex(n.productTypes):(yield Promise.all(a),yield n.reloadProductTypes()),yield r.dismiss()})()}down(e,o){var n=this;return(0,l.Z)(function*(){const r=yield n.navCtrl.loading(),a=[];n.productTypes[o].orderIndex=o+1,n.productTypes[o+1].orderIndex=o,n.productId>0&&(a.push(n.productService.saveProductType(n.productTypes[o])),a.push(n.productService.saveProductType(n.productTypes[o+1])));for(let d=o+2;d<n.productTypes.length;d++)n.productTypes[d].orderIndex=d,n.productId>0&&a.push(n.productService.saveProductType(n.productTypes[d]));0===n.productId?n.productTypes=n.sortByOrderIndex(n.productTypes):(yield Promise.all(a),yield n.reloadProductTypes()),yield r.dismiss()})()}upValue(e,o,n){var r=this;return(0,l.Z)(function*(){const a=yield r.navCtrl.loading(),d=[],u=r.productTypes[o];u.values[n].orderIndex=n-1,u.values[n-1].orderIndex=n,r.productId>0&&(d.push(r.productService.saveProductTypeValue(u.values[n])),d.push(r.productService.saveProductTypeValue(u.values[n-1])));for(let p=n+1;p<u.values.length;p++)u.values[p].orderIndex=p,r.productId>0&&d.push(r.productService.saveProductTypeValue(u.values[p]));r.productId>0?(yield Promise.all(d),yield r.reloadProductTypes()):u.values=r.sortByOrderIndex(u.values),yield a.dismiss()})()}downValue(e,o,n){var r=this;return(0,l.Z)(function*(){const a=yield r.navCtrl.loading(),d=[],u=r.productTypes[o];u.values[n].orderIndex=n+1,u.values[n+1].orderIndex=n,r.productId>0&&(d.push(r.productService.saveProductTypeValue(u.values[n])),d.push(r.productService.saveProductTypeValue(u.values[n+1])));for(let p=n+2;p<u.values.length;p++)u.values[p].orderIndex=p,r.productId>0&&d.push(r.productService.saveProductTypeValue(u.values[p]));r.productId>0?(yield Promise.all(d),yield r.reloadProductTypes()):u.values=r.sortByOrderIndex(u.values),yield a.dismiss()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(s.IN),t.Y36(E.K),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(b.sK),t.Y36(s.Br))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-type"]],inputs:{productId:"productId",productTypesSaved:"productTypesSaved"},decls:22,vars:13,consts:[["slot","start"],[3,"click"],["name","close"],[1,"ion-text-start",2,"font-weight","bold"],["slot","end"],["size","large","color","primary",3,"hidden","click"],["name","add-circle"],["size","large","color","primary",3,"click"],["name","copy"],["size","large","color","primary",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",3,"hidden"],["name","add"],["name","checkmark"],[1,"ion-text-wrap"],[2,"white-space","pre-wrap","font-weight","bold"],["name","pricetag"],["name","calendar"],["text-wrap","","color","light"],["size","small","fill","clear",2,"--padding-end","0","--padding-start","0",3,"disabled","click"],["name","caret-up"],["size","small","fill","clear",2,"--padding-end","10px","--padding-start","0",3,"disabled","click"],["name","caret-down"],[2,"white-space","pre-wrap"],["slot","end",3,"hidden"],["name","create-outline"],["size","large","color","danger",3,"click"],["name","trash-outline"],["text-wrap","",4,"ngFor","ngForOf"],["color","primary"],["text-wrap",""],["color","primary",4,"ngIf"],["name","close-outline"],[3,"innerHTML"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-label",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",4)(9,"ion-button",5),t.NdJ("click",function(){return o.openProductTypeAdd()}),t._UZ(10,"ion-icon",6),t.qZA(),t.TgZ(11,"ion-button",7),t.NdJ("click",function(){return o.copy()}),t._UZ(12,"ion-icon",8),t.qZA(),t.YNc(13,Ac,4,3,"ion-button",9),t.qZA()()(),t.TgZ(14,"ion-content")(15,"ion-list"),t.YNc(16,yc,14,21,"ion-item",10),t.YNc(17,kc,20,7,"ng-container",11),t.YNc(18,qc,3,3,"ion-item",12),t.qZA(),t.TgZ(19,"ion-fab",13)(20,"ion-fab-button",1),t.NdJ("click",function(){return o.openProductTypeAdd()}),t._UZ(21,"ion-icon",14),t.qZA()()()),2&e&&(t.xp6(6),t.hij(" ",t.lcZ(7,11,"product-type.title")," "),t.xp6(3),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()),t.xp6(4),t.Q6J("ngIf",0===o.productId),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(2),t.Q6J("ngIf",o.product),t.xp6(1),t.Q6J("ngForOf",o.productTypes),t.xp6(1),t.Q6J("ngIf",!o.originalProductTypes||0===o.originalProductTypes.length),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"margin-bottom: 60px":""),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()))},dependencies:[T.sg,T.O5,s.YG,s.Sm,s.W2,s.IJ,s.W4,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.yW,s.sr,T.H9,b.X$],encapsulation:2}),i})(),Uc=(()=>{class i{constructor(e,o,n,r,a){this.navCtrl=e,this.staffService=o,this.productService=n,this.analyticsService=r,this.modalController=a,this.productId=0,this.productTypeId=0,this.lastOrderIndex=0,this.productType={},this.isNew=!0,this.saveDisabled=!1,this.onKeyPress=d=>{!d.target||"body"!==d.target.localName||("s"===d.key||"S"===d.key)&&this.save()}}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-type-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct()){if(e.params=e.navCtrl.getParams(e.params),e.params&&e.params.callback&&(e.callback=e.params.callback),e.params&&e.params.productTypeToEdit&&(e.productTypeToEdit=e.params.productTypeToEdit),e.params&&e.params.productTypeId&&(e.productTypeId=e.params.productTypeId),e.params&&e.params.productId&&(e.productId=e.params.productId),e.params&&e.params.lastOrderIndex&&(e.lastOrderIndex=e.params.lastOrderIndex),e.productType={id:e.productTypeToEdit?e.productTypeToEdit.id:0,title:e.productTypeToEdit?e.productTypeToEdit.title:null,productId:e.productTypeToEdit?e.productTypeToEdit.productId:0},e.productTypeId&&e.productTypeId>0&&(e.isNew=!1),e.productTypeId&&e.productTypeId>0){const o=yield e.navCtrl.loading();e.productService.getProductType(e.productTypeId).then(function(){var n=(0,l.Z)(function*(r){yield o.dismiss(),e.productType=r});return function(r){return n.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield o.dismiss()}))}}else e.navCtrl.pop()})()}save(){var e=this;return(0,l.Z)(function*(){if(e.saveDisabled=!0,0===e.productId?e.productTypeToEdit&&(e.productTypeToEdit.title=e.productType.title,e.productTypeToEdit.multiChoice=e.productType.multiChoice):(e.productType.productId=e.productId,0===e.productTypeId&&(e.productType.orderIndex=e.lastOrderIndex+1),yield e.productService.saveProductType(e.productType).then((0,l.Z)(function*(){e.analyticsService.logEvent("product-type-add-save-success"),e.navCtrl.publish("reloadProductTypes"),e.navCtrl.publish("reloadProductType",e.productType),e.productId>0&&e.navCtrl.publish("reloadProduct",{id:e.productId})}))),e.callback)return e.callback(e.productType),void(yield e.navCtrl.back());e.modalController.dismiss(e.productType)})()}dismiss(){var e=this;return(0,l.Z)(function*(){if(e.callback)return e.callback(null),void(yield e.navCtrl.back());e.modalController.dismiss()})()}selectAll(e){Z.W.selectAll(e)}isNotCordova(){return this.navCtrl.isNotCordova()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(s.IN))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-type-add"]],inputs:{productId:"productId",productTypeId:"productTypeId",productTypeToEdit:"productTypeToEdit"},decls:29,vars:23,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["size","large","color","success",3,"disabled","click"],["name","checkmark"],["position","stacked","color","primary"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["color","primary",3,"ngModel","ngModelChange"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",3)(9,"ion-button",4),t.NdJ("click",function(){return o.save()}),t._UZ(10,"ion-icon",5),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item")(16,"ion-label",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-input",7),t.NdJ("ngModelChange",function(r){return o.productType.title=r}),t.ALo(20,"translate"),t.qZA()(),t.TgZ(21,"ion-item")(22,"ion-label",6),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"ion-toggle",8),t.NdJ("ngModelChange",function(r){return o.productType.multiChoice=r}),t.qZA(),t.TgZ(26,"p"),t._uU(27),t.ALo(28,"translate"),t.qZA()()()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,11,"product-type-add.title")),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(12,13,"action.save")," "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(4),t.Oqu(t.lcZ(18,15,"product-type-add.product-type-title")),t.xp6(2),t.s9C("placeholder",t.lcZ(20,17,"product-type-add.enter-title")),t.Q6J("ngModel",o.productType.title),t.xp6(4),t.Oqu(t.lcZ(24,19,"product-type-add.product-type-multichoice")),t.xp6(2),t.Q6J("ngModel",o.productType.multiChoice),t.xp6(2),t.Oqu(t.lcZ(28,21,"product-type-add.product-type-multichoice-description")))},dependencies:[P.JJ,P.On,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.ho,s.sr,s.w,s.j9,b.X$],encapsulation:2}),i})();function Ic(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("(",e.currency,")")}}let Jc=(()=>{class i{constructor(e,o,n,r,a,d){this.navCtrl=e,this.staffService=o,this.productService=n,this.userService=r,this.analyticsService=a,this.modalController=d,this.productId=0,this.productTypeId=0,this.productAttributeId=0,this.lastOrderIndex=0,this.productTypeValue={},this.isNew=!0,this.saveDisabled=!1,this.onKeyPress=u=>{!u.target||"body"!==u.target.localName||("s"===u.key||"S"===u.key)&&this.save()}}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-type-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct()){if(e.currency=yield e.userService.getAttr("current-currency"),e.params=e.navCtrl.getParams(e.params),e.params&&e.params.callback&&(e.callback=e.params.callback),e.params&&e.params.productAttributeToEdit&&(e.productAttributeToEdit=e.params.productAttributeToEdit),e.params&&e.params.productAttributeId&&(e.productAttributeId=e.params.productAttributeId),e.params&&e.params.productTypeId&&(e.productTypeId=e.params.productTypeId),e.params&&e.params.productId&&(e.productId=e.params.productId),e.params&&e.params.lastOrderIndex&&(e.lastOrderIndex=e.params.lastOrderIndex),e.productTypeValue={id:e.productAttributeToEdit?e.productAttributeToEdit.id:0,title:e.productAttributeToEdit?e.productAttributeToEdit.title:null,productId:e.productAttributeToEdit?e.productAttributeToEdit.productId:0,productTypeId:e.productAttributeToEdit?e.productAttributeToEdit.productTypeId:0,price:e.productAttributeToEdit?e.productAttributeToEdit.price:0,isAddedToPrice:!!e.productAttributeToEdit&&e.productAttributeToEdit.isAddedToPrice,selectOnly:!e.productAttributeToEdit||e.productAttributeToEdit.selectOnly},e.productAttributeId&&e.productAttributeId>0&&(e.isNew=!1),e.productAttributeId&&e.productAttributeId>0){const o=yield e.navCtrl.loading();e.productService.getProductTypeValue(e.productAttributeId).then(function(){var n=(0,l.Z)(function*(r){yield o.dismiss(),e.productTypeValue=r});return function(r){return n.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield o.dismiss()}))}}else e.navCtrl.pop()})()}save(){var e=this;return(0,l.Z)(function*(){if(e.saveDisabled=!0,0===e.productId?e.productAttributeToEdit&&(e.productAttributeToEdit.title=e.productTypeValue.title,e.productAttributeToEdit.price=e.productTypeValue.price,e.productAttributeToEdit.isAddedToPrice=e.productTypeValue.isAddedToPrice,e.productAttributeToEdit.selectOnly=e.productTypeValue.selectOnly):(e.productTypeValue.productId=e.productId,e.productTypeValue.productTypeId=e.productTypeId,0===e.productAttributeId&&(e.productTypeValue.orderIndex=e.lastOrderIndex+1),yield e.productService.saveProductTypeValue(e.productTypeValue).then((0,l.Z)(function*(){e.analyticsService.logEvent("product-type-add-save-success"),e.navCtrl.publish("reloadProductTypes"),e.navCtrl.publish("reloadProductType",e.productTypeValue),e.productId>0&&e.navCtrl.publish("reloadProduct",{id:e.productId})}))),e.callback)return e.callback(e.productTypeValue),void(yield e.navCtrl.back());e.modalController.dismiss(e.productTypeValue)})()}dismiss(){var e=this;return(0,l.Z)(function*(){if(e.callback)return e.callback(null),void(yield e.navCtrl.back());e.modalController.dismiss()})()}selectAll(e){Z.W.selectAll(e)}isNotCordova(){return this.navCtrl.isNotCordova()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(A.x),t.Y36(N.M),t.Y36(E.K),t.Y36(Q.y),t.Y36(s.IN))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-type-value-add"]],inputs:{productId:"productId",productTypeId:"productTypeId",productAttributeId:"productAttributeId",productAttributeToEdit:"productAttributeToEdit"},decls:47,vars:42,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["size","large","color","success",3,"disabled","click"],["name","checkmark"],["position","stacked","color","primary"],["clearInput","","type","text",3,"placeholder","ngModel","ngModelChange"],[4,"ngIf"],[3,"clear","placeholder","moneyValue","moneyValueChange"],["color","primary",3,"ngModel","ngModelChange"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",3)(9,"ion-button",4),t.NdJ("click",function(){return o.save()}),t._UZ(10,"ion-icon",5),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item")(16,"ion-label",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-input",7),t.NdJ("ngModelChange",function(r){return o.productTypeValue.title=r}),t.ALo(20,"translate"),t.qZA()(),t.TgZ(21,"ion-item")(22,"ion-label",6),t._uU(23),t.ALo(24,"translate"),t.YNc(25,Ic,2,1,"span",8),t.qZA(),t.TgZ(26,"money-input",9),t.NdJ("moneyValueChange",function(r){return o.productTypeValue.price=r}),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"p"),t._uU(29),t.ALo(30,"translate"),t.qZA()(),t.TgZ(31,"ion-item")(32,"ion-label",6),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"ion-toggle",10),t.NdJ("ngModelChange",function(r){return o.productTypeValue.isAddedToPrice=r}),t.qZA(),t.TgZ(36,"p"),t._uU(37),t.ALo(38,"translate"),t.qZA()(),t.TgZ(39,"ion-item")(40,"ion-label",6),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"ion-toggle",10),t.NdJ("ngModelChange",function(r){return o.productTypeValue.selectOnly=r}),t.qZA(),t.TgZ(44,"p"),t._uU(45),t.ALo(46,"translate"),t.qZA()()()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,20,"product-type-value-add.title")),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(12,22,"action.save")," "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(4),t.Oqu(t.lcZ(18,24,"product-type-value-add.product-type-title")),t.xp6(2),t.s9C("placeholder",t.lcZ(20,26,"product-type-value-add.enter-title")),t.Q6J("ngModel",o.productTypeValue.title),t.xp6(4),t.hij("",t.lcZ(24,28,"product-type-value-add.price")," "),t.xp6(2),t.Q6J("ngIf",o.currency),t.xp6(1),t.s9C("placeholder",t.lcZ(27,30,"product-type-value-add.enter-price")),t.Q6J("clear",!0)("moneyValue",o.productTypeValue.price),t.xp6(3),t.Oqu(t.lcZ(30,32,"product-type-value-add.price-description")),t.xp6(4),t.Oqu(t.lcZ(34,34,"product-type-value-add.is-added-to-price")),t.xp6(2),t.Q6J("ngModel",o.productTypeValue.isAddedToPrice),t.xp6(2),t.Oqu(t.lcZ(38,36,"product-type-value-add.is-added-to-price-description")),t.xp6(4),t.Oqu(t.lcZ(42,38,"product-type-value-add.select-only")),t.xp6(2),t.Q6J("ngModel",o.productTypeValue.selectOnly),t.xp6(2),t.Oqu(t.lcZ(46,40,"product-type-value-add.select-only-description")))},dependencies:[T.O5,P.JJ,P.On,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.ho,s.sr,s.w,s.j9,ot.F,b.X$],encapsulation:2}),i})();const Mc=["barcodeInput"];function Qc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-buttons")(2,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.viewTypes())}),t._UZ(3,"ion-icon",11),t.TgZ(4,"ion-text"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()}2&i&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"type-selector.edit-types")))}const W=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function Lc(i,c){if(1&i&&(t.TgZ(0,"ion-text",16),t._UZ(1,"br"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",t.lcZ(3,2,"type-selector.changed-price"),": ",t.G7q(4,4,t.kEZ(10,W,e.mainProduct.changedPrice,e.currency,e.translateService.currentLang))," ")}}function Ec(i,c){if(1&i&&(t.TgZ(0,"ion-avatar",3),t._UZ(1,"img",17),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.mainProduct.avatarUrl,t.LSH)}}function Oc(i,c){if(1&i&&(t.TgZ(0,"ion-item",12)(1,"ion-text",13)(2,"strong"),t._uU(3),t.qZA(),t._UZ(4,"br"),t._uU(5),t.ALo(6,"translate"),t.ALo(7,"currency"),t.YNc(8,Lc,5,14,"ion-text",14),t.qZA(),t.YNc(9,Ec,2,1,"ion-avatar",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("color",e.mainProduct.count>0?"primary":"normal"),t.xp6(2),t.Oqu(e.productName(e.mainProduct.code,e.mainProduct.title)),t.xp6(2),t.AsE(" ",t.lcZ(6,6,"type-selector.price"),": ",t.G7q(7,8,t.kEZ(14,W,e.mainProduct.price,e.currency,e.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.mainProduct.changedPrice),t.xp6(1),t.Q6J("ngIf",e.mainProduct.avatarUrl)}}function Yc(i,c){1&i&&(t.TgZ(0,"span",20),t._UZ(1,"br"),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"product-type.allow-multi-choice")))}function Fc(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Gc(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Fc,2,0,"span",6),t._uU(4),t.ALo(5,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"type-selector.value-price"),": "),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.Oqu(t.G7q(5,5,t.kEZ(11,W,e.price,o.currency,o.translateService.currentLang)))}}function Kc(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Hc(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function Dc(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Hc,2,0,"span",6),t._uU(4),t.ALo(5,"currency"),t.qZA()),2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.xp6(1),t.hij("| ",t.lcZ(2,3,"type-selector.amount"),": "),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.Oqu(t.G7q(5,5,t.kEZ(11,W,e.total,o.currency,o.translateService.currentLang)))}}function Bc(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t._uU(2),t.ALo(3,"translate"),t.YNc(4,Kc,2,0,"span",6),t._uU(5),t.YNc(6,Dc,6,15,"span",6),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,5,"type-selector.quantity-selected"),": "),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.AsE("",e.count," ",e.unit," "),t.xp6(1),t.Q6J("ngIf",e.price)}}function jc(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function $c(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t._uU(2),t.ALo(3,"translate"),t.YNc(4,jc,2,0,"span",6),t._uU(5),t.ALo(6,"currency"),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,3,"type-selector.amount"),": "),t.xp6(2),t.Q6J("ngIf",e.isAddedToPrice),t.xp6(1),t.hij("",t.G7q(6,5,t.kEZ(11,W,e.total,o.currency,o.translateService.currentLang))," ")}}function Vc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-toggle",24),t.NdJ("ngModelChange",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.changeSelected(n,r))})("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.selected=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.selected)}}function zc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",3)(1,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.decrease(n,r))}),t._UZ(2,"ion-icon",25),t.qZA(),t.TgZ(3,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.increase(n,r))}),t._UZ(4,"ion-icon",26),t.qZA()()}}function Wc(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",21)(1,"ion-text",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw().$implicit,d=t.oxw();return t.KtG(d.increase(r,a))}),t._uU(2),t.YNc(3,Gc,6,15,"span",6),t.YNc(4,Bc,7,7,"span",6),t.YNc(5,$c,7,15,"span",6),t.qZA(),t.YNc(6,Vc,1,1,"ion-toggle",23),t.YNc(7,zc,5,0,"ion-buttons",15),t.qZA()}if(2&i){const e=c.$implicit;t.xp6(1),t.Udp("font-weight",e.count>0?"bold":"normal"),t.Q6J("color",e.count>0?"primary":"normal"),t.xp6(1),t.hij(" ",e.title," "),t.xp6(1),t.Q6J("ngIf",e.price),t.xp6(1),t.Q6J("ngIf",!e.selectOnly),t.xp6(1),t.Q6J("ngIf",e.selectOnly&&e.price),t.xp6(1),t.Q6J("ngIf",e.selectOnly),t.xp6(1),t.Q6J("ngIf",!e.selectOnly)}}function Rc(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-item")(2,"ion-text")(3,"strong"),t._uU(4),t.qZA(),t.YNc(5,Yc,4,3,"span",18),t.qZA()(),t.YNc(6,Wc,8,9,"ion-item",19),t.BQk()),2&i){const e=c.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("ngIf",e.multiChoice),t.xp6(1),t.Q6J("ngForOf",e.values)}}function Xc(i,c){1&i&&(t.TgZ(0,"ion-item",27),t._UZ(1,"div",28),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"type-selector.no-types"),t.oJD))}let ta=(()=>{class i{constructor(e,o,n,r,a,d,u){var p=this;this.navCtrl=e,this.modalCtrl=o,this.userService=n,this.translateService=r,this.staffService=a,this.productService=d,this.analyticsService=u,this.types=[],this.originalTypes=[],this.searchKey="",this.tab="all",this.reloadTypes=(0,l.Z)(function*(){p.params=p.navCtrl.getParams(p.params),p.params&&(p.mainProduct=p.params.mainProduct,p.callback=p.params.callback);const _=yield p.navCtrl.loading();p.currency=yield p.userService.getAttr("current-currency"),p.productService.getProductTypes(p.mainProduct.id).then(function(){var g=(0,l.Z)(function*(m){const y=p.sortByOrderIndex(m),k=yield p.productService.getProductTypeValues(p.mainProduct.id);if(k&&k.length){const J=p.sortByOrderIndex(k);for(const U of J){const v=y.find(S=>S.id===U.productTypeId);if(!v)continue;const f=p.mainProduct.types?p.mainProduct.types.find(S=>S.id===U.productTypeId):null,w=f?f.values.find(S=>S.id===U.id):null;v.values||(v.values=[]),U.total=0,U.count=0,v.values.push(w||U)}}p.originalTypes=y,p.types=y,p.applyTotal(),yield _.dismiss(),p.barcodeFocus()});return function(m){return g.apply(this,arguments)}}())}),this.navCtrl.removeEventListener("reloadProductTypes",this.reloadTypes),this.navCtrl.addEventListener("reloadProductTypes",this.reloadTypes)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-type-selector")})()}tabChanged(){this.barcodeFocus()}barcodeFocus(){!this.navCtrl.isNotCordova()||"all"===this.tab&&setTimeout(()=>{typeof this.barcodeInput<"u"&&this.barcodeInput.setFocus()},600)}increase(e,o){var n=this;return(0,l.Z)(function*(){if(!o.multiChoice)for(const r of o.values)r.title!==e.title&&(r.count=0);e.count++,e.selected=!0,e.total=e.price?e.count*e.price:0,e.count>=2&&n.analyticsService.logEvent("product-option-selector-increase-2"),n.applyTotal(),n.barcodeFocus()})()}decrease(e,o){var n=this;return(0,l.Z)(function*(){if(e&&0===e.count)n.barcodeFocus();else{if(!o.multiChoice)for(const r of o.values)r.count=0,r.total=0;n.analyticsService.logEvent("product-option-selector-decrease"),e.count--,e.total=e.price?e.count*e.price:0,0===e.count&&(e.selected=!1),n.applyTotal(),n.barcodeFocus()}})()}ngOnInit(){this.reloadTypes()}dateFormat(e){return C.C.toUiString(e)}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-option-selector-search");let o=e.originalTypes;if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.title&&-1!==r.title.toLowerCase().indexOf(n)||r.code&&-1!==r.code.toLowerCase().indexOf(n))}e.types=o})()}clearSearch(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-option-selector-clear-search"),e.searchKey=null,e.types=e.originalTypes,e.barcodeFocus()})()}dismiss(){var e=this;return(0,l.Z)(function*(){if(e.callback)return e.callback(null),void(yield e.navCtrl.back());e.modalCtrl.dismiss()})()}ok(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-option-selector-ok"),e.callback)return e.callback({types:e.types,price:e.mainProduct.changedPrice,initPrice:e.mainProduct.price}),void e.navCtrl.back();e.modalCtrl.dismiss({types:e.types,price:e.mainProduct.changedPrice,initPrice:e.mainProduct.initPrice})})()}productName(e,o){return Z.W.productName(e,o)}sortByOrderIndex(e){return e?q.orderBy(e,["orderIndex"],["asc"]):null}changeSelected(e,o){if(!o.multiChoice&&e.count<=0)for(const n of o.values)n.id!==e.id&&n.count>0&&(n.count=0,n.total=0,n.selected=!1);e.count>0?(e.count=0,e.selected=!1):(e.count=1,e.selected=!0,e.total=e.price?e.count*e.price:0),this.applyTotal()}applyTotal(){let e=this.mainProduct.price,o=0;for(const n of this.types)for(const r of n.values)r.selected&&r.price&&(r.isAddedToPrice?o+=r.price*r.count:e=r.price);e+=o,this.mainProduct.changedPrice=e!==this.mainProduct.price?e:0}clear(){if(confirm(this.translateService.instant("type-selector.clear-alert"))){for(const e of this.types)for(const o of e.values)o.count=0,o.total=0,o.selected=!1;this.applyTotal()}}viewTypes(){var e=this;return(0,l.Z)(function*(){e.navCtrl.push("/product/type",{callback:()=>{},productId:e.mainProduct.id,product:e.mainProduct})})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(s.IN),t.Y36(E.K),t.Y36(b.sK),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-type-selector"]],viewQuery:function(e,o){if(1&e&&t.Gf(Mc,5),2&e){let n;t.iGM(n=t.CRH())&&(o.barcodeInput=n.first)}},inputs:{mainProduct:"mainProduct"},decls:21,vars:12,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["name","arrow-undo-outline"],["name","checkmark"],[4,"ngIf"],["text-wrap","","lines","none",4,"ngIf"],[4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["fill","clear",3,"click"],["slot","start","name","options"],["text-wrap","","lines","none"],[2,"padding-top","8px","padding-bottom","8px",3,"color"],["color","danger",4,"ngIf"],["slot","end",4,"ngIf"],["color","danger"],[3,"src"],["style","font-size: 0.8em;",4,"ngIf"],["style","padding-bottom: 8px;",4,"ngFor","ngForOf"],[2,"font-size","0.8em"],[2,"padding-bottom","8px"],[2,"font-size","0.8em",3,"color","click"],["slot","end",3,"ngModel","ngModelChange",4,"ngIf"],["slot","end",3,"ngModel","ngModelChange"],["slot","icon-only","size","large","name","remove"],["slot","icon-only","size","large","name","add"],["text-wrap",""],[3,"innerHTML"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",3)(9,"ion-button",1),t.NdJ("click",function(){return o.clear()}),t._UZ(10,"ion-icon",4),t.qZA(),t.TgZ(11,"ion-button",1),t.NdJ("click",function(){return o.ok()}),t._UZ(12,"ion-icon",5),t._uU(13),t.ALo(14,"translate"),t.qZA()()(),t.YNc(15,Qc,7,3,"ion-item",6),t.YNc(16,Oc,10,18,"ion-item",7),t.qZA(),t.TgZ(17,"ion-content")(18,"ion-list"),t.YNc(19,Rc,7,3,"ng-container",8),t.YNc(20,Xc,3,3,"ion-item",9),t.qZA()()),2&e&&(t.xp6(6),t.hij(" ",t.lcZ(7,8,"type-selector.title")," "),t.xp6(7),t.hij("\xa0",t.lcZ(14,10,"action.save")," "),t.xp6(2),t.Q6J("ngIf",o.staffService.canAddUpdateProduct()),t.xp6(1),t.Q6J("ngIf",o.mainProduct),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(2),t.Q6J("ngForOf",o.types),t.xp6(1),t.Q6J("ngIf",!o.originalTypes||0===o.originalTypes.length))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.BJ,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.Ie,s.q_,s.yW,s.wd,s.ho,s.sr,s.w,T.H9,b.X$],encapsulation:2}),i})();const ea=["barcodeInput"];function oa(i,c){if(1&i&&(t.TgZ(0,"ion-select-option",13),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.Q6J("value",e.unit),t.xp6(1),t.Oqu(e.unit)}}function na(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-select",12),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.productBarcode.unit=n)}),t.ALo(5,"translate"),t.TgZ(6,"ion-select-option",13),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.YNc(9,oa,2,2,"ion-select-option",14),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,6,"product-add.unit")),t.xp6(2),t.s9C("placeholder",t.lcZ(5,8,"product-add.enter-unit")),t.Q6J("ngModel",e.productBarcode.unit),t.xp6(2),t.Q6J("value",null),t.xp6(1),t.Oqu(t.lcZ(8,10,"product-add.no-select-unit")),t.xp6(2),t.Q6J("ngForOf",e.units)}}let _t=(()=>{class i{constructor(e,o,n,r,a,d,u){this.navCtrl=e,this.staffService=o,this.productService=n,this.analyticsService=r,this.translateService=a,this.modalController=d,this.barcodeScanner=u,this.productId=0,this.productBarcodeId=0,this.units=null,this.productBarcode={},this.isNew=!0,this.saveDisabled=!1,this.onKeyPress=p=>{!p.target||"body"!==p.target.localName||("s"===p.key||"S"===p.key)&&this.save()}}ionViewDidEnter(){this.navCtrl.addEventListener("keyup",this.onKeyPress)}ionViewWillLeave(){this.navCtrl.removeEventListener("keyup",this.onKeyPress)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-barcode-add")})()}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct()){if(e.productBarcode={id:e.productBarcodeToEdit?e.productBarcodeToEdit.id:0,barcode:e.productBarcodeToEdit?e.productBarcodeToEdit.barcode:null,productId:e.productBarcodeToEdit?e.productBarcodeToEdit.productId:0,unit:e.productBarcodeToEdit?e.productBarcodeToEdit.unit:null},e.productBarcodeId&&e.productBarcodeId>0&&(e.isNew=!1),e.productBarcodeId&&e.productBarcodeId>0){const o=yield e.navCtrl.loading();e.productService.getProductBarcode(e.productBarcodeId).then(function(){var n=(0,l.Z)(function*(r){yield o.dismiss(),e.productBarcode=r});return function(r){return n.apply(this,arguments)}}()).catch((0,l.Z)(function*(){yield o.dismiss()}))}}else e.navCtrl.pop()})()}save(){var e=this;return(0,l.Z)(function*(){if(e.saveDisabled=!0,yield e.productService.searchByBarcode(e.productBarcode.barcode)){e.analyticsService.logEvent("product-quick-add-duplicated-barcode");const n=e.translateService.instant("product-add.duplicate-barcode-alert",{barcode:e.productBarcode.barcode});return alert(n),void(e.saveDisabled=!1)}if(0===e.productId)return e.productBarcodeToEdit&&(e.productBarcodeToEdit.barcode=e.productBarcode.barcode,e.productBarcodeToEdit.unit=e.productBarcode.unit),void e.modalController.dismiss(e.productBarcode);e.productBarcode.productId=e.productId,e.productService.saveProductBarcode(e.productBarcode).then((0,l.Z)(function*(){e.analyticsService.logEvent("product-barcode-add-save-success"),e.exitPage()}))})()}exitPage(){var e=this;return(0,l.Z)(function*(){e.navCtrl.publish("reloadProductBarcodes"),e.navCtrl.publish("reloadProductBarcode",e.productBarcode),e.productId>0&&e.navCtrl.publish("reloadProduct",{id:e.productId}),e.modalController.dismiss(e.productBarcode)})()}dismiss(){this.modalController.dismiss()}selectAll(e){Z.W.selectAll(e)}isNotCordova(){return this.navCtrl.isNotCordova()}scan(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-add-scanbarcode"),e.navCtrl.isNotCordova()){const o=Math.random().toString(36).substring(7);e.productBarcode.barcode=o}else e.barcodeScanner.scan().then(o=>{!o||!o.text||(e.productBarcode.barcode=o.text)})})()}autoGenBarcode(){const e=Math.random().toString(36).substring(7);this.productBarcode.barcode=e}barcodeFocus(){setTimeout(()=>{this.barcodeInput.setFocus()},500)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(b.sK),t.Y36(s.IN),t.Y36(I.m))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-barcode-add"]],viewQuery:function(e,o){if(1&e&&t.Gf(ea,7),2&e){let n;t.iGM(n=t.CRH())&&(o.barcodeInput=n.first)}},inputs:{productId:"productId",productBarcodeId:"productBarcodeId",productBarcodeToEdit:"productBarcodeToEdit",units:"units"},decls:32,vars:23,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],["size","large","color","success",3,"disabled","click"],["name","checkmark"],["position","stacked","color","primary"],["clearInput","","autofocus","","type","text",3,"placeholder","ngModel","ngModelChange","focus"],["barcodeInput",""],["name","barcode"],["color","secondary",3,"click"],[4,"ngIf"],[3,"placeholder","ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",3)(9,"ion-button",4),t.NdJ("click",function(){return o.save()}),t._UZ(10,"ion-icon",5),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"ion-content")(14,"ion-list")(15,"ion-item")(16,"ion-label",6),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-input",7,8),t.NdJ("ngModelChange",function(r){return o.productBarcode.barcode=r})("focus",function(r){return o.selectAll(r)}),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"ion-item")(23,"ion-button",1),t.NdJ("click",function(){return o.scan()}),t._UZ(24,"ion-icon",9),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"ion-button",10),t.NdJ("click",function(){return o.autoGenBarcode()}),t._UZ(28,"ion-icon",9),t._uU(29),t.ALo(30,"translate"),t.qZA()(),t.YNc(31,na,10,12,"ion-item",11),t.qZA()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,11,"product-barcode-add.title")),t.xp6(3),t.Q6J("disabled",o.saveDisabled),t.xp6(2),t.hij(" \xa0",t.lcZ(12,13,"action.save")," "),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(4),t.Oqu(t.lcZ(18,15,"product-barcode-add.enter-barcode")),t.xp6(2),t.s9C("placeholder",t.lcZ(21,17,"product-barcode-add.enter-barcode-placeholder")),t.Q6J("ngModel",o.productBarcode.barcode),t.xp6(6),t.hij(" ",t.lcZ(26,19,"product.scan-barcode")," "),t.xp6(4),t.hij(" ",t.lcZ(30,21,"product.auto-gen-barcode")," "),t.xp6(2),t.Q6J("ngIf",o.units&&o.units.length))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.t9,s.n0,s.wd,s.sr,s.QI,s.j9,b.X$],encapsulation:2}),i})();function ia(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save())}),t._UZ(1,"ion-icon",14),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij("\xa0",t.lcZ(3,1,"action.save")," "))}function ra(i,c){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.AsE("",t.lcZ(2,2,"product-add.unit"),": ",e.unit,"")}}function ca(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",15)(1,"ion-label",1),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProduct(r))}),t.TgZ(2,"span",16),t._uU(3),t.qZA(),t.YNc(4,ra,3,4,"p",17),t.qZA(),t.TgZ(5,"ion-buttons",18)(6,"ion-button",13),t.NdJ("click",function(){const n=t.CHM(e),r=n.$implicit,a=n.index,d=t.oxw();return t.KtG(d.removeProductBarcode(r,a))}),t._UZ(7,"ion-icon",19),t.qZA(),t.TgZ(8,"ion-button",13),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProduct(r))}),t._UZ(9,"ion-icon",20),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw();t.xp6(3),t.hij("",e.barcode," "),t.xp6(1),t.Q6J("ngIf",e.unit),t.xp6(1),t.Q6J("hidden",!o.staffService.canAddUpdateProduct())}}function aa(i,c){1&i&&(t.TgZ(0,"ion-item",15),t._UZ(1,"div",21),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"product-barcode.no-product-barcode"),t.oJD))}function da(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",26)(1,"ion-label",27),t._uU(2),t.qZA(),t.TgZ(3,"ion-buttons")(4,"ion-button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exitStore())}),t._UZ(5,"ion-icon",29),t._uU(6),t.ALo(7,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.checkStore),t.xp6(4),t.hij(" ",t.lcZ(7,2,"store.exit-store")," ")}}function la(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",30)(1,"p",31),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.navCtrl.push("/request-pro"))}),t._UZ(5,"ion-icon",33),t._uU(6),t.ALo(7,"translate"),t.qZA()()}2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"product.no-pro-plan")),t.xp6(4),t.hij("\xa0 ",t.lcZ(7,4,"home.request-pro-plan")," "))}function ua(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function _a(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",47),t.qZA(),t.TgZ(3,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",48),t.qZA()()}}function pa(i,c){if(1&i&&(t.TgZ(0,"ion-item",35)(1,"ion-label",44),t._uU(2),t.ALo(3,"translate"),t.YNc(4,ua,3,4,"span",20),t.qZA(),t.YNc(5,_a,5,0,"ion-buttons",45),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function ma(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-checkbox",49),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.isSelectAll=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.selectAll())}),t.qZA(),t.TgZ(2,"ion-buttons")(3,"ion-button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.multiDelete())}),t._uU(4),t.ALo(5,"translate"),t._UZ(6,"ion-icon",51),t.qZA(),t.TgZ(7,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exitSelectMode())}),t._uU(8),t.ALo(9,"translate"),t._UZ(10,"ion-icon",52),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.isSelectAll),t.xp6(3),t.hij(" ",t.lcZ(5,3,"product-detail.delete-multi")," "),t.xp6(4),t.hij(" ",t.lcZ(9,5,"product-detail.exit-select-mode")," ")}}function ga(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",58),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.isSelected=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.isSelected)}}const B=function(i,c,e){return[i,c,"symbol","1.0-2",e]};function fa(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3).$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,B,e.costPrice,o.currency,o.translateService.currentLang)))}}function xa(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function ha(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,fa,3,11,"span",20),t.YNc(4,xa,2,0,"span",20),t.qZA()),2&i){const e=t.oxw(4);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function Za(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function Ta(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function Aa(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-text"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"currency"),t.qZA(),t.YNc(5,ha,5,5,"span",20),t.TgZ(6,"span"),t.YNc(7,Za,2,0,"span",20),t.YNc(8,Ta,2,0,"span",20),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.AsE(" ",t.lcZ(3,8,"product-detail.product-unit-price"),": ",t.G7q(4,10,t.kEZ(18,B,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice),t.xp6(2),t.Q6J("ngIf",e.costPrice),t.xp6(1),t.Q6J("ngIf",!e.costPrice),t.xp6(1),t.lnq("",t.lcZ(10,16,"product-detail.product-quantity"),": ",o.store?e.storeQuantity?e.storeQuantity:0:e.count," ",e.unit,"")}}function Ca(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const e=t.oxw(3).$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.G7q(2,1,t.kEZ(7,B,e.costPrice,o.currency,o.translateService.currentLang)))}}function ya(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1,"***"),t.qZA())}function ba(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.YNc(3,Ca,3,11,"span",20),t.YNc(4,ya,2,0,"span",20),t.qZA()),2&i){const e=t.oxw(4);t.xp6(1),t.hij(" - ",t.lcZ(2,3,"product-add.cost-price"),": "),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(1),t.Q6J("ngIf",!e.canViewProductCostPrice)}}function va(i,c){1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.qZA())}function Pa(i,c){1&i&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function Sa(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._uU(4,"\xa0-\xa0 "),t.TgZ(5,"ion-text"),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"currency"),t.qZA(),t.YNc(9,ba,5,5,"span",20),t.TgZ(10,"span"),t.YNc(11,va,2,0,"span",20),t.YNc(12,Pa,2,0,"span",20),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,9,"product-add.unit"),": ",e.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(7,11,"product-detail.product-unit-price"),": ",t.G7q(8,13,t.kEZ(21,B,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(3),t.Q6J("ngIf",e.costPrice),t.xp6(2),t.Q6J("ngIf",e.costPrice),t.xp6(1),t.Q6J("ngIf",!e.costPrice),t.xp6(1),t.AsE("",t.lcZ(14,19,"product-detail.product-quantity"),": ",o.store?e.storeQuantity?e.storeQuantity:0:e.count,"")}}function wa(i,c){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._UZ(3,"ion-icon",59),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(4),t.AsE(" \xa0",t.lcZ(5,2,"product-add.expired-date"),": ",o.dateFormat(e.expiredAt)," ")}}function ka(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",4),t._UZ(1,"img",60),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function qa(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",62),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.selectProduct(n.id))})("press",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.presentActionSheet(n))}),t.TgZ(1,"ion-label",63)(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._uU(5,"\xa0-\xa0 "),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA()()()}if(2&i){const e=c.$implicit,o=c.index,n=t.oxw(2).$implicit,r=t.oxw(2);t.Q6J("lines",o===n.units.length-1?"":"none"),t.xp6(3),t.AsE("",t.lcZ(4,7,"product-add.unit"),": ",e.unit,""),t.xp6(4),t.AsE(" ",t.lcZ(8,9,"product-detail.product-unit-price"),": ",t.G7q(9,11,t.kEZ(19,B,e.price,r.currency,r.translateService.currentLang))," "),t.xp6(4),t.AsE(" - ",t.lcZ(12,17,"product-add.unit-exchange"),": ",e.exchange,"")}}function Na(i,c){if(1&i&&(t.ynx(0),t.YNc(1,qa,13,23,"ion-item",61),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.units)}}function Ua(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item-sliding")(2,"ion-item",53),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r.id))})("press",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))}),t.YNc(3,ga,1,1,"ion-checkbox",54),t.TgZ(4,"ion-label",27)(5,"span",55),t._uU(6),t.qZA(),t._UZ(7,"br"),t.YNc(8,Aa,11,22,"ng-container",20),t.YNc(9,Sa,15,25,"ng-container",20),t.YNc(10,wa,6,4,"span",20),t.qZA(),t.YNc(11,ka,2,1,"ion-thumbnail",45),t.qZA(),t.TgZ(12,"ion-item-options",56)(13,"ion-item-option",24),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))}),t._UZ(14,"ion-icon",57),t.qZA()()(),t.YNc(15,Na,2,1,"ng-container",20),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(3),t.Q6J("ngIf",o.selectMode),t.xp6(3),t.hij("",o.limitText(o.productName(e.code,e.title))," "),t.xp6(2),t.Q6J("ngIf",!e.units||!e.units.length),t.xp6(1),t.Q6J("ngIf",e.units&&e.units.length),t.xp6(1),t.Q6J("ngIf",e.expiredAt),t.xp6(1),t.Q6J("ngIf",e.avatarUrl),t.xp6(4),t.Q6J("ngIf",e&&e.units&&e.units.length)}}function Ia(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function Ja(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",47),t.qZA(),t.TgZ(3,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",48),t.qZA()()}}function Ma(i,c){if(1&i&&(t.TgZ(0,"ion-item",64)(1,"ion-label",44),t._uU(2),t.ALo(3,"translate"),t.YNc(4,Ia,3,4,"span",20),t.qZA(),t.YNc(5,Ja,5,0,"ion-buttons",45),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function Qa(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-grid")(2,"ion-row")(3,"ion-col",34)(4,"ion-item",35)(5,"ion-select",36),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.listOption=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeListOption())}),t.ALo(6,"translate"),t.TgZ(7,"ion-select-option",37),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ion-select-option",38),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"ion-select-option",39),t._uU(14),t.ALo(15,"translate"),t.qZA()()()(),t.TgZ(16,"ion-col",40),t.YNc(17,pa,6,6,"ion-item",41),t.qZA()()(),t.YNc(18,ma,11,7,"ion-item",20),t.YNc(19,Ua,16,7,"ng-container",42),t.ALo(20,"slice"),t.TgZ(21,"ion-grid")(22,"ion-row")(23,"ion-col",34),t._uU(24," \xa0 "),t.qZA(),t.TgZ(25,"ion-col",40),t.YNc(26,Ma,6,6,"ion-item",43),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(5),t.s9C("placeholder",t.lcZ(6,9,"product.select-option")),t.Q6J("ngModel",e.listOption),t.xp6(3),t.Oqu(t.lcZ(9,11,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(12,13,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(15,15,"product.list-option-quantiy")),t.xp6(3),t.Q6J("ngIf",e.products&&e.products.length),t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(1),t.Q6J("ngForOf",t.Dn7(20,17,e.products,e.start,e.end+1)),t.xp6(7),t.Q6J("ngIf",e.products&&e.products.length)}}function La(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function Ea(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",47),t.qZA(),t.TgZ(3,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",48),t.qZA()()}}function Oa(i,c){if(1&i&&(t.TgZ(0,"ion-item",35)(1,"ion-label",44),t._uU(2),t.ALo(3,"translate"),t.YNc(4,La,3,4,"span",20),t.qZA(),t.YNc(5,Ea,5,0,"ion-buttons",45),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function Ya(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-buttons")(3,"ion-button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.multiDelete())}),t._uU(4),t.ALo(5,"translate"),t._UZ(6,"ion-icon",51),t.qZA(),t.TgZ(7,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exitSelectMode())}),t._uU(8),t.ALo(9,"translate"),t._UZ(10,"ion-icon",52),t.qZA()()()()}2&i&&(t.xp6(4),t.hij(" ",t.lcZ(5,2,"product-detail.delete-multi")," "),t.xp6(4),t.hij(" ",t.lcZ(9,4,"product-detail.exit-select-mode")," "))}function Fa(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",49),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.isSelectAll=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.selectAll())}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("ngModel",e.isSelectAll)}}function Ga(i,c){1&i&&(t.TgZ(0,"ion-col",69)(1,"ion-item",35)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"product-add.cost-price")))}function Ka(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-checkbox",58),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.isSelected=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.isSelected)}}function Ha(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0(",e.unit,")")}}function Da(i,c){if(1&i&&(t.TgZ(0,"ion-col",69)(1,"ion-item",35),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,B,e.costPrice,o.currency,o.translateService.currentLang))," ")}}function Ba(i,c){if(1&i&&(t.TgZ(0,"ion-thumbnail",75),t._UZ(1,"img",60),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatarUrl,t.LSH)}}function ja(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0(",e.unit,")")}}function $a(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-row",72),t.NdJ("press",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.presentActionSheet(n))})("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.selectProduct(n.id))}),t.TgZ(1,"ion-col",34)(2,"ion-item",35),t._uU(3),t.YNc(4,ja,2,1,"span",20),t.qZA()(),t.TgZ(5,"ion-col",69)(6,"ion-item",35),t._uU(7),t.ALo(8,"currency"),t.qZA()(),t.TgZ(9,"ion-col",69)(10,"ion-item",35),t._uU(11," \xa0 "),t.qZA()(),t.TgZ(12,"ion-col",71)(13,"ion-item",35),t._uU(14),t.qZA()(),t.TgZ(15,"ion-col",71)(16,"ion-item",35),t._uU(17),t.qZA()(),t.TgZ(18,"ion-col",69)(19,"ion-item",35),t._uU(20," \xa0 "),t.qZA()()()}if(2&i){const e=c.$implicit,o=t.oxw().$implicit,n=t.oxw(2);t.Udp("cursor","pointer"),t.xp6(3),t.hij(" ",n.limitText(n.productName(o.code,o.title)),""),t.xp6(1),t.Q6J("ngIf",o.units&&o.units.length),t.xp6(3),t.hij(" ",t.G7q(8,7,t.kEZ(13,B,e.price,n.currency,n.translateService.currentLang))," "),t.xp6(7),t.hij(" ",n.store?o.storeQuantity?n.floor(o.storeQuantity*e.exchange):0:n.floor(o.count/e.exchange)," "),t.xp6(3),t.hij(" ",e.unit," ")}}function Va(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-row",72),t.NdJ("press",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.presentActionSheet(r))})("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return t.KtG(a.selectProduct(r.id))}),t.TgZ(2,"ion-col",34)(3,"ion-item",35),t.YNc(4,Ka,1,1,"ion-checkbox",54),t._uU(5),t.YNc(6,Ha,2,1,"span",20),t.qZA()(),t.TgZ(7,"ion-col",69)(8,"ion-item",35),t._uU(9),t.ALo(10,"currency"),t.qZA()(),t.YNc(11,Da,4,11,"ion-col",70),t.TgZ(12,"ion-col",71)(13,"ion-item",35),t._uU(14),t.qZA()(),t.TgZ(15,"ion-col",71)(16,"ion-item",35),t._uU(17),t.qZA()(),t.TgZ(18,"ion-col",69)(19,"ion-item",35),t.YNc(20,Ba,2,1,"ion-thumbnail",73),t.qZA()()(),t.YNc(21,$a,21,17,"ion-row",74),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(2);t.xp6(1),t.Udp("cursor","pointer"),t.xp6(3),t.Q6J("ngIf",o.selectMode),t.xp6(1),t.hij(" ",o.limitText(o.productName(e.code,e.title)),""),t.xp6(1),t.Q6J("ngIf",e.units&&e.units.length),t.xp6(3),t.hij(" ",t.G7q(10,11,t.kEZ(17,B,e.price,o.currency,o.translateService.currentLang))," "),t.xp6(2),t.Q6J("ngIf",o.canViewProductCostPrice),t.xp6(3),t.hij(" ",o.store?e.storeQuantity?e.storeQuantity:0:e.count," "),t.xp6(3),t.hij(" ",e.unit," "),t.xp6(3),t.Q6J("ngIf",e.avatarUrl),t.xp6(1),t.Q6J("ngForOf",e.units)}}function za(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.AsE("/ ",t.lcZ(2,2,"common.page")," ",e.currentPage+1,"")}}function Wa(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",4)(1,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.previousPage())}),t._UZ(2,"ion-icon",47),t.qZA(),t.TgZ(3,"ion-button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.nextPage())}),t._UZ(4,"ion-icon",48),t.qZA()()}}function Ra(i,c){if(1&i&&(t.TgZ(0,"ion-item",35)(1,"ion-label",44),t._uU(2),t.ALo(3,"translate"),t.YNc(4,za,3,4,"span",20),t.qZA(),t.YNc(5,Wa,5,0,"ion-buttons",45),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.AsE(" ",e.products.length," ",t.lcZ(3,4,"common.products")," "),t.xp6(2),t.Q6J("ngIf",e.isShowPaging),t.xp6(1),t.Q6J("ngIf",e.isShowPaging)}}function Xa(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",34)(3,"ion-item",35)(4,"ion-buttons")(5,"ion-button",65),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showSelect())}),t._UZ(6,"ion-icon",66),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"ion-select",36),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.listOption=n)})("ngModelChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeListOption())}),t.ALo(10,"translate"),t.TgZ(11,"ion-select-option",37),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"ion-select-option",38),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ion-select-option",39),t._uU(18),t.ALo(19,"translate"),t.qZA()()()(),t.TgZ(20,"ion-col",40),t.YNc(21,Oa,6,6,"ion-item",67),t.qZA()(),t.YNc(22,Ya,11,6,"ion-row",20),t.TgZ(23,"ion-row")(24,"ion-col",34)(25,"ion-item",35),t.YNc(26,Fa,1,1,"ion-checkbox",68),t.TgZ(27,"strong"),t._uU(28),t.ALo(29,"translate"),t.qZA()()(),t.TgZ(30,"ion-col",69)(31,"ion-item",35)(32,"strong"),t._uU(33),t.ALo(34,"translate"),t.qZA()()(),t.YNc(35,Ga,5,3,"ion-col",70),t.TgZ(36,"ion-col",71)(37,"ion-item",35)(38,"strong"),t._uU(39),t.ALo(40,"translate"),t.qZA()()(),t.TgZ(41,"ion-col",71)(42,"ion-item",35)(43,"strong"),t._uU(44),t.ALo(45,"translate"),t.qZA()()(),t.TgZ(46,"ion-col",69)(47,"ion-item",35)(48,"strong"),t._uU(49),t.ALo(50,"translate"),t.qZA()()()(),t.YNc(51,Va,22,21,"ng-container",42),t.ALo(52,"slice"),t.TgZ(53,"ion-row")(54,"ion-col",34),t._uU(55," \xa0 "),t.qZA(),t.TgZ(56,"ion-col",40),t.YNc(57,Ra,6,6,"ion-item",67),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(7),t.hij(" ",t.lcZ(8,17,"product-detail.multi-select")," "),t.xp6(2),t.s9C("placeholder",t.lcZ(10,19,"product.select-option")),t.Q6J("ngModel",e.listOption),t.xp6(3),t.Oqu(t.lcZ(13,21,"product.list-option-all")),t.xp6(3),t.Oqu(t.lcZ(16,23,"product.list-option-expiry")),t.xp6(3),t.Oqu(t.lcZ(19,25,"product.list-option-quantiy")),t.xp6(3),t.Q6J("ngIf",e.products&&e.products.length),t.xp6(1),t.Q6J("ngIf",e.selectMode),t.xp6(4),t.Q6J("ngIf",e.selectMode),t.xp6(2),t.Oqu(t.lcZ(29,27,"product-add.product-title")),t.xp6(5),t.Oqu(t.lcZ(34,29,"product-add.price")),t.xp6(2),t.Q6J("ngIf",e.canViewProductCostPrice),t.xp6(4),t.Oqu(t.lcZ(40,31,"product-add.count")),t.xp6(5),t.Oqu(t.lcZ(45,33,"product-add.unit")),t.xp6(5),t.Oqu(t.lcZ(50,35,"product-detail.photo")),t.xp6(2),t.Q6J("ngForOf",t.Dn7(52,37,e.products,e.start,e.end+1)),t.xp6(6),t.Q6J("ngIf",e.products&&e.products.length)}}function ts(i,c){1&i&&(t.TgZ(0,"ion-item",76),t._UZ(1,"div",77),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,"material.no-product"),t.oJD))}function es(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",78),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.goHelpPage("product"))}),t._UZ(1,"ion-icon",79),t.TgZ(2,"ion-label",80),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"help-product.title")," "))}const os=[{path:"",component:ro},{path:"detail",component:Vn},{path:"edit",component:yi},{path:"quick-add",component:cc},{path:"import",component:Ii},{path:"export",component:mr},{path:"attribute",component:lc},{path:"type",component:Nc},{path:"add-attribute",component:lt},{path:"add-type",component:Uc},{path:"add-type-value",component:Jc},{path:"type-selector",component:ta},{path:"expiries",component:Tc},{path:"add-barcode",component:_t},{path:"barcode",component:(()=>{class i{constructor(e,o,n,r,a,d,u,p){var _=this;this.navCtrl=e,this.modalCtrl=o,this.userService=n,this.staffService=r,this.productService=a,this.analyticsService=d,this.translateService=u,this.alertCtrl=p,this.units=null,this.searchKey="",this.reloadProductBarcodes=(0,l.Z)(function*(){_.params=_.navCtrl.getParams(_.params),_.params&&(_.callback=_.params.callback,_.productId=_.params.productId,_.productBarcodesSaved=_.params.productBarcodesSaved,_.units=_.params.units);const g=yield _.navCtrl.loading();if(_.currency=yield _.userService.getAttr("current-currency"),0===_.productId)return _.productBarcodesSaved&&_.productBarcodesSaved.length&&(_.originalProductBarcodes=JSON.parse(JSON.stringify(_.productBarcodesSaved)),_.productBarcodes=JSON.parse(JSON.stringify(_.productBarcodesSaved))),void(yield g.dismiss());_.productService.getProductBarcodes(_.productId).then(function(){var m=(0,l.Z)(function*(y){yield g.dismiss(),_.originalProductBarcodes=JSON.parse(JSON.stringify(y)),_.productBarcodes=y});return function(y){return m.apply(this,arguments)}}())}),this.navCtrl.removeEventListener("reloadProductBarcodes",this.reloadProductBarcodes),this.navCtrl.addEventListener("reloadProductBarcodes",this.reloadProductBarcodes)}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("product-barcode")})()}ngOnInit(){this.reloadProductBarcodes()}dateFormat(e){return C.C.toUiString(e)}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("search-product-barcode-search");let o=e.originalProductBarcodes?JSON.parse(JSON.stringify(e.originalProductBarcodes)):[];if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.barcode&&-1!==r.barcode.toLowerCase().indexOf(n))}e.productBarcodes=o})()}clearSearch(){this.searchKey=null,this.reloadProductBarcodes()}dismiss(){var e=this;return(0,l.Z)(function*(){let o=!1;if(0===e.productId){const n=e.productBarcodesSaved&&e.productBarcodesSaved.length,r=e.productBarcodes&&e.productBarcodes.length;n&&r?o=JSON.stringify(e.productBarcodesSaved)!==JSON.stringify(e.productBarcodes):(r&&!n||!r&&n)&&(o=!0)}var r;if(!o)return e.callback?(e.callback(e.productBarcodesSaved),void e.navCtrl.back()):void e.modalCtrl.dismiss(e.productBarcodesSaved);yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-barcode.dismiss-with-data-warning"),buttons:[{text:e.translateService.instant("common.agree"),handler:(r=(0,l.Z)(function*(){if(e.callback)return e.callback(null),void e.navCtrl.back();e.modalCtrl.dismiss()}),function(){return r.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}save(){if(this.callback)return this.callback(this.productBarcodes),void this.navCtrl.back();this.modalCtrl.dismiss(this.productBarcodes)}removeProductBarcode(e,o){var n=this;return(0,l.Z)(function*(){var a;yield(yield n.alertCtrl.create({header:n.translateService.instant("common.confirm"),message:n.translateService.instant("product-barcode.delete-warning"),buttons:[{text:n.translateService.instant("common.agree"),handler:(a=(0,l.Z)(function*(){if(0===n.productId)return void n.productBarcodes.splice(o,1);const d=yield n.navCtrl.loading();n.productService.deleteProductBarcode(e).then((0,l.Z)(function*(){yield d.dismiss(),n.analyticsService.logEvent("product-barcode-delete-success"),n.navCtrl.publish("reloadProductBarcodes"),n.navCtrl.publish("reloadProduct",{id:n.productId})})).catch(function(){var u=(0,l.Z)(function*(p){console.error(p),yield d.dismiss()});return function(p){return u.apply(this,arguments)}}())}),function(){return a.apply(this,arguments)})},{text:n.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}selectProduct(e){var o=this;return(0,l.Z)(function*(){yield(yield o.modalCtrl.create({component:_t,componentProps:{productId:o.productId,productBarcodeId:e.id,productBarcodeToEdit:e,units:o.units}})).present()})()}productName(e,o){return Z.W.productName(e,o)}openProductBarcodeAdd(){var e=this;return(0,l.Z)(function*(){const o=yield e.modalCtrl.create({component:_t,componentProps:{productId:e.productId,productBarcodeId:0,units:e.units}});yield o.present();const{data:n}=yield o.onDidDismiss();!n||0===e.productId&&(e.productBarcodes||(e.productBarcodes=[]),e.productBarcodes.push(n),e.originalProductBarcodes||(e.originalProductBarcodes=[]),e.originalProductBarcodes.push(n))})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.G),t.Y36(s.IN),t.Y36(E.K),t.Y36(A.x),t.Y36(N.M),t.Y36(Q.y),t.Y36(b.sK),t.Y36(s.Br))},i.\u0275cmp=t.Xpm({type:i,selectors:[["product-barcode"]],inputs:{productId:"productId",units:"units",productBarcodesSaved:"productBarcodesSaved"},decls:21,vars:16,consts:[["slot","start"],[3,"click"],["name","close"],[1,"ion-text-start",2,"font-weight","bold"],["slot","end"],["size","large","color","primary",3,"hidden","click"],["name","add-circle"],["size","large","color","primary",3,"click",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["text-wrap","",4,"ngFor","ngForOf"],["text-wrap","",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",3,"hidden"],["name","add"],["size","large","color","primary",3,"click"],["name","checkmark"],["text-wrap",""],[2,"white-space","pre-wrap"],[4,"ngIf"],["slot","end",3,"hidden"],["name","close-circle"],["name","create"],[3,"innerHTML"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return o.dismiss()}),t._UZ(4,"ion-icon",2),t.qZA()(),t.TgZ(5,"ion-label",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"ion-buttons",4)(9,"ion-button",5),t.NdJ("click",function(){return o.openProductBarcodeAdd()}),t._UZ(10,"ion-icon",6),t.qZA(),t.YNc(11,ia,4,3,"ion-button",7),t.qZA()()(),t.TgZ(12,"ion-content")(13,"ion-searchbar",8),t.NdJ("ionClear",function(){return o.clearSearch()})("ionChange",function(){return o.search()})("ngModelChange",function(r){return o.searchKey=r}),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"ion-list"),t.YNc(16,ca,10,3,"ion-item",9),t.YNc(17,aa,3,3,"ion-item",10),t.qZA(),t.TgZ(18,"ion-fab",11)(19,"ion-fab-button",1),t.NdJ("click",function(){return o.openProductBarcodeAdd()}),t._UZ(20,"ion-icon",12),t.qZA()()()),2&e&&(t.xp6(6),t.hij(" ",t.lcZ(7,12,"product-barcode.title")," "),t.xp6(3),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()),t.xp6(2),t.Q6J("ngIf",0===o.productId),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.s9C("placeholder",t.lcZ(14,14,"product-barcode.search")),t.Q6J("ngModel",o.searchKey),t.xp6(3),t.Q6J("ngForOf",o.productBarcodes),t.xp6(1),t.Q6J("ngIf",!o.originalProductBarcodes||0===o.originalProductBarcodes.length),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"margin-bottom: 60px":""),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.W2,s.IJ,s.W4,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.VI,s.sr,s.j9,b.X$],encapsulation:2}),i})()},{path:"material",component:(()=>{class i{constructor(e,o,n,r,a,d,u,p,_,g,m,y,k,J,U,v){var f=this;this.platform=e,this.barcodeScanner=o,this.productService=n,this.staffService=r,this.debtService=a,this.translateService=d,this.userService=u,this.actionSheetCtrl=p,this.alertCtrl=_,this.modalCtrl=g,this.dataService=m,this.navCtrl=y,this.analyticsService=k,this.planService=J,this.storeService=U,this.excelService=v,this.searchKey="",this.isMobile=!0,this.checkProduct=0,this.currentPlan=null,this.start=0,this.end=20,this.pageSize=20,this.currentPage=0,this.listOption="all",this.selectMode=!1,this.isSelectAll=!1,this.canViewProductCostPrice=!1,this.reload=(0,l.Z)(function*(){const w=yield f.navCtrl.loading();f.isMobile=f.platform.width()<720,f.currency=yield f.userService.getAttr("current-currency"),f.currentPlan=yield f.planService.getCurrentPlan(),f.selectedStaff=f.staffService.selectedStaff,f.store=yield f.storeService.getCurrentStore(),f.canViewProductCostPrice=!f.selectedStaff||f.selectedStaff.hasFullAccess||f.selectedStaff.canViewProductCostPrice,f.checkStore=f.store?f.translateService.instant("store.check-store",{shop:f.store.name}):null,f.currentPlan||(f.checkProduct=yield f.planService.checkProduct(),f.checkProduct>=30&&(f.isOnTrial=yield f.planService.isOnTrial(f.currentPlan))),("all"===f.listOption?f.productService.getProducts(f.store?f.store.id:0,!0):"expiry"===f.listOption?f.productService.getProductsExpiry(f.store?f.store.id:0,!0):f.productService.getProductsQuantity(f.store?f.store.id:0,!0)).then(function(){var h=(0,l.Z)(function*(G){for(const j of G)j.units=j.unitsJson?JSON.parse(j.unitsJson):[];f.originalProducts=JSON.parse(JSON.stringify(G)),f.products=G,yield w.dismiss()});return function(G){return h.apply(this,arguments)}}())}),this.doEnteredBarcode=w=>{!w||this.productService.searchByBarcode(w).then(S=>{if(S)return this.analyticsService.logEvent("product-scan-barcode-ok"),void this.navCtrl.push("/product/detail",{id:S.id});this.navCtrl.push("/product/quick-add",{barcode:w})})},this.navCtrl.removeEventListener("reloadProductList",this.reload),this.navCtrl.addEventListener("reloadProductList",this.reload)}ngOnInit(){this.platform.resize.subscribe(()=>{this.isMobile=this.platform.width()<720}),this.reload()}ionViewWillEnter(){var e=this;return(0,l.Z)(function*(){yield e.analyticsService.setCurrentScreen("home")})()}openProductAdd(){var e=this;return(0,l.Z)(function*(){if(e.staffService.canAddUpdateProduct())return!e.currentPlan&&e.checkProduct>=30&&!e.isOnTrial?(e.analyticsService.logEvent("check-product-alert"),void alert(e.translateService.instant("product.check-product-alert",{total:e.checkProduct}))):void e.navCtrl.push("/product/quick-add",{isMaterial:!0});alert(e.translateService.instant("product.no-permission"))})()}isNotCordova(){return this.navCtrl.isNotCordova()}scanProduct(){var e=this;return(0,l.Z)(function*(){if(e.analyticsService.logEvent("product-scan-barcode"),e.navCtrl.isNotCordova()){const o=yield e.modalCtrl.create({component:Y.k});yield o.present();const{data:n}=yield o.onDidDismiss();n&&n.barcode&&e.doEnteredBarcode(n.barcode)}else e.barcodeScanner.scan().then(o=>{!o||!o.text||e.doEnteredBarcode(o.text)})})()}search(){var e=this;return(0,l.Z)(function*(){e.analyticsService.logEvent("product-search");let o=JSON.parse(JSON.stringify(e.originalProducts));if(null!==e.searchKey&&""!==e.searchKey){const n=e.searchKey.toLowerCase();o=o.filter(r=>r.code&&-1!==r.code.toLowerCase().indexOf(n)||r.title&&-1!==r.title.toLowerCase().indexOf(n)||r.barcode&&-1!==r.barcode.toLowerCase().indexOf(n))}e.products=o,e.start=0,e.end=e.pageSize,e.currentPage=0})()}clearSearch(){this.searchKey=null,this.reload()}limitText(e,o=200){return Z.W.limitText(e,o)}selectProduct(e){if(!this.selectMode)try{this.navCtrl.navigateForward("/product/detail",{id:e})}catch(o){console.error(o),alert(o)}}deleteProduct(e){var o=this;return(0,l.Z)(function*(){o.staffService.canAddUpdateProduct()?yield(yield o.alertCtrl.create({header:o.translateService.instant("common.confirm"),message:o.translateService.instant("product-detail.delete-alert"),buttons:[{text:o.translateService.instant("common.agree"),handler:()=>{o.productService.deleteProduct(e).then((0,l.Z)(function*(){o.analyticsService.logEvent("product-delete-success");let a=o.products.findIndex(d=>d.id===e.id);a>=0&&o.products.splice(a,1),a=o.originalProducts.findIndex(d=>d.id===e.id),a>=0&&o.originalProducts.splice(a,1)}))}},{text:o.translateService.instant("common.cancel"),handler:()=>{}}]})).present():alert(o.translateService.instant("product.no-permission"))})()}importProducts(){if(!this.currentPlan&&this.checkProduct>=30&&!this.isOnTrial)return this.analyticsService.logEvent("check-product-alert"),void alert(this.translateService.instant("product.check-product-alert",{total:this.checkProduct}));this.navCtrl.navigateForward("/product/import",{isMaterial:!0})}presentActionSheet(e){var o=this;return(0,l.Z)(function*(){yield(yield o.actionSheetCtrl.create({header:o.translateService.instant("action.action"),buttons:[{text:o.translateService.instant("product-detail.delete"),role:"destructive",handler:()=>{o.deleteProduct(e)}},{text:o.translateService.instant("product-detail.view-detail"),handler:()=>{o.selectProduct(e.id)}},{text:o.translateService.instant("product-detail.multi-select"),handler:()=>{o.selectMode=!0}},{text:o.translateService.instant("common.cancel"),role:"cancel",handler:()=>{}}]})).present()})()}productName(e,o){return Z.W.productName(e,o)}removeProductDebts(e){return new Promise((o,n)=>{this.debtService.getDebtsByContact(e).then(r=>{const a=[];if(r&&r.length>0)for(const d of r){d.productId=0;const u=this.debtService.saveDebt(d);a.push(u)}a.length>0?Promise.all(a).then(()=>{o(!0)}).catch(()=>{n(null)}):o(!0)}).catch(()=>{n(null)})})}exportProductNotesReport(e){this.navCtrl.navigateForward("/product/export",{reportType:e})}goHelpPage(e){this.navCtrl.push("/help/"+e)}exportProductsReport(){var e=this;return(0,l.Z)(function*(){const o="products-report.xlsx",n=yield e.navCtrl.loading();e.excelService.downloadProductsReport(o,!0).then(function(){var r=(0,l.Z)(function*(a){e.analyticsService.logEvent("product-export-to-excel-success"),yield n.dismiss(),e.navCtrl.isNotCordova()||(yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("report.file-save-alert")+a,buttons:[{text:e.translateService.instant("common.agree"),handler:()=>{}}]})).present(),e.userService.shareFileUrl(o,o,a))});return function(a){return r.apply(this,arguments)}}())})()}requestProPlan(){this.navCtrl.push("/request-pro")}dateFormat(e){return C.C.toUiDateString(e)}showExpiries(){this.navCtrl.navigateForward("/product/expiries")}get isShowPaging(){return!!(this.products&&this.products.length>this.pageSize)}previousPage(){this.currentPage<=0?this.currentPage=0:(this.currentPage--,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.isSelectAll=!1)}nextPage(){(this.currentPage+1)*this.pageSize>=this.products.length||(this.currentPage++,this.start=this.currentPage*this.pageSize,this.end=this.start+this.pageSize-1,this.isSelectAll=!1)}changeListOption(){this.start=0,this.end=19,this.currentPage=0,this.reload()}showSelect(){this.selectMode=!0,this.isSelectAll=!1}exitSelectMode(){this.selectMode=!1,this.isSelectAll=!1;for(const e of this.products)e.isSelected=!1}multiDelete(){var e=this;return(0,l.Z)(function*(){const o=e.products?e.products.filter(r=>r.isSelected).length:0;var r;0!==o?yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("product-detail.multi-delete-alert",{count:o}),buttons:[{text:e.translateService.instant("common.agree"),handler:(r=(0,l.Z)(function*(){const a=yield e.navCtrl.loading(),d=[],u=[];for(const p of e.products)p.isSelected&&(d.push(p),u.push(e.productService.deleteProduct(p)));yield Promise.all(u);for(const p of d){e.analyticsService.logEvent("product-delete-success");let _=e.products.findIndex(g=>g.id===p.id);_>=0&&e.products.splice(_,1),_=e.originalProducts.findIndex(g=>g.id===p.id),_>=0&&e.originalProducts.splice(_,1)}e.selectMode=!1,yield a.dismiss()}),function(){return r.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present():alert(e.translateService.instant("product-detail.multi-delete-no-product-alert"))})()}selectAll(){for(const e of this.products)e.isSelected=!1;for(let e=this.start;e<this.end;e++)this.products[e].isSelected=this.isSelectAll}exitStore(){var e=this;return(0,l.Z)(function*(){var n;yield(yield e.alertCtrl.create({header:e.translateService.instant("common.confirm"),message:e.translateService.instant("store.exit-store-alert",{shop:e.store.name}),buttons:[{text:e.translateService.instant("common.agree"),handler:(n=(0,l.Z)(function*(){yield e.storeService.exitStore(),yield e.reload()}),function(){return n.apply(this,arguments)})},{text:e.translateService.instant("common.cancel"),handler:()=>{}}]})).present()})()}floor(e){return Math.floor(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.t4),t.Y36(I.m),t.Y36(N.M),t.Y36(A.x),t.Y36(L.E),t.Y36(b.sK),t.Y36(E.K),t.Y36(s.BX),t.Y36(s.Br),t.Y36(s.IN),t.Y36(et.D),t.Y36(M.G),t.Y36(Q.y),t.Y36(it.D),t.Y36(D.d),t.Y36($.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["material"]],decls:61,vars:30,consts:[["slot","start"],["menu","first"],["color","primary",3,"click"],["name","home"],["slot","end"],["size","large","color","success",3,"click"],["slot","icon-only","name","barcode-sharp"],["size","large","root","product-add",3,"click"],["slot","icon-only","name","add-circle-sharp"],["lines","none","color","success",4,"ngIf"],["debounce","700",3,"placeholder","ngModel","ionClear","ionChange","ngModelChange"],["style","padding: 10px; margin: 10px; background-color: #f0ad4e; color: white; border-radius: 10px;",4,"ngIf"],["size-xs","3","size-sm","3","size-md","2","size-md","2",1,"ion-no-padding",2,"padding-right","0px","padding-left","9px"],["lines","none",1,"ion-no-padding",2,"border","1px solid #bbb","border-radius","10px","height","100px","cursor","pointer",3,"click"],[1,"ion-text-wrap","ion-text-center",2,"padding-left","5px","margin-right","0"],["name","document-attach","color","danger",2,"font-size","30px"],[1,"ion-text-wrap",2,"font-size","0.8em"],["name","reader","color","secondary",2,"font-size","30px"],["name","document","color","tertiary",2,"font-size","30px"],["name","newspaper","color","warning",2,"font-size","30px"],[4,"ngIf"],["class","ion-text-wrap","lines","none",4,"ngIf"],["button","","detail","","lines","none",3,"click",4,"ngIf"],["vertical","bottom","horizontal","start","slot","fixed",3,"hidden"],[3,"click"],["name","add"],["lines","none","color","success"],[1,"ion-text-wrap"],["size","small",3,"click"],["name","exit","slot","start","size","small"],[2,"padding","10px","margin","10px","background-color","#f0ad4e","color","white","border-radius","10px"],[2,"margin","5px 5px 5px 5px"],["color","success","fill","solid",3,"click"],["name","gift","slot","start"],["size","4",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],[2,"max-width","100% !important",3,"placeholder","ngModel","ngModelChange"],["value","all"],["value","expiry"],["value","quantity"],["size","8",1,"ion-no-padding"],["lines","none","class","ion-no-padding",4,"ngIf"],[4,"ngFor","ngForOf"],["lines","none","class","ion-no-padding","lines","none",4,"ngIf"],[1,"ion-text-wrap","ion-text-right"],["slot","end",4,"ngIf"],["fill","solid",3,"click"],["slot","icon-only","name","arrow-back-circle"],["slot","icon-only","name","arrow-forward-circle"],["slot","start","color","primary",3,"ngModel","ngModelChange"],["color","danger",3,"click"],["name","trash","slot","end"],["name","exit-outline","slot","end"],[3,"click","press"],["color","primary","slot","start",3,"ngModel","ngModelChange",4,"ngIf"],[2,"white-space","pre-wrap","font-weight","bold"],["side","end"],["slot","icon-only","name","ellipsis-vertical"],["color","primary","slot","start",3,"ngModel","ngModelChange"],["name","calendar"],[3,"src"],["style","--min-height: 0",3,"lines","click","press",4,"ngFor","ngForOf"],[2,"--min-height","0",3,"lines","click","press"],[1,"ion-text-wrap",2,"margin","5px 0 0 0"],["lines","none","lines","none",1,"ion-no-padding"],["color","primary","fill","clear",3,"click"],["slot","start","name","list-outline"],["class","ion-no-padding","lines","none",4,"ngIf"],["slot","start","color","primary",3,"ngModel","ngModelChange",4,"ngIf"],["size","2",1,"ion-no-padding"],["class","ion-no-padding","size","2",4,"ngIf"],["size","1",1,"ion-no-padding"],[2,"border-bottom","1px solid #ccc",3,"press","click"],["class","ion-item-right","size","small",4,"ngIf"],["style","border-bottom: 1px solid #ccc;",3,"cursor","press","click",4,"ngFor","ngForOf"],["size","small",1,"ion-item-right"],["lines","none",1,"ion-text-wrap"],[3,"innerHTML"],["button","","detail","","lines","none",3,"click"],["name","help","slot","start"],["color","primary"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-menu-button",1),t.TgZ(4,"ion-button",2),t.NdJ("click",function(){return o.navCtrl.home()}),t._UZ(5,"ion-icon",3),t.qZA()(),t.TgZ(6,"ion-title"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"ion-buttons",4)(10,"ion-button",5),t.NdJ("click",function(){return o.scanProduct()}),t._UZ(11,"ion-icon",6),t.qZA(),t.TgZ(12,"ion-button",7),t.NdJ("click",function(){return o.openProductAdd()}),t._UZ(13,"ion-icon",8),t.qZA()()(),t.YNc(14,da,8,4,"ion-item",9),t.TgZ(15,"ion-searchbar",10),t.NdJ("ionClear",function(){return o.clearSearch()})("ionChange",function(){return o.search()})("ngModelChange",function(r){return o.searchKey=r}),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"ion-content"),t.YNc(18,la,8,6,"div",11),t.TgZ(19,"ion-grid")(20,"ion-row")(21,"ion-col",12)(22,"ion-item",13),t.NdJ("click",function(){return o.importProducts()}),t.TgZ(23,"ion-label",14),t._UZ(24,"ion-icon",15)(25,"br"),t.TgZ(26,"ion-text",16),t._uU(27),t.ALo(28,"translate"),t.qZA()()()(),t.TgZ(29,"ion-col",12)(30,"ion-item",13),t.NdJ("click",function(){return o.exportProductsReport()}),t.TgZ(31,"ion-label",14),t._UZ(32,"ion-icon",17)(33,"br"),t.TgZ(34,"ion-text",16),t._uU(35),t.ALo(36,"translate"),t.qZA()()()(),t.TgZ(37,"ion-col",12)(38,"ion-item",13),t.NdJ("click",function(){return o.exportProductNotesReport(0)}),t.TgZ(39,"ion-label",14),t._UZ(40,"ion-icon",18)(41,"br"),t.TgZ(42,"ion-text",16),t._uU(43),t.ALo(44,"translate"),t.qZA()()()(),t.TgZ(45,"ion-col",12)(46,"ion-item",13),t.NdJ("click",function(){return o.exportProductNotesReport(1)}),t.TgZ(47,"ion-label",14),t._UZ(48,"ion-icon",19)(49,"br"),t.TgZ(50,"ion-text",16),t._uU(51),t.ALo(52,"translate"),t.qZA()()()()()(),t.TgZ(53,"ion-list"),t.YNc(54,Qa,27,21,"ng-container",20),t.YNc(55,Xa,58,41,"ion-grid",20),t.YNc(56,ts,3,3,"ion-item",21),t.YNc(57,es,5,3,"ion-item",22),t.qZA(),t.TgZ(58,"ion-fab",23)(59,"ion-fab-button",24),t.NdJ("click",function(){return o.openProductAdd()}),t._UZ(60,"ion-icon",25),t.qZA()()()),2&e&&(t.xp6(7),t.Oqu(t.lcZ(8,18,"material.title")),t.xp6(7),t.Q6J("ngIf",o.checkStore&&(null==o.selectedStaff||o.selectedStaff.hasFullAccess&&!o.selectedStaff.storeId)),t.xp6(1),t.s9C("placeholder",t.lcZ(16,20,"material.search")),t.Q6J("ngModel",o.searchKey),t.xp6(2),t.Akn(o.navCtrl.hasAds()?"--padding-bottom: 60px":""),t.xp6(1),t.Q6J("ngIf",!o.currentPlan&&!o.isOnTrial),t.xp6(9),t.hij("",t.lcZ(28,22,"material.import-from-excel")," "),t.xp6(8),t.hij("",t.lcZ(36,24,"material.export-to-excel")," "),t.xp6(8),t.hij(" ",t.lcZ(44,26,"product-note-export.report-type-summary")," "),t.xp6(8),t.hij(" ",t.lcZ(52,28,"product-note-export.report-type-detail")," "),t.xp6(3),t.Q6J("ngIf",o.isMobile),t.xp6(1),t.Q6J("ngIf",!o.isMobile&&o.products&&o.products.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Q6J("ngIf",!o.originalProducts||0===o.originalProducts.length),t.xp6(1),t.Akn(o.navCtrl.hasAds()?"margin-bottom: 60px":""),t.Q6J("hidden",!o.staffService.canAddUpdateProduct()))},dependencies:[T.sg,T.O5,P.JJ,P.On,s.YG,s.Sm,s.nz,s.wI,s.W2,s.IJ,s.W4,s.jY,s.Gu,s.gu,s.Ie,s.u8,s.IK,s.td,s.Q$,s.q_,s.fG,s.Nd,s.VI,s.t9,s.n0,s.yW,s.Bs,s.wd,s.sr,s.w,s.QI,s.j9,T.OU,T.H9,b.X$],encapsulation:2}),i})()}];let ns=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[X.Bz.forChild(os),X.Bz]}),i})();var is=x(529),bt=x(3093);let rs=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[T.H9],imports:[T.ez,P.u5,s.Pc,ns,bt.m,Ct.uH,b.aw.forChild({loader:{provide:b.Zw,useFactory:bt.x,deps:[is.eN]}})]}),i})()},360:(Pt,R,x)=>{x.d(R,{Y:()=>tt});var T=x(5861),P=x(6723),s=x(6738),X=x(5851),l=x(323),q=x(7852),Z=x(3306),Y=x(6895),C=x(191);function V(I,N){if(1&I){const A=s.EpF();s.TgZ(0,"ion-button",13),s.NdJ("click",function(){s.CHM(A);const b=s.oxw(2);return s.KtG(b.hideSupport())}),s._UZ(1,"ion-icon",14),s.qZA()}}function t(I,N){if(1&I){const A=s.EpF();s.TgZ(0,"div",1)(1,"ion-item",2),s.NdJ("click",function(){s.CHM(A);const b=s.oxw();return s.KtG(b.callPhone("+84869366606"))}),s.TgZ(2,"ion-label",3)(3,"h2")(4,"strong"),s._uU(5),s.ALo(6,"translate"),s.qZA()()(),s.YNc(7,V,2,0,"ion-button",4),s.qZA(),s.TgZ(8,"p")(9,"i"),s._uU(10),s.ALo(11,"translate"),s.qZA()(),s.TgZ(12,"ion-button",5),s.NdJ("click",function(){s.CHM(A);const b=s.oxw();return s.KtG(b.sendTicket())}),s._UZ(13,"ion-icon",6),s._uU(14),s.ALo(15,"translate"),s.qZA(),s.TgZ(16,"ion-grid")(17,"ion-row")(18,"ion-col",7)(19,"ion-item",8),s.NdJ("click",function(){s.CHM(A);const b=s.oxw();return s.KtG(b.callPhone("+84869366606"))}),s._UZ(20,"ion-icon",9),s.TgZ(21,"ion-label",10),s._uU(22),s.ALo(23,"translate"),s.qZA()()(),s.TgZ(24,"ion-col",7)(25,"ion-item",8),s.NdJ("click",function(){s.CHM(A);const b=s.oxw();return s.KtG(b.sendEmail("dlv.isale.app@gmail.com"))}),s._UZ(26,"ion-icon",11),s.TgZ(27,"ion-label",12),s._uU(28),s.ALo(29,"translate"),s.qZA()()()()()()}if(2&I){const A=s.oxw();s.xp6(5),s.hij("",s.lcZ(6,6,"common.contact"),":"),s.xp6(2),s.Q6J("ngIf",!A.neverHide),s.xp6(3),s.Oqu(s.lcZ(11,8,"ticket-add.send-ticket-note")),s.xp6(4),s.hij("\xa0 ",s.lcZ(15,10,"ticket-add.title")," "),s.xp6(8),s.hij(" ",s.lcZ(23,12,"common.hotline"),": (+84) 0383.838.394 "),s.xp6(6),s.hij(" ",s.lcZ(29,14,"common.email"),": dlv.isale.app@gmail.com ")}}let tt=(()=>{class I{constructor(A,L,b,E){this.navCtrl=A,this.analyticsService=L,this.storage=b,this.translate=E,this.neverHide=!1,this.isHide=!1}ngOnInit(){var A=this;return(0,T.Z)(function*(){A.isHide=!!(yield A.storage.get("hide-support"))})()}callPhone(A){!A||(this.analyticsService.logEvent("support-call-hotline"),P.W.callPhone(A))}sendEmail(A){!A||(this.analyticsService.logEvent("support-email"),P.W.sendEmail(A))}sendTicket(){this.navCtrl.push("/ticket/add",null)}hideSupport(){var A=this;return(0,T.Z)(function*(){A.analyticsService.logEvent("support-hide"),A.isHide=!0,alert(A.translate.instant("support.alert")),yield A.storage.set("hide-support","1")})()}}return I.\u0275fac=function(A){return new(A||I)(s.Y36(X.G),s.Y36(l.y),s.Y36(q.V),s.Y36(Z.sK))},I.\u0275cmp=s.Xpm({type:I,selectors:[["support"]],inputs:{neverHide:"neverHide"},decls:1,vars:1,consts:[["style","padding: 5px; border: 1px solid #D3679D; border-radius: 10px; margin-top: 10px;",4,"ngIf"],[2,"padding","5px","border","1px solid #D3679D","border-radius","10px","margin-top","10px"],["lines","none",1,"ion-no-padding",2,"padding-top","10px !important","min-height","0 !important","--min-height","0 !important",3,"click"],[2,"margin","0 !important","padding","0 !important"],["slot","end","size","small","fill","clear",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","mail"],[2,"padding","0 !important","margin","0 !important"],[1,"ion-no-padding",2,"padding-top","0px !important","cursor","pointer",3,"click"],["name","call","slot","start","color","tertiary"],[1,"ion-text-wrap"],["name","mail","slot","start","color","danger"],["color","danger",1,"ion-text-wrap"],["slot","end","size","small","fill","clear",3,"click"],["name","close","slot","icon-only"]],template:function(A,L){1&A&&s.YNc(0,t,30,16,"div",0),2&A&&s.Q6J("ngIf",!L.isHide||L.neverHide)},dependencies:[Y.O5,C.YG,C.wI,C.jY,C.gu,C.Ie,C.Q$,C.Nd,Z.X$],encapsulation:2}),I})()}}]);